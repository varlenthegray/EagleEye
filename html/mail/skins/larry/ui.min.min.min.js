function rcube_mail_ui(){var M={};var J={};var B={forwardmenu:{editable:1},searchmenu:{editable:1,callback:T},attachmentmenu:{},listoptions:{editable:1},groupmenu:{above:1},mailboxmenu:{above:1},spellmenu:{callback:K},"folder-selector":{iconized:1}};var U=this;var r;var N;var D={};var e;this.set=l;this.init=E;this.init_tabs=t;this.show_about=s;this.show_popup=A;this.toggle_popup=n;this.add_popup=F;this.set_searchmod=I;this.set_searchscope=q;this.show_uploadform=w;this.show_header_row=R;this.hide_header_row=b;this.update_quota=z;this.get_pref=a;this.save_pref=y;this.folder_search_init=L;if(window.$&&document.body){var p=a("minimalmode");if(parseInt(p)||(p===null&&$(window).height()<850)){$(document.body).addClass("minimal")}if(bw.tablet){$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}$(document).ready(function(){U.init()})}function l(V,W){M[V]=W}function a(W){if(!e){e=rcmail.local_storage_get_item("prefs.larry",{})}if(e[W]==null){var V=rcmail.get_cookie(W);if(V!=null){e[W]=V;if(rcmail.local_storage_set_item("prefs.larry",e)){rcmail.set_cookie(W,V,new Date())}}}return e[W]}function y(V,X){e[V]=X;if(!rcmail.local_storage_set_item("prefs.larry",e)){var W=new Date();W.setYear(W.getFullYear()+1);rcmail.set_cookie(V,X,W)}}function E(){rcmail.addEventListener("message",v);$("#taskbar a").each(function(ae,af){$(af).append('<span class="tooltip">'+$(".button-inner",this).html()+"</span>")});$("#taskbar .minmodetoggle").click(function(af){var ae=$(document.body).toggleClass("minimal").hasClass("minimal");y("minimalmode",ae?1:0);$(window).resize()});if(rcmail.env.task=="mail"){rcmail.addEventListener("menu-open",d).addEventListener("menu-close",d).addEventListener("menu-save",g).addEventListener("enable-command",j).addEventListener("responseafterlist",function(ae){H(rcmail.env.threading?"thread":"list",true)}).addEventListener("responseaftersearch",function(ae){H(rcmail.env.threading?"thread":"list",true)});var V=$("#dragmessagemenu");if(V.length){rcmail.gui_object("dragmenu","dragmessagemenu");J.dragmenu=V}if(rcmail.env.action=="show"||rcmail.env.action=="preview"){rcmail.addEventListener("aftershow-headers",function(){O()}).addEventListener("afterhide-headers",function(){O()});$("#previewheaderstoggle").click(function(ae){o();if(this.blur&&!rcube_event.is_keyboard(ae)){this.blur()}return false});$("#attachment-list > li").each(function(){i(this)});if(a("previewheaders")=="1"){o()}if(rcmail.env.action=="show"){$("#messagecontent").focus()}}else{if(rcmail.env.action=="compose"){rcmail.addEventListener("aftersend-attachment",w).addEventListener("fileappended",function(ae){if(ae.attachment.complete){i(ae.item)}}).addEventListener("aftertoggle-editor",function(ae){window.setTimeout(function(){S()},200);if(ae&&ae.mode){$("select[name='editorSelector']").val(ae.mode)}}).addEventListener("compose-encrypted",function(ae){$("select[name='editorSelector']").prop("disabled",ae.active);$("a.button.attach, a.button.responses")[(ae.active?"addClass":"removeClass")]("disabled");$("#responseslist a.insertresponse")[(ae.active?"removeClass":"addClass")]("active")});var aa,W,ac,Z=["cc","bcc","replyto","followupto"];for(aa=0;aa<Z.length;aa++){W=Z[aa];ac=$("#_"+W);if(ac.length){ac.on("change",{v:W},function(ae){if(this.value){R(ae.data.v,true)}});if(ac.val()!=""){R(W,true)}}}$("#composeoptionstoggle").click(function(af){var ae=$("#composeoptions").toggle().is(":visible");$("#composeoptionstoggle").toggleClass("remove").attr("aria-expanded",ae?"true":"false");S();y("composeoptions",ae?"1":"0");if(!rcube_event.is_keyboard(af)){this.blur()}return false}).css("cursor","pointer");if(a("composeoptions")!=="0"){$("#composeoptionstoggle").click()}$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(ae){k(this)}).change();rcmail.addEventListener("autocomplete_insert",function(ae){k(ae.field)});var ab=rcmail.opener();if(ab&&ab.env.action=="compose"&&$("#composeoptionstoggle",opener.document).hasClass("remove")){$("#composeoptionstoggle").click()}new rcube_splitter({id:"composesplitterv",p1:"#composeview-left",p2:"#composeview-right",orientation:"v",relative:true,start:206,min:170,size:12,render:S}).init();$("#attachment-list > li").each(function(){i(this)})}else{if(rcmail.env.action=="list"||!rcmail.env.action){x();$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(ae){H("list");return false});$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(ae){H("thread");return false});rcmail.init_pagejumper("#pagejumper");rcmail.addEventListener("setquota",z).addEventListener("layout-change",x).addEventListener("afterimport-messages",w)}else{if(rcmail.env.action=="get"){new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",orientation:"v",relative:true,start:226,min:150,size:12}).init()}}}}if($("#mailview-left").length){new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:true,start:206,min:150,size:12,callback:Q,render:C}).init()}}else{if(rcmail.env.task=="settings"){rcmail.addEventListener("init",function(){var ae="#settingstabpreferences";if(rcmail.env.action){ae="#settingstab"+(rcmail.env.action.indexOf("identity")>0?"identities":rcmail.env.action.replace(/\./g,""))}$(ae).addClass("selected").children().first().removeAttr("onclick").click(function(){return false})});if(rcmail.env.action=="folders"){new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:true,start:266,min:180,size:12}).init();rcmail.addEventListener("setquota",z);L($("#folderslist"))}else{if(rcmail.env.action=="identities"){new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="responses"){new rcube_splitter({id:"responseviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="preferences"||!rcmail.env.action){new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="edit-prefs"){var ad=$("#preferences-details fieldset.advanced legend"),Y=$('<a href="#toggle"></a>').text(rcmail.gettext("toggleadvancedoptions")).attr("title",rcmail.gettext("toggleadvancedoptions")).addClass("advanced-toggle");ad.click(function(ae){Y.html($(this).hasClass("collapsed")?"&#9650;":"&#9660;");$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).append(Y).addClass("collapsed");if(bw.mz){ad.parents("form").css("display","inline")}}}}}}}else{if(rcmail.env.task=="addressbook"){rcmail.addEventListener("afterupload-photo",w).addEventListener("beforepushgroup",u).addEventListener("beforepopgroup",f).addEventListener("menu-open",d).addEventListener("menu-close",d);if(rcmail.env.action==""){new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",p2:"#addressview-right",orientation:"v",relative:true,start:206,min:150,size:12,render:C}).init();new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:true,start:266,min:260,size:12}).init()}var V=$("#dragcontactmenu");if(V.length){rcmail.gui_object("dragmenu","dragcontactmenu");J.dragmenu=V}}}}$(".tabbed").each(function(ae,af){t(af)});$("select.decorated").each(function(){if(bw.opera){$(this).removeClass("decorated");return}var aj=$(this),ag=aj.parent(),ai=Math.max(aj.height(),26)-2,af=aj.width()-22,ah=$("option",this).first().text();if($("option:selected",this).val()!=""){ah=$("option:selected",this).text()}var ae=$('<a class="menuselector" tabindex="-1"><span class="handle">'+ah+"</span></a>").css("position","absolute").offset(aj.position()).insertAfter(aj);ae.children().width(af).height(ai).css("line-height",(ai-1)+"px");if(ag.css("position")!="absolute"){ag.css("position","relative")}aj.width(ae.width()).on(bw.mz?"change keyup":"change",function(){var ak=$("option:selected",this).text();$(this).next().children().text(ak)});aj.on("focus",function(ak){ae.addClass("focus")}).on("blur",function(ak){ae.removeClass("focus")})});var X=$("body.minwidth");if(X.length){X.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30)}window.onresize=c;c()}function c(W){var V=W?10:0;if(rcmail.resize_timeout){window.clearTimeout(rcmail.resize_timeout)}rcmail.resize_timeout=window.setTimeout(function(){if(rcmail.env.task=="mail"){if(rcmail.env.action=="show"||rcmail.env.action=="preview"){O()}else{if(rcmail.env.action=="compose"){S()}}}$("body.iframe .footerleft").each(function(){var ab=$(this),X=$(document.body),Z=ab.hasClass("floating"),aa=X.outerHeight(true)>$(window).height();if(aa!=Z){var Y=aa?"addClass":"removeClass";ab[Y]("floating");X[Y]("floatingbuttons")}})},V)}function v(W){var Y=$(W.object).siblings("div");if(Y.length){$(W.object).insertBefore(Y.first())}if(W.type=="error"&&rcmail.env.task!="login"){rcmail.hide_message(W.object);if(U.message_timer){window.clearTimeout(U.message_timer)}if(!U.messagedialog){U.messagedialog=$("<div>").addClass("popupdialog").hide()}var X=W.message,V=function(){U.messagedialog.is(":visible")&&U.messagedialog.dialog("destroy").hide()};if(U.messagedialog.is(":visible")&&U.messagedialog.text()!=X){X=U.messagedialog.html()+"<p>"+W.message+"</p>"}U.messagedialog.html(X).dialog({resizable:false,closeOnEscape:true,dialogClass:W.type,title:rcmail.gettext("errortitle"),close:V,hide:{effect:"fadeOut"},width:420,minHeight:90}).show();U.messagedialog.closest("div[role=dialog]").attr("role","alertdialog");if(W.timeout>0){U.message_timer=window.setTimeout(V,W.timeout)}}}function x(Y){var W=Y?Y.new_layout:rcmail.env.layout,X=$("#mailview-top"),V=$("#mailview-bottom");if(Y){$("#mainscreencontent").removeClass().addClass(W)}$("#mailviewsplitter")[W=="desktop"?"show":"hide"]();$("#mailviewsplitter2")[W=="widescreen"?"show":"hide"]();$("#mailpreviewframe")[W!="list"?"show":"hide"]();rcmail.env.contentframe=W=="list"?null:"messagecontframe";if(W=="widescreen"){$("#countcontrols").detach().appendTo($("#messagelistheader"));X.css({height:"auto",width:394});V.css({top:0,left:406,height:"auto"}).show();if(!N){N=new rcube_splitter({id:"mailviewsplitter2",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"v",relative:true,start:416,min:400,size:12});N.init()}else{N.resize()}}else{if(W=="desktop"){X.css({height:270,width:"auto"});V.css({left:0,top:284,height:"auto"}).show();if(!r){r=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:true,start:276,min:150,size:12,offset:4});r.init()}else{r.resize()}}else{X.css({height:"auto",width:"auto"});V.hide()}}if(Y&&Y.old_layout=="widescreen"){$("#countcontrols").detach().appendTo($("#messagelistfooter"))}}function O(){$("#messagecontent").css("top",($("#messageheader").outerHeight()+1)+"px");$("#message-objects div a").addClass("button");if(!$("#attachment-list li").length){$("div.rightcol").hide().attr("aria-hidden","true");$("div.leftcol").css("margin-right","0")}var V=$("#messagebody.mailvelope, #messagebody > .mailvelope");if(V.length){var W=$("#messagecontent").length?$("#messagecontent").height()-16:$(window).height()-V.offset().top-2;V.height(W)}}function Q(V){}function C(V){}function k(X){if(X.nodeName=="TEXTAREA"){var W=$(X),Z=14,V=X.scrollHeight,Y=X.value.length>80&&V>Z*1.5?2:1;W.css("height",(Z*Y)+"px");S()}}function S(){var V=$("#composebody"),aa=$("#compose-content"),Z=$("#composeview-bottom"),W,ae,ad,Y,ac=0,X=300,ad=aa.height()-Z.position().top;Y=X-ad;ac=Y>-100?0:40;Z.height(Math.max(X,ad));aa.css("overflow",Y>0?"auto":"hidden");W=V.parent().width()-5;ae=V.parent().height()-8;V.width(W).height(ae);$("#composebodycontainer > div").width(W+8);$("#composebody_ifr").height(ae+4-$("div.mce-toolbar").height());$("#googie_edit_layer").width(W).height(ae);var ab=$("#directorylist");if(ab.length){$("#compose-contacts .scroller").css("top",ab.position().top+ab.outerHeight())}}function z(Y){var V=$("#quotadisplay"),Z=$("#quotamenu"),W=24,X=20,aa=Y.total?Math.ceil(Y.percent/100*X)*W:0;if(Y.total&&aa==W*X&&Y.percent<100){aa-=W}V.css("background-position","0 -"+aa+"px");V.attr("class","countdisplay p"+(Math.round(Y.percent/10)*10));if(Y.table){if(!Z.length){Z=$('<div id="quotamenu" class="popupmenu">').appendTo($("body"))}Z.html(Y.table);V.css("cursor","pointer").off("click").on("click",function(ab){return rcmail.command("menu-open","quotamenu",ab.target,ab)})}}function L(V){$(".boxtitle a.search",V).click(function(Z){var aa=$(".boxtitle",V),Y=$(".listsearchbox",V),X=Y.is(":visible")?-1:1,W=34+($("select",Y).length?22:0);Y.slideToggle({duration:160,progress:function(ac,ab){if(X<0){ab=1-ab}$(".scroller",V).css("top",(aa.outerHeight()+W*ab)+"px")},complete:function(){Y.toggleClass("expanded");if(Y.is(":visible")){Y.find("input[type=text]").focus();W=34+($("select",Y).length?$("select",Y).outerHeight()+4:0);$(".scroller",V).css("top",(aa.outerHeight()+W)+"px")}else{$("a.reset",Y).click()}}});return false})}function j(W){if(W.command=="reply-list"&&rcmail.env.reply_all_mode==1){var V=rcmail.gettext(W.status?"replylist":"replyall");if(rcmail.env.action=="preview"){$("a.button.replyall").attr("title",V)}else{$("a.button.reply-all").text(V).attr("title",V)}}else{if(W.command=="compose-encrypted"){$("a.button.encrypt").show()}}}function F(V,W){var X=J[V]=$("#"+V);X.appendTo(document.body);if(X.length){B[V]=$.extend(B[V]||{},W||{})}}function n(V,X,W){if(W||!B[V]){F(V,W)}return rcmail.command("menu-open",V,X.target,X)}function A(W,V,X){if(X||!B[W]){F(W,X)}X=B[W]||{};var Y=$(X.link?X.link:"#"+W+"link"),Z=Y.offset();if(Y.has(".inner")){Y=Y.children(".inner")}return rcmail.command("menu-open",{menu:W,show:V},Y.get(0),$.Event("click",{target:Y.get(0),pageX:Z.left,pageY:Z.top,clientX:Z.left,clientY:Z.top}))}function o(){$("#preview-shortheaders").toggle();var W=$("#preview-allheaders").toggle(),V=$("a#previewheaderstoggle");if(W.is(":visible")){V.attr("href","#hide").removeClass("add").addClass("remove").attr("aria-expanded","true")}else{V.attr("href","#details").removeClass("remove").addClass("add").attr("aria-expanded","false")}y("previewheaders",W.is(":visible")?"1":"0")}function H(W,V){if(V||!$("#mail"+W+"mode").hasClass("disabled")){$("#maillistmode, #mailthreadmode").removeClass("selected").attr("tabindex","0").attr("aria-disabled","false");$("#mail"+W+"mode").addClass("selected").attr("tabindex","-1").attr("aria-disabled","true")}}function d(Z){if(Z&&Z.name=="messagelistmenu"){P(Z)}else{if(Z){var W=B[Z.name]||{},Y=$(W.link||"#"+Z.name+"link"),ab=Z.obj&&Z.obj.is(":visible"),V=W.above;if(Z.obj&&ab&&Y.length){var X=Y.parent(),aa=$(window),ac;if(X.hasClass("dropbutton")){Y=X}if(W.above||Y.hasClass("dropbutton")){ac=Y.offset();Z.obj.css({left:ac.left+"px",top:(ac.top+(W.above?-Z.obj.height():Y.outerHeight()))+"px"})}}if(Z.obj&&W.iconized){Z.obj.children("ul").addClass("iconized")}if(Z.obj&&W.editable){Z.obj.attr("data-editable","true")}if(typeof W.callback=="function"){W.callback(ab,Z)}}}}function T(V){if(V&&rcmail.env.search_mods){var ac,X,Z=J.searchmenu,aa=$('input:checkbox[name="s_mods[]"]',Z),ab=rcmail.env.mailbox,Y=rcmail.env.search_mods,W=rcmail.env.search_scope||"base";if(rcmail.env.task=="mail"){if(W=="all"){ab="*"}Y=Y[ab]?Y[ab]:Y["*"];X="text";$('input:radio[name="s_scope"]').prop("checked",false).filter("#s_scope_"+W).prop("checked",true)}else{X="*"}if(Y[X]){aa.map(function(){this.checked=true;this.disabled=this.value!=X})}else{aa.prop("disabled",false).prop("checked",false);for(ac in Y){$("#s_mod_"+ac).prop("checked",true)}}}}function m(W,V){var X=W.parentNode.id.replace(/^attach/,"");$.each(["open","download","rename"],function(){var Y=this;$("#attachmenu"+Y).off("click").attr("onclick","").click(function(Z){return rcmail.command(Y+"-attachment",X,this)})});B.attachmentmenu.link=W;rcmail.command("menu-open",{menu:"attachmentmenu",id:X},W,V)}function K(W,Z){var X,aa,V,ab=rcmail.spellcheck_lang(),Y=$("ul",Z.obj);if(!Y.length){Y=$('<ul class="toolbarmenu selectable" role="menu">');for(X in rcmail.env.spell_langs){V=$('<li role="menuitem">');aa=$('<a href="#'+X+'" tabindex="0"></a>').text(rcmail.env.spell_langs[X]).addClass("active").data("lang",X).on("click keypress",function(ac){if(ac.type!="keypress"||rcube_event.get_keycode(ac)==13){rcmail.spellcheck_lang_set($(this).data("lang"));rcmail.hide_menu("spellmenu",ac);return false}});aa.appendTo(V);V.appendTo(Y)}Y.appendTo(Z.obj)}$("li",Y).each(function(){var ac=$("a",this);if(ac.data("lang")==ab){ac.addClass("selected").attr("aria-selected","true")}else{if(ac.hasClass("selected")){ac.removeClass("selected").removeAttr("aria-selected")}}})}function i(V){V=$(V);if(!V.children(".drop").length){V.append($('<a class="drop skip-content" tabindex="0" aria-haspopup="true">Show options</a>').on("click keypress",function(W){if(W.type!="keypress"||rcube_event.get_keycode(W)==13){m(this,W);return false}}))}}function P(W){var V=$("#listoptions");if(V.is(":visible")){V.dialog("close",W.originalEvent);return}$('input[name="sort_col"][value="'+rcmail.env.sort_col+'"]').prop("checked",true);$('input[name="sort_ord"][value="DESC"]').prop("checked",rcmail.env.sort_order=="DESC");$('input[name="sort_ord"][value="ASC"]').prop("checked",rcmail.env.sort_order!="DESC");$.each(["widescreen","desktop","list"],function(){$('input[name="layout"][value="'+this+'"]').prop("checked",rcmail.env.layout==this)});$("#listoptions-columns",V)[rcmail.env.layout=="widescreen"?"hide":"show"]();$('input[name="list_col[]"]').each(function(){$(this).prop("checked",$.inArray(this.value,rcmail.env.listcols)!=-1)});V.dialog({modal:true,resizable:false,closeOnEscape:true,title:null,open:function(X){setTimeout(function(){V.find("a, input:not(:disabled)").not("[aria-disabled=true]").first().focus()},100)},close:function(X){V.dialog("destroy").hide();if(X.originalEvent&&rcube_event.is_keyboard(X.originalEvent)){$("#listmenulink").focus()}},minWidth:500,width:V.width()+25}).show()}function g(Z){$("#listoptions").dialog("close");if(rcube_event.is_keyboard(Z.originalEvent)){$("#listmenulink").focus()}var W=$('input[name="sort_col"]:checked').val(),V=$('input[name="sort_ord"]:checked').val(),X=$('input[name="layout"]:checked').val(),Y=$('input[name="list_col[]"]:checked').map(function(){return this.value}).get();rcmail.set_list_options(Y,W,V,rcmail.env.threading,X)}function I(Z){var Y,V,W=rcmail.env.task,aa=rcmail.env.search_mods,ab=rcmail.env.mailbox,X=$('input[name="s_scope"]:checked').val();if(X=="all"){ab="*"}if(!aa){aa={}}if(W=="mail"){if(!aa[ab]){aa[ab]=rcube_clone_object(aa["*"])}V=aa[ab];Y="text"}else{V=aa;Y="*"}if(!Z.checked){delete (V[Z.value])}else{V[Z.value]=1}if(Z.value==Y){$('input:checkbox[name="s_mods[]"]').map(function(){if(this==Z){return}this.checked=true;if(Z.checked){this.disabled=true;delete V[this.value]}else{this.disabled=false;V[this.value]=1}})}rcmail.set_searchmods(V)}function q(V){rcmail.set_searchscope(V.value)}function u(X){var W=$("#contacts-table"),V=W.parent().css("overflow","hidden");W.clone().css({position:"absolute",top:"0",left:"0",width:W.width()+"px","z-index":10}).appendTo(V).animate({left:-(W.width()+5)+"px"},300,"swing",function(){$(this).remove();V.css("overflow","auto")})}function f(X){var W=$("#contacts-table"),V=W.parent().css("overflow","hidden"),Y=W.clone().appendTo(V);W.css({position:"absolute",top:"0",left:-(W.width()+5)+"px",width:W.width()+"px",height:W.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){Y.remove();$(this).css({position:"relative",left:"0",width:"100%",height:"auto","z-index":1});V.css("overflow","auto")})}function w(W){var V=$("#upload-dialog");if(V.is(":visible")){V.dialog("close");return}if(rcmail.mailvelope_editor){return}if(rcmail.env.action=="compose"&&!V.data("extended")){$("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($('input[type="file"]',V).parent()).click(G);V.data("extended",true)}V.dialog({modal:true,resizable:false,closeOnEscape:true,title:V.attr("title"),open:function(X){if(!document.all){$("input[type=file]",V).first().click()}},close:function(){try{$("#upload-dialog form").get(0).reset()}catch(X){}V.dialog("destroy").hide();$("div.addline",V).remove()},width:480}).show()}function G(V){var X=$(this).parent();var W=X.clone().addClass("addline").insertAfter(X);W.children(".iconlink").click(G);W.children("input").val("");if(!document.all){$("input[type=file]",W).click()}}function R(X,V){var W=$("#compose-"+X);if(W.is(":visible")){return}if(D[X]&&!V){$("#_"+X).val(D[X])}W.show();$("#"+X+"-link").hide();S();$("input,textarea",W).focus();return false}function b(W){var V=$("#_"+W);D[W]=V.val();V.val("");$("#compose-"+W).hide();$("#"+W+"-link").show();S();return false}function t(Y,Z){var X=$(Y),aa=X.get(0).id,V=X.children("fieldset");if(!V.length){return}if(!aa){aa="rcmtabcontainer";X.attr("id",aa)}var W=$("<ul>").addClass("tabsbar").prependTo(X);V.each(function(ab){var ae,ac,ag=$(this),ad=ag.children("legend"),af=aa+"-t"+ab;ac=$("<a>").text(ad.text()).attr("href","#"+af);ae=$("<li>").addClass("tablink");ad.remove();ag.attr("id",af);ae.append(ac).appendTo(W)});X.tabs({active:Z||0,heightStyle:"content",activate:function(ac,ab){c()}})}function s(V){var W=$("<iframe>").attr({id:"aboutframe",src:rcmail.url("settings/about"),frameborder:"0"});h=Math.floor($(window).height()*0.75),buttons={},supportln=$("#supportlink");if(supportln.length&&(M.supporturl=supportln.attr("href"))){buttons[supportln.html()]=function(X){M.supporturl.indexOf("mailto:")<0?window.open(M.supporturl):location.href=M.supporturl}}W.dialog({modal:true,resizable:false,closeOnEscape:true,title:V?V.title||V.innerHTML:null,close:function(){W.dialog("destroy").remove()},buttons:buttons,width:640,height:h}).width(640)}}function rcube_scroller(a,b,c){var d=this;this.list=$(a);this.top=$(b);this.bottom=$(c);this.step_size=6;this.step_time=20;this.delay=500;this.top.mouseenter(function(){if(rcmail.drag_active){d.ts=window.setTimeout(function(){d.scroll("down")},d.delay)}}).mouseout(function(){if(d.ts){window.clearTimeout(d.ts)}});this.bottom.mouseenter(function(){if(rcmail.drag_active){d.ts=window.setTimeout(function(){d.scroll("up")},d.delay)}}).mouseout(function(){if(d.ts){window.clearTimeout(d.ts)}});this.scroll=function(g){var f=this,e=this.step_size;if(!rcmail.drag_active){return}if(g=="down"){e*=-1}this.list.get(0).scrollTop+=e;this.ts=window.setTimeout(function(){f.scroll(g)},this.step_time)}}function rcube_splitter(b){this.p=b;this.id=b.id;this.horizontal=(b.orientation=="horizontal"||b.orientation=="h");this.halfsize=(b.size!==undefined?b.size:10)/2;this.pos=b.start||0;this.min=b.min||20;this.offset=b.offset||0;this.relative=b.relative?true:false;this.drag_active=false;this.render=b.render;this.callback=b.callback;var g=this;rcube_splitter._instances[this.id]=g;this.init=function(){this.p1=$(this.p.p1);this.p2=$(this.p.p2);this.parent=this.p1.parent();if(!this.p1.length||!this.p2.length){return}this.p1pos=this.relative?this.p1.position():this.p1.offset();this.p2pos=this.relative?this.p2.position():this.p2.offset();this.handle=$("<div>").attr("id",this.id).attr("unselectable","on").attr("role","presentation").addClass("splitter "+(this.horizontal?"splitter-h":"splitter-v")).appendTo(this.parent).mousedown(a);if(this.horizontal){var j=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:j+"px"})}else{var i=this.p1pos.left+this.p1.outerWidth();this.handle.css({left:i+"px",top:"0px"})}if(bw.ie){$(window).resize(f)}var k=this.get_cookie();if(k&&!isNaN(k)){this.pos=parseFloat(k);this.resize()}else{if(this.pos){this.resize();this.set_cookie()}}};this.resize=function(){if(this.horizontal){this.p1.css("height",Math.floor(this.pos-this.p1pos.top-Math.floor(this.halfsize))+"px");this.p2.css("top",Math.ceil(this.pos+Math.ceil(this.halfsize)+2)+"px");this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px");if(bw.ie){var j=parseInt(this.parent.outerHeight(),10)-parseInt(this.p2.css("top"),10);this.p2.css("height",(j>0?j:0)+"px")}}else{this.p1.css("width",Math.floor(this.pos-this.p1pos.left-Math.floor(this.halfsize))+"px");this.p2.css("left",Math.ceil(this.pos+Math.ceil(this.halfsize))+"px");this.handle.css("left",Math.round(this.pos-this.halfsize+this.offset+3)+"px");if(bw.ie){var i=parseInt(this.parent.outerWidth(),10)-parseInt(this.p2.css("left"),10);this.p2.css("width",(i>0?i:0)+"px")}}this.p2.resize();this.p1.resize();if(this.drag_active){$("iframe").each(function(k,l){var m=$(this).offset();$("#iframe-splitter-fix-"+k).css({top:m.top+"px",left:m.left+"px",width:l.offsetWidth+"px",height:l.offsetHeight+"px"})})}if(typeof this.render=="function"){this.render(this)}};function a(i){if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="none"}g.p1pos=g.relative?g.p1.position():g.p1.offset();g.p2pos=g.relative?g.p2.position():g.p2.offset();g.drag_active=true;$(document).on("mousemove."+this.id,d).on("mouseup."+this.id,c);if(rcmail.message_list){rcmail.message_list.drag_active=true}$("iframe").each(function(k,j){$("<div>").attr("id","iframe-splitter-fix-"+k).addClass("iframe-splitter-fix").css({background:"#fff",width:j.offsetWidth+"px",height:j.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")})}function d(i){if(!g.drag_active){return false}window.clearTimeout(g.ts);g.ts=window.setTimeout(function(){e(i)},1);return false}function e(i){var j=rcube_event.get_mouse_pos(i);if(g.relative){var k=g.parent.offset();j.x-=k.left;j.y-=k.top}if(g.horizontal){if(((j.y-g.halfsize)>g.p1pos.top)&&((j.y+g.halfsize)<(g.p2pos.top+g.p2.outerHeight()))){g.pos=Math.max(g.min,j.y-Math.max(0,g.offset));if(g.pos>g.min){g.pos=Math.min(g.pos,g.parent.height()-g.min)}g.resize()}}else{if(((j.x-g.halfsize)>g.p1pos.left)&&((j.x+g.halfsize)<(g.p2pos.left+g.p2.outerWidth()))){g.pos=Math.max(g.min,j.x-Math.max(0,g.offset));if(g.pos>g.min){g.pos=Math.min(g.pos,g.parent.width()-g.min)}g.resize()}}g.p1pos=g.relative?g.p1.position():g.p1.offset();g.p2pos=g.relative?g.p2.position():g.p2.offset()}function c(i){if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="auto"}$(document).off("."+g.id);g.drag_active=false;if(rcmail.message_list){rcmail.message_list.drag_active=false}$("div.iframe-splitter-fix").remove();g.set_cookie();if(typeof g.callback=="function"){g.callback(g)}return bw.safari?true:rcube_event.cancel(i)}function f(j){if(g.horizontal){var i=parseInt(g.parent.outerHeight(),10)-parseInt(g.p2[0].style.top,10);g.p2.css("height",(i>0?i:0)+"px")}else{var k=parseInt(g.parent.outerWidth(),10)-parseInt(g.p2[0].style.left,10);g.p2.css("width",(k>0?k:0)+"px")}}this.get_cookie=function(){return window.UI?UI.get_pref(this.id):null};this.set_cookie=function(){if(window.UI){UI.save_pref(this.id,this.pos)}}}rcube_splitter._instances={};rcube_splitter.get_instance=function(a){return rcube_splitter._instances[a]};