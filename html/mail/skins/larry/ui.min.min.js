function rcube_mail_ui(){var aI={};var aL={};var ad={forwardmenu:{editable:1},searchmenu:{editable:1,callback:aB},attachmentmenu:{},listoptions:{editable:1},groupmenu:{above:1},mailboxmenu:{above:1},spellmenu:{callback:aK},"folder-selector":{iconized:1}};var aA=this;var an;var aH;var ab={};var X;this.set=au;this.init=aa;this.init_tabs=al;this.show_about=am;this.show_popup=ae;this.toggle_popup=ar;this.add_popup=aP;this.set_searchmod=aM;this.set_searchscope=ao;this.show_uploadform=ai;this.show_header_row=aD;this.hide_header_row=Y;this.update_quota=af;this.get_pref=Z;this.save_pref=ag;this.folder_search_init=aJ;if(window.$&&document.body){var ap=Z("minimalmode");if(parseInt(ap)||(ap===null&&$(window).height()<850)){$(document.body).addClass("minimal")}if(bw.tablet){$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}$(document).ready(function(){aA.init()})}function au(b,a){aI[b]=a}function Z(a){if(!X){X=rcmail.local_storage_get_item("prefs.larry",{})}if(X[a]==null){var b=rcmail.get_cookie(a);if(b!=null){X[a]=b;if(rcmail.local_storage_set_item("prefs.larry",X)){rcmail.set_cookie(a,b,new Date())}}}return X[a]}function ag(b,c){X[b]=c;if(!rcmail.local_storage_set_item("prefs.larry",X)){var a=new Date();a.setYear(a.getFullYear()+1);rcmail.set_cookie(b,c,a)}}function aa(){rcmail.addEventListener("message",aj);$("#taskbar a").each(function(l,k){$(k).append('<span class="tooltip">'+$(".button-inner",this).html()+"</span>")});$("#taskbar .minmodetoggle").click(function(k){var l=$(document.body).toggleClass("minimal").hasClass("minimal");ag("minimalmode",l?1:0);$(window).resize()});if(rcmail.env.task=="mail"){rcmail.addEventListener("menu-open",ay).addEventListener("menu-close",ay).addEventListener("menu-save",ax).addEventListener("enable-command",V).addEventListener("responseafterlist",function(k){aN(rcmail.env.threading?"thread":"list",true)}).addEventListener("responseaftersearch",function(k){aN(rcmail.env.threading?"thread":"list",true)});var j=$("#dragmessagemenu");if(j.length){rcmail.gui_object("dragmenu","dragmessagemenu");aL.dragmenu=j}if(rcmail.env.action=="show"||rcmail.env.action=="preview"){rcmail.addEventListener("aftershow-headers",function(){aG()}).addEventListener("afterhide-headers",function(){aG()});$("#previewheaderstoggle").click(function(k){aq();if(this.blur&&!rcube_event.is_keyboard(k)){this.blur()}return false});$("#attachment-list > li").each(function(){aw(this)});if(Z("previewheaders")=="1"){aq()}if(rcmail.env.action=="show"){$("#messagecontent").focus()}}else{if(rcmail.env.action=="compose"){rcmail.addEventListener("aftersend-attachment",ai).addEventListener("fileappended",function(k){if(k.attachment.complete){aw(k.item)}}).addEventListener("aftertoggle-editor",function(k){window.setTimeout(function(){aC()},200);if(k&&k.mode){$("select[name='editorSelector']").val(k.mode)}}).addEventListener("compose-encrypted",function(k){$("select[name='editorSelector']").prop("disabled",k.active);$("a.button.attach, a.button.responses")[(k.active?"addClass":"removeClass")]("disabled");$("#responseslist a.insertresponse")[(k.active?"removeClass":"addClass")]("active")});var d,i,b,e=["cc","bcc","replyto","followupto"];for(d=0;d<e.length;d++){i=e[d];b=$("#_"+i);if(b.length){b.on("change",{v:i},function(k){if(this.value){aD(k.data.v,true)}});if(b.val()!=""){aD(i,true)}}}$("#composeoptionstoggle").click(function(k){var l=$("#composeoptions").toggle().is(":visible");$("#composeoptionstoggle").toggleClass("remove").attr("aria-expanded",l?"true":"false");aC();ag("composeoptions",l?"1":"0");if(!rcube_event.is_keyboard(k)){this.blur()}return false}).css("cursor","pointer");if(Z("composeoptions")!=="0"){$("#composeoptionstoggle").click()}$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(k){av(this)}).change();rcmail.addEventListener("autocomplete_insert",function(k){av(k.field)});var c=rcmail.opener();if(c&&c.env.action=="compose"&&$("#composeoptionstoggle",opener.document).hasClass("remove")){$("#composeoptionstoggle").click()}new rcube_splitter({id:"composesplitterv",p1:"#composeview-left",p2:"#composeview-right",orientation:"v",relative:true,start:206,min:170,size:12,render:aC}).init();$("#attachment-list > li").each(function(){aw(this)})}else{if(rcmail.env.action=="list"||!rcmail.env.action){ah();$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(k){aN("list");return false});$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(k){aN("thread");return false});rcmail.init_pagejumper("#pagejumper");rcmail.addEventListener("setquota",af).addEventListener("layout-change",ah).addEventListener("afterimport-messages",ai)}else{if(rcmail.env.action=="get"){new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",orientation:"v",relative:true,start:226,min:150,size:12}).init()}}}}if($("#mailview-left").length){new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:true,start:206,min:150,size:12,callback:aE,render:ac}).init()}}else{if(rcmail.env.task=="settings"){rcmail.addEventListener("init",function(){var k="#settingstabpreferences";if(rcmail.env.action){k="#settingstab"+(rcmail.env.action.indexOf("identity")>0?"identities":rcmail.env.action.replace(/\./g,""))}$(k).addClass("selected").children().first().removeAttr("onclick").click(function(){return false})});if(rcmail.env.action=="folders"){new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:true,start:266,min:180,size:12}).init();rcmail.addEventListener("setquota",af);aJ($("#folderslist"))}else{if(rcmail.env.action=="identities"){new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="responses"){new rcube_splitter({id:"responseviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="preferences"||!rcmail.env.action){new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:true,start:266,min:180,size:12}).init()}else{if(rcmail.env.action=="edit-prefs"){var a=$("#preferences-details fieldset.advanced legend"),f=$('<a href="#toggle"></a>').text(rcmail.gettext("toggleadvancedoptions")).attr("title",rcmail.gettext("toggleadvancedoptions")).addClass("advanced-toggle");a.click(function(k){f.html($(this).hasClass("collapsed")?"&#9650;":"&#9660;");$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).append(f).addClass("collapsed");if(bw.mz){a.parents("form").css("display","inline")}}}}}}}else{if(rcmail.env.task=="addressbook"){rcmail.addEventListener("afterupload-photo",ai).addEventListener("beforepushgroup",ak).addEventListener("beforepopgroup",W).addEventListener("menu-open",ay).addEventListener("menu-close",ay);if(rcmail.env.action==""){new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",p2:"#addressview-right",orientation:"v",relative:true,start:206,min:150,size:12,render:ac}).init();new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:true,start:266,min:260,size:12}).init()}var j=$("#dragcontactmenu");if(j.length){rcmail.gui_object("dragmenu","dragcontactmenu");aL.dragmenu=j}}}}$(".tabbed").each(function(l,k){al(k)});$("select.decorated").each(function(){if(bw.opera){$(this).removeClass("decorated");return}var n=$(this),k=n.parent(),o=Math.max(n.height(),26)-2,l=n.width()-22,p=$("option",this).first().text();if($("option:selected",this).val()!=""){p=$("option:selected",this).text()}var m=$('<a class="menuselector" tabindex="-1"><span class="handle">'+p+"</span></a>").css("position","absolute").offset(n.position()).insertAfter(n);m.children().width(l).height(o).css("line-height",(o-1)+"px");if(k.css("position")!="absolute"){k.css("position","relative")}n.width(m.width()).on(bw.mz?"change keyup":"change",function(){var q=$("option:selected",this).text();$(this).next().children().text(q)});n.on("focus",function(q){m.addClass("focus")}).on("blur",function(q){m.removeClass("focus")})});var g=$("body.minwidth");if(g.length){g.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30)}window.onresize=az;az()}function az(a){var b=a?10:0;if(rcmail.resize_timeout){window.clearTimeout(rcmail.resize_timeout)}rcmail.resize_timeout=window.setTimeout(function(){if(rcmail.env.task=="mail"){if(rcmail.env.action=="show"||rcmail.env.action=="preview"){aG()}else{if(rcmail.env.action=="compose"){aC()}}}$("body.iframe .footerleft").each(function(){var c=$(this),g=$(document.body),e=c.hasClass("floating"),d=g.outerHeight(true)>$(window).height();if(d!=e){var f=d?"addClass":"removeClass";c[f]("floating");g[f]("floatingbuttons")}})},b)}function aj(a){var c=$(a.object).siblings("div");if(c.length){$(a.object).insertBefore(c.first())}if(a.type=="error"&&rcmail.env.task!="login"){rcmail.hide_message(a.object);if(aA.message_timer){window.clearTimeout(aA.message_timer)}if(!aA.messagedialog){aA.messagedialog=$("<div>").addClass("popupdialog").hide()}var d=a.message,b=function(){aA.messagedialog.is(":visible")&&aA.messagedialog.dialog("destroy").hide()};if(aA.messagedialog.is(":visible")&&aA.messagedialog.text()!=d){d=aA.messagedialog.html()+"<p>"+a.message+"</p>"}aA.messagedialog.html(d).dialog({resizable:false,closeOnEscape:true,dialogClass:a.type,title:rcmail.gettext("errortitle"),close:b,hide:{effect:"fadeOut"},width:420,minHeight:90}).show();aA.messagedialog.closest("div[role=dialog]").attr("role","alertdialog");if(a.timeout>0){aA.message_timer=window.setTimeout(b,a.timeout)}}}function ah(c){var a=c?c.new_layout:rcmail.env.layout,d=$("#mailview-top"),b=$("#mailview-bottom");if(c){$("#mainscreencontent").removeClass().addClass(a)}$("#mailviewsplitter")[a=="desktop"?"show":"hide"]();$("#mailviewsplitter2")[a=="widescreen"?"show":"hide"]();$("#mailpreviewframe")[a!="list"?"show":"hide"]();rcmail.env.contentframe=a=="list"?null:"messagecontframe";if(a=="widescreen"){$("#countcontrols").detach().appendTo($("#messagelistheader"));d.css({height:"auto",width:394});b.css({top:0,left:406,height:"auto"}).show();if(!aH){aH=new rcube_splitter({id:"mailviewsplitter2",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"v",relative:true,start:416,min:400,size:12});aH.init()}else{aH.resize()}}else{if(a=="desktop"){d.css({height:270,width:"auto"});b.css({left:0,top:284,height:"auto"}).show();if(!an){an=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:true,start:276,min:150,size:12,offset:4});an.init()}else{an.resize()}}else{d.css({height:"auto",width:"auto"});b.hide()}}if(c&&c.old_layout=="widescreen"){$("#countcontrols").detach().appendTo($("#messagelistfooter"))}}function aG(){$("#messagecontent").css("top",($("#messageheader").outerHeight()+1)+"px");$("#message-objects div a").addClass("button");if(!$("#attachment-list li").length){$("div.rightcol").hide().attr("aria-hidden","true");$("div.leftcol").css("margin-right","0")}var b=$("#messagebody.mailvelope, #messagebody > .mailvelope");if(b.length){var a=$("#messagecontent").length?$("#messagecontent").height()-16:$(window).height()-b.offset().top-2;b.height(a)}}function aE(a){}function ac(a){}function av(e){if(e.nodeName=="TEXTAREA"){var a=$(e),c=14,b=e.scrollHeight,d=e.value.length>80&&b>c*1.5?2:1;a.css("height",(c*d)+"px");aC()}}function aC(){var k=$("#composebody"),e=$("#compose-content"),f=$("#composeview-bottom"),j,a,b,g,c=0,i=300,b=e.height()-f.position().top;g=i-b;c=g>-100?0:40;f.height(Math.max(i,b));e.css("overflow",g>0?"auto":"hidden");j=k.parent().width()-5;a=k.parent().height()-8;k.width(j).height(a);$("#composebodycontainer > div").width(j+8);$("#composebody_ifr").height(a+4-$("div.mce-toolbar").height());$("#googie_edit_layer").width(j).height(a);var d=$("#directorylist");if(d.length){$("#compose-contacts .scroller").css("top",d.position().top+d.outerHeight())}}function af(e){var b=$("#quotadisplay"),d=$("#quotamenu"),a=24,f=20,c=e.total?Math.ceil(e.percent/100*f)*a:0;if(e.total&&c==a*f&&e.percent<100){c-=a}b.css("background-position","0 -"+c+"px");b.attr("class","countdisplay p"+(Math.round(e.percent/10)*10));if(e.table){if(!d.length){d=$('<div id="quotamenu" class="popupmenu">').appendTo($("body"))}d.html(e.table);b.css("cursor","pointer").off("click").on("click",function(g){return rcmail.command("menu-open","quotamenu",g.target,g)})}}function aJ(a){$(".boxtitle a.search",a).click(function(d){var c=$(".boxtitle",a),e=$(".listsearchbox",a),f=e.is(":visible")?-1:1,b=34+($("select",e).length?22:0);e.slideToggle({duration:160,progress:function(g,i){if(f<0){i=1-i}$(".scroller",a).css("top",(c.outerHeight()+b*i)+"px")},complete:function(){e.toggleClass("expanded");if(e.is(":visible")){e.find("input[type=text]").focus();b=34+($("select",e).length?$("select",e).outerHeight()+4:0);$(".scroller",a).css("top",(c.outerHeight()+b)+"px")}else{$("a.reset",e).click()}}});return false})}function V(a){if(a.command=="reply-list"&&rcmail.env.reply_all_mode==1){var b=rcmail.gettext(a.status?"replylist":"replyall");if(rcmail.env.action=="preview"){$("a.button.replyall").attr("title",b)}else{$("a.button.reply-all").text(b).attr("title",b)}}else{if(a.command=="compose-encrypted"){$("a.button.encrypt").show()}}}function aP(b,a){var c=aL[b]=$("#"+b);c.appendTo(document.body);if(c.length){ad[b]=$.extend(ad[b]||{},a||{})}}function ar(b,c,a){if(a||!ad[b]){aP(b,a)}return rcmail.command("menu-open",b,c.target,c)}function ae(a,b,e){if(e||!ad[a]){aP(a,e)}e=ad[a]||{};var d=$(e.link?e.link:"#"+a+"link"),c=d.offset();if(d.has(".inner")){d=d.children(".inner")}return rcmail.command("menu-open",{menu:a,show:b},d.get(0),$.Event("click",{target:d.get(0),pageX:c.left,pageY:c.top,clientX:c.left,clientY:c.top}))}function aq(){$("#preview-shortheaders").toggle();var a=$("#preview-allheaders").toggle(),b=$("a#previewheaderstoggle");if(a.is(":visible")){b.attr("href","#hide").removeClass("add").addClass("remove").attr("aria-expanded","true")}else{b.attr("href","#details").removeClass("remove").addClass("add").attr("aria-expanded","false")}ag("previewheaders",a.is(":visible")?"1":"0")}function aN(a,b){if(b||!$("#mail"+a+"mode").hasClass("disabled")){$("#maillistmode, #mailthreadmode").removeClass("selected").attr("tabindex","0").attr("aria-disabled","false");$("#mail"+a+"mode").addClass("selected").attr("tabindex","-1").attr("aria-disabled","true")}}function ay(f){if(f&&f.name=="messagelistmenu"){aF(f)}else{if(f){var a=ad[f.name]||{},g=$(a.link||"#"+f.name+"link"),d=f.obj&&f.obj.is(":visible"),b=a.above;if(f.obj&&d&&g.length){var i=g.parent(),e=$(window),c;if(i.hasClass("dropbutton")){g=i}if(a.above||g.hasClass("dropbutton")){c=g.offset();f.obj.css({left:c.left+"px",top:(c.top+(a.above?-f.obj.height():g.outerHeight()))+"px"})}}if(f.obj&&a.iconized){f.obj.children("ul").addClass("iconized")}if(f.obj&&a.editable){f.obj.attr("data-editable","true")}if(typeof a.callback=="function"){a.callback(d,f)}}}}function aB(b){if(b&&rcmail.env.search_mods){var c,i,f=aL.searchmenu,e=$('input:checkbox[name="s_mods[]"]',f),d=rcmail.env.mailbox,g=rcmail.env.search_mods,a=rcmail.env.search_scope||"base";if(rcmail.env.task=="mail"){if(a=="all"){d="*"}g=g[d]?g[d]:g["*"];i="text";$('input:radio[name="s_scope"]').prop("checked",false).filter("#s_scope_"+a).prop("checked",true)}else{i="*"}if(g[i]){e.map(function(){this.checked=true;this.disabled=this.value!=i})}else{e.prop("disabled",false).prop("checked",false);for(c in g){$("#s_mod_"+c).prop("checked",true)}}}}function at(a,b){var c=a.parentNode.id.replace(/^attach/,"");$.each(["open","download","rename"],function(){var d=this;$("#attachmenu"+d).off("click").attr("onclick","").click(function(e){return rcmail.command(d+"-attachment",c,this)})});ad.attachmentmenu.link=a;rcmail.command("menu-open",{menu:"attachmentmenu",id:c},a,b)}function aK(a,e){var g,d,b,c=rcmail.spellcheck_lang(),f=$("ul",e.obj);if(!f.length){f=$('<ul class="toolbarmenu selectable" role="menu">');for(g in rcmail.env.spell_langs){b=$('<li role="menuitem">');d=$('<a href="#'+g+'" tabindex="0"></a>').text(rcmail.env.spell_langs[g]).addClass("active").data("lang",g).on("click keypress",function(i){if(i.type!="keypress"||rcube_event.get_keycode(i)==13){rcmail.spellcheck_lang_set($(this).data("lang"));rcmail.hide_menu("spellmenu",i);return false}});d.appendTo(b);b.appendTo(f)}f.appendTo(e.obj)}$("li",f).each(function(){var i=$("a",this);if(i.data("lang")==c){i.addClass("selected").attr("aria-selected","true")}else{if(i.hasClass("selected")){i.removeClass("selected").removeAttr("aria-selected")}}})}function aw(a){a=$(a);if(!a.children(".drop").length){a.append($('<a class="drop skip-content" tabindex="0" aria-haspopup="true">Show options</a>').on("click keypress",function(b){if(b.type!="keypress"||rcube_event.get_keycode(b)==13){at(this,b);return false}}))}}function aF(a){var b=$("#listoptions");if(b.is(":visible")){b.dialog("close",a.originalEvent);return}$('input[name="sort_col"][value="'+rcmail.env.sort_col+'"]').prop("checked",true);$('input[name="sort_ord"][value="DESC"]').prop("checked",rcmail.env.sort_order=="DESC");$('input[name="sort_ord"][value="ASC"]').prop("checked",rcmail.env.sort_order!="DESC");$.each(["widescreen","desktop","list"],function(){$('input[name="layout"][value="'+this+'"]').prop("checked",rcmail.env.layout==this)});$("#listoptions-columns",b)[rcmail.env.layout=="widescreen"?"hide":"show"]();$('input[name="list_col[]"]').each(function(){$(this).prop("checked",$.inArray(this.value,rcmail.env.listcols)!=-1)});b.dialog({modal:true,resizable:false,closeOnEscape:true,title:null,open:function(c){setTimeout(function(){b.find("a, input:not(:disabled)").not("[aria-disabled=true]").first().focus()},100)},close:function(c){b.dialog("destroy").hide();if(c.originalEvent&&rcube_event.is_keyboard(c.originalEvent)){$("#listmenulink").focus()}},minWidth:500,width:b.width()+25}).show()}function ax(c){$("#listoptions").dialog("close");if(rcube_event.is_keyboard(c.originalEvent)){$("#listmenulink").focus()}var a=$('input[name="sort_col"]:checked').val(),b=$('input[name="sort_ord"]:checked').val(),e=$('input[name="layout"]:checked').val(),d=$('input[name="list_col[]"]:checked').map(function(){return this.value}).get();rcmail.set_list_options(d,a,b,rcmail.env.threading,e)}function aM(e){var f,b,a=rcmail.env.task,d=rcmail.env.search_mods,c=rcmail.env.mailbox,g=$('input[name="s_scope"]:checked').val();if(g=="all"){c="*"}if(!d){d={}}if(a=="mail"){if(!d[c]){d[c]=rcube_clone_object(d["*"])}b=d[c];f="text"}else{b=d;f="*"}if(!e.checked){delete (b[e.value])}else{b[e.value]=1}if(e.value==f){$('input:checkbox[name="s_mods[]"]').map(function(){if(this==e){return}this.checked=true;if(e.checked){this.disabled=true;delete b[this.value]}else{this.disabled=false;b[this.value]=1}})}rcmail.set_searchmods(b)}function ao(a){rcmail.set_searchscope(a.value)}function ak(c){var a=$("#contacts-table"),b=a.parent().css("overflow","hidden");a.clone().css({position:"absolute",top:"0",left:"0",width:a.width()+"px","z-index":10}).appendTo(b).animate({left:-(a.width()+5)+"px"},300,"swing",function(){$(this).remove();b.css("overflow","auto")})}function W(d){var a=$("#contacts-table"),b=a.parent().css("overflow","hidden"),c=a.clone().appendTo(b);a.css({position:"absolute",top:"0",left:-(a.width()+5)+"px",width:a.width()+"px",height:a.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){c.remove();$(this).css({position:"relative",left:"0",width:"100%",height:"auto","z-index":1});b.css("overflow","auto")})}function ai(a){var b=$("#upload-dialog");if(b.is(":visible")){b.dialog("close");return}if(rcmail.mailvelope_editor){return}if(rcmail.env.action=="compose"&&!b.data("extended")){$("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($('input[type="file"]',b).parent()).click(aO);b.data("extended",true)}b.dialog({modal:true,resizable:false,closeOnEscape:true,title:b.attr("title"),open:function(c){if(!document.all){$("input[type=file]",b).first().click()}},close:function(){try{$("#upload-dialog form").get(0).reset()}catch(c){}b.dialog("destroy").hide();$("div.addline",b).remove()},width:480}).show()}function aO(b){var c=$(this).parent();var a=c.clone().addClass("addline").insertAfter(c);a.children(".iconlink").click(aO);a.children("input").val("");if(!document.all){$("input[type=file]",a).click()}}function aD(c,b){var a=$("#compose-"+c);if(a.is(":visible")){return}if(ab[c]&&!b){$("#_"+c).val(ab[c])}a.show();$("#"+c+"-link").hide();aC();$("input,textarea",a).focus();return false}function Y(a){var b=$("#_"+a);ab[a]=b.val();b.val("");$("#compose-"+a).hide();$("#"+a+"-link").show();aC();return false}function al(e,d){var f=$(e),c=f.get(0).id,b=f.children("fieldset");if(!b.length){return}if(!c){c="rcmtabcontainer";f.attr("id",c)}var a=$("<ul>").addClass("tabsbar").prependTo(f);b.each(function(m){var j,l,g=$(this),k=g.children("legend"),i=c+"-t"+m;l=$("<a>").text(k.text()).attr("href","#"+i);j=$("<li>").addClass("tablink");k.remove();g.attr("id",i);j.append(l).appendTo(a)});f.tabs({active:d||0,heightStyle:"content",activate:function(g,i){az()}})}function am(b){var a=$("<iframe>").attr({id:"aboutframe",src:rcmail.url("settings/about"),frameborder:"0"});h=Math.floor($(window).height()*0.75),buttons={},supportln=$("#supportlink");if(supportln.length&&(aI.supporturl=supportln.attr("href"))){buttons[supportln.html()]=function(c){aI.supporturl.indexOf("mailto:")<0?window.open(aI.supporturl):location.href=aI.supporturl}}a.dialog({modal:true,resizable:false,closeOnEscape:true,title:b?b.title||b.innerHTML:null,close:function(){a.dialog("destroy").remove()},buttons:buttons,width:640,height:h}).width(640)}}function rcube_scroller(i,g,f){var e=this;this.list=$(i);this.top=$(g);this.bottom=$(f);this.step_size=6;this.step_time=20;this.delay=500;this.top.mouseenter(function(){if(rcmail.drag_active){e.ts=window.setTimeout(function(){e.scroll("down")},e.delay)}}).mouseout(function(){if(e.ts){window.clearTimeout(e.ts)}});this.bottom.mouseenter(function(){if(rcmail.drag_active){e.ts=window.setTimeout(function(){e.scroll("up")},e.delay)}}).mouseout(function(){if(e.ts){window.clearTimeout(e.ts)}});this.scroll=function(c){var a=this,b=this.step_size;if(!rcmail.drag_active){return}if(c=="down"){b*=-1}this.list.get(0).scrollTop+=b;this.ts=window.setTimeout(function(){a.scroll(c)},this.step_time)}}function rcube_splitter(l){this.p=l;this.id=l.id;this.horizontal=(l.orientation=="horizontal"||l.orientation=="h");this.halfsize=(l.size!==undefined?l.size:10)/2;this.pos=l.start||0;this.min=l.min||20;this.offset=l.offset||0;this.relative=l.relative?true:false;this.drag_active=false;this.render=l.render;this.callback=l.callback;var n=this;rcube_splitter._instances[this.id]=n;this.init=function(){this.p1=$(this.p.p1);this.p2=$(this.p.p2);this.parent=this.p1.parent();if(!this.p1.length||!this.p2.length){return}this.p1pos=this.relative?this.p1.position():this.p1.offset();this.p2pos=this.relative?this.p2.position():this.p2.offset();this.handle=$("<div>").attr("id",this.id).attr("unselectable","on").attr("role","presentation").addClass("splitter "+(this.horizontal?"splitter-h":"splitter-v")).appendTo(this.parent).mousedown(m);if(this.horizontal){var a=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:a+"px"})}else{var b=this.p1pos.left+this.p1.outerWidth();this.handle.css({left:b+"px",top:"0px"})}if(bw.ie){$(window).resize(o)}var c=this.get_cookie();if(c&&!isNaN(c)){this.pos=parseFloat(c);this.resize()}else{if(this.pos){this.resize();this.set_cookie()}}};this.resize=function(){if(this.horizontal){this.p1.css("height",Math.floor(this.pos-this.p1pos.top-Math.floor(this.halfsize))+"px");this.p2.css("top",Math.ceil(this.pos+Math.ceil(this.halfsize)+2)+"px");this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px");if(bw.ie){var a=parseInt(this.parent.outerHeight(),10)-parseInt(this.p2.css("top"),10);this.p2.css("height",(a>0?a:0)+"px")}}else{this.p1.css("width",Math.floor(this.pos-this.p1pos.left-Math.floor(this.halfsize))+"px");this.p2.css("left",Math.ceil(this.pos+Math.ceil(this.halfsize))+"px");this.handle.css("left",Math.round(this.pos-this.halfsize+this.offset+3)+"px");if(bw.ie){var b=parseInt(this.parent.outerWidth(),10)-parseInt(this.p2.css("left"),10);this.p2.css("width",(b>0?b:0)+"px")}}this.p2.resize();this.p1.resize();if(this.drag_active){$("iframe").each(function(e,d){var c=$(this).offset();$("#iframe-splitter-fix-"+e).css({top:c.top+"px",left:c.left+"px",width:d.offsetWidth+"px",height:d.offsetHeight+"px"})})}if(typeof this.render=="function"){this.render(this)}};function m(a){if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="none"}n.p1pos=n.relative?n.p1.position():n.p1.offset();n.p2pos=n.relative?n.p2.position():n.p2.offset();n.drag_active=true;$(document).on("mousemove."+this.id,j).on("mouseup."+this.id,k);if(rcmail.message_list){rcmail.message_list.drag_active=true}$("iframe").each(function(c,b){$("<div>").attr("id","iframe-splitter-fix-"+c).addClass("iframe-splitter-fix").css({background:"#fff",width:b.offsetWidth+"px",height:b.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")})}function j(a){if(!n.drag_active){return false}window.clearTimeout(n.ts);n.ts=window.setTimeout(function(){i(a)},1);return false}function i(b){var a=rcube_event.get_mouse_pos(b);if(n.relative){var c=n.parent.offset();a.x-=c.left;a.y-=c.top}if(n.horizontal){if(((a.y-n.halfsize)>n.p1pos.top)&&((a.y+n.halfsize)<(n.p2pos.top+n.p2.outerHeight()))){n.pos=Math.max(n.min,a.y-Math.max(0,n.offset));if(n.pos>n.min){n.pos=Math.min(n.pos,n.parent.height()-n.min)}n.resize()}}else{if(((a.x-n.halfsize)>n.p1pos.left)&&((a.x+n.halfsize)<(n.p2pos.left+n.p2.outerWidth()))){n.pos=Math.max(n.min,a.x-Math.max(0,n.offset));if(n.pos>n.min){n.pos=Math.min(n.pos,n.parent.width()-n.min)}n.resize()}}n.p1pos=n.relative?n.p1.position():n.p1.offset();n.p2pos=n.relative?n.p2.position():n.p2.offset()}function k(a){if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="auto"}$(document).off("."+n.id);n.drag_active=false;if(rcmail.message_list){rcmail.message_list.drag_active=false}$("div.iframe-splitter-fix").remove();n.set_cookie();if(typeof n.callback=="function"){n.callback(n)}return bw.safari?true:rcube_event.cancel(a)}function o(a){if(n.horizontal){var b=parseInt(n.parent.outerHeight(),10)-parseInt(n.p2[0].style.top,10);n.p2.css("height",(b>0?b:0)+"px")}else{var c=parseInt(n.parent.outerWidth(),10)-parseInt(n.p2[0].style.left,10);n.p2.css("width",(c>0?c:0)+"px")}}this.get_cookie=function(){return window.UI?UI.get_pref(this.id):null};this.set_cookie=function(){if(window.UI){UI.save_pref(this.id,this.pos)}}}rcube_splitter._instances={};rcube_splitter.get_instance=function(b){return rcube_splitter._instances[b]};