function rcube_splitter(b){this.p1id=b.p1;this.p2id=b.p2;this.id=b.id?b.id:this.p1id+"_"+this.p2id+"_splitter";this.orientation=b.orientation;this.horizontal=(this.orientation=="horizontal"||this.orientation=="h");this.pos=b.start?b.start*1:0;this.relative=b.relative?true:false;this.drag_active=false;this.callback=b.callback;var a=this;this.init=function(){this.p1=document.getElementById(this.p1id);this.p2=document.getElementById(this.p2id);this.p1pos=this.relative?$(this.p1).position():$(this.p1).offset();this.p2pos=this.relative?$(this.p2).position():$(this.p2).offset();if(this.horizontal){var i=this.p1pos.top+this.p1.offsetHeight;this.layer=new rcube_layer(this.id,{x:0,y:i,height:10,width:"100%",vis:1,parent:this.p1.parentNode})}else{var h=this.p1pos.left+this.p1.offsetWidth;this.layer=new rcube_layer(this.id,{x:h,y:0,width:10,height:"100%",vis:1,parent:this.p1.parentNode})}this.elm=this.layer.elm;this.elm.className="splitter "+(this.horizontal?"splitter-h":"splitter-v");this.elm.unselectable="on";$(this.elm).mousedown(c);if(bw.ie){$(window).resize(g)}var j=rcmail.get_cookie(this.id);if(j&&!isNaN(j)){this.pos=parseFloat(j);this.resize()}else{if(this.pos){this.resize();this.set_cookie()}}};this.resize=function(){if(this.horizontal){var j=this.layer.height;this.p1.style.height=Math.floor(this.pos-this.p1pos.top-j/2)+"px";this.p2.style.top=Math.ceil(this.pos+j/2)+"px";this.layer.move(this.layer.x,Math.round(this.pos-j/2+1));if(bw.ie){var i=parseInt(this.p2.parentNode.offsetHeight,10)-parseInt(this.p2.style.top,10);this.p2.style.height=(i>0?i:0)+"px"}}else{this.p1.style.width=Math.floor(this.pos-this.p1pos.left-this.layer.width/2)+"px";this.p2.style.left=Math.ceil(this.pos+this.layer.width/2)+"px";this.layer.move(Math.round(this.pos-this.layer.width/2+1),this.layer.y);if(bw.ie){var h=parseInt(this.p2.parentNode.offsetWidth,10)-parseInt(this.p2.style.left,10);this.p2.style.width=(h>0?h:0)+"px"}}$(this.p2).resize();$(this.p1).resize()};function c(h){a.drag_active=true;if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="none"}a.p1pos=a.relative?$(a.p1).position():$(a.p1).offset();a.p2pos=a.relative?$(a.p2).position():$(a.p2).offset();$(document).on("mousemove."+a.id,e).on("mouseup."+a.id,d);$("iframe").each(function(){$('<div class="iframe-splitter-fix"></div>').css({background:"#fff",width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")})}function e(h){if(!a.drag_active){return false}window.clearTimeout(a.ts);a.ts=window.setTimeout(function(){f(h)},1);return false}function f(h){var i=rcube_event.get_mouse_pos(h);if(a.relative){var j=$(a.p1.parentNode).offset();i.x-=j.left;i.y-=j.top}if(a.horizontal){if(((i.y-a.layer.height*1.5)>a.p1pos.top)&&((i.y+a.layer.height*1.5)<(a.p2pos.top+a.p2.offsetHeight))){a.pos=i.y;a.resize()}}else{if(((i.x-a.layer.width*1.5)>a.p1pos.left)&&((i.x+a.layer.width*1.5)<(a.p2pos.left+a.p2.offsetWidth))){a.pos=i.x;a.resize()}}a.p1pos=a.relative?$(a.p1).position():$(a.p1).offset();a.p2pos=a.relative?$(a.p2).position():$(a.p2).offset()}function d(h){a.drag_active=false;if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="auto"}$(document).off("."+a.id);$("div.iframe-splitter-fix").remove();a.set_cookie();if(typeof a.callback=="function"){a.callback(a)}return bw.safari?true:rcube_event.cancel(h)}function g(i){if(a.horizontal){var h=parseInt(a.p2.parentNode.offsetHeight,10)-parseInt(a.p2.style.top,10);a.p2.style.height=(h>0?h:0)+"px"}else{var j=parseInt(a.p2.parentNode.offsetWidth,10)-parseInt(a.p2.style.left,10);a.p2.style.width=(j>0?j:0)+"px"}}this.set_cookie=function(){var h=new Date();h.setYear(h.getFullYear()+1);rcmail.set_cookie(this.id,this.pos,h)}};