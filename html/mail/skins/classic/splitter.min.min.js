function rcube_splitter(l){this.p1id=l.p1;this.p2id=l.p2;this.id=l.id?l.id:this.p1id+"_"+this.p2id+"_splitter";this.orientation=l.orientation;this.horizontal=(this.orientation=="horizontal"||this.orientation=="h");this.pos=l.start?l.start*1:0;this.relative=l.relative?true:false;this.drag_active=false;this.callback=l.callback;var m=this;this.init=function(){this.p1=document.getElementById(this.p1id);this.p2=document.getElementById(this.p2id);this.p1pos=this.relative?$(this.p1).position():$(this.p1).offset();this.p2pos=this.relative?$(this.p2).position():$(this.p2).offset();if(this.horizontal){var a=this.p1pos.top+this.p1.offsetHeight;this.layer=new rcube_layer(this.id,{x:0,y:a,height:10,width:"100%",vis:1,parent:this.p1.parentNode})}else{var b=this.p1pos.left+this.p1.offsetWidth;this.layer=new rcube_layer(this.id,{x:b,y:0,width:10,height:"100%",vis:1,parent:this.p1.parentNode})}this.elm=this.layer.elm;this.elm.className="splitter "+(this.horizontal?"splitter-h":"splitter-v");this.elm.unselectable="on";$(this.elm).mousedown(k);if(bw.ie){$(window).resize(n)}var c=rcmail.get_cookie(this.id);if(c&&!isNaN(c)){this.pos=parseFloat(c);this.resize()}else{if(this.pos){this.resize();this.set_cookie()}}};this.resize=function(){if(this.horizontal){var c=this.layer.height;this.p1.style.height=Math.floor(this.pos-this.p1pos.top-c/2)+"px";this.p2.style.top=Math.ceil(this.pos+c/2)+"px";this.layer.move(this.layer.x,Math.round(this.pos-c/2+1));if(bw.ie){var a=parseInt(this.p2.parentNode.offsetHeight,10)-parseInt(this.p2.style.top,10);this.p2.style.height=(a>0?a:0)+"px"}}else{this.p1.style.width=Math.floor(this.pos-this.p1pos.left-this.layer.width/2)+"px";this.p2.style.left=Math.ceil(this.pos+this.layer.width/2)+"px";this.layer.move(Math.round(this.pos-this.layer.width/2+1),this.layer.y);if(bw.ie){var b=parseInt(this.p2.parentNode.offsetWidth,10)-parseInt(this.p2.style.left,10);this.p2.style.width=(b>0?b:0)+"px"}}$(this.p2).resize();$(this.p1).resize()};function k(a){m.drag_active=true;if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="none"}m.p1pos=m.relative?$(m.p1).position():$(m.p1).offset();m.p2pos=m.relative?$(m.p2).position():$(m.p2).offset();$(document).on("mousemove."+m.id,i).on("mouseup."+m.id,j);$("iframe").each(function(){$('<div class="iframe-splitter-fix"></div>').css({background:"#fff",width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")})}function i(a){if(!m.drag_active){return false}window.clearTimeout(m.ts);m.ts=window.setTimeout(function(){h(a)},1);return false}function h(b){var a=rcube_event.get_mouse_pos(b);if(m.relative){var c=$(m.p1.parentNode).offset();a.x-=c.left;a.y-=c.top}if(m.horizontal){if(((a.y-m.layer.height*1.5)>m.p1pos.top)&&((a.y+m.layer.height*1.5)<(m.p2pos.top+m.p2.offsetHeight))){m.pos=a.y;m.resize()}}else{if(((a.x-m.layer.width*1.5)>m.p1pos.left)&&((a.x+m.layer.width*1.5)<(m.p2pos.left+m.p2.offsetWidth))){m.pos=a.x;m.resize()}}m.p1pos=m.relative?$(m.p1).position():$(m.p1).offset();m.p2pos=m.relative?$(m.p2).position():$(m.p2).offset()}function j(a){m.drag_active=false;if(bw.konq||bw.chrome||bw.safari){document.body.style.webkitUserSelect="auto"}$(document).off("."+m.id);$("div.iframe-splitter-fix").remove();m.set_cookie();if(typeof m.callback=="function"){m.callback(m)}return bw.safari?true:rcube_event.cancel(a)}function n(a){if(m.horizontal){var b=parseInt(m.p2.parentNode.offsetHeight,10)-parseInt(m.p2.style.top,10);m.p2.style.height=(b>0?b:0)+"px"}else{var c=parseInt(m.p2.parentNode.offsetWidth,10)-parseInt(m.p2.style.left,10);m.p2.style.width=(c>0?c:0)+"px"}}this.set_cookie=function(){var a=new Date();a.setYear(a.getFullYear()+1);rcmail.set_cookie(this.id,this.pos,a)}};