tinymce.PluginManager.add("contextmenu",function(k){var m,e,l=k.settings.contextmenu_never_use_native,n=function(b){return b.ctrlKey&&!l},i=function(){return tinymce.Env.mac&&tinymce.Env.webkit},a=function(){return e===!0};return k.on("mousedown",function(b){i()&&2===b.button&&!n(b)&&k.selection.isCollapsed()&&k.once("contextmenu",function(c){k.selection.placeCaretAt(c.clientX,c.clientY)})}),k.on("contextmenu",function(b){var g;if(!n(b)){if(b.preventDefault(),g=k.settings.contextmenu||"link openlink image inserttable | cell row column deletetable",m){m.show()}else{var d=[];tinymce.each(g.split(/[ ,]/),function(j){var h=k.menuItems[j];"|"==j&&(h={text:j}),h&&(h.shortcut="",d.push(h))});for(var c=0;c<d.length;c++){"|"==d[c].text&&(0!==c&&c!=d.length-1||d.splice(c,1))}m=new tinymce.ui.Menu({items:d,context:"contextmenu",classes:"contextmenu"}).renderTo(),m.on("hide",function(h){h.control===this&&(e=!1)}),k.on("remove",function(){m.remove(),m=null})}var f={x:b.pageX,y:b.pageY};k.inline||(f=tinymce.DOM.getPos(k.getContentAreaContainer()),f.x+=b.clientX,f.y+=b.clientY),m.moveTo(f.x,f.y),e=!0}}),{isContextMenuVisible:a}});