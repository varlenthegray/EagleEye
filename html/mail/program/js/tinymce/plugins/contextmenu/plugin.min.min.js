tinymce.PluginManager.add("contextmenu",function(g){var d,j,f=g.settings.contextmenu_never_use_native,c=function(a){return a.ctrlKey&&!f},h=function(){return tinymce.Env.mac&&tinymce.Env.webkit},b=function(){return j===!0};return g.on("mousedown",function(a){h()&&2===a.button&&!c(a)&&g.selection.isCollapsed()&&g.once("contextmenu",function(e){g.selection.placeCaretAt(e.clientX,e.clientY)})}),g.on("contextmenu",function(m){var n;if(!c(m)){if(m.preventDefault(),n=g.settings.contextmenu||"link openlink image inserttable | cell row column deletetable",d){d.show()}else{var i=[];tinymce.each(n.split(/[ ,]/),function(a){var l=g.menuItems[a];"|"==a&&(l={text:a}),l&&(l.shortcut="",i.push(l))});for(var k=0;k<i.length;k++){"|"==i[k].text&&(0!==k&&k!=i.length-1||i.splice(k,1))}d=new tinymce.ui.Menu({items:i,context:"contextmenu",classes:"contextmenu"}).renderTo(),d.on("hide",function(a){a.control===this&&(j=!1)}),g.on("remove",function(){d.remove(),d=null})}var e={x:m.pageX,y:m.pageY};g.inline||(e=tinymce.DOM.getPos(g.getContentAreaContainer()),e.x+=m.clientX,e.y+=m.clientY),d.moveTo(e.x,e.y),j=!0}}),{isContextMenuVisible:b}});