tinymce.PluginManager.add("visualblocks",function(k,e){function i(){var a=this;a.active(j),k.on("VisualBlocks",function(){a.active(k.dom.hasClass(k.getBody(),"mce-visualblocks"))})}var l,h,j;window.NodeList&&(k.addCommand("mceVisualBlocks",function(){var a,b=k.dom;l||(l=b.uniqueId(),a=b.create("link",{id:l,rel:"stylesheet",href:e+"/css/visualblocks.css"}),k.getDoc().getElementsByTagName("head")[0].appendChild(a)),k.on("PreviewFormats AfterPreviewFormats",function(c){j&&b.toggleClass(k.getBody(),"mce-visualblocks","afterpreviewformats"==c.type)}),b.toggleClass(k.getBody(),"mce-visualblocks"),j=k.dom.hasClass(k.getBody(),"mce-visualblocks"),h&&h.active(b.hasClass(k.getBody(),"mce-visualblocks")),k.fire("VisualBlocks")}),k.addButton("visualblocks",{title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:i}),k.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:i,selectable:!0,context:"view",prependToContext:!0}),k.on("init",function(){k.settings.visualblocks_default_state&&k.execCommand("mceVisualBlocks",!1,null,{skip_focus:!0})}),k.on("remove",function(){k.dom.removeClass(k.getBody(),"mce-visualblocks")}))});