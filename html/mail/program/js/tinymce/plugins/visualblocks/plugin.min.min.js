tinymce.PluginManager.add("visualblocks",function(d,b){function g(){var e=this;e.active(f),d.on("VisualBlocks",function(){e.active(d.dom.hasClass(d.getBody(),"mce-visualblocks"))})}var c,a,f;window.NodeList&&(d.addCommand("mceVisualBlocks",function(){var h,e=d.dom;c||(c=e.uniqueId(),h=e.create("link",{id:c,rel:"stylesheet",href:b+"/css/visualblocks.css"}),d.getDoc().getElementsByTagName("head")[0].appendChild(h)),d.on("PreviewFormats AfterPreviewFormats",function(i){f&&e.toggleClass(d.getBody(),"mce-visualblocks","afterpreviewformats"==i.type)}),e.toggleClass(d.getBody(),"mce-visualblocks"),f=d.dom.hasClass(d.getBody(),"mce-visualblocks"),a&&a.active(e.hasClass(d.getBody(),"mce-visualblocks")),d.fire("VisualBlocks")}),d.addButton("visualblocks",{title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:g}),d.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:g,selectable:!0,context:"view",prependToContext:!0}),d.on("init",function(){d.settings.visualblocks_default_state&&d.execCommand("mceVisualBlocks",!1,null,{skip_focus:!0})}),d.on("remove",function(){d.dom.removeClass(d.getBody(),"mce-visualblocks")}))});