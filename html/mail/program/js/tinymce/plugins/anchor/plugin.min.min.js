tinymce.PluginManager.add("anchor",function(d){var b=function(g){return !g.attr("href")&&(g.attr("id")||g.attr("name"))&&!g.firstChild},f=function(g){return function(h){for(var e=0;e<h.length;e++){b(h[e])&&h[e].attr("contenteditable",g)}}},c=function(g){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(g)},a=function(){var g=d.selection.getNode(),h="A"==g.tagName&&""===d.dom.getAttrib(g,"href"),e="";h&&(e=g.id||g.name||""),d.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:e},onsubmit:function(j){var k=j.data.id;return c(k)?void (h?(g.removeAttribute("name"),g.id=k):(d.selection.collapse(!0),d.execCommand("mceInsertContent",!1,d.dom.createHTML("a",{id:k})))):(j.preventDefault(),void d.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."))}})};tinymce.Env.ceFalse&&d.on("PreInit",function(){d.parser.addNodeFilter("a",f("false")),d.serializer.addNodeFilter("a",f(null))}),d.addCommand("mceAnchor",a),d.addButton("anchor",{icon:"anchor",tooltip:"Anchor",onclick:a,stateSelector:"a:not([href])"}),d.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",onclick:a})});