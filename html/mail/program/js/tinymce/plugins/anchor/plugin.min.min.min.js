tinymce.PluginManager.add("anchor",function(i){var e=function(a){return !a.attr("href")&&(a.attr("id")||a.attr("name"))&&!a.firstChild},h=function(a){return function(b){for(var c=0;c<b.length;c++){e(b[c])&&b[c].attr("contenteditable",a)}}},j=function(a){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(a)},g=function(){var b=i.selection.getNode(),a="A"==b.tagName&&""===i.dom.getAttrib(b,"href"),c="";a&&(c=b.id||b.name||""),i.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:c},onsubmit:function(f){var d=f.data.id;return j(d)?void (a?(b.removeAttribute("name"),b.id=d):(i.selection.collapse(!0),i.execCommand("mceInsertContent",!1,i.dom.createHTML("a",{id:d})))):(f.preventDefault(),void i.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."))}})};tinymce.Env.ceFalse&&i.on("PreInit",function(){i.parser.addNodeFilter("a",h("false")),i.serializer.addNodeFilter("a",h(null))}),i.addCommand("mceAnchor",g),i.addButton("anchor",{icon:"anchor",tooltip:"Anchor",onclick:g,stateSelector:"a:not([href])"}),i.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",onclick:g})});