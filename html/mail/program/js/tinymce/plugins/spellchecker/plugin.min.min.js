!function(g,d){function j(k,a){for(var m,i=[],l=0;l<k.length;++l){if(m=b[k[l]]||c(k[l]),!m){throw"module definition dependecy not found: "+k[l]}i.push(m)}a.apply(null,i)}function f(l,k,a){if("string"!=typeof l){throw"invalid module definition, module id must be defined and be a string"}if(k===d){throw"invalid module definition, dependencies must be specified"}if(a===d){throw"invalid module definition, definition function must be specified"}j(k,function(){b[l]=a.apply(null,arguments)})}function c(e){for(var l=g,k=e.split(/[.\/]/),a=0;a<k.length;++a){if(!l[k[a]]){return}l=l[k[a]]}return l}function h(t){var m,e,p,k,a;for(m=0;m<t.length;m++){e=g,p=t[m],k=p.split(/[.\/]/);for(var q=0;q<k.length-1;++q){e[k[q]]===d&&(e[k[q]]={}),e=e[k[q]]}e[k[k.length-1]]=b[p]}if(g.AMDLC_TESTS){a=g.privateModules||{};for(p in b){a[p]=b[p]}for(m=0;m<t.length;m++){delete a[t[m]]}g.privateModules=a}}var b={};f("tinymce/spellcheckerplugin/DomTextMatcher",[],function(){function a(i){return i&&1==i.nodeType&&"false"===i.contentEditable}return function(H,O){function K(k,i){if(!k[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}return{start:k.index,end:k.index+k[0].length,text:k[0],data:i}}function T(i){var k;if(3===i.nodeType){return i.data}if(R[i.nodeName]&&!q[i.nodeName]){return""}if(a(i)){return"\n"}if(k="",(q[i.nodeName]||e[i.nodeName])&&(k+="\n"),i=i.firstChild){do{k+=T(i)}while(i=i.nextSibling)}return k}function M(S,p,k){var w,m,E,ac,v,C=[],N=0,y=S,x=0;p=p.slice(0),p.sort(function(l,i){return l.start-i.start}),v=p.shift();a:for(;;){if((q[y.nodeName]||e[y.nodeName]||a(y))&&N++,3===y.nodeType&&(!m&&y.length+N>=v.end?(m=y,ac=v.end-N):w&&C.push(y),!w&&y.length+N>v.start&&(w=y,E=v.start-N),N+=y.length),w&&m){if(y=k({startNode:w,startNodeIndex:E,endNode:m,endNodeIndex:ac,innerNodes:C,match:v.text,matchIndex:x}),N-=m.length-ac,w=null,m=null,C=[],v=p.shift(),x++,!v){break}}else{if(R[y.nodeName]&&!q[y.nodeName]||!y.firstChild){if(y.nextSibling){y=y.nextSibling;continue}}else{if(!a(y)){y=y.firstChild;continue}}}for(;;){if(y.nextSibling){y=y.nextSibling;break}if(y.parentNode===S){break a}y=y.parentNode}}}function aa(k){function i(m,p){var o=ab[p];o.stencil||(o.stencil=k(o));var l=o.stencil.cloneNode(!1);return l.setAttribute("data-mce-index",p),m&&l.appendChild(G.doc.createTextNode(m)),l}return function(ae){var y,t,N,x=ae.startNode,ah=ae.endNode,ak=ae.matchIndex,E=G.doc;if(x===ah){var ag=x;N=ag.parentNode,ae.startNodeIndex>0&&(y=E.createTextNode(ag.data.substring(0,ae.startNodeIndex)),N.insertBefore(y,ag));var aj=i(ae.match,ak);return N.insertBefore(aj,ag),ae.endNodeIndex<ag.length&&(t=E.createTextNode(ag.data.substring(ae.endNodeIndex)),N.insertBefore(t,ag)),ag.parentNode.removeChild(ag),aj}y=E.createTextNode(x.data.substring(0,ae.startNodeIndex)),t=E.createTextNode(ah.data.substring(ae.endNodeIndex));for(var af=i(x.data.substring(ae.startNodeIndex),ak),ad=[],w=0,C=ae.innerNodes.length;w<C;++w){var ac=ae.innerNodes[w],S=i(ac.data,ak);ac.parentNode.replaceChild(S,ac),ad.push(S)}var ai=i(ah.data.substring(0,ae.endNodeIndex),ak);return N=x.parentNode,N.insertBefore(y,x),N.insertBefore(af,x),N.removeChild(x),N=ah.parentNode,N.insertBefore(ai,ah),N.insertBefore(t,ah),N.removeChild(ah),ai}}function I(k){var i=k.parentNode;i.insertBefore(k.firstChild,k),k.parentNode.removeChild(k)}function Q(p){var t=H.getElementsByTagName("*"),m=[];p="number"==typeof p?""+p:null;for(var l=0;l<t.length;l++){var s=t[l],k=s.getAttribute("data-mce-index");null!==k&&k.length&&(k!==p&&null!==p||m.push(s))}return m}function Y(k){for(var i=ab.length;i--;){if(ab[i]===k){return i}}return -1}function F(k){var i=[];return X(function(m,l){k(m,l)&&i.push(m)}),ab=i,this}function X(k){for(var i=0,l=ab.length;i<l&&k(ab[i],i)!==!1;i++){}return this}function W(i){return ab.length&&M(H,ab,aa(i)),this}function L(k,i){if(B&&k.global){for(;J=k.exec(B);){ab.push(K(J,i))}}return this}function P(k){var i,l=Q(k?Y(k):null);for(i=l.length;i--;){I(l[i])}return this}function V(i){return ab[i.getAttribute("data-mce-index")]}function U(i){return Q(Y(i))[0]}function D(k,i,l){return ab.push({start:k,end:k+i,text:B.substr(k,i),data:l}),this}function Z(l){var i=Q(Y(l)),k=O.dom.createRng();return k.setStartBefore(i[0]),k.setEndAfter(i[i.length-1]),k}function z(l,i){var k=Z(l);return k.deleteContents(),i.length>0&&k.insertNode(O.dom.doc.createTextNode(i)),k}function A(){return ab.splice(0,ab.length),P(),this}var J,B,q,R,e,ab=[],G=O.dom;return q=O.schema.getBlockElements(),R=O.schema.getWhiteSpaceElements(),e=O.schema.getShortEndedElements(),B=T(H),{text:B,matches:ab,each:X,filter:F,reset:A,matchFromElement:V,elementFromMatch:U,find:L,add:D,wrap:W,unwrap:P,replace:z,rangeFromMatch:Z,indexOf:Y}}}),f("tinymce/spellcheckerplugin/Plugin",["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/PluginManager","tinymce/util/Tools","tinymce/ui/Menu","tinymce/dom/DOMUtils","tinymce/util/XHR","tinymce/util/URI","tinymce/util/JSON"],function(u,m,w,q,l,v,k,p){m.add("spellchecker",function(U,aa){function G(){return K.textMatcher||(K.textMatcher=new u(U.getBody(),U)),K.textMatcher}function Z(A,x){var y=[];return w.each(x,function(B){y.push({selectable:!0,text:B.name,data:B.value})}),y}function Y(y){for(var x in y){return !1}return !0}function O(C,A){var D=[],x=H[C];w.each(x,function(M){D.push({text:M,onclick:function(){U.insertContent(U.dom.encode(M)),U.dom.remove(A),ab()}})}),D.push({text:"-"}),L&&D.push({text:"Add to Dictionary",onclick:function(){s(C,A)}}),D.push.apply(D,[{text:"Ignore",onclick:function(){t(C,A)}},{text:"Ignore all",onclick:function(){t(C,A,!0)}}]),i=new q({items:D,context:"contextmenu",onautohide:function(M){M.target.className.indexOf("spellchecker")!=-1&&M.preventDefault()},onhide:function(){i.remove(),i=null}}),i.renderTo(document.body);var B=l.DOM.getPos(U.getContentAreaContainer()),E=U.dom.getPos(A[0]),y=U.dom.getRoot();"BODY"==y.nodeName?(E.x-=y.ownerDocument.documentElement.scrollLeft||y.scrollLeft,E.y-=y.ownerDocument.documentElement.scrollTop||y.scrollTop):(E.x-=y.scrollLeft,E.y-=y.scrollTop),B.x+=E.x,B.y+=E.y,i.moveTo(B.x,B.y+A[0].offsetHeight)}function Q(){return U.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e\xa0\u2002\u2003\u2009]+',"g")}function X(C,A,B,y){var x={method:C,lang:n.spellchecker_language},D="";x["addToDictionary"==C?"word":"text"]=A,w.each(x,function(M,E){D&&(D+="&"),D+=E+"="+encodeURIComponent(M)}),v.send({url:new k(aa).toAbsolute(n.spellchecker_rpc_url),type:"post",content_type:"application/x-www-form-urlencoded",data:D,success:function(M){if(M=p.parse(M)){M.error?y(M.error):B(M)}else{var E=U.translate("Server response wasn't proper JSON.");y(E)}},error:function(){var E=U.translate("The spelling service was not found: (")+n.spellchecker_rpc_url+U.translate(")");y(E)}})}function W(B,y,C,A){var x=n.spellchecker_callback||X;x.call(K,B,y,C,A)}function F(){function x(y){U.notificationManager.open({text:y,type:"error"}),U.setProgressState(!1),J()}J()||(U.setProgressState(!0),W("spellcheck",G().text,e,x),U.focus())}function ab(){U.dom.select("span.mce-spellchecker-word").length||J()}function s(y,x){U.setProgressState(!0),W("addToDictionary",y,function(){U.setProgressState(!1),U.dom.remove(x,!0),ab()},function(A){U.notificationManager.open({text:A,type:"error"}),U.setProgressState(!1)})}function t(A,x,y){U.selection.collapse(),y?w.each(U.dom.select("span.mce-spellchecker-word"),function(B){B.getAttribute("data-mce-word")==A&&U.dom.remove(B,!0)}):U.dom.remove(x,!0),ab()}function J(){if(G().reset(),K.textMatcher=null,a){return a=!1,U.fire("SpellcheckEnd"),!0}}function z(y){var x=y.getAttribute("data-mce-index");return"number"==typeof x?""+x:x}function o(B){var y,A=[];if(y=w.toArray(U.getBody().getElementsByTagName("span")),y.length){for(var x=0;x<y.length;x++){var C=z(y[x]);null!==C&&C.length&&C===B.toString()&&A.push(y[x])}}return A}function V(y){var x=n.spellchecker_language;y.control.items().each(function(A){A.active(A.settings.data===x)})}function e(y){var x;if(y.words?(L=!!y.dictionary,x=y.words):x=y,U.setProgressState(!1),Y(x)){var A=U.translate("No misspellings found.");return U.notificationManager.open({text:A,type:"info"}),void (a=!1)}H=x,G().find(Q()).filter(function(B){return !!x[B.text]}).wrap(function(B){return U.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":B.text})}),a=!0,U.fire("SpellcheckStart")}var ac,H,a,i,L,K=this,n=U.settings;if(/(^|[ ,])tinymcespellchecker([, ]|$)/.test(n.plugins)&&m.get("tinymcespellchecker")){return void ("undefined"!=typeof console&&console.log&&console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."))}var I=n.spellchecker_languages||"English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";ac=Z("Language",w.map(I.split(","),function(x){return x=x.split("="),{name:x[0],value:x[1]}})),U.on("click",function(A){var x=A.target;if("mce-spellchecker-word"==x.className){A.preventDefault();var B=o(z(x));if(B.length>0){var y=U.dom.createRng();y.setStartBefore(B[0]),y.setEndAfter(B[B.length-1]),U.selection.setRng(y),O(x.getAttribute("data-mce-word"),B)}}}),U.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:F,selectable:!0,onPostRender:function(){var x=this;x.active(a),U.on("SpellcheckStart SpellcheckEnd",function(){x.active(a)})}});var r={tooltip:"Spellcheck",onclick:F,onPostRender:function(){var x=this;U.on("SpellcheckStart SpellcheckEnd",function(){x.active(a)})}};ac.length>1&&(r.type="splitbutton",r.menu=ac,r.onshow=V,r.onselect=function(x){n.spellchecker_language=x.control.settings.data}),U.addButton("spellchecker",r),U.addCommand("mceSpellCheck",F),U.on("remove",function(){i&&(i.remove(),i=null)}),U.on("change",ab),this.getTextMatcher=G,this.getWordCharPattern=Q,this.markErrors=e,this.getLanguage=function(){return n.spellchecker_language},n.spellchecker_language=n.spellchecker_language||n.language||"en"})}),h(["tinymce/spellcheckerplugin/DomTextMatcher"])}(window);