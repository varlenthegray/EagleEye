tinymce.PluginManager.add("preview",function(b){var a=b.settings,c=!tinymce.Env.ie;b.addCommand("mcePreview",function(){b.windowManager.open({title:"Preview",width:parseInt(b.getParam("plugin_preview_width","650"),10),height:parseInt(b.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(c?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var h,f="";f+='<base href="'+b.documentBaseURI.getURI()+'">',tinymce.each(b.contentCSS,function(i){f+='<link type="text/css" rel="stylesheet" href="'+b.documentBaseURI.toAbsolute(i)+'">'});var j=a.body_id||"tinymce";j.indexOf("=")!=-1&&(j=b.getParam("body_id","","hash"),j=j[b.id]||j);var e=a.body_class||"";e.indexOf("=")!=-1&&(e=b.getParam("body_class","","hash"),e=e[b.id]||"");var g='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ',d=b.settings.directionality?' dir="'+b.settings.directionality+'"':"";if(h="<!DOCTYPE html><html><head>"+f+'</head><body id="'+j+'" class="mce-content-body '+e+'"'+d+">"+b.getContent()+g+"</body></html>",c){this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(h)}else{var k=this.getEl("body").firstChild.contentWindow.document;k.open(),k.write(h),k.close()}}})}),b.addButton("preview",{title:"Preview",cmd:"mcePreview"}),b.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});