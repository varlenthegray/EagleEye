tinymce.PluginManager.add("preview",function(d){var e=d.settings,f=!tinymce.Env.ie;d.addCommand("mcePreview",function(){d.windowManager.open({title:"Preview",width:parseInt(d.getParam("plugin_preview_width","650"),10),height:parseInt(d.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(f?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var c,l="";l+='<base href="'+d.documentBaseURI.getURI()+'">',tinymce.each(d.contentCSS,function(g){l+='<link type="text/css" rel="stylesheet" href="'+d.documentBaseURI.toAbsolute(g)+'">'});var b=e.body_id||"tinymce";b.indexOf("=")!=-1&&(b=d.getParam("body_id","","hash"),b=b[d.id]||b);var m=e.body_class||"";m.indexOf("=")!=-1&&(m=d.getParam("body_class","","hash"),m=m[d.id]||"");var i='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ',n=d.settings.directionality?' dir="'+d.settings.directionality+'"':"";if(c="<!DOCTYPE html><html><head>"+l+'</head><body id="'+b+'" class="mce-content-body '+m+'"'+n+">"+d.getContent()+i+"</body></html>",f){this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(c)}else{var a=this.getEl("body").firstChild.contentWindow.document;a.open(),a.write(c),a.close()}}})}),d.addButton("preview",{title:"Preview",cmd:"mcePreview"}),d.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});