tinymce.PluginManager.add("autolink",function(g){function d(a){c(a,-1,"(",!0)}function j(a){c(a,0,"",!0)}function f(a){c(a,-1,"",!1)}function c(C,G,v){function a(l,i){if(i<0&&(i=0),3==l.nodeType){var m=l.data.length;i>m&&(i=m)}return i}function y(l,i){1!=l.nodeType||l.hasChildNodes()?H.setStart(l,a(l,i)):H.setStartBefore(l)}function q(l,i){1!=l.nodeType||l.hasChildNodes()?H.setEnd(l,a(l,i)):H.setEndAfter(l)}var H,x,E,F,D,B,k,w,A,z;if("A"!=C.selection.getNode().tagName){if(H=C.selection.getRng(!0).cloneRange(),H.startOffset<5){if(w=H.endContainer.previousSibling,!w){if(!H.endContainer.firstChild||!H.endContainer.firstChild.nextSibling){return}w=H.endContainer.firstChild.nextSibling}if(A=w.length,y(w,A),q(w,A),H.endOffset<5){return}x=H.endOffset,F=w}else{if(F=H.endContainer,3!=F.nodeType&&F.firstChild){for(;3!=F.nodeType&&F.firstChild;){F=F.firstChild}3==F.nodeType&&(y(F,0),q(F,F.nodeValue.length))}x=1==H.endOffset?2:H.endOffset-1-G}E=x;do{y(F,x>=2?x-2:0),q(F,x>=1?x-1:0),x-=1,z=H.toString()}while(" "!=z&&""!==z&&160!=z.charCodeAt(0)&&x-2>=0&&z!=v);H.toString()==v||160==H.toString().charCodeAt(0)?(y(F,x),q(F,E),x+=1):0===H.startOffset?(y(F,0),q(F,E)):(y(F,x),q(F,E)),B=H.toString(),"."==B.charAt(B.length-1)&&q(F,E-1),B=H.toString(),k=B.match(b),k&&("www."==k[1]?k[1]="http://www.":/@$/.test(k[1])&&!/^mailto:/.test(k[1])&&(k[1]="mailto:"+k[1]),D=C.selection.getBookmark(),C.selection.setRng(H),C.execCommand("createlink",!1,k[1]+k[2]),C.settings.default_link_target&&C.dom.setAttrib(C.selection.getNode(),"target",C.settings.default_link_target),C.selection.moveToBookmark(D),C.nodeChanged())}}var h,b=/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i;return g.settings.autolink_pattern&&(b=g.settings.autolink_pattern),g.on("keydown",function(a){if(13==a.keyCode){return f(g)}}),tinymce.Env.ie?void g.on("focus",function(){if(!h){h=!0;try{a.execCommand("AutoUrlDetect",!1,!0)}catch(a){}}}):(g.on("keypress",function(a){if(41==a.keyCode){return d(g)}}),void g.on("keyup",function(a){if(32==a.keyCode){return j(g)}}))});