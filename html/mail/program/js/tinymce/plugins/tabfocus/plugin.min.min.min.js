tinymce.PluginManager.add("tabfocus",function(k){function e(a){9!==a.keyCode||a.ctrlKey||a.altKey||a.metaKey||a.preventDefault()}function i(c){function n(m){function o(p){return"BODY"===p.nodeName||"hidden"!=p.type&&"none"!=p.style.display&&"hidden"!=p.style.visibility&&o(p.parentNode)}function s(p){return/INPUT|TEXTAREA|BUTTON/.test(p.tagName)&&tinymce.get(c.id)&&p.tabIndex!=-1&&o(p)}if(b=l.select(":input:enabled,*[tabindex]:not(iframe)"),h(b,function(p,q){if(p.id==k.id){return f=q,!1}}),m>0){for(a=f+1;a<b.length;a++){if(s(b[a])){return b[a]}}}else{for(a=f-1;a>=0;a--){if(s(b[a])){return b[a]}}}return null}var f,b,g,a;if(!(9!==c.keyCode||c.ctrlKey||c.altKey||c.metaKey||c.isDefaultPrevented())&&(g=j(k.getParam("tab_focus",k.getParam("tabfocus_elements",":prev,:next"))),1==g.length&&(g[1]=g[0],g[0]=":prev"),b=c.shiftKey?":prev"==g[0]?n(-1):l.get(g[0]):":next"==g[1]?n(1):l.get(g[1]))){var d=tinymce.get(b.id||b.name);b.id&&d?d.focus():tinymce.util.Delay.setTimeout(function(){tinymce.Env.webkit||window.focus(),b.focus()},10),c.preventDefault()}}var l=tinymce.DOM,h=tinymce.each,j=tinymce.explode;k.on("init",function(){k.inline&&tinymce.DOM.setAttrib(k.getBody(),"tabIndex",null),k.on("keyup",e),tinymce.Env.gecko?k.on("keypress keydown",i):k.on("keydown",i)})});