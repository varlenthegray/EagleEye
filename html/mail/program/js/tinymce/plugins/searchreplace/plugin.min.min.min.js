!function(){function d(a){return a&&1==a.nodeType&&"false"===a.contentEditable}function e(t,c,m,o,i){function J(k,w){if(w=w||0,!k[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var j=k.index;if(w>0){var q=k[w];if(!q){throw"Invalid capture group"}j+=k[0].indexOf(q),k[0]=q}return[j,j+k[0].length,[k[0]]]}function s(k){var j;if(3===k.nodeType){return k.data}if(r[k.nodeName]&&!l[k.nodeName]){return""}if(j="",d(k)){return"\n"}if((l[k.nodeName]||h[k.nodeName])&&(j+="\n"),k=k.firstChild){do{j+=s(k)}while(k=k.nextSibling)}return j}function p(y,k,x){var E,q,A,w,j=[],B=0,z=y,C=k.shift(),D=0;d:for(;;){if((l[z.nodeName]||h[z.nodeName]||d(z))&&B++,3===z.nodeType&&(!q&&z.length+B>=C[1]?(q=z,w=C[1]-B):E&&j.push(z),!E&&z.length+B>C[0]&&(E=z,A=C[0]-B),B+=z.length),E&&q){if(z=x({startNode:E,startNodeIndex:A,endNode:q,endNodeIndex:w,innerNodes:j,match:C[2],matchIndex:D}),B-=q.length-w,E=null,q=null,j=[],C=k.shift(),D++,!C){break}}else{if(r[z.nodeName]&&!l[z.nodeName]||!z.firstChild){if(z.nextSibling){z=z.nextSibling;continue}}else{if(!d(z)){z=z.firstChild;continue}}}for(;;){if(z.nextSibling){z=z.nextSibling;break}if(z.parentNode===y){break d}z=z.parentNode}}}function a(k){var q;if("function"!=typeof k){var j=k.nodeType?k:g.createElement(k);q=function(w,y){var x=j.cloneNode(!1);return x.setAttribute("data-mce-index",y),w&&x.appendChild(g.createTextNode(w)),x}}else{q=k}return function(C){var I,aa,F,Y=C.startNode,z=C.endNode,w=C.matchIndex;if(Y===z){var G=Y;F=G.parentNode,C.startNodeIndex>0&&(I=g.createTextNode(G.data.substring(0,C.startNodeIndex)),F.insertBefore(I,G));var A=q(C.match[0],w);return F.insertBefore(A,G),C.endNodeIndex<G.length&&(aa=g.createTextNode(G.data.substring(C.endNodeIndex)),F.insertBefore(aa,G)),G.parentNode.removeChild(G),A}I=g.createTextNode(Y.data.substring(0,C.startNodeIndex)),aa=g.createTextNode(z.data.substring(C.endNodeIndex));for(var x=q(Y.data.substring(C.startNodeIndex),w),B=[],Z=0,H=C.innerNodes.length;Z<H;++Z){var D=C.innerNodes[Z],E=q(D.data,w);D.parentNode.replaceChild(E,D),B.push(E)}var y=q(z.data.substring(0,C.endNodeIndex),w);return F=Y.parentNode,F.insertBefore(I,Y),F.insertBefore(x,Y),F.removeChild(Y),F=z.parentNode,F.insertBefore(y,z),F.insertBefore(aa,z),F.removeChild(z),y}}var u,b,g,l,r,h,n=[],v=0;if(g=c.ownerDocument,l=i.getBlockElements(),r=i.getWhiteSpaceElements(),h=i.getShortEndedElements(),b=s(c)){if(t.global){for(;u=t.exec(b);){n.push(J(u,o))}}else{u=b.match(t),n.push(J(u,o))}return n.length&&(v=n.length,p(c,n,a(m))),v}}function f(c){function n(){function k(){j.statusbar.find("#next").disabled(!x(b+1).length),j.statusbar.find("#prev").disabled(!x(b-1).length)}function h(){c.windowManager.alert("Could not find the specified string.",function(){j.find("#find")[0].focus()})}var g,m={};g=tinymce.trim(c.selection.getContent({format:"text"}));var j=c.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){c.focus(),u.done()},onSubmit:function(p){var t,w,q,v;return p.preventDefault(),w=j.find("#case").checked(),v=j.find("#words").checked(),q=j.find("#find").value(),q.length?m.text==q&&m.caseState==w&&m.wholeWord==v?0===x(b+1).length?void h():(u.next(),void k()):(t=u.find(q,w,v),t||h(),j.statusbar.items().slice(1).disabled(0===t),k(),void (m={text:q,caseState:w,wholeWord:v})):(u.done(!1),void j.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){j.submit()}},{text:"Replace",disabled:!0,onclick:function(){u.replace(j.find("#replace").value())||(j.statusbar.items().slice(1).disabled(!0),b=-1,m={})}},{text:"Replace all",disabled:!0,onclick:function(){u.replace(j.find("#replace").value(),!0,!0),j.statusbar.items().slice(1).disabled(!0),m={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){u.prev(),k()}},{text:"Next",name:"next",disabled:!0,onclick:function(){u.next(),k()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:g},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})}function r(g){var h=g.getAttribute("data-mce-index");return"number"==typeof h?""+h:h}function i(g){var h,j;return j=c.dom.create("span",{"data-mce-bogus":1}),j.className="mce-match-marker",h=c.getBody(),u.done(!1),e(g,h,j,!1,c.schema)}function o(g){var h=g.parentNode;g.firstChild&&h.insertBefore(g.firstChild,g),g.parentNode.removeChild(g)}function x(g){var h,k=[];if(h=tinymce.toArray(c.getBody().getElementsByTagName("span")),h.length){for(var j=0;j<h.length;j++){var m=r(h[j]);null!==m&&m.length&&m===g.toString()&&k.push(h[j])}}return k}function s(h){var k=b,g=c.dom;h=h!==!1,h?k++:k--,g.removeClass(x(b),"mce-match-marker-selected");var j=x(k);return j.length?(g.addClass(x(k),"mce-match-marker-selected"),c.selection.scrollIntoView(j[0]),k):-1}function l(j){var g=c.dom,h=j.parentNode;g.remove(j),g.isEmpty(h)&&g.remove(h)}function a(g){var h=r(g);return null!==h&&h.length>0}var u=this,b=-1;u.init=function(g){g.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:n,separator:"before",context:"edit"}),g.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Meta+F",onclick:n}),g.addCommand("SearchReplace",n),g.shortcuts.add("Meta+F","",n)},u.find=function(g,k,j){g=g.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),g=j?"\\b"+g+"\\b":g;var h=i(new RegExp(g,k?"g":"gi"));return h&&(b=-1,b=s(!0)),h},u.next=function(){var g=s(!0);g!==-1&&(b=g)},u.prev=function(){var g=s(!1);g!==-1&&(b=g)},u.replace=function(k,p,j){var h,w,q,m,C,g,t=b;for(p=p!==!1,q=c.getBody(),w=tinymce.grep(tinymce.toArray(q.getElementsByTagName("span")),a),h=0;h<w.length;h++){var v=r(w[h]);if(m=C=parseInt(v,10),j||m===b){for(k.length?(w[h].firstChild.nodeValue=k,o(w[h])):l(w[h]);w[++h];){if(m=parseInt(r(w[h]),10),m!==C){h--;break}l(w[h])}p&&t--}else{C>b&&w[h].setAttribute("data-mce-index",C-1)}}return c.undoManager.add(),b=t,p?(g=x(t+1).length>0,u.next()):(g=x(t-1).length>0,u.prev()),!j&&g},u.done=function(j){var q,p,k,h;for(p=tinymce.toArray(c.getBody().getElementsByTagName("span")),q=0;q<p.length;q++){var m=r(p[q]);null!==m&&m.length&&(m===b.toString()&&(k||(k=p[q].firstChild),h=p[q].firstChild),o(p[q]))}if(k&&h){var g=c.dom.createRng();return g.setStart(k,0),g.setEnd(h,h.data.length),j!==!1&&c.selection.setRng(g),g}}}tinymce.PluginManager.add("searchreplace",f)}();