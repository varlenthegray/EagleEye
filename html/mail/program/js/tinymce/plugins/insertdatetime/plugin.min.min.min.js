tinymce.PluginManager.add("insertdatetime",function(l){function c(b,d){function f(g,h){if(g=""+g,g.length<h){for(var j=0;j<h-g.length;j++){g="0"+g}}return g}return d=d||new Date,b=b.replace("%D","%m/%d/%Y"),b=b.replace("%r","%I:%M:%S %p"),b=b.replace("%Y",""+d.getFullYear()),b=b.replace("%y",""+d.getYear()),b=b.replace("%m",f(d.getMonth()+1,2)),b=b.replace("%d",f(d.getDate(),2)),b=b.replace("%H",""+f(d.getHours(),2)),b=b.replace("%M",""+f(d.getMinutes(),2)),b=b.replace("%S",""+f(d.getSeconds(),2)),b=b.replace("%I",""+((d.getHours()+11)%12+1)),b=b.replace("%p",""+(d.getHours()<12?"AM":"PM")),b=b.replace("%B",""+l.translate(o[d.getMonth()])),b=b.replace("%b",""+l.translate(a[d.getMonth()])),b=b.replace("%A",""+l.translate(e[d.getDay()])),b=b.replace("%a",""+l.translate(s[d.getDay()])),b=b.replace("%%","%")}function r(d){var g=c(d);if(l.settings.insertdatetime_element){var b;b=c(/%[HMSIp]/.test(d)?"%Y-%m-%dT%H:%M":"%Y-%m-%d"),g='<time datetime="'+b+'">'+g+"</time>";var f=l.dom.getParent(l.selection.getStart(),"time");if(f){return void l.dom.setOuterHTML(f,g)}}l.insertContent(g)}var t,n,s="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),e="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),a="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),o="January February March April May June July August September October November December".split(" "),i=[];l.addCommand("mceInsertDate",function(){r(l.getParam("insertdatetime_dateformat",l.translate("%Y-%m-%d")))}),l.addCommand("mceInsertTime",function(){r(l.getParam("insertdatetime_timeformat",l.translate("%H:%M:%S")))}),l.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",onclick:function(){r(t||n)},menu:i}),tinymce.each(l.settings.insertdatetime_formats||["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"],function(b){n||(n=b),i.push({text:c(b),onclick:function(){t=b,r(b)}})}),l.addMenuItem("insertdatetime",{icon:"date",text:"Date/time",menu:i,context:"insert"})});