tinymce.PluginManager.add("pagebreak",function(i){var e="mce-pagebreak",h=i.getParam("pagebreak_separator","<!-- pagebreak -->"),j=new RegExp(h.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi"),g='<img src="'+tinymce.Env.transparentSrc+'" class="'+e+'" data-mce-resize="false" data-mce-placeholder />';i.addCommand("mcePageBreak",function(){i.settings.pagebreak_split_block?i.insertContent("<p>"+g+"</p>"):i.insertContent(g)}),i.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),i.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),i.on("ResolveName",function(a){"IMG"==a.target.nodeName&&i.dom.hasClass(a.target,e)&&(a.name="pagebreak")}),i.on("click",function(a){a=a.target,"IMG"===a.nodeName&&i.dom.hasClass(a,e)&&i.selection.select(a)}),i.on("BeforeSetContent",function(a){a.content=a.content.replace(j,g)}),i.on("PreInit",function(){i.serializer.addNodeFilter("img",function(c){for(var b,d,a=c.length;a--;){if(b=c[a],d=b.attr("class"),d&&d.indexOf("mce-pagebreak")!==-1){var f=b.parent;if(i.schema.getBlockElements()[f.name]&&i.settings.pagebreak_split_block){f.type=3,f.value=h,f.raw=!0,b.remove();continue}b.type=3,b.value=h,b.raw=!0}}})})});