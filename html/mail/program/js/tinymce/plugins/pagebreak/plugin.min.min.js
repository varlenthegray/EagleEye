tinymce.PluginManager.add("pagebreak",function(d){var b="mce-pagebreak",f=d.getParam("pagebreak_separator","<!-- pagebreak -->"),c=new RegExp(f.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(g){return"\\"+g}),"gi"),a='<img src="'+tinymce.Env.transparentSrc+'" class="'+b+'" data-mce-resize="false" data-mce-placeholder />';d.addCommand("mcePageBreak",function(){d.settings.pagebreak_split_block?d.insertContent("<p>"+a+"</p>"):d.insertContent(a)}),d.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),d.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),d.on("ResolveName",function(e){"IMG"==e.target.nodeName&&d.dom.hasClass(e.target,b)&&(e.name="pagebreak")}),d.on("click",function(e){e=e.target,"IMG"===e.nodeName&&d.dom.hasClass(e,b)&&d.selection.select(e)}),d.on("BeforeSetContent",function(g){g.content=g.content.replace(c,a)}),d.on("PreInit",function(){d.serializer.addNodeFilter("img",function(h){for(var j,g,k=h.length;k--;){if(j=h[k],g=j.attr("class"),g&&g.indexOf("mce-pagebreak")!==-1){var e=j.parent;if(d.schema.getBlockElements()[e.name]&&d.settings.pagebreak_split_block){e.type=3,e.value=f,e.raw=!0,j.remove();continue}j.type=3,j.value=f,j.raw=!0}}})})});