"use strict";(function(e){var f=["https://keys.fedoraproject.org/","https://keybase.io/"];var d=function(a){this.keyservers=a||f};d.prototype.get=function(a,b,n,m){if(n===undefined){n=0}if(n>=this.keyservers.length){return b(null,m||404)}var c=this.keyservers[n];var k=this;if(c.indexOf("https://keybase.io/")===0){if(a.indexOf("0x")===0){a=a.substr(2)}var l=new XMLHttpRequest();l.open("get","https://keybase.io/_/api/1.0/user/lookup.json?fields=public_keys&key_fingerprint="+a);l.onload=function(){if(l.status===200){var h=JSON.parse(l.responseText);if(h.status.code!==0){return k.get(a,b,n+1,h.status.code)}if(h.them.length===0){return k.get(a,b,n+1,404)}var g=h.them[0]["public_keys"]["primary"]["bundle"];return b(g,null)}else{return k.get(a,b,n+1,l.status)}};l.send()}else{if(a.indexOf("0x")!==0){a="0x"+a}var l=new XMLHttpRequest();l.open("get",c+"pks/lookup?op=get&options=mr&search="+a);l.onload=function(){if(l.status===200){return b(l.responseText,null)}else{return k.get(a,b,n+1,l.status)}};l.send()}};d.prototype.search=function(c,C,u,x,z){if(u===undefined){u=0}if(x===undefined){x=[]}if(u>=this.keyservers.length){if(x.length===0){return C(null,z||404)}else{var a={};for(var w=0;w<x.length;w++){var y=x[w];if(a[y.keyid]!==undefined){for(var D=0;D<y.uids.length;D++){var i=false;for(var A=0;A<a[y.keyid]["uids"].length;A++){if(a[y.keyid]["uids"][A]["uid"]===y.uids[D]){i=true;break}}if(!i){a[y.keyid]["uids"].push(y.uids[D])}}}else{a[y.keyid]=y}}var k=[];for(var w=0;w<x.length;w++){var y=x[w];if(a[y.keyid]!==undefined){k.push(a[y.keyid]);delete (a[y.keyid])}}return C(k,null)}}var b=this.keyservers[u];var m=this;if(b.indexOf("https://keybase.io/")===0){var B=new XMLHttpRequest();B.open("get","https://keybase.io/_/api/1.0/user/autocomplete.json?q="+encodeURIComponent(c));B.onload=function(){if(B.status===200){var n=JSON.parse(B.responseText);if(n.status.code!==0){return m.search(c,C,u+1,x,n.status.code)}if(n.completions.length===0){return m.search(c,C,u+1,x,404)}var j=[];for(var h=0;h<n.completions.length;h++){var l=n.completions[h]["components"];if(l.key_fingerprint===undefined){continue}var o={keyid:l.key_fingerprint.val.toUpperCase(),href:"https://keybase.io/"+l.username.val+"/key.asc",info:"https://keybase.io/"+l.username.val,algo:l.key_fingerprint.algo,keylen:l.key_fingerprint.nbits,creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false,uids:[{uid:l.username.val+" on Keybase <https://keybase.io/"+l.username.val+">",creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false}]};if(l.full_name!==undefined){o.uids.push({uid:"Full Name: "+l.full_name.val,creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}if(l.twitter!==undefined){o.uids.push({uid:l.twitter.val+" on Twitter <https://twitter.com/"+l.twitter.val+">",creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}if(l.github!==undefined){o.uids.push({uid:l.github.val+" on Github <https://github.com/"+l.github.val+">",creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}if(l.reddit!==undefined){o.uids.push({uid:l.reddit.val+" on Github <https://reddit.com/u/"+l.reddit.val+">",creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}if(l.hackernews!==undefined){o.uids.push({uid:l.hackernews.val+" on Hacker News <https://news.ycombinator.com/user?id="+l.hackernews.val+">",creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}if(l.coinbase!==undefined){o.uids.push({uid:l.coinbase.val+" on Coinbase <https://www.coinbase.com/"+l.coinbase.val+">",creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}if(l.websites!==undefined){for(var g=0;g<l.websites.length;g++){o.uids.push({uid:"Owns "+l.websites[g]["val"],creationdate:null,expirationdate:null,revoked:false,disabled:false,expired:false})}}j.push(o)}x=x.concat(j);return m.search(c,C,u+1,x,null)}else{return m.search(c,C,u+1,x,B.status)}};B.send()}else{var B=new XMLHttpRequest();B.open("get",b+"pks/lookup?op=index&options=mr&fingerprint=on&search="+encodeURIComponent(c));B.onload=function(){if(B.status===200){var l=[];var n=B.responseText.split("\n");var o=undefined;for(var j=0;j<n.length;j++){var h=n[j].trim();if(h.indexOf("pub:")==0){if(o!==undefined){l.push(o)}var g=h.split(":");o={keyid:g[1],href:b+"pks/lookup?op=get&options=mr&search=0x"+g[1],info:b+"pks/lookup?op=vindex&search=0x"+g[1],algo:g[2]===""?null:parseInt(g[2]),keylen:g[3]===""?null:parseInt(g[3]),creationdate:g[4]===""?null:parseInt(g[4]),expirationdate:g[5]===""?null:parseInt(g[5]),revoked:g[6].indexOf("r")!==-1,disabled:g[6].indexOf("d")!==-1,expired:g[6].indexOf("e")!==-1,uids:[]}}if(h.indexOf("uid:")==0){var g=h.split(":");o.uids.push({uid:decodeURIComponent(g[1]),creationdate:g[2]===""?null:parseInt(g[2]),expirationdate:g[3]===""?null:parseInt(g[3]),revoked:g[4].indexOf("r")!==-1,disabled:g[4].indexOf("d")!==-1,expired:g[4].indexOf("e")!==-1})}}l.push(o);x=x.concat(l);return m.search(c,C,u+1,x,null)}else{return m.search(c,C,u+1,x,B.status)}};B.send()}};e.PublicKey=d})(typeof exports==="undefined"?this:exports);