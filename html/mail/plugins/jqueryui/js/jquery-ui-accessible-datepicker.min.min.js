/*! jQuery UI Accessible Datepicker extension
* (to be appended to jquery-ui-*.custom.min.js)
*
* @licstart The following is the entire license notice for the
*  JavaScript code in this page.
*
* Copyright 2014 Kolab Systems AG
*
* The JavaScript code in this page is free software: you can
* redistribute it and/or modify it under the terms of the GNU
* General Public License (GNU GPL) as published by the Free Software
* Foundation, either version 3 of the License, or (at your option)
* any later version.  The code is distributed WITHOUT ANY WARRANTY;
* without even the implied warranty of MERCHANTABILITY or FITNESS
* FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
*
* As additional permission under GNU GPL version 3 section 7, you
* may distribute non-source (e.g., minimized or compacted) forms of
* that code without the copy of the GNU GPL normally required by
* section 4, provided you include this license notice and a URL
* through which recipients can access the Corresponding Source.
*
* @licend The above is the entire license notice
*  for the JavaScript code in this page.
*/
(function(l,j){var m=l.datepicker._newInst;var h=l.datepicker._updateDatepicker;var i=l.datepicker._connectDatepicker;var k=l.datepicker._showDatepicker;var n=l.datepicker._hideDatepicker;l.extend(l.datepicker,{_newInst:function(a,b){var d=this,c=m.call(this,a,b);if(c.inline){c.dpDiv.on("keydown.datepicker",".ui-datepicker-calendar",function(g){if(l.inArray(g.keyCode,[13,33,34,35,36,37,38,39,40])==-1){return}g.stopPropagation();g.preventDefault();c._hasfocus=true;var f;switch(g.keyCode){case l.ui.keyCode.ENTER:if((f=l("."+d._dayOverClass,c.dpDiv).get(0)||l("."+d._currentClass,c.dpDiv).get(0))){d._selectDay(c.input,c.selectedMonth,c.selectedYear,f)}break;case l.ui.keyCode.PAGE_UP:d._adjustDate(c.input,-d._get(c,"stepMonths"),"M");break;case l.ui.keyCode.PAGE_DOWN:d._adjustDate(c.input,d._get(c,"stepMonths"),"M");break;default:return d._cursorKeydown(g,c)}}).attr("role","region").attr("aria-labelledby",c.id+"-dp-title")}else{var e=c.dpDiv.attr("id")||c.id+"-dp-widget";c.dpDiv.attr("id",e).attr("aria-hidden","true").attr("aria-labelledby",c.id+"-dp-title");l(c.input).attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-owns",e)}return c},_connectDatepicker:function(a,b){i.call(this,a,b);var c=this;l(a).unbind("keydown.datepicker-extended").bind("keydown.datepicker-extended",function(e){var d=1;switch(e.keyCode){case 109:case 173:case 189:d=-1;case 61:case 107:case 187:if(this.value.length<c._formatDate(b,b.selectedDay,b.selectedMonth,b.selectedYear).length){return true}c._adjustInstDate(b,d,"D");c._selectDateRC(a,c._formatDate(b,b.selectedDay,b.selectedMonth,b.selectedYear));return false;case l.ui.keyCode.UP:case l.ui.keyCode.DOWN:if(l.datepicker._lastInput!==a&&!l.datepicker._isDisabledDatepicker(a)){c._showDatepicker(e);e.stopPropagation();e.preventDefault();return false}default:if(!l.datepicker._isDisabledDatepicker(a)&&!e.ctrlKey&&!e.metaKey){return c._cursorKeydown(e,b)}}}).click(function(d){c._showDatepicker(d)}).attr("autocomplete","off")},_cursorKeydown:function(b,a){a._keyEvent=true;var c=a.dpDiv.hasClass("ui-datepicker-rtl");switch(b.keyCode){case l.ui.keyCode.LEFT:this._adjustDate(a.input,(c?+1:-1),"D");break;case l.ui.keyCode.RIGHT:this._adjustDate(a.input,(c?-1:+1),"D");break;case l.ui.keyCode.UP:this._adjustDate(a.input,-7,"D");break;case l.ui.keyCode.DOWN:this._adjustDate(a.input,+7,"D");break;case l.ui.keyCode.HOME:break;case l.ui.keyCode.END:break}return true},_showDatepicker:function(b){b=b.target||b;k.call(this,b);var a=l.datepicker._getInst(b);if(a&&l.datepicker._datepickerShowing){a.dpDiv.attr("aria-hidden","false");l(b).attr("aria-expanded","true")}},_hideDatepicker:function(b){n.call(this,b);var a=this._curInst;if(a&&!l.datepicker._datepickerShowing){a.dpDiv.attr("aria-hidden","true");l(a.input).attr("aria-expanded","false")}},_updateDatepicker:function(a){h.call(this,a);var b=l("."+this._dayOverClass,a.dpDiv).get(0)||l("."+this._currentClass,a.dpDiv).get(0);if(b){b=l(b);b.attr("id",a.id+"-day-"+b.text())}a.dpDiv.find(".ui-datepicker-calendar").attr("tabindex",a.inline?"0":"-1").attr("role","grid").attr("aria-readonly","true").attr("aria-activedescendant",b?b.attr("id"):"").find("td").attr("role","gridcell").attr("aria-selected","false").find("a").attr("tabindex","-1");l(".ui-datepicker-current-day",a.dpDiv).attr("aria-selected","true");a.dpDiv.find(".ui-datepicker-title").attr("id",a.id+"-dp-title");if(a._hasfocus){a.dpDiv.find(".ui-datepicker-calendar").focus();a._hasfocus=false}},_selectDateRC:function(a,d){var b=l(a),c=this._getInst(b[0]);d=(d!=null?d:this._formatDate(c));if(c.input){c.input.val(d)}this._updateAlternate(c);if(c.input){c.input.trigger("change")}if(c.inline){this._updateDatepicker(c)}}})}(jQuery));