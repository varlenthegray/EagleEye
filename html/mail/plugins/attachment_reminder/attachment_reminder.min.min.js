function rcmail_get_compose_message(){var b;if(window.tinyMCE&&(ed=tinyMCE.get(rcmail.env.composebody))){b=ed.getContent();b=b.replace(/<blockquote[^>]*>(.|[\r\n])*<\/blockquote>/gmi,"")}else{b=$("#"+rcmail.env.composebody).val();b=b.replace(/^>.*$/gmi,"")}return b}function rcmail_check_message(g){var e,h,f=rcmail.get_label("keywords","attachment_reminder").split(",").concat([".doc",".pdf"]);f=$.map(f,function(a){return RegExp.escape(a)});h=new RegExp("("+f.join("|")+")","i");return g.search(h)!=-1}function rcmail_have_attachments(){return rcmail.env.attachments&&$("li",rcmail.gui_objects.attachmentlist).length}function rcmail_attachment_reminder_dialog(){var b={};b[rcmail.get_label("addattachment")]=function(){$(this).remove();if(window.UI&&UI.show_uploadform){UI.show_uploadform()}else{if(window.rcmail_ui&&rcmail_ui.show_popup){rcmail_ui.show_popup("uploadmenu",true)}}};b[rcmail.get_label("send")]=function(a){$(this).remove();rcmail.env.attachment_reminder=true;rcmail.command("send","",a)};rcmail.env.attachment_reminder=false;rcmail.show_popup_dialog(rcmail.get_label("attachment_reminder.forgotattachment"),"",b)}if(window.rcmail){rcmail.addEventListener("beforesend",function(e){var f=rcmail_get_compose_message(),d=$("#compose-subject").val();if(!rcmail.env.attachment_reminder&&!rcmail_have_attachments()&&(rcmail_check_message(f)||rcmail_check_message(d))){rcmail_attachment_reminder_dialog();return false}})};