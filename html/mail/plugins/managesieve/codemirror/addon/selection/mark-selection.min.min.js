(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(s){s.defineOption("styleSelectedText",false,function(c,d,b){var a=b&&b!=s.Init;if(d&&!a){c.state.markedSelection=[];c.state.markedSelectionStyle=typeof d=="string"?d:"CodeMirror-selectedtext";o(c);c.on("cursorActivity",n);c.on("change",m)}else{if(!d&&a){c.off("cursorActivity",n);c.off("change",m);q(c);c.state.markedSelection=c.state.markedSelectionStyle=null}}});function n(a){a.operation(function(){r(a)})}function m(a){if(a.state.markedSelection.length){a.operation(function(){q(a)})}}var t=8;var k=s.Pos;var l=s.cmpPos;function p(w,a,x,d){if(l(a,x)==0){return}var c=w.state.markedSelection;var j=w.state.markedSelectionStyle;for(var i=a.line;;){var h=i==a.line?a:k(i,0);var g=i+t,b=g>=x.line;var e=b?x:k(g,0);var f=w.markText(h,e,{className:j});if(d==null){c.push(f)}else{c.splice(d++,0,f)}if(b){break}i=g}}function q(c){var a=c.state.markedSelection;for(var b=0;b<a.length;++b){a[b].clear()}a.length=0}function o(c){q(c);var b=c.listSelections();for(var a=0;a<b.length;a++){p(c,b[a].from(),b[a].to())}}function r(c){if(!c.somethingSelected()){return q(c)}if(c.listSelections().length>1){return o(c)}var d=c.getCursor("start"),e=c.getCursor("end");var f=c.state.markedSelection;if(!f.length){return p(c,d,e)}var a=f[0].find(),b=f[f.length-1].find();if(!a||!b||e.line-d.line<t||l(d,b.to)>=0||l(e,a.from)<=0){return o(c)}while(l(d,a.from)>0){f.shift().clear();a=f[0].find()}if(l(d,a.from)<0){if(a.to.line-d.line<t){f.shift().clear();p(c,d,a.to,0)}else{p(c,d,a.from,0)}}while(l(e,b.to)<0){f.pop().clear();b=f[f.length-1].find()}if(l(e,b.to)>0){if(e.line-b.from.line<t){f.pop().clear();p(c,b.from,e)}else{p(c,b.to,e)}}}});