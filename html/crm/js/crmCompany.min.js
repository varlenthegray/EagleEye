var crmCompany={editor:null,init:function(){crmCompany.checkboxCheck(".add_customer_checked",".customer_data");crmCompany.checkboxCheck(".cust_ship_addr_different",".cust_ship_different");crmCompany.checkboxCheck(".add_vendor_check",".vendor_data");crmCompany.checkboxCheck(".vend_receive_addr_different",".vend_receive_different");crmCompany.checkboxCheck(".vend_payment_contact_different",".vend_payment_contact");crmCompany.checkboxCheck(".add_employee_check",".employee_data");crmCompany.checkboxCheck(".emp_personal_info_check",".emp_personal_different");crmCompany.checkboxCheck(".emp_emergency_contact_info_check",".emp_emergency_contact");$(".generate_pin_pw").change(function(){let generatePinPW=$(this).parents().eq(4).find(".generate_pin_pw_field");if($(this).find(":selected").text()==="Yes"){generatePinPW.hide()}else{generatePinPW.show()}});$("#add_new_save").click(function(){var a=$("#add_new_form").serialize();let new_type=$("#new_type").find(":selected").text();let error=false;if(new_type==="Organization"){let oname=$("#org_name");if($.trim(oname.val())===""){displayToast("error","Organization Name is required.","Field Missing");error=true;oname.focus()}}else{if(new_type==="Individual"){let fname=$("#first_name");let uname=$("#emp_username");if($.trim(uname.val())===""&&$("#add_employee_check").is(":checked")){displayToast("error","User Name is required.","Field Missing");error=true;uname.focus()}if($.trim(fname.val())===""){displayToast("error","First Name is required.","Field Missing");error=true;fname.focus()}}}if(!error){$.post("/html/crm/ajax/company.php?action=addNew",{formInfo:a},function(b){$("body").append(b);$("#modalGlobal").modal("hide")});unsaved=false}});$(".new_type").change(function(){let org=$(this).parents().eq(4).find(".add_new_org");let ind=$(this).parents().eq(4).find(".add_new_individual");let emp_checkbox=$(this).parents().eq(4).find(".employee_info_checkbox");let uidField=$(this).parents().eq(4).find(".identifier");let uid=uidField.attr("data-uid");switch($(this).find(":selected").text()){case"Organization":ind.hide();org.show();emp_checkbox.hide();uidField.val("R"+uid);break;case"Individual":org.hide();ind.show();emp_checkbox.show();uidField.val("N"+uid);break}});$("#shipping_different").change(function(){if($(this).is(":checked")){$(".shipping_empty_hide").show()}else{$(".shipping_empty_hide").hide()}});$("#billing_different").change(function(){if($(this).is(":checked")){$(".billing_empty_hide").show()}else{$(".billing_empty_hide").hide()}});$("#show_payment_info").change(function(){if($(this).is(":checked")){$(".payment_info").show()}else{$(".payment_info").hide()}});$(".save_company").click(function(){let formInfo=$("#company_information").serialize();$.post("/html/crm/ajax/company.php?action=updateContact",{formInfo:formInfo},function(a){$("body").append(a)})});$(".add_project").click(function(){let contact_id=$(this).attr("data-id");$.post("/html/modals/add_project.php",{id:contact_id},function(a){$("#modalGlobal").html(a).modal("show")})})},checkboxCheck:function(a,b){let targetID=$(a);targetID.on("change",function(){let $this=$(this);if($this.is(":checked")){$this.parents().eq(3).find(b).show()}else{$this.parents().eq(3).find(b).hide()}})},editCustomerDisplay:function(a,b){let checkEle=$(".customer_edit");if(checkEle.find(a).is(":checked")){checkEle.find(b).show()}else{checkEle.find(b).hide()}},getCompany:function(){$.post("/html/crm/templates/crm_view.php",function(a){crmMain.body.html(a)})},startListening:function(){$("body").on("click",".get-company",function(){crmCompany.getCompany($(this).attr("data-id"))}).on("click",".crm_view_company_list",function(){crmCompany.getCompanyList()}).on("click","#modalAddProjectSave",function(){let info=$("#add_project_form").serialize();$.post("/html/crm/ajax/company.php?action=addProject",{formInfo:info},function(a){$("body").append(a);$("#modalGlobal").modal("hide")});unsaved=false})},initEditor:function(){crmCompany.editor=new dhtmlXEditor({parent:"new_note",toolbar:true,iconsPath:"/assets/plugins/dhtmlXEditor/imgs/",content:""})},reInitEditor:function(){if(crmCompany.editor!==undefined&&crmCompany.editor!==null){let curContent=crmCompany.editor.getContent();crmCompany.editor.unload();crmCompany.editor=new dhtmlXEditor({parent:"new_note",toolbar:true,iconsPath:"/assets/plugins/dhtmlXEditor/imgs/",content:curContent})}},checkEmpty:function(b,c,a){let isEmpty=true;$.each($("input[name^='"+b+"']"),function(d,e){if($(e).val()!==""){isEmpty=false}});if(isEmpty){$(c).prop("checked",false);$(a).hide()}else{$(c).prop("checked",true);$(a).show()}}};