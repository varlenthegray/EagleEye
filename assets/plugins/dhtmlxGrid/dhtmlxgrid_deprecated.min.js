window.dhtmlxAjax={get:function(e,f,d){if(d){return dhx4.ajax.getSync(e)}else{dhx4.ajax.get(e,f)}},post:function(f,e,g,h){if(h){return dhx4.ajax.postSync(f,e)}else{dhx4.ajax.post(f,e,g)}},getSync:function(b){return dhx4.ajax.getSync(b)},postSync:function(d,c){return dhx4.ajax.postSync(d,c)}};dhtmlXCalendarObject.prototype.draw=function(){this.show()};dhtmlXCalendarObject.prototype.close=function(){this.hide()};dhtmlXCalendarObject.prototype.setYearsRange=function(){};dhtmlXCombo.prototype.loadXML=function(d,c){this.load(d,c)};dhtmlXCombo.prototype.loadXMLString=function(b){this.load(b)};dhtmlXCombo.prototype.enableOptionAutoHeight=function(){};dhtmlXCombo.prototype.enableOptionAutoPositioning=function(){};dhtmlXCombo.prototype.enableOptionAutoWidth=function(){};dhtmlXCombo.prototype.destructor=function(){this.unload()};dhtmlXCombo.prototype.render=function(){};dhtmlXCombo.prototype.setOptionHeight=function(){};dhtmlXCombo.prototype.attachChildCombo=function(){};dhtmlXCombo.prototype.setAutoSubCombo=function(){};dhtmlXMenuObject.prototype.loadXML=function(d,c){this.loadStruct(d,c)};dhtmlXMenuObject.prototype.loadXMLString=function(c,d){this.loadStruct(c,d)};dhtmlXMenuObject.prototype.setIconPath=function(b){this.setIconsPath(b)};dhtmlXMenuObject.prototype.setImagePath=function(){};dhtmlXToolbarObject.prototype.loadXML=function(d,c){this.loadStruct(d,c)};dhtmlXToolbarObject.prototype.loadXMLString=function(c,d){this.loadStruct(c,d)};dhtmlXToolbarObject.prototype.setIconPath=function(b){this.setIconsPath(b)};dhtmlXGridObject.prototype.hidePivot=function(d){if(this._pgridCont){if(this._pgrid){this._pgrid.destructor()}var c=this._pgridCont.parentNode;c.innerHTML="";if(c.parentNode==this.entBox){this.entBox.removeChild(c)}this._pgrid=this._pgridSelect=this._pUNI=this._pgridCont=null}};dhtmlXGridObject.prototype.makePivot=function(i,r){r=r||{};this.hidePivot();if(!i){var i=document.createElement("DIV");i.style.cssText="position:absolute; top:0px; left:0px;background-color:white;";i.style.height=this.entBox.offsetHeight+"px";i.style.width=this.entBox.offsetWidth+"px";if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}this.entBox.appendChild(i)}if(typeof(i)!="object"){i=document.getElementById(i)}if(r.column_list){this._column_list=r.column_list}else{this._column_list=[];for(var l=0;l<this.hdr.rows[1].cells.length;l++){this._column_list.push(this.hdr.rows[1].cells[l][_isIE?"innerText":"textContent"])}}var k=this;i.innerHTML="<table cellspacing='0' cellpadding='0'><tr><td style='width:160px' align='center'></td><td>&nbsp;&nbsp;&nbsp;</td><td></td></tr></table><div></div>";var m=this.makePivotSelect(this._column_list);m.style.width="80px";m.onchange=function(){if(this.value!=-1){k._pivotS.value=this.value}else{k._pivotS.value=""}k._reFillPivotLists();k._renderPivot2()};var n=this.makePivotSelect(this._column_list);n.onchange=function(){if(this.value!=-1){k._pivotS.x=this.value}else{k._pivotS.x=""}k._reFillPivotLists();k._renderPivot()};var o=this.makePivotSelect(this._column_list);o.onchange=function(){if(this.value!=-1){k._pivotS.y=this.value}else{k._pivotS.y=""}k._reFillPivotLists();k._renderPivot()};var p=this.makePivotSelect(["Sum","Min","Max","Average","Count"],-1);p.style.width="70px";p.onchange=function(){if(this.value!=-1){k._pivotS.action=this.value}else{k._pivotS.action=null}k._renderPivot2()};if(r.readonly){m.disabled=n.disabled=o.disabled=p.disabled=true}i.firstChild.rows[0].cells[0].appendChild(p);i.firstChild.rows[0].cells[0].appendChild(m);i.firstChild.rows[0].cells[2].appendChild(n);var q=i.childNodes[1];q.style.width=i.offsetWidth+"px";q.style.height=i.offsetHeight-20+"px";q.style.overflow="hidden";this._pgridCont=q;this._pgridSelect=[m,n,o,p];this._pData=this._fetchPivotData();this._pUNI=[];this._pivotS={action:(r.action||"0"),value:(typeof r.value!="undefined"?(r.value||"0"):null),x:(typeof r.x!="undefined"?(r.x||"0"):null),y:(typeof r.y!="undefined"?(r.y||"0"):null)};m.value=this._pivotS.value;n.value=this._pivotS.x;o.value=this._pivotS.y;p.value=this._pivotS.action;k._reFillPivotLists();this._renderPivot()};dhtmlXGridObject.prototype._fetchPivotData=function(){var g=[];for(var d=0;d<this._cCount;d++){var h=[];for(var f=0;f<this.rowsCol.length;f++){if(this.rowsCol[f]._cntr){continue}h.push(this.cells2(f,d).getValue())}g.push(h)}return g};dhtmlXGridObject.prototype._renderPivot=function(){if(_isIE){this._pgridSelect[2].removeNode(true)}if(this._pgrid){this._pgrid.destructor()}this._pgrid=new dhtmlXGridObject(this._pgridCont);this._pgrid.setImagePath(this.imgURL);this._pgrid.attachEvent("onBeforeSelect",function(){return false});if(this._pivotS.x){var f=this._getUniList(this._pivotS.x);var g=[160];for(var h=0;h<f.length;h++){g.push(100)}f=[""].concat(f);this._pgrid.setHeader(f);this._pgrid.setInitWidths(g.join(","))}else{this._pgrid.setHeader("");this._pgrid.setInitWidths("160")}this._pgrid.init();this._pgrid.setEditable(false);this._pgrid.setSkin(this.entBox.className.replace("gridbox gridbox_",""));var e=this._pgrid.hdr.rows[1].cells[0];if(e.firstChild&&e.firstChild.tagName=="DIV"){e=e.firstChild}e.appendChild(this._pgridSelect[2]);this._pgrid.setSizes();if(this._pivotS.y){var f=this._getUniList(this._pivotS.y);for(var h=0;h<f.length;h++){this._pgrid.addRow(this._pgrid.uid(),[f[h]],-1)}}else{this._pgrid.addRow(1,"not ready",1)}this._renderPivot2()};dhtmlXGridObject.prototype._pivot_action_0=function(b,c,i,v,a,q){var p=0;var s=q[b];var t=q[c];var u=q[i];for(var r=s.length-1;r>=0;r--){if(s[r]==v&&t[r]==a){p+=this.parseFloat(u[r])}}return p};dhtmlXGridObject.prototype._pivot_action_1=function(b,c,i,t,a,o){ret=9999999999;var q=o[b];var r=o[c];var s=o[i];for(var p=q.length-1;p>=0;p--){if(q[p]==t&&r[p]==a){ret=Math.min(this.parseFloat(s[p]),ret)}}if(ret==9999999999){ret=""}return ret};dhtmlXGridObject.prototype._pivot_action_2=function(b,c,i,t,a,o){ret=-9999999999;var q=o[b];var r=o[c];var s=o[i];for(var p=q.length-1;p>=0;p--){if(q[p]==t&&r[p]==a){ret=Math.max(this.parseFloat(s[p]),ret)}}if(ret==-9999999999){ret=""}return ret};dhtmlXGridObject.prototype._pivot_action_3=function(b,c,i,x,a,s){var q=0;var r=0;var u=s[b];var v=s[c];var w=s[i];for(var t=u.length-1;t>=0;t--){if(u[t]==x&&v[t]==a){q+=this.parseFloat(w[t]);r++}}return r?q/r:""};dhtmlXGridObject.prototype._pivot_action_4=function(b,c,i,x,a,s){var q=0;var r=0;var u=s[b];var v=s[c];var w=s[i];for(var t=u.length-1;t>=0;t--){if(u[t]==x&&v[t]==a){q++}}return q};dhtmlXGridObject.prototype.parseFloat=function(b){b=parseFloat(b);if(isNaN(b)){return 0}return b};dhtmlXGridObject.prototype._renderPivot2=function(){if(!(this._pivotS.x&&this._pivotS.y&&this._pivotS.value&&this._pivotS.action)){return}var i=this["_pivot_action_"+this._pivotS.action];var g=this._getUniList(this._pivotS.x);var h=this._getUniList(this._pivotS.y);for(var j=0;j<g.length;j++){for(var f=0;f<h.length;f++){this._pgrid.cells2(f,j+1).setValue(Math.round(i(this._pivotS.x,this._pivotS.y,this._pivotS.value,g[j],h[f],this._pData)*100)/100)}}};dhtmlXGridObject.prototype._getUniList=function(j){if(!this._pUNI[j]){var h={};var a=[];for(var i=this._pData[j].length-1;i>=0;i--){h[this._pData[j][i]]=true}for(var g in h){if(h[g]===true){a.push(g)}}this._pUNI[j]=a.sort()}return this._pUNI[j]};dhtmlXGridObject.prototype._fillPivotList=function(h,i,j,g){if(!j){j={};g=-1}h.innerHTML="";h.options[h.options.length]=new Option("-select-",-1);for(var f=0;f<i.length;f++){if(j[f]||i[f]===null){continue}h.options[h.options.length]=new Option(i[f],f)}h.value=parseInt(g)};dhtmlXGridObject.prototype._reFillPivotLists=function(){var h=[];var f=[];for(var i=0;i<3;i++){h.push(this._pgridSelect[i]);f.push(h[i].value)}var j=this._reFfillPivotLists;var g={};g[f[1]]=g[f[2]]=true;this._fillPivotList(h[0],this._column_list,g,f[0]);g={};g[f[0]]=g[f[2]]=true;this._fillPivotList(h[1],this._column_list,g,f[1]);g={};g[f[1]]=g[f[0]]=true;this._fillPivotList(h[2],this._column_list,g,f[2]);this._reFfillPivotLists=j};dhtmlXGridObject.prototype.makePivotSelect=function(d,e){var f=document.createElement("SELECT");this._fillPivotList(f,d,e);f.style.cssText="width:150px; height:20px; font-family:Tahoma; font-size:8pt; font-weight:normal;";return f};function eXcell_dec(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.getValue=function(){return parseFloat(this.cell.innerHTML.replace(/,/g,""))};this.setValue=function(i){var k="0,000.00";if(i=="0"){this.setCValue(k.replace(/.*(0\.[0]+)/,"$1"),i);return}var j=k.substr(k.indexOf(".")+1).length;i=Math.round(i*Math.pow(10,j)).toString();var a="";var m=0;var l=false;for(var n=i.length-1;n>=0;n--){m++;a=i.charAt(n)+a;if(!l&&m==j){a="."+a;m=0;l=true}if(l&&m==3&&n!=0&&i.charAt(n-1)!="-"){a=","+a;m=0}}this.setCValue(a,i)}}eXcell_dec.prototype=new eXcell_ed;function eXcell_cor(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.combo=this.grid.getCombo(this.cell._cellIndex);this.editable=true}this.shiftNext=function(){var a=this.list.options[this.list.selectedIndex+1];if(a){a.selected=true}this.obj.value=this.list.value;return true};this.shiftPrev=function(){var a=this.list.options[this.list.selectedIndex-1];if(a){a.selected=true}this.obj.value=this.list.value;return true};this.edit=function(){this.val=this.getValue();this.text=this.cell.innerHTML._dhx_trim();var i=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(c){(c||event).cancelBubble=true};this.obj.value=this.text;this.list=document.createElement("SELECT");this.list.editor_obj=this;this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=i[0]+"px";this.list.style.top=i[1]+this.cell.offsetHeight+"px";this.list.onclick=function(c){var d=c||window.event;var e=d.target||d.srcElement;if(e.tagName=="OPTION"){e=e.parentNode}if(e.value!=-1){e.editor_obj._byClick=true;e.editor_obj.editable=false;e.editor_obj.grid.editStop()}else{d.cancelBubble=true;e.editor_obj.obj.value="";e.editor_obj.obj.focus()}};var a=this.combo.getKeys();var g=0;this.list.options[0]=new Option(this.combo.get(a[0]),a[0]);this.list.options[0].selected=true;for(var j=1;j<a.length;j++){var h=this.combo.get(a[j]);this.list.options[this.list.options.length]=new Option(h,a[j]);if(a[j]==this.val){g=this.list.options.length-1}}document.body.appendChild(this.list);this.list.size="6";this.cstate=1;if(this.editable){this.cell.innerHTML=""}else{this.obj.style.width="1px";this.obj.style.height="1px"}this.cell.appendChild(this.obj);this.list.options[g].selected=true;if(this.editable){this.obj.focus();this.obj.focus()}if(!this.editable){this.obj.style.visibility="hidden"}};this.getValue=function(){return((this.cell.combo_value==window.undefined)?"":this.cell.combo_value)};this.getText=function(){return this.cell.innerHTML};this.getState=function(){return{prev:this.cell.__prev,now:this.cell.__now}};this.detach=function(){if(this.val!=this.getValue()){this.cell.wasChanged=true}if(this.list.parentNode!=null){if((this.obj.value._dhx_trim()!=this.text)||(this._byClick)){var a=this.list.value;if(!this._byClick){this.combo.values[this.combo.keys._dhx_find(a)]=this.obj.value}this.setValue(a)}else{this.setValue(this.val)}}if(this.list.parentNode){this.list.parentNode.removeChild(this.list)}if(this.obj.parentNode){this.obj.parentNode.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_cor.prototype=new eXcell;eXcell_cor.prototype.setValue=function(c){if((c||"").toString()._dhx_trim()==""){c=null}var d=this.grid.getCombo(this.cell._cellIndex).get(c);if((c==-1)&&(d=="")){this.combo.values[this.combo.keys._dhx_find(-1)]="Create new value";c=null}if(c!==null){this.setCValue(d,c)}else{this.setCValue("&nbsp;",c)}this.cell.__prev=this.cell.__now;this.cell.__now={key:c,value:d};this.cell.combo_value=c};function eXcell_wbut(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.edit=function(){var i=this.getValue().toString();this.obj=document.createElement("INPUT");this.obj.readOnly=true;this.obj.style.width="60px";this.obj.style.height=(this.cell.offsetHeight-(this.grid.multiLine?5:4))+"px";this.obj.style.border="0px";this.obj.style.margin="0px";this.obj.style.padding="0px";this.obj.style.overflow="hidden";this.obj.style.fontSize=_isKHTML?"10px":"12px";this.obj.style.fontFamily="Arial";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(c){(c||event).cancelBubble=true};this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(c){if(!c){c=event}c.cancelBubble=true;return true};this.obj.style.textAlign=this.cell.align;this.obj.value=i;this.obj.focus();this.obj.focus();this.cell.appendChild(document.createTextNode(" "));var l=document.createElement("input");if(_isIE){l.style.height=(this.cell.offsetHeight-(this.grid.multiLine?5:4))+"px";l.style.lineHeight="5px"}else{l.style.fontSize="8px";l.style.width="10px";l.style.marginTop="-5px"}l.type="button";l.name="Lookup";l.value="...";var k=this.obj;var a=this.cell.cellIndex;var m=this.cell.parentNode.idd;var j=this.grid;var n=this;this.dhx_m_func=this.grid.getWButFunction(this.cell._cellIndex);l.onclick=function(c){n.dhx_m_func(n,n.cell.parentNode.idd,n.cell._cellIndex,i)};this.cell.appendChild(l)};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_wbut.prototype=new eXcell;dhtmlXGridObject.prototype.getWButFunction=function(b){if(this._wbtfna){return this._wbtfna[b]}else{return(function(){})}};dhtmlXGridObject.prototype.setWButFunction=function(d,c){if(!this._wbtfna){this._wbtfna=new Array()}this._wbtfna[d]=c};function eXcell_passw(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.innerHTML="";this.cell.atag="INPUT";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.style.height=(this.cell.offsetHeight-(_isIE?6:4))+"px";this.obj.className="dhx_combo_edit";this.obj.type="password";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(a){(a||event).cancelBubble=true};this.obj.onmousedown=function(a){(a||event).cancelBubble=true};this.obj.value=this.cell._rval||"";this.cell.appendChild(this.obj);if(_isFF){this.obj.style.overflow="visible";if((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}}this.obj.onselectstart=function(a){if(!a){a=event}a.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};this.getValue=function(){return this.cell._rval};this.setValue=function(d){var a="*****";this.cell.innerHTML=a;this.cell._rval=d};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_passw.prototype=new eXcell;function eXcell_num(d){try{this.cell=d;this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement(_isKHTML?"INPUT":"TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(a){(a||event).cancelBubble=true};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(a){if(!a){a=event}a.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}else{return this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)}};this.setValue=function(a){var b=new RegExp("[a-z]|[A-Z]","i");if(a.match(b)){a="&nbsp;"}this.cell.innerHTML=a};this.detach=function(){var a=this.obj.value;this.setValue(a);return this.val!=this.getValue()}}eXcell_num.prototype=new eXcell;function eXcell_mro(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.edit=function(){}}eXcell_mro.prototype=new eXcell;eXcell_mro.prototype.getValue=function(){return this.cell.childNodes[0].innerHTML._dhx_trim()};eXcell_mro.prototype.setValue=function(b){if(!this.cell.childNodes.length){this.cell.style.whiteSpace="normal";this.cell.innerHTML="<div style='height:100%; white-space:nowrap; overflow:hidden;'></div>"}if(!b||b.toString()._dhx_trim()==""){b="&nbsp;"}this.cell.childNodes[0].innerHTML=b};function eXcell_liveedit(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.inputObj.focus();this.cell.inputObj.focus()};this.detach=function(){this.setValue(this.cell.inputObj.value)};this.getValue=function(){return this.cell.inputObj?this.cell.inputObj.value:""};this.destructor=function(){};this.onFocus=function(){var a=this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex]);if(a===false){this.cell.inputObj.blur()}};this.onBlur=function(){var a=this.grid.callEvent("onEditCell",[2,this.cell.parentNode.idd,this.cell._cellIndex]);this.detach()};this.onChange=function(){var a=this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,this.cell.inputObj.value]);this.detach()}}eXcell_liveedit.prototype=new eXcell_ed;eXcell_liveedit.prototype.setValue=function(c){var d=this;this.cell.innerHTML='<input type="text" value="" style="width:100%;" />';this.cell.inputObj=this.cell.firstChild;this.cell.inputObj=this.cell.firstChild;this.cell.inputObj.value=c;this.cell.inputObj.onfocus=function(){d.onFocus()};this.cell.inputObj.onblur=function(){d.onFocus()};this.cell.inputObj.onchange=function(){d.onChange()}};if(window.eXcell_math){eXcell_liveedit.prototype.setValueA=eXcell_liveedit.prototype.setValue;eXcell_liveedit.prototype.setValue=eXcell_math.prototype._NsetValue}function eXcell_limit(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.style.height=(this.cell.offsetHeight-(_isIE?6:4))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(a){(a||event).cancelBubble=true};this.obj.onmousedown=function(a){(a||event).cancelBubble=true};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF){this.obj.style.overflow="visible";if((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}}this.obj.onkeypress=function(a){if(this.value.length>=15){return false}};this.obj.onselectstart=function(a){if(!a){a=event}a.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}else{return this.cell.innerHTML.toString()._dhx_trim()}};this.setValue=function(a){if(a.length>15){this.cell.innerHTML=a.substring(0,14)}else{this.cell.innerHTML=a}};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_limit.prototype=new eXcell;