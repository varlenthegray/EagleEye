if(typeof(window.dhx)=="undefined"){window.dhx=window.dhx4={version:"5.1.0",skin:null,skinDetect:function(d){var c=Math.floor(dhx4.readFromCss(d+"_skin_detect")/10)*10;return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace",40:"material"}[c]||null},readFromCss:function(j,i,h){var f=document.createElement("DIV");f.className=j;if(document.body.firstChild!=null){document.body.insertBefore(f,document.body.firstChild)}else{document.body.appendChild(f)}if(typeof(h)=="string"){f.innerHTML=h}var g=f[i||"offsetWidth"];f.parentNode.removeChild(f);f=null;return g},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var d=this.first();for(var a in this.data){d=Math.max(d,this.data[a])}return d},reserve:function(b){this.data[b]=this.last()+this.step;return this.data[b]},clear:function(b){if(this.data[b]!=null){this.data[b]=null;delete this.data[b]}}},s2b:function(b){if(typeof(b)=="string"){b=b.toLowerCase()}return(b==true||b==1||b=="true"||b=="1"||b=="yes"||b=="y"||b=="on")},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(e){dhx4.temp=null}obj=dhx4.temp;dhx4.temp=null;return obj},absLeft:function(b){if(typeof(b)=="string"){b=document.getElementById(b)}return this.getOffset(b).left},absTop:function(b){if(typeof(b)=="string"){b=document.getElementById(b)}return this.getOffset(b).top},_aOfs:function(e){var f=0,d=0;while(e){f=f+parseInt(e.offsetTop);d=d+parseInt(e.offsetLeft);e=e.offsetParent}return{top:f,left:d}},_aOfsRect:function(r){var o=r.getBoundingClientRect();var n=document.body;var t=document.documentElement;var u=window.pageYOffset||t.scrollTop||n.scrollTop;var q=window.pageXOffset||t.scrollLeft||n.scrollLeft;var p=t.clientTop||n.clientTop||0;var m=t.clientLeft||n.clientLeft||0;var l=o.top+u-p;var s=o.left+q-m;return{top:Math.round(l),left:Math.round(s)}},getOffset:function(b){if(b.getBoundingClientRect){return this._aOfsRect(b)}else{return this._aOfs(b)}},_isObj:function(b){return(b!=null&&typeof(b)=="object"&&typeof(b.length)=="undefined")},_copyObj:function(e){if(this._isObj(e)){var f={};for(var a in e){if(typeof(e[a])=="object"&&e[a]!=null){f[a]=this._copyObj(e[a])}else{f[a]=e[a]}}}else{var f=[];for(var a=0;a<e.length;a++){if(typeof(e[a])=="object"&&e[a]!=null){f[a]=this._copyObj(e[a])}else{f[a]=e[a]}}}return f},screenDim:function(){var d=(navigator.userAgent.indexOf("MSIE")>=0);var c={};c.left=document.body.scrollLeft;c.right=c.left+(window.innerWidth||document.body.clientWidth);c.top=Math.max((d?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);c.bottom=c.top+(d?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight);return c},selectTextRange:function(l,i,e){l=(typeof(l)=="string"?document.getElementById(l):l);var h=l.value.length;i=Math.max(Math.min(i,h),0);e=Math.min(e,h);if(l.setSelectionRange){try{l.setSelectionRange(i,e)}catch(j){}}else{if(l.createTextRange){var m=l.createTextRange();m.moveStart("character",i);m.moveEnd("character",e-h);try{m.select()}catch(j){}}}},transData:null,transDetect:function(){if(this.transData==null){this.transData={transProp:false,transEv:null};var d={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var a in d){if(this.transData.transProp==false&&document.documentElement.style[a]!=null){this.transData.transProp=a;this.transData.transEv=d[a]}}d=null}return this.transData},_xmlNodeValue:function(e){var f="";for(var d=0;d<e.childNodes.length;d++){f+=(e.childNodes[d].nodeValue!=null?e.childNodes[d].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"")}return f}};window.dhx4.isIE=(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isIE6=(window.XMLHttpRequest==null&&navigator.userAgent.indexOf("MSIE")>=0);window.dhx4.isIE7=(navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0);window.dhx4.isIE8=(navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isIE9=(navigator.userAgent.indexOf("MSIE 9.0")>=0&&navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isIE10=(navigator.userAgent.indexOf("MSIE 10.0")>=0&&navigator.userAgent.indexOf("Trident")>=0&&window.navigator.pointerEnabled!=true);window.dhx4.isIE11=(navigator.userAgent.indexOf("Trident")>=0&&window.navigator.pointerEnabled==true);window.dhx4.isEdge=(navigator.userAgent.indexOf("Edge")>=0);window.dhx4.isOpera=(navigator.userAgent.indexOf("Opera")>=0);window.dhx4.isChrome=(navigator.userAgent.indexOf("Chrome")>=0)&&!window.dhx4.isEdge;window.dhx4.isKHTML=(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0)&&!window.dhx4.isEdge;window.dhx4.isFF=(navigator.userAgent.indexOf("Firefox")>=0);window.dhx4.isIPad=(navigator.userAgent.search(/iPad/gi)>=0);window.dhx4.dnd={evs:{},p_en:((window.dhx4.isIE||window.dhx4.isEdge)&&(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)),_mTouch:function(b){return(window.dhx4.isIE10&&b.pointerType==b.MSPOINTER_TYPE_MOUSE||window.dhx4.isIE11&&b.pointerType=="mouse"||window.dhx4.isEdge&&b.pointerType=="mouse")},_touchOn:function(b){if(b==null){b=document.body}b.style.touchAction=b.style.msTouchAction="";b=null},_touchOff:function(b){if(b==null){b=document.body}b.style.touchAction=b.style.msTouchAction="none";b=null}};if(window.navigator.pointerEnabled==true){window.dhx4.dnd.evs={start:"pointerdown",move:"pointermove",end:"pointerup"}}else{if(window.navigator.msPointerEnabled==true){window.dhx4.dnd.evs={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}}else{if(typeof(window.addEventListener)!="undefined"){window.dhx4.dnd.evs={start:"touchstart",move:"touchmove",end:"touchend"}}}}}if(typeof(window.dhx4.template)=="undefined"){window.dhx4.trim=function(b){return String(b).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")};window.dhx4.template=function(d,f,e){return d.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var c=arguments[1];var j=window.dhx4.trim(arguments[3]);var b=null;var l=[f[c]];if(j.length>0){j=j.split(":");var m=[];for(var a=0;a<j.length;a++){if(a>0&&m[m.length-1].match(/\\$/)!=null){m[m.length-1]=m[m.length-1].replace(/\\$/,"")+":"+j[a]}else{m.push(j[a])}}b=m[0];for(var a=1;a<m.length;a++){l.push(m[a])}}if(typeof(b)=="string"&&typeof(window.dhx4.template[b])=="function"){return window.dhx4.template[b].apply(window.dhx4.template,l)}if(c.length>0&&typeof(f[c])!="undefined"){if(e==true){return window.dhx4.trim(f[c])}return String(f[c])}return""})};window.dhx4.template.date=function(d,c){if(d!=null){if(d instanceof Date){return window.dhx4.date2str(d,c)}else{d=d.toString();if(d.match(/^\d*$/)!=null){return window.dhx4.date2str(new Date(parseInt(d)),c)}return d}}return""};window.dhx4.template.maxlength=function(c,d){return String(c).substr(0,d)};window.dhx4.template.number_format=function(i,h,j,g){var f=window.dhx4.template._parseFmt(h,j,g);if(f==false){return i}return window.dhx4.template._getFmtValue(i,f)};window.dhx4.template.lowercase=function(b){if(typeof(b)=="undefined"||b==null){b=""}return String(b).toLowerCase()};window.dhx4.template.uppercase=function(b){if(typeof(b)=="undefined"||b==null){b=""}return String(b).toUpperCase()};window.dhx4.template._parseFmt=function(j,o,i){var n=j.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(n==null||n.length!=4){return false}var f={i_len:false,i_sep:(typeof(o)=="string"?o:","),d_len:false,d_sep:(typeof(i)=="string"?i:"."),s_bef:(typeof(n[1])=="string"?n[1]:""),s_aft:(typeof(n[3])=="string"?n[3]:"")};var l=n[2].split(".");if(l[1]!=null){f.d_len=l[1].length}var m=l[0].split(",");if(m.length>1){f.i_len=m[m.length-1].length}return f};window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(r!=null&&r.length==5){var v0="";if(r[1]!=null){v0+=r[1]}v0+=fmt.s_bef;if(fmt.i_len!==false){var i=0;var v1="";for(var q=r[2].length-1;q>=0;q--){v1=""+r[2].charAt(q)+v1;if(++i==fmt.i_len&&q>0){v1=fmt.i_sep+v1;i=0}}v0+=v1}else{v0+=r[2]}if(fmt.d_len!==false){if(r[4]==null){r[4]=""}while(r[4].length<fmt.d_len){r[4]+="0"}eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=(r[4]).match(dhx4.temp);if(t1!=null){v0+=fmt.d_sep+t1}dhx4.temp=t1=null}v0+=fmt.s_aft;return v0}return value}}if(typeof(window.dhx4.dateLang)=="undefined"){window.dhx4.dateLang="en";window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}};window.dhx4.dateFormat={en:"%Y-%m-%d"};window.dhx4.date2str=function(i,l,h){if(l==null||typeof(l)=="undefined"){l=window.dhx4.dateFormat[window.dhx4.dateLang]}if(h==null||typeof(h)=="undefined"){h=window.dhx4.dateStrings[window.dhx4.dateLang]}if(i instanceof Date){var j=function(a){return(String(a).length==1?"0"+String(a):a)};var g=function(c){switch(c){case"%d":return j(i.getDate());case"%j":return i.getDate();case"%D":return h.dayShortName[i.getDay()];case"%l":return h.dayFullName[i.getDay()];case"%m":return j(i.getMonth()+1);case"%n":return i.getMonth()+1;case"%M":return h.monthShortName[i.getMonth()];case"%F":return h.monthFullName[i.getMonth()];case"%y":return j(i.getYear()%100);case"%Y":return i.getFullYear();case"%g":return(i.getHours()+11)%12+1;case"%h":return j((i.getHours()+11)%12+1);case"%G":return i.getHours();case"%H":return j(i.getHours());case"%i":return j(i.getMinutes());case"%s":return j(i.getSeconds());case"%a":return(i.getHours()>11?"pm":"am");case"%A":return(i.getHours()>11?"PM":"AM");case"%%":return"%";case"%u":return i.getMilliseconds();case"%P":if(window.dhx4.temp_calendar!=null&&window.dhx4.temp_calendar.tz!=null){return window.dhx4.temp_calendar.tz}var a=i.getTimezoneOffset();var b=Math.abs(Math.floor(a/60));var d=Math.abs(a)-b*60;return(a>0?"-":"+")+j(b)+":"+j(d);default:return c}};var m=String(l||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,g)}return(m||String(i))};window.dhx4.str2date=function(z,K,H){if(K==null||typeof(K)=="undefined"){K=window.dhx4.dateFormat[window.dhx4.dateLang]}if(H==null||typeof(H)=="undefined"){H=window.dhx4.dateStrings[window.dhx4.dateLang]}K=K.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&");var I=[];var r=[];K=K.replace(/%[a-z]/gi,function(a){switch(a){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":r.push(a);return"(\\d{2})";case"%D":case"%l":case"%M":case"%F":r.push(a);return"([a-zéûä\u0430-\u044F\u0451]{1,})";case"%j":case"%n":case"%g":case"%G":r.push(a);return"(\\d{1,2})";case"%Y":r.push(a);return"(\\d{4})";case"%a":r.push(a);return"([a|p]m)";case"%A":r.push(a);return"([A|P]M)";case"%u":r.push(a);return"(\\d{1,6})";case"%P":r.push(a);return"([+-]\\d{1,2}:\\d{1,2})"}return a});var D=new RegExp(K,"i");var q=z.match(D);if(q==null||q.length-1!=r.length){return"Invalid Date"}for(var E=1;E<q.length;E++){I.push(q[E])}var C={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7};var p={};var v={};for(var E=0;E<r.length;E++){if(typeof(C[r[E]])!="undefined"){var A=C[r[E]];if(!p[A]){p[A]=[];v[A]=[]}p[A].push(I[E]);v[A].push(r[E])}}I=[];r=[];for(var E=1;E<=7;E++){if(p[E]!=null){for(var e=0;e<p[E].length;e++){I.push(p[E][e]);r.push(v[E][e])}}}var F=new Date();F.setDate(1);F.setHours(0);F.setMinutes(0);F.setSeconds(0);F.setMilliseconds(0);var f=function(c,b){for(var a=0;a<b.length;a++){if(b[a].toLowerCase()==c){return a}}return -1};for(var E=0;E<I.length;E++){switch(r[E]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":if(!isNaN(I[E])){F[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[r[E]]](Number(I[E])+(r[E]=="%m"||r[E]=="%n"?-1:0))}break;case"%M":case"%F":var w=f(I[E].toLowerCase(),H[{"%M":"monthShortName","%F":"monthFullName"}[r[E]]]);if(w>=0){F.setMonth(w)}break;case"%y":if(!isNaN(I[E])){var J=Number(I[E]);F.setFullYear(J+(J>50?1900:2000))}break;case"%g":case"%h":if(!isNaN(I[E])){var J=Number(I[E]);if(J<=12&&J>=0){F.setHours(J+(f("pm",I)>=0?(J==12?0:12):(J==12?-12:0)))}}break;case"%P":if(window.dhx4.temp_calendar!=null){window.dhx4.temp_calendar.tz=I[E]}break}}return F}}if(typeof(window.dhx4.ajax)=="undefined"){window.dhx4.ajax={cache:false,method:"get",parse:function(d){if(typeof d!=="string"){return d}d=d.replace(/^[\s]+/,"");if(window.DOMParser&&!dhx4.isIE){var c=(new window.DOMParser()).parseFromString(d,"text/xml")}else{if(window.ActiveXObject!==window.undefined){var c=new window.ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(d)}}return c},xmltop:function(f,g,h){if(typeof g.status=="undefined"||g.status<400){xml=(!g.responseXML)?dhx4.ajax.parse(g.responseText||g):(g.responseXML||g);if(xml&&xml.documentElement!==null){try{if(!xml.getElementsByTagName("parsererror").length){return xml.getElementsByTagName(f)[0]}}catch(e){}}}if(h!==-1){dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],h])}return document.createElement("DIV")},xpath:function(m,h){if(!h.nodeName){h=h.responseXML||h}if(dhx4.isIE){try{return h.selectNodes(m)||[]}catch(j){return[]}}else{var l=[];var i;var e=(h.ownerDocument||h).evaluate(m,h,null,XPathResult.ANY_TYPE,null);while(i=e.iterateNext()){l.push(i)}return l}},query:function(b){return dhx4.ajax._call((b.method||"GET"),b.url,b.data||"",(b.async||true),b.callback,null,b.headers)},get:function(d,c){return this._call("GET",d,null,true,c)},getSync:function(b){return this._call("GET",b,null,false)},put:function(d,e,f){return this._call("PUT",d,e,true,f)},del:function(d,e,f){return this._call("DELETE",d,e,true,f)},post:function(d,e,f){if(arguments.length==1){e=""}else{if(arguments.length==2&&(typeof(e)=="function"||typeof(window[e])=="function")){f=e;e=""}else{e=String(e)}}return this._call("POST",d,e,true,f)},postSync:function(c,d){d=(d==null?"":String(d));return this._call("POST",c,d,false)},getLong:function(d,c){this._call("GET",d,null,true,c,{url:d})},postLong:function(d,e,f){if(arguments.length==2&&(typeof(e)=="function"||typeof(window[e]))){f=e;e=""}this._call("POST",d,e,true,f,{url:d,postData:e})},_call:function(A,z,y,u,s,a,w){if(typeof y==="object"){var v=[];for(var r in y){v.push(r+"="+encodeURIComponent(y[r]))}y=v.join("&")}var x=dhx.promise.defer();var p=(window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));var t=(navigator.userAgent.match(/AppleWebKit/)!=null&&navigator.userAgent.match(/Qt/)!=null&&navigator.userAgent.match(/Safari/)!=null);if(u==true){p.onreadystatechange=function(){if((p.readyState==4)||(t==true&&p.readyState==3)){if(p.status!=200||p.responseText==""){x.reject(p);if(!dhx4.callEvent("onAjaxError",[{xmlDoc:p,filePath:z,async:u}])){return}}window.setTimeout(function(){if(typeof(s)=="function"){try{s.apply(window,[{xmlDoc:p,filePath:z,async:u}])}catch(b){x.reject(b)}x.resolve(p.responseText)}if(a!=null){if(typeof(a.postData)!="undefined"){dhx4.ajax.postLong(a.url,a.postData,s)}else{dhx4.ajax.getLong(a.url,s)}}s=null;p=null},1)}}}if(A=="GET"){z+=this._dhxr(z)}p.open(A,z,u);if(w!=null){for(var q in w){p.setRequestHeader(q,w[q])}}else{if(A=="POST"||A=="PUT"||A=="DELETE"){p.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{if(A=="GET"){y=null}}}p.setRequestHeader("X-Requested-With","XMLHttpRequest");p.send(y);if(u!=true){if((p.readyState==4)||(t==true&&p.readyState==3)){if(p.status!=200||p.responseText==""){dhx4.callEvent("onAjaxError",[{xmlDoc:p,filePath:z,async:u}])}}}x.xmlDoc=p;x.filePath=z;x.async=u;return x},_dhxr:function(d,c){if(this.cache!=true){if(d.match(/^[\?\&]$/)==null){d=(d.indexOf("?")>=0?"&":"?")}if(typeof(c)=="undefined"){c=true}return d+"dhxr"+new Date().getTime()+(c==true?"=1":"")}return""}}}if(typeof(window.dhx4._enableDataLoading)=="undefined"){window.dhx4._enableDataLoading=function(j,o,l,m,i){if(i=="clear"){for(var a in j._dhxdataload){j._dhxdataload[a]=null;delete j._dhxdataload[a]}j._loadData=null;j._dhxdataload=null;j.load=null;j.loadStruct=null;j=null;return}j._dhxdataload={initObj:o,xmlToJson:l,xmlRootTag:m,onBeforeXLS:null};j._loadData=function(f,e,d){if(arguments.length==2){d=e;e=null}var g=null;if(arguments.length==3){d=arguments[2]}this.callEvent("onXLS",[]);if(typeof(f)=="string"){var h=f.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");var v=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(v.test(h.replace(/^<\?xml[^\?]*\?>\s*/,""))){g=dhx4.ajax.parse(f);if(g!=null){g=this[this._dhxdataload.xmlToJson].apply(this,[g])}}if(g==null&&(h.match(/^[\s\S]*{[.\s\S]*}[\s\S]*$/)!=null||h.match(/^[\s\S]*\[[.\s\S]*\][\s\S]*$/)!=null)){g=dhx4.s2j(h)}if(g==null){var t=[];if(typeof(this._dhxdataload.onBeforeXLS)=="function"){var h=this._dhxdataload.onBeforeXLS.apply(this,[f]);if(h!=null&&typeof(h)=="object"){if(h.url!=null){f=h.url}if(h.params!=null){for(var c in h.params){t.push(c+"="+encodeURIComponent(h.params[c]))}}}}var b=this;var u=function(p){var q=null;if((p.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||(p.xmlDoc.responseText.replace(/^\s{1,}/,"")).match(/^</)!=null){q=b[b._dhxdataload.xmlToJson].apply(b,[p.xmlDoc.responseXML])}else{q=dhx4.s2j(p.xmlDoc.responseText)}if(q!=null){b[b._dhxdataload.initObj].apply(b,[q,f])}b.callEvent("onXLE",[]);if(d!=null){if(typeof(d)=="function"){d.apply(b,[])}else{if(typeof(window[d])=="function"){window[d].apply(b,[])}}}u=d=null;q=p=b=null};t=t.join("&")+(typeof(e)=="string"?"&"+e:"");if(dhx4.ajax.method=="post"){return dhx4.ajax.post(f,t,u)}else{if(dhx4.ajax.method=="get"){return dhx4.ajax.get(f+(t.length>0?(f.indexOf("?")>0?"&":"?")+t:""),u)}}return}}else{if(typeof(f.documentElement)=="object"||(typeof(f.tagName)!="undefined"&&typeof(f.getElementsByTagName)!="undefined"&&f.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0)){g=this[this._dhxdataload.xmlToJson].apply(this,[f])}else{g=window.dhx4._copyObj(f)}}if(g!=null){this[this._dhxdataload.initObj].apply(this,[g])}this.callEvent("onXLE",[]);if(d!=null){if(typeof(d)=="function"){d.apply(this,[])}else{if(typeof(window[d])=="function"){window[d].apply(this,[])}}d=null}};if(i!=null){var n={struct:"loadStruct",data:"load"};for(var a in i){if(i[a]==true){j[n[a]]=function(){return this._loadData.apply(this,arguments)}}}}j=null}}if(typeof(window.dhx4._eventable)=="undefined"){window.dhx4._eventable=function(d,c){if(c=="clear"){d.detachAllEvents();d.dhxevs=null;d.attachEvent=null;d.detachEvent=null;d.checkEvent=null;d.callEvent=null;d.detachAllEvents=null;d=null;return}d.dhxevs={data:{}};d.attachEvent=function(f,a){f=String(f).toLowerCase();if(!this.dhxevs.data[f]){this.dhxevs.data[f]={}}var b=window.dhx4.newId();this.dhxevs.data[f][b]=a;return b};d.detachEvent=function(a){for(var g in this.dhxevs.data){var b=0;for(var h in this.dhxevs.data[g]){if(h==a){this.dhxevs.data[g][h]=null;delete this.dhxevs.data[g][h]}else{b++}}if(b==0){this.dhxevs.data[g]=null;delete this.dhxevs.data[g]}}};d.checkEvent=function(a){a=String(a).toLowerCase();return(this.dhxevs.data[a]!=null)};d.callEvent=function(g,a){g=String(g).toLowerCase();if(this.dhxevs.data[g]==null){return true}var b=true;for(var h in this.dhxevs.data[g]){b=this.dhxevs.data[g][h].apply(this,a)&&b}return b};d.detachAllEvents=function(){for(var a in this.dhxevs.data){for(var b in this.dhxevs.data[a]){this.dhxevs.data[a][b]=null;delete this.dhxevs.data[a][b]}this.dhxevs.data[a]=null;delete this.dhxevs.data[a]}};d=null};dhx4._eventable(dhx4)}if(!window.dhtmlxValidation){dhtmlxValidation=function(){};dhtmlxValidation.prototype={isEmpty:function(b){return b==""},isNotEmpty:function(b){return(b instanceof Array?b.length>0:!b=="")},isValidBoolean:function(b){return !!b.toString().match(/^(0|1|true|false)$/)},isValidEmail:function(b){return !!b.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,5})$)/i)},isValidInteger:function(b){return !!b.toString().match(/(^-?\d+$)/)},isValidNumeric:function(b){return !!b.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)},isValidAplhaNumeric:function(b){return !!b.toString().match(/^[_\-a-z0-9]+$/gi)},isValidDatetime:function(c){var d=c.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);return d&&!!(d[1]<=9999&&d[2]<=12&&d[3]<=31&&d[4]<=59&&d[5]<=59&&d[6]<=59)||false},isValidDate:function(d){var c=d.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);return c&&!!(c[1]<=9999&&c[2]<=12&&c[3]<=31)||false},isValidTime:function(c){var d=c.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);return d&&!!(d[1]<=24&&d[2]<=59&&d[3]<=59)||false},isValidIPv4:function(d){var c=d.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);return c&&!!(c[1]<=255&&c[2]<=255&&c[3]<=255&&c[4]<=255)||false},isValidCurrency:function(b){return b.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/)&&true||false},isValidSSN:function(b){return b.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/)&&true||false},isValidSIN:function(b){return b.toString().match(/^\d{9}$/)&&true||false}};dhtmlxValidation=new dhtmlxValidation()}if(typeof(window.dhtmlx)=="undefined"){window.dhtmlx={extend:function(b,f){for(var a in f){if(!b[a]){b[a]=f[a]}}return b},extend_api:function(f,g,h){var e=window[f];if(!e){return}window[f]=function(a){if(a&&typeof a=="object"&&!a.tagName){var b=e.apply(this,(g._init?g._init(a):arguments));for(var c in dhtmlx){if(g[c]){this[g[c]](dhtmlx[c])}}for(var c in a){if(g[c]){this[g[c]](a[c])}else{if(c.indexOf("on")===0){this.attachEvent(c,a[c])}}}}else{var b=e.apply(this,arguments)}if(g._patch){g._patch(this)}return b||this};window[f].prototype=e.prototype;if(h){dhtmlx.extend(window[f].prototype,h)}},url:function(b){if(b.indexOf("?")!=-1){return"&"}else{return"?"}}}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(b){b.onmousedown=null;b.dragStarter=null;b.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(d,c){d.onmousedown=this.preCreateDragCopy;d.dragStarter=c;this.addDragLanding(d,c)};dhtmlDragAndDropObject.prototype.addDragLanding=function(d,c){d.dragLanding=c};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(b){if((b||window.event)&&(b||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode){window.dhtmlDragAndDrop.stopDrag(b)}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((b)&&(b.preventDefault)){b.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(j){if(!j){j=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return}if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,j);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(j,true)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var g=dragger.gldragNode;if(dragger.gldragNode.old){g=dragger.gldragNode.old}g.parentNode.removeChild(g);var e=dragger.dragNode.pWindow;if(g.pWindow&&g.pWindow.dhtmlDragAndDrop.lastLanding){g.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(g.pWindow.dhtmlDragAndDrop.lastLanding)}if(_isIE){var h=document.createElement("Div");h.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=h.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);e.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=j.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=j.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!j.srcElement){var i=j.target}else{i=j.srcElement}dragger.checkLanding(i,j)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(h){if(window.name){var j=parent.frames[window.name].frameElement.offsetParent;var i=0;var f=0;while(j){i+=j.offsetLeft;f+=j.offsetTop;j=j.offsetParent}if((parent.dhtmlDragAndDrop)){var g=parent.dhtmlDragAndDrop.calculateFramePosition(1);i+=g.split("_")[0]*1;f+=g.split("_")[1]*1}if(h){return i+"_"+f}else{this.fx=i}this.fy=f}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(c,d){if((c)&&(c.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=c;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,d.clientX,d.clientY,d);this.lastLanding_scr=(_isIE?d.srcElement:d.target)}else{if((c)&&(c.tagName!="BODY")){this.checkLanding(c.parentNode,d)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,d.clientX,d.clientY,d)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(d,f){dragger=window.dhtmlDragAndDrop;if(!f){dragger.stopFrameRoute();var e=dragger.lastLanding;dragger.lastLanding=null;if(e){e.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,e,(_isIE?event.srcElement:d.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(f){if(f){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var e=0;e<window.frames.length;e++){try{if((window.frames[e]!=f)&&(window.frames[e].dhtmlDragAndDrop)){window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(d){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=f)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(d){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(h,g){if(h){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=h.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=h.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=h.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=h.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(g))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=h)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(e){}for(var f=0;f<window.frames.length;f++){try{if((window.frames[f]!=h)&&(window.frames[f].dhtmlDragAndDrop)){window.frames[f].dhtmlDragAndDrop.initFrameRoute(window,((!h||g)?1:0))}}catch(e){}}};_isFF=false;_isIE=false;_isOpera=false;_isKHTML=false;_isMacOS=false;_isChrome=false;_FFrv=false;_KHTMLrv=false;_OperaRv=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;_FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if((navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1||document.documentMode>7)&&document.compatMode!="BackCompat"){_isIE=8}}else{if(navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1){_isIE=8}else{_isFF=true;_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}}if(typeof(window.dhtmlxEvent)=="undefined"){function dhtmlxEvent(d,f,e){if(d.addEventListener){d.addEventListener(f,e,false)}else{if(d.attachEvent){d.attachEvent("on"+f,e)}}}}if(dhtmlxEvent.touchDelay==null){dhtmlxEvent.touchDelay=2000}if(typeof(dhtmlxEvent.initTouch)=="undefined"){dhtmlxEvent.initTouch=function(){var i;var h;var f,g;dhtmlxEvent(document.body,"touchstart",function(a){h=a.touches[0].target;f=a.touches[0].clientX;g=a.touches[0].clientY;i=window.setTimeout(j,dhtmlxEvent.touchDelay)});function j(){if(h){var a=document.createEvent("HTMLEvents");a.initEvent("dblclick",true,true);h.dispatchEvent(a);i=h=null}}dhtmlxEvent(document.body,"touchmove",function(a){if(i){if(Math.abs(a.touches[0].clientX-f)>50||Math.abs(a.touches[0].clientY-g)>50){window.clearTimeout(i);i=h=false}}});dhtmlxEvent(document.body,"touchend",function(a){if(i){window.clearTimeout(i);i=h=false}});dhtmlxEvent.initTouch=function(){}}}(function(e){var h=typeof setImmediate!=="undefined"?setImmediate:function(a){setTimeout(a,0)};function g(b,a){var c=this;c.promise=c;c.state="pending";c.val=null;c.fn=b||null;c.er=a||null;c.next=[]}g.prototype.resolve=function(a){var b=this;if(b.state==="pending"){b.val=a;b.state="resolving";h(function(){b.fire()})}};g.prototype.reject=function(a){var b=this;if(b.state==="pending"){b.val=a;b.state="rejecting";h(function(){b.fire()})}};g.prototype.then=function(c,a){var d=this;var b=new g(c,a);d.next.push(b);if(d.state==="resolved"){b.resolve(d.val)}if(d.state==="rejected"){b.reject(d.val)}return b};g.prototype.fail=function(a){return this.then(null,a)};g.prototype.finish=function(a){var c=this;c.state=a;if(c.state==="resolved"){for(var b=0;b<c.next.length;b++){c.next[b].resolve(c.val)}}if(c.state==="rejected"){for(var b=0;b<c.next.length;b++){c.next[b].reject(c.val)}if(!c.next.length){throw (c.val)}}};g.prototype.thennable=function(c,q,o,r,a){var p=this;a=a||p.val;if(typeof a==="object"&&typeof c==="function"){try{var d=0;c.call(a,function(i){if(d++!==0){return}q(i)},function(i){if(d++!==0){return}o(i)})}catch(b){o(b)}}else{r(a)}};g.prototype.fire=function(){var c=this;var b;try{b=c.val&&c.val.then}catch(a){c.val=a;c.state="rejecting";return c.fire()}c.thennable(b,function(d){c.val=d;c.state="resolving";c.fire()},function(d){c.val=d;c.state="rejecting";c.fire()},function(l){c.val=l;if(c.state==="resolving"&&typeof c.fn==="function"){try{c.val=c.fn.call(undefined,c.val)}catch(d){c.val=d;return c.finish("rejected")}}if(c.state==="rejecting"&&typeof c.er==="function"){try{c.val=c.er.call(undefined,c.val);c.state="resolving"}catch(d){c.val=d;return c.finish("rejected")}}if(c.val===c){c.val=TypeError();return c.finish("rejected")}c.thennable(b,function(i){c.val=i;c.finish("resolved")},function(i){c.val=i;c.finish("rejected")},function(i){c.val=i;c.state==="resolving"?c.finish("resolved"):c.finish("rejected")})})};g.prototype.done=function(){if(this.state="rejected"&&!this.next){throw this.val}return null};g.prototype.nodeify=function(a){if(typeof a==="function"){return this.then(function(b){try{a(null,b)}catch(c){setImmediate(function(){throw c})}return b},function(b){try{a(b)}catch(c){setImmediate(function(){throw c})}return b})}return this};g.prototype.spread=function(b,a){return this.all().then(function(c){return typeof b==="function"&&b.apply(null,c)},a)};g.prototype.all=function(){var a=this;return this.then(function(b){var v=new g();if(!(b instanceof Array)){v.reject(TypeError);return v}var t=0;var c=b.length;function l(){if(++t===c){v.resolve(b)}}for(var i=0,p=b.length;i<p;i++){var w=b[i];var u;try{u=w&&w.then}catch(d){v.reject(d);break}(function(j){a.thennable(u,function(m){b[j]=m;l()},function(m){v.reject(m)},function(){l()},w)})(i)}return v})};var f={all:function(b){var a=new g(null,null);a.resolve(b);return a.all()},defer:function(){return new g(null,null)},fcall:function(){var c=new g();var l=Array.apply([],arguments);var d=l.shift();try{var a=d.apply(null,l);c.resolve(a)}catch(b){c.reject(b)}return c},nfcall:function(){var b=new g();var d=Array.apply([],arguments);var c=d.shift();try{d.push(function(l,i){if(l){return b.reject(l)}return b.resolve(i)});c.apply(null,d)}catch(a){b.reject(a)}return b}};e.promise=f})(dhx);function dhtmlXCalendarObject(q,a){this.i={};var t=null;if(typeof(q)=="string"){var s=document.getElementById(q)}else{var s=q}if(s&&typeof(s)=="object"&&s.tagName&&String(s.tagName).toLowerCase()!="input"){t=s}s=null;if(typeof(q)!="object"||!q.length){q=[q]}for(var u=0;u<q.length;u++){if(typeof(q[u])=="string"){q[u]=(document.getElementById(q[u])||null)}if(q[u]!=null&&q[u].tagName&&String(q[u].tagName).toLowerCase()=="input"){this.i[window.dhx4.newId()]={input:q[u]}}else{if(!(q[u] instanceof Array)&&q[u] instanceof Object&&(q[u].input!=null||q[u].button!=null)){if(q[u].input!=null&&typeof(q[u].input)=="string"){q[u].input=document.getElementById(q[u].input)}if(q[u].button!=null&&typeof(q[u].button)=="string"){q[u].button=document.getElementById(q[u].button)}this.i[window.dhx4.newId()]=q[u]}}q[u]=null}this.conf={skin:(a||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhtmlxcalendar")||"material"),zi:window.dhx4.newId(),touch:!window.dhx4.isIE,time:true,today:false,ws_first:true};this.setSkin=function(b,c){if(this.conf.skin==b&&!c){return}this.conf.skin=b;this.base.className="dhtmlxcalendar_"+this.conf.skin;this._ifrSize()};this.base=document.createElement("DIV");this.base.style.display="none";this.base.appendChild(document.createElement("DIV"));if(t!=null){this._hasParent=true;t.appendChild(this.base);t=null}else{document.body.appendChild(this.base)}this.setParent=function(b){if(this._hasParent){if(typeof(b)=="object"){b.appendChild(this.base)}else{if(typeof(b)=="string"){document.getElementById(b).appendChild(this.base)}}}};this.setSkin(this.conf.skin,true);this.base.onclick=function(b){b=b||event;if(b.preventDefault){b.preventDefault()}b.cancelBubble=true};this.base.onmousedown=function(){return false};if(this.conf.touch){this.base.ontouchstart=this.base.onclick}this.loadUserLanguage=function(d){if(!this.langData[d]){return}this.lang=d;this.setWeekStartDay(this.langData[this.lang].weekstart);this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d");if(this.msCont){var e=0;for(var b=0;b<this.msCont.childNodes.length;b++){for(var c=0;c<this.msCont.childNodes[b].childNodes.length;c++){this.msCont.childNodes[b].childNodes[c].innerHTML=this.langData[this.lang].monthesSNames[e++]}}}this.contTime.childNodes[0].childNodes[0].childNodes[5].innerHTML=this.langData[this.lang].today;this.contTime.childNodes[0].childNodes[0].childNodes[4].innerHTML=this.langData[this.lang].clear};this.contMonth=document.createElement("DIV");this.contMonth.className="dhtmlxcalendar_month_cont";this.contMonth.onselectstart=function(b){b=b||event;b.cancelBubble=true;if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}return false};this.base.firstChild.appendChild(this.contMonth);var p=document.createElement("UL");p.className="dhtmlxcalendar_line";this.contMonth.appendChild(p);var m=document.createElement("LI");m.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";m.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span></span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";p.appendChild(m);var r=this;m.onclick=function(d){d=d||event;if(d.type=="touchstart"&&d.preventDefault!=null){d.preventDefault()}var b=(d.target||d.srcElement);if(b.className&&b.className.indexOf("dhtmlxcalendar_month_arrow")===0){r._hideSelector();var e=(b.parentNode.firstChild==b?-1:1);var c=new Date(r._activeMonth);r._drawMonth(new Date(r._activeMonth.getFullYear(),r._activeMonth.getMonth()+e,1,0,0,0,0));r._evOnArrowClick([c,new Date(r._activeMonth)]);return}if(b.className&&b.className=="dhtmlxcalendar_month_label_month"){d.cancelBubble=true;r._showSelector("month",Math.round(b.offsetLeft+b.offsetWidth/2),b.offsetTop+b.offsetHeight+2,"selector_month",true);return}if(b.className&&b.className=="dhtmlxcalendar_month_label_year"){d.cancelBubble=true;r._showSelector("year",Math.round(b.offsetLeft+b.offsetWidth/2),b.offsetTop+b.offsetHeight+2,"selector_year",true);return}r._hideSelector()};if(this.conf.touch==true){m.ontouchstart=m.onclick}this.contDays=document.createElement("DIV");this.contDays.className="dhtmlxcalendar_days_cont";this.base.firstChild.appendChild(this.contDays);this.setWeekStartDay=function(b){if(b==0){b=7}this._wStart=Math.min(Math.max((isNaN(b)?1:b),1),7);this._drawDaysOfWeek()};this._drawDaysOfWeek=function(){if(this.contDays.childNodes.length==0){var e=document.createElement("UL");e.className="dhtmlxcalendar_line";this.contDays.appendChild(e)}else{var e=this.contDays.firstChild}var b=this._wStart;var f=this.langData[this.lang].daysSNames;f.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var d=0;d<8;d++){if(e.childNodes[d]==null){var c=document.createElement("LI");e.appendChild(c)}else{var c=e.childNodes[d]}if(d==0){c.className="dhtmlxcalendar_cell_wn";c.innerHTML="<div class='dhtmlxcalendar_label'>"+(this.langData[this.lang].weekname||"w")+"</div>"}else{c.className="dhtmlxcalendar_cell"+(b>=6?" dhtmlxcalendar_day_weekday_cell":"")+(d==1?"_first":"");c.innerHTML=f[b];if(++b>7){b=1}}}if(this._activeMonth!=null){this._drawMonth(this._activeMonth)}};this._wStart=this.langData[this.lang].weekstart;this.setWeekStartDay(this._wStart);this.contDates=document.createElement("DIV");this.contDates.className="dhtmlxcalendar_dates_cont";this.base.firstChild.appendChild(this.contDates);this.contDates.onclick=function(d){d=d||event;if(d.type=="touchstart"&&d.preventDefault!=null){d.preventDefault()}var b=(d.target||d.srcElement);if(b.parentNode!=null&&b.parentNode._date!=null){b=b.parentNode}if(b._date!=null&&!b._css_dis){var f=r._activeDate.getHours();var g=r._activeDate.getMinutes();var e=b._date;if(r.checkEvent("onBeforeChange")){if(!r.callEvent("onBeforeChange",[new Date(b._date.getFullYear(),b._date.getMonth(),b._date.getDate(),f,g)])){return}}if(r._activeDateCell!=null){r._activeDateCell._css_date=false;r._updateCellStyle(r._activeDateCell._q,r._activeDateCell._w)}var c=(r._activeDate.getFullYear()+"_"+r._activeDate.getMonth()!=e.getFullYear()+"_"+e.getMonth());r._nullDate=false;r._activeDate=new Date(e.getFullYear(),e.getMonth(),e.getDate(),f,g);r._activeDateCell=b;r._activeDateCell._css_date=true;r._activeDateCell._css_hover=false;r._updateCellStyle(r._activeDateCell._q,r._activeDateCell._w);if(c){r._drawMonth(r._activeDate)}r._updateInp();if(!r._hasParent){if(d.type=="touchstart"){window.setTimeout(function(){r._hide()},400)}else{r._hide()}}r._evOnClick([new Date(r._activeDate.getTime())]);r._doOnSelectorChange(true)}};if(this.conf.touch==true){this.contDates.ontouchstart=this.contDates.onclick}this.contDates.onmouseover=function(b){b=b||event;var c=(b.target||b.srcElement);if(c.parentNode!=null&&c.parentNode._date!=null){c=c.parentNode}if(c._date!=null){if(r._lastHover==c||c._css_hover){return}c._css_hover=true;r._updateCellStyle(c._q,c._w);r._lastHover=c;r._evOnMouseOver([new Date(c._date.getFullYear(),c._date.getMonth(),c._date.getDate(),0,0,0,0),b]);c=null}};this.contDates.onmouseout=function(b){r._clearDayHover(b||event)};this._lastHover=null;this._clearDayHover=function(b){if(!this._lastHover){return}this._lastHover._css_hover=false;this._updateCellStyle(this._lastHover._q,this._lastHover._w);if(b!=null){r._evOnMouseOut([new Date(this._lastHover._date.getFullYear(),this._lastHover._date.getMonth(),this._lastHover._date.getDate(),0,0,0,0),b])}this._lastHover=null};for(var u=0;u<6;u++){var p=document.createElement("UL");p.className="dhtmlxcalendar_line";this.contDates.appendChild(p);for(var n=0;n<=7;n++){var m=document.createElement("LI");if(n==0){m.className="dhtmlxcalendar_cell_wn"}else{m.className="dhtmlxcalendar_cell"}p.appendChild(m)}}this.contTime=document.createElement("DIV");this.contTime.className="dhtmlxcalendar_time_cont";this.contTime.style.display="none";this.base.firstChild.appendChild(this.contTime);this.showTime=function(){if(this.conf.time!=true){this.conf.time=true;this._adjustTimeCont()}};this.hideTime=function(){if(this.conf.time==true){this.conf.time=false;this._adjustTimeCont()}};this.showToday=function(){if(this.conf.today!=true){this.conf.today=true;this._adjustTimeCont()}};this.hideToday=function(){if(this.conf.today==true){this.conf.today=false;this._adjustTimeCont()}};this._adjustTimeCont=function(){var b="";if(this.conf.time==true){b+="_time"}if(this.conf.today==true){b+="_today"}if(b==""){this.contTime.style.display="none"}else{this.contTime.className="dhtmlxcalendar_time_cont dhtmlxcalendar_mode"+b;this.contTime.style.display=""}this._ifrSize()};this._adjustTimeCont();var p=document.createElement("UL");p.className="dhtmlxcalendar_line";this.contTime.appendChild(p);var m=document.createElement("LI");m.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";m.innerHTML="<div class='dhtmlxcalendar_time_img'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'>:</span><span class='dhtmlxcalendar_label_minutes'></span><span class='dhtmlxcalendar_label_clear'>"+this.langData[this.lang].clear+"</span><span class='dhtmlxcalendar_label_today'>"+this.langData[this.lang].today+"</span>";p.appendChild(m);m.onclick=function(e){e=e||event;if(e.type=="touchstart"&&e.preventDefault!=null){e.preventDefault()}var c=(e.target||e.srcElement);if(c.tagName!=null&&c.tagName.toLowerCase()=="span"&&c._par==true&&c.parentNode!=null){c=c.parentNode}if(c.className&&c.className=="dhtmlxcalendar_label_hours"){e.cancelBubble=true;var b=r.contMonth.offsetHeight+r.contDays.offsetHeight+r.contDates.offsetHeight+c.offsetTop;r._showSelector("hours",Math.round(c.offsetLeft+c.offsetWidth/2),b-2,"selector_hours",true);return}if(c.className&&c.className=="dhtmlxcalendar_label_minutes"){e.cancelBubble=true;if(r._minutesInterval==1){var d=r.getFormatedDate("%i");c.innerHTML="<span class='dhtmlxcalendar_selected_date'>"+d.charAt(0)+"</span>"+d.charAt(1);c.firstChild._par=true;r._selectorMode=1}var b=r.contMonth.offsetHeight+r.contDays.offsetHeight+r.contDates.offsetHeight+c.offsetTop;r._showSelector("minutes",Math.round(c.offsetLeft+c.offsetWidth/2),b-2,"selector_minutes",true);return}r._hideSelector();if(c.className&&c.className=="dhtmlxcalendar_label_today"){var d=new Date();d=new Date(d.getFullYear(),d.getMonth(),d.getDate(),r._activeDate.getHours(),r._activeDate.getMinutes(),r._activeDate.getSeconds(),r._activeDate.getMilliseconds());r.setDate(d);r._updateInp();r.callEvent("onButtonClick",[d])}if(c.className&&c.className=="dhtmlxcalendar_label_clear"){r._nullDate=true;r._drawMonth(new Date());r._updateInp();r.callEvent("onButtonClick",[null])}};if(this.conf.touch==true){m.ontouchstart=m.onclick}this._activeMonth=null;this._activeDate=new Date();this._activeDateCell=null;this.setDate=function(b){window.dhx4.temp_calendar={tz:null};this._nullDate=(typeof(b)=="undefined"||b===""||!b);if(!(b instanceof Date)){b=this._strToDate(String(b||""));if(b=="Invalid Date"){b=new Date()}else{this.conf.tz=window.dhx4.temp_calendar.tz}window.dhx4.temp_calendar=null}if(this.conf.tz==null){this.conf.tz=window.dhx4.date2str(b,"%P")}var c=b.getTime();if(this._isOutOfRange(c)){return}this._activeDate=new Date(c);this._drawMonth(this._nullDate?new Date():this._activeDate);this._updateVisibleHours();this._updateVisibleMinutes()};this.getDate=function(d){if(this._nullDate){return null}var c=new Date(this._activeDate.getTime());if(d){window.dhx4.temp_calendar={tz:this.conf.tz};var b=this._dateToStr(c);window.dhx4.temp_calendar=null;return b}return c};this._drawMonth=function(H){if(!(H instanceof Date)){return}if(isNaN(H.getFullYear())){H=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0)}this._activeMonth=new Date(H.getFullYear(),H.getMonth(),1,0,0,0,0);this._activeDateCell=null;var J=new Date(this._activeMonth.getTime());var h=J.getDay();var j=h-this._wStart;if(j<0){j=j+7}J.setDate(J.getDate()-j);var b=H.getMonth();var L=new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0).getTime();var c=0;for(var i=0;i<6;i++){var I=this._wStart;for(var d=0;d<=7;d++){if(d==0){var g=this.getWeekNumber(new Date(J.getFullYear(),J.getMonth(),J.getDate()+c,0,0,0,0));if(g>=52&&this.conf.ws_first==true&&this._activeMonth.getMonth()==0){var e=this.getWeekNumber(new Date(J.getFullYear(),J.getMonth(),J.getDate()+c+7,0,0,0,0));if(e<g&&e>1){g=1}}else{if(g>52&&this._activeMonth.getMonth()==11){var e=this.getWeekNumber(new Date(J.getFullYear()+1,0,1));if(e==1){g=1}}}this.contDates.childNodes[i].childNodes[d].innerHTML="<div class='dhtmlxcalendar_label'>"+g+"</div>"}else{var F=new Date(J.getFullYear(),J.getMonth(),J.getDate()+c,0,0,0,0);if(F.getHours()!=0){var K=(F.getHours()>12?24-F.getHours():F.getHours());F.setTime(F.getTime()+60*60*1000*K)}var l=F.getDay();var f=F.getTime();var w="dhtmlxcalendar_label";if(this._tipData[f]!=null){if(this._tipData[f].usePopup&&typeof(window.dhtmlXPopup)=="function"){this.contDates.childNodes[i].childNodes[d].removeAttribute("title");this._initTooltipPopup()}else{this.contDates.childNodes[i].childNodes[d].setAttribute("title",this._tipData[f].text)}if(this._tipData[f].showIcon){w+=" dhtmlxcalendar_label_title"}}else{this.contDates.childNodes[i].childNodes[d].removeAttribute("title")}this.contDates.childNodes[i].childNodes[d].innerHTML="<div class='"+w+"'>"+F.getDate()+"</div>";this.contDates.childNodes[i].childNodes[d]._date=new Date(f);this.contDates.childNodes[i].childNodes[d]._q=i;this.contDates.childNodes[i].childNodes[d]._w=d;this.contDates.childNodes[i].childNodes[d]._css_month=(F.getMonth()==b);this.contDates.childNodes[i].childNodes[d]._css_date=(!this._nullDate&&f==L);this.contDates.childNodes[i].childNodes[d]._css_weekend=(I>=6);this.contDates.childNodes[i].childNodes[d]._css_dis=this._isOutOfRange(f);this.contDates.childNodes[i].childNodes[d]._css_holiday=(this._holidays[f]==true);this._updateCellStyle(i,d);if(f==L){this._activeDateCell=this.contDates.childNodes[i].childNodes[d]}if(++I>7){I=1}c++}}}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this._buildMonthHdr(H)};this._updateCellStyle=function(d,c){var e=this.contDates.childNodes[d].childNodes[c];var b="dhtmlxcalendar_cell dhtmlxcalendar_cell";b+=(e._css_month?"_month":"");b+=(e._css_date?"_date":"");b+=(e._css_weekend?"_weekend":"");b+=(e._css_holiday?"_holiday":"");b+=(e._css_dis?"_dis":"");b+=(e._css_hover&&!e._css_dis?"_hover":"");e.className=b;e=null};this._minutesInterval=5;this._initSelector=function(j,d){if(!this._selCover){this._selCover=document.createElement("DIV");this._selCover.className="dhtmlxcalendar_selector_cover";this.base.firstChild.appendChild(this._selCover)}if(!this._sel){this._sel=document.createElement("DIV");this._sel.className="dhtmlxcalendar_selector_obj";this.base.firstChild.appendChild(this._sel);this._sel.appendChild(document.createElement("TABLE"));this._sel.firstChild.className="dhtmlxcalendar_selector_table";this._sel.firstChild.cellSpacing=0;this._sel.firstChild.cellPadding=0;this._sel.firstChild.border=0;this._sel.firstChild.appendChild(document.createElement("TBODY"));this._sel.firstChild.firstChild.appendChild(document.createElement("TR"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left";this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle";this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right";this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;";this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;";this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"};this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"};this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"};this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"};this._sel.onmouseover=function(v){v=v||event;var x=(v.target||v.srcElement);if(x._cell===true){if(r._selHover!=x){r._clearSelHover()}if(String(x.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)!=null){x.className+=" dhtmlxcalendar_selector_cell_hover";r._selHover=x}}};this._sel.onmouseout=function(){r._clearSelHover()};this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(v){v=v||event;if(v.type=="touchstart"&&v.preventDefault!=null){v.preventDefault()}v.cancelBubble=true;r._scrollYears(-1)};this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=function(v){v=v||event;if(v.type=="touchstart"&&v.preventDefault!=null){v.preventDefault()}v.cancelBubble=true;r._scrollYears(1)};if(this.conf.touch==true){this._sel.firstChild.firstChild.firstChild.childNodes[0].ontouchstart=this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick;this._sel.firstChild.firstChild.firstChild.childNodes[2].ontouchstart=this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick}this._sel._ta={};this._selHover=null;this._sel.appendChild(document.createElement("DIV"));this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow"}if(this._sel._ta[j]==true){return}if(j=="month"){this._msCells={};this.msCont=document.createElement("DIV");this.msCont.className="dhtmlxcalendar_area_"+d;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);var f=0;for(var g=0;g<4;g++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line";this.msCont.appendChild(l);for(var i=0;i<3;i++){var h=document.createElement("LI");h.innerHTML=this.langData[this.lang].monthesSNames[f];h.className="dhtmlxcalendar_selector_cell";l.appendChild(h);h._month=f;h._cell=true;this._msCells[f++]=h}}this.msCont.onclick=function(v){v=v||event;if(v.type=="touchstart"&&v.preventDefault!=null){v.preventDefault()}v.cancelBubble=true;var x=(v.target||v.srcElement);if(x._month!=null){r._hideSelector();r._updateActiveMonth();r._drawMonth(new Date(r._activeMonth.getFullYear(),x._month,1,0,0,0,0));r._doOnSelectorChange()}};if(this.conf.touch==true){this.msCont.ontouchstart=this.msCont.onclick}}if(j=="year"){this._ysCells={};this.ysCont=document.createElement("DIV");this.ysCont.className="dhtmlxcalendar_area_"+d;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(var g=0;g<4;g++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line";this.ysCont.appendChild(l);for(var i=0;i<3;i++){var h=document.createElement("LI");h.className="dhtmlxcalendar_selector_cell";h._cell=true;l.appendChild(h)}}this.ysCont.onclick=function(v){v=v||event;if(v.type=="touchstart"&&v.preventDefault!=null){v.preventDefault()}v.cancelBubble=true;var x=(v.target||v.srcElement);if(x._year!=null){r._hideSelector();r._drawMonth(new Date(x._year,r._activeMonth.getMonth(),1,0,0,0,0));r._doOnSelectorChange()}};if(this.conf.touch==true){this.ysCont.ontouchstart=this.ysCont.onclick}}if(j=="hours"){this._hsCells={};this.hsCont=document.createElement("DIV");this.hsCont.className="dhtmlxcalendar_area_"+d;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);var f=0;for(var g=0;g<4;g++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line";this.hsCont.appendChild(l);for(var i=0;i<6;i++){var h=document.createElement("LI");h.innerHTML=this._fixLength(f,2);h.className="dhtmlxcalendar_selector_cell";l.appendChild(h);h._hours=f;h._cell=true;this._hsCells[f++]=h}}this.hsCont.onclick=function(v){v=v||event;if(v.type=="touchstart"&&v.preventDefault!=null){v.preventDefault()}v.cancelBubble=true;var x=(v.target||v.srcElement);if(x._hours!=null){r._hideSelector();r._activeDate.setHours(x._hours);r._updateActiveHours();r._updateVisibleHours();r._doOnSelectorChange();r.callEvent("onTimeChange",[new Date(r._activeDate.getTime())])}};if(this.conf.touch==true){this.hsCont.ontouchstart=this.hsCont.onclick}}if(j=="minutes"){var b=4;var e=3;var c=2;if(this._minutesInterval==1){if(this._selectorMode==1){b=2;e=3;c=1}else{b=2;e=5;c=1;d+="5"}}if(this._minutesInterval==10){b=2}if(this._minutesInterval==15){b=1;e=4;d+="4"}this._rsCells={};this.rsCont=document.createElement("DIV");this.rsCont.className="dhtmlxcalendar_area_"+d;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);var f=0;for(var g=0;g<b;g++){var l=document.createElement("UL");l.className="dhtmlxcalendar_selector_line";this.rsCont.appendChild(l);for(var i=0;i<e;i++){var h=document.createElement("LI");h.innerHTML=(c>1?this._fixLength(f,c):f);h.className="dhtmlxcalendar_selector_cell";l.appendChild(h);h._minutes=f;h._cell=true;this._rsCells[f]=h;f+=this._minutesInterval}}this.rsCont.onclick=function(v){v=v||event;if(v.type=="touchstart"&&v.preventDefault!=null){v.preventDefault()}v.cancelBubble=true;var y=(v.target||v.srcElement);if(y._minutes!=null){if(r._minutesInterval==1){var z=r.getFormatedDate("%i");if(r._selectorMode==1){z=y._minutes.toString()+z.charAt(1)}else{z=z.charAt(0)+y._minutes.toString()}r._activeDate.setMinutes(Number(z));r.callEvent("onTimeChange",[new Date(r._activeDate.getTime())]);r._hideSelector();if(r._selectorMode==1){r._updateVisibleMinutes(true);r._selectorMode=2;r._showSelector("minutes",r._sel._x,r._sel._y,"selector_minutes",true);r._updateActiveMinutes();return}else{r._selectorMode=1}}else{r._hideSelector();r._activeDate.setMinutes(y._minutes);r._updateActiveMinutes();r.callEvent("onTimeChange",[new Date(r._activeDate.getTime())])}r._updateVisibleMinutes();r._doOnSelectorChange()}};if(this.conf.touch==true){this.rsCont.ontouchstart=this.rsCont.onclick}}this._sel._ta[j]=true};this._showSelector=function(e,b,d,f,c){if(c===true&&this._sel!=null&&this._isSelectorVisible()&&e==this._sel._t){this._hideSelector();return}if(this.conf.skin=="dhx_terrace"){b+=12}if(!this._sel||!this._sel._ta[e]){this._initSelector(e,f)}if(e!=this._sel._t&&this._sel._t=="minutes"&&this._minutesInterval==1){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i")}this._sel._x=b;this._sel._y=d;this._sel.style.visibility="hidden";this._sel.style.display="";this._selCover.style.width=this.base.offsetWidth-2+"px";this._selCover.style.top=this.contMonth.offsetHeight+"px";this._selCover.style.height=this.contDates.offsetHeight+this.contDays.offsetHeight-1+"px";this._selCover.style.display="";this._sel._t=e;this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+f+(e=="hours"&&this.conf.today==true?"2":"");this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display=this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display=(e=="year"?"":"none");var g=Math.max(0,b-Math.round(this._sel.offsetWidth/2));if(g+this._sel.offsetWidth>this._sel.parentNode.offsetWidth){g=this._sel.parentNode.offsetWidth-this._sel.offsetWidth}this._sel.style.left=g+"px";if(e=="hours"||e=="minutes"){this._sel.style.top=d-this._sel.offsetHeight+"px"}else{this._sel.style.top=d+"px"}this._sel.childNodes[1].style.width=this._sel.childNodes[0].offsetWidth+"px";this._sel.style.visibility="visible";this._doOnSelectorShow(e)};this._doOnSelectorShow=function(b){if(b=="month"){this._updateActiveMonth()}if(b=="year"){this._updateYearsList(this._activeMonth)}if(b=="hours"){this._updateActiveHours()}if(b=="minutes"){this._updateActiveMinutes()}};this._hideSelector=function(b){if(!this._sel){return}this._sel.style.display="none";this._sel.style.visible="hidden";this._selCover.style.display="none";if(this._sel._t=="minutes"&&this._minutesInterval==1){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this.getFormatedDate("%i");this._unloadSelector("minutes")}};this._isSelectorVisible=function(){if(!this._sel){return false}return(this._sel.style.display!="none")};this._doOnSelectorChange=function(b){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),b===true])};this._clearSelHover=function(){if(!this._selHover){return}this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,""));this._selHover=null};this._unloadSelector=function(c){if(!this._sel){return}if(!this._sel._ta[c]){return}if(c=="month"){this.msCont.onclick=this.msCont.ontouchstart=null;this._msActive=null;for(var b in this._msCells){this._msCells[b]._cell=null;this._msCells[b]._month=null;this._msCells[b].parentNode.removeChild(this._msCells[b]);this._msCells[b]=null}this._msCells=null;while(this.msCont.childNodes.length>0){this.msCont.removeChild(this.msCont.lastChild)}this.msCont.parentNode.removeChild(this.msCont);this.msCont=null}if(c=="year"){this.ysCont.onclick=this.ysCont.ontouchstart=null;for(var b in this._ysCells){this._ysCells[b]._cell=null;this._ysCells[b]._year=null;this._ysCells[b].parentNode.removeChild(this._ysCells[b]);this._ysCells[b]=null}this._ysCells=null;while(this.ysCont.childNodes.length>0){this.ysCont.removeChild(this.ysCont.lastChild)}this.ysCont.parentNode.removeChild(this.ysCont);this.ysCont=null}if(c=="hours"){this.hsCont.onclick=this.hsCont.ontouchstart=null;this._hsActive=null;for(var b in this._hsCells){this._hsCells[b]._cell=null;this._hsCells[b]._hours=null;this._hsCells[b].parentNode.removeChild(this._hsCells[b]);this._hsCells[b]=null}this._hsCells=null;while(this.hsCont.childNodes.length>0){this.hsCont.removeChild(this.hsCont.lastChild)}this.hsCont.parentNode.removeChild(this.hsCont);this.hsCont=null}if(c=="minutes"){this.rsCont.onclick=this.rsCont.ontouchstart=null;this._rsActive=null;for(var b in this._rsCells){this._rsCells[b]._cell=null;this._rsCells[b]._minutes=null;this._rsCells[b].parentNode.removeChild(this._rsCells[b]);this._rsCells[b]=null}this._rsCells=null;while(this.rsCont.childNodes.length>0){this.rsCont.removeChild(this.rsCont.lastChild)}this.rsCont.parentNode.removeChild(this.rsCont);this.rsCont=null}this._sel._ta[c]=null};this.setMinutesInterval=function(b){if(!(b==1||b==5||b==10||b==15)){return}this._minutesInterval=b;this._unloadSelector("minutes")};this._updateActiveMonth=function(){if(typeof(this._msActive)!="undefined"&&typeof(this._msCells[this._msActive])!="undefined"){this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell"}this._msActive=this._activeMonth.getMonth();this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateActiveYear=function(){var b=this._activeMonth.getFullYear();if(this._ysCells[b]){this._ysCells[b].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"}};this._updateYearsList=function(c){for(var f in this._ysCells){this._ysCells[f]=null;delete this._ysCells[f]}var e=12*Math.floor(c.getFullYear()/12);for(var d=0;d<4;d++){for(var b=0;b<3;b++){this.ysCont.childNodes[d].childNodes[b].innerHTML=e;this.ysCont.childNodes[d].childNodes[b]._year=e;this.ysCont.childNodes[d].childNodes[b].className="dhtmlxcalendar_selector_cell";this._ysCells[e++]=this.ysCont.childNodes[d].childNodes[b]}}this._updateActiveYear()};this._scrollYears=function(c){var d=(c<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+c;var b=new Date(d,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(b)};this._updateActiveHours=function(){if(typeof(this._hsActive)!="undefined"&&typeof(this._hsCells[this._hsActive])!="undefined"){this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell"}this._hsActive=this._activeDate.getHours();this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)};this._updateActiveMinutes=function(){if(this._rsActive!=null&&typeof(this._rsActive)!="undefined"&&typeof(this._rsCells[this._rsActive])!="undefined"){this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell"}if(this._minutesInterval==1){this._rsActive=(this.getFormatedDate("%i").toString()).charAt(this._selectorMode==1?0:1)}else{this._rsActive=this._activeDate.getMinutes()}if(typeof(this._rsCells[this._rsActive])!="undefined"){this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"}};this._updateVisibleMinutes=function(b){var c=this._fixLength(this._activeDate.getMinutes(),2).toString();if(b==true){c=c.charAt(0)+"<span class='dhtmlxcalendar_selected_date'>"+c.charAt(1)+"</span>"}this.contTime.firstChild.firstChild.childNodes[3].innerHTML=c;if(b==true){this.contTime.firstChild.firstChild.childNodes[3].lastChild._par=true}};this._fixLength=function(c,b){while(String(c).length<b){c="0"+String(c)}return c};this._dateFormat="";this._dateFormatRE=null;this.setDateFormat=function(d){var e={};if(this._strToDate!=null){for(var b in this.i){if(this.i[b].input!=null&&this.i[b].input.value.length>0){var c=this._strToDate(this.i[b].input.value,this._dateFormat||this.langData[this.lang].dateformat||"%Y-%m-%d");if(c instanceof Date){e[b]=c}}}}this._dateFormat=d;var f=String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(g){var h=g.replace(/%/,"");switch(h){case"n":case"h":case"j":case"g":case"G":return"\\d{1,2}";case"m":case"d":case"H":case"i":case"s":case"y":return"\\d{2}";case"Y":return"\\d{4}";case"M":return"("+r.langData[r.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case"F":return"("+r.langData[r.lang].monthesFNames.join("|").toLowerCase()+"){1,}";case"D":return"[a-z]{2}";case"a":case"A":return"AM|PM";case"u":return"\\d{1,6}";case"P":return"[\\+\\-]\\d{1,2}\\:\\d{1,2}"}return g});this._dateFormatRE=new RegExp(f,"i");for(var b in e){this.i[b].input.value=this._dateToStr(e[b])}e=null};this.setDateFormat(this.langData[this.lang].dateformat||"%Y-%m-%d");this._updateDateStr=function(b){if(!this._dateFormatRE||!b.match(this._dateFormatRE)){return}if(b==this.getFormatedDate()){return}var c=this._strToDate(b);if(!(c instanceof Date)){return}if(this.checkEvent("onBeforeChange")){if(!this.callEvent("onBeforeChange",[new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds())])){this._updateInp();return}}this._nullDate=false;this._activeDate=c;this._drawMonth(this._nullDate?new Date():this._activeDate);this._updateVisibleMinutes();this._updateVisibleHours();if(this._sel&&this._isSelectorVisible()){this._doOnSelectorShow(this._sel._t)}this._doOnSelectorChange(true)};this.showMonth=function(b){if(typeof(b)=="string"){b=this._strToDate(b)}if(!(b instanceof Date)){return}this._drawMonth(b)};this.setFormatedDate=function(d,c,b,e){var f=this._strToDate(c,d);if(e){return f}this.setDate(f)};this.getFormatedDate=function(b,c){if(!(c&&c instanceof Date)){if(this._nullDate){return""}c=new Date(this._activeDate)}return this._dateToStr(c,b)};this.getWeekNumber=function(f){if(typeof(f)=="string"){f=this._strToDate(f)}if(!(f instanceof Date)){return"Invalid Date"}var b=f.getDay();if(b===0){b=7}var e=new Date(f.valueOf());e.setDate(f.getDate()+(4-b));var c=e.getFullYear();var d=Math.round((e.getTime()-new Date(c,0,1).getTime())/86400000);return 1+Math.floor(d/7)};this.showWeekNumbers=function(){this.base.firstChild.className="dhtmlxcalendar_wn"};this.hideWeekNumbers=function(){this.base.firstChild.className=""};this.show=function(c){if(!c&&this._hasParent){this._show();return}if(typeof(c)=="string"){var d=document.getElementById(c);if(d!=null&&typeof(d._dhtmlxcalendar_uid)!="undefined"&&this.i[d._dhtmlxcalendar_uid]!=null){this._show(d._dhtmlxcalendar_uid);return}}if(typeof(c)=="object"&&typeof(c._dhtmlxcalendar_uid)!="undefined"&&this.i[c._dhtmlxcalendar_uid]==c){this._show(c._dhtmlxcalendar_uid);return}if(typeof(c)=="undefined"){for(var b in this.i){if(!c){c=b}}}if(!c){return}this._show(c)};this.hide=function(){if(this._isVisible()){this._hide()}};this.isVisible=function(){return this._isVisible()};this._activeInp=null;this.pos="bottom";this.setPosition=function(c,b){this._px=null;this._py=null;if(c=="right"||c=="bottom"){this.pos=c}else{this.pos="int";if(typeof(c)!="undefined"&&!isNaN(c)){this.base.style.left=c+"px";this._px=c}if(typeof(b)!="undefined"&&!isNaN(b)){this.base.style.top=b+"px";this._py=b}this._ifrSize()}};this._show=function(e,b){if(b===true&&this._activeInp==e&&this._isVisible()){this._hide();return}this.base.style.visibility="hidden";this.base.style.display="";if(!e){if(this._px!=null&&this._py!=null){this.base.style.left=this._px+"px";this.base.style.top=this._py+"px"}else{this.base.style.left="0px";this.base.style.top="0px"}}else{if(this.base.className.indexOf("dhtmlxcalendar_in_input")==-1){this.base.className+=" dhtmlxcalendar_in_input"}var i=(this.i[e].input||this.i[e].button);var d=window.dhx4.screenDim();var f={top:window.dhx4.absTop(i),left:window.dhx4.absLeft(i)};if(this.pos=="right"){this.base.style.left=f.left+i.offsetWidth+"px";this.base.style.top=Math.min(f.top,d.bottom-this.base.offsetHeight)+"px"}else{if(this.pos=="bottom"){var g=f.top+i.offsetHeight+1;if(g+this.base.offsetHeight>d.bottom){var h=f.top-this.base.offsetHeight;if(h>=-20){g=h}}var c=f.left;if(c+this.base.offsetWidth>d.right){c=Math.max(0,f.left+i.offsetWidth-this.base.offsetWidth)}this.base.style.left=c+"px";this.base.style.top=g+"px"}else{this.base.style.left=(this._px||0)+"px";this.base.style.top=(this._py||0)+"px"}}this._activeInp=e;i=null}this._hideSelector();this.base.style.visibility="visible";this.base.style.zIndex=window.dhx4.zim.reserve(this.conf.zi);this._ifrSize();if(this._ifr){this._ifr.style.display=""}this.callEvent("onShow",[])};this._hide=function(){if(this._lastHover!=null){this._clearDayHover()}this._hideSelector();this.base.style.display="none";window.dhx4.zim.clear(this.conf.zi);if(this.base.className.indexOf("dhtmlxcalendar_in_input")>=0){this.base.className=this.base.className.replace(/\s{0,}dhtmlxcalendar_in_input/gi,"")}this._activeInp=null;if(this._ifr){this._ifr.style.display="none"}this.callEvent("onHide",[])};this._isVisible=function(){return(this.base.style.display!="none")};this._rangeActive=false;this._rangeFrom=null;this._rangeTo=null;this._rangeSet={};this.setInsensitiveDays=function(d){var c=this._extractDates(d);for(var b=0;b<c.length;b++){this._rangeSet[new Date(c[b].getFullYear(),c[b].getMonth(),c[b].getDate(),0,0,0,0).getTime()]=true}this._drawMonth(this._activeMonth)};this.clearInsensitiveDays=function(){this._clearRangeSet();this._drawMonth(this._activeMonth)};this._holidays={};this.setHolidays=function(b){if(b==null){this._clearHolidays()}else{if(b!=null){var c=this._extractDates(b);for(var d=0;d<c.length;d++){this._holidays[new Date(c[d].getFullYear(),c[d].getMonth(),c[d].getDate(),0,0,0,0).getTime()]=true}}}this._drawMonth(this._activeMonth)};this._extractDates=function(f){if(typeof(f)=="string"||f instanceof Date){f=[f]}var b=[];for(var e=0;e<f.length;e++){if(typeof(f[e])=="string"){var d=f[e].split(",");for(var c=0;c<d.length;c++){b.push(this._strToDate(d[c]))}}else{if(f[e] instanceof Date){b.push(f[e])}}}return b};this._clearRange=function(){this._rangeActive=false;this._rangeType=null;this._rangeFrom=null;this._rangeTo=null};this._clearRangeSet=function(){for(var b in this._rangeSet){this._rangeSet[b]=null;delete this._rangeSet[b]}};this._clearHolidays=function(){for(var b in this._holidays){this._holidays[b]=null;delete this._holidays[b]}};this._isOutOfRange=function(b){if(this._rangeSet[b]==true){return true}if(this._rangeActive){if(this._rangeType=="in"&&(b<this._rangeFrom||b>this._rangeTo)){return true}if(this._rangeType=="out"&&(b>=this._rangeFrom&&b<=this._rangeTo)){return true}if(this._rangeType=="from"&&b<this._rangeFrom){return true}if(this._rangeType=="to"&&b>this._rangeTo){return true}}var c=new Date(b);if(this._rangeWeek){if(this._rangeWeekData[c.getDay()]===true){return true}}if(this._rangeMonth){if(this._rangeMonthData[c.getDate()]===true){return true}}if(this._rangeYear){if(this._rangeYearData[c.getMonth()+"_"+c.getDate()]===true){return true}}return false};this.clearSensitiveRange=function(){this._clearRange();this._drawMonth(this._activeMonth)};this.setSensitiveRange=function(d,e,c){var b=false;if(d!=null&&e!=null){if(!(d instanceof Date)){d=this._strToDate(d)}if(!(e instanceof Date)){e=this._strToDate(e)}if(d.getTime()>e.getTime()){return}this._rangeFrom=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0,0).getTime();this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime();this._rangeActive=true;this._rangeType="in";b=true}if(!b&&d!=null&&e==null){if(!(d instanceof Date)){d=this._strToDate(d)}this._rangeFrom=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0,0).getTime();this._rangeTo=null;if(c===true){this._rangeFrom++}this._rangeActive=true;this._rangeType="from";b=true}if(!b&&d==null&&e!=null){if(!(e instanceof Date)){e=this._strToDate(e)}this._rangeFrom=null;this._rangeTo=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0).getTime();if(c===true){this._rangeTo--}this._rangeActive=true;this._rangeType="to";b=true}if(b){this._drawMonth(this._activeMonth)}};this.setInsensitiveRange=function(b,c){if(b!=null&&c!=null){if(!(b instanceof Date)){b=this._strToDate(b)}if(!(c instanceof Date)){c=this._strToDate(c)}if(b.getTime()>c.getTime()){return}this._rangeFrom=new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0).getTime();this._rangeTo=new Date(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0,0).getTime();this._rangeActive=true;this._rangeType="out";this._drawMonth(this._activeMonth);return}if(b!=null&&c==null){this.setSensitiveRange(null,b,true);return}if(b==null&&c!=null){this.setSensitiveRange(c,null,true);return}};this.disableDays=function(c,d){if(c=="week"){if(typeof(d)!="object"&&typeof(d.length)=="undefined"){d=[d]}if(!this._rangeWeekData){this._rangeWeekData={}}for(var b in this._rangeWeekData){this._rangeWeekData[b]=false;delete this._rangeWeekData[b]}for(var e=0;e<d.length;e++){this._rangeWeekData[d[e]]=true;if(d[e]==7){this._rangeWeekData[0]=true}}this._rangeWeek=true}if(c=="month"){if(typeof(d)!="object"&&typeof(d.length)=="undefined"){d=[d]}if(!this._rangeMonthData){this._rangeMonthData={}}for(var b in this._rangeMonthData){this._rangeMonthData[b]=false;delete this._rangeMonthData[b]}for(var e=0;e<d.length;e++){this._rangeMonthData[d[e]]=true}this._rangeMonth=true}if(c=="year"){var f=this._extractDates(d);if(!this._rangeYearData){this._rangeYearData={}}for(var b in this._rangeYearData){this._rangeYearData[b]=false;delete this._rangeYearData[b]}for(var e=0;e<f.length;e++){this._rangeYearData[f[e].getMonth()+"_"+f[e].getDate()]=true}this._rangeYear=true}this._drawMonth(this._activeMonth)};this.enableDays=function(b){if(b=="week"){this._rangeWeek=false}if(b=="month"){this._rangeMonth=false}if(b=="year"){this._rangeYear=false}this._drawMonth(this._activeMonth)};this._tipData={};this._tipTM=null;this._tipTMTime=400;this._tipEvs=false;this._tipPopup=null;this._tipCellDate=null;this._tipCellDim=null;this.setTooltip=function(h,e,d,c){var g=this._extractDates(h);for(var f=0;f<g.length;f++){var b=new Date(g[f].getFullYear(),g[f].getMonth(),g[f].getDate(),0,0,0,0).getTime();this._tipData[b]={text:e,showIcon:d,usePopup:c}}this._drawMonth(this._activeMonth)};this.clearTooltip=function(b){var e=this._extractDates(b);for(var d=0;d<e.length;d++){var c=new Date(e[d].getFullYear(),e[d].getMonth(),e[d].getDate(),0,0,0,0).getTime();this._tipData[c]=null;delete this._tipData[c]}this._drawMonth(this._activeMonth)};this._initTooltipPopup=function(){if(this._tipEvs){return}this.attachEvent("onMouseOver",function(b){var c=new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0).getTime();if(this._tipData[c]!=null){if(this._tipTM){window.clearTimeout(this._tipTM)}this._tipCellDate=b;this._tipCellDim=this.getCellDimension(b);this._tipText=this._tipData[c].text;this._tipTM=window.setTimeout(this._showTooltipPopup,this._tipTMTime)}});this.attachEvent("onMouseOut",this._hideTooltipPopup);this._tipEvs=true};this._showTooltipPopup=function(e,c,d,b,f){if(!r._tipPopup){r._tipPopup=new dhtmlXPopup({mode:"top"})}r._tipPopup.attachHTML(r._tipText);r._tipPopup.show(r._tipCellDim.x,r._tipCellDim.y,r._tipCellDim.w,r._tipCellDim.h);r.callEvent("onPopupShow",[r._tipCellDate])};this._hideTooltipPopup=function(){if(this._tipTM){window.clearTimeout(this._tipTM)}if(this._tipPopup!=null&&this._tipPopup.isVisible()){this._tipPopup.hide();this.callEvent("onPopupHide",[this._tipCellDate])}};this.getPopup=function(){return this._tipPopup};this.getCellDimension=function(g){if(typeof(g)=="string"){g=this._strToDate(g)}if(!(g instanceof Date)){return null}var f=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0).getTime();var b=null;for(var e=0;e<this.contDates.childNodes.length;e++){for(var c=0;c<this.contDates.childNodes[e].childNodes.length;c++){var d=this.contDates.childNodes[e].childNodes[c];if(d._date!=null&&d._date.getTime()==f){b={x:window.dhx4.absLeft(d),y:window.dhx4.absTop(d),w:d.offsetWidth,h:d.offsetHeight}}d=null}}return b};this._updateFromInput=function(b){if(this._nullInInput&&((b.value).replace(/\s/g,"")).length==0){if(this.checkEvent("onBeforeChange")){if(!this.callEvent("onBeforeChange",[null])){this._updateInp();return}}this.setDate(null)}else{this._updateDateStr(b.value)}b=null};this._doOnClick=function(b){b=b||event;var c=(b.target||b.srcElement);if(c._dhtmlxcalendar_uid&&c._dhtmlxcalendar_uid!=r._activeInp&&r._isVisible()&&r._activeInp){r._hide();return}if(!c._dhtmlxcalendar_uid||!r.i[c._dhtmlxcalendar_uid]){if(r._isSelectorVisible()){r._hideSelector()}else{if(!r._hasParent&&r._isVisible()){r._hide()}}}};this._doOnKeyDown=function(b){b=b||event;if(b.keyCode==27||b.keyCode==13){if(r._isSelectorVisible()){r._hideSelector()}else{if(r._isVisible()&&!r._hasParent){r._hide()}}}};this._doOnInpClick=function(b){b=b||event;if(b.type=="touchstart"&&b.preventDefault!=null){b.preventDefault()}var c=(b.target||b.srcElement);if(!c._dhtmlxcalendar_uid){return}if(!r._listenerEnabled){r._updateFromInput(c)}r._show(c._dhtmlxcalendar_uid,true)};this._doOnInpKeyUp=function(b){b=b||event;var c=(b.target||b.srcElement);if(b.keyCode==13||!c._dhtmlxcalendar_uid){return}if(!r._listenerEnabled){r._updateFromInput(c)}};this._doOnBtnClick=function(b){b=b||event;if(b.type=="touchstart"&&b.preventDefault!=null){b.preventDefault()}var c=(b.target||b.srcElement);if(!c._dhtmlxcalendar_uid){return}if(r.i[c._dhtmlxcalendar_uid].input!=null){r._updateFromInput(r.i[c._dhtmlxcalendar_uid].input)}r._show(c._dhtmlxcalendar_uid,true)};this._doOnUnload=function(){if(r&&r.unload){r.unload()}};if(typeof(window.addEventListener)=="function"){document.body.addEventListener("click",r._doOnClick,false);window.addEventListener("keydown",r._doOnKeyDown,false);window.addEventListener("unload",r._doOnUnload,false);if(this.conf.touch==true){document.body.addEventListener("touchstart",r._doOnClick,false)}}else{document.body.attachEvent("onclick",r._doOnClick);document.body.attachEvent("onkeydown",r._doOnKeyDown);window.attachEvent("onunload",r._doOnUnload)}this.attachObj=function(c){var b=window.dhx4.newId();if(typeof(c)=="string"){this.i[b]={input:document.getElementById(c)}}else{if(typeof(c.tagName)!="undefined"){this.i[b]={input:c}}else{if(typeof(c)=="object"&&(c.input!=null||c.button!=null)){this.i[b]={};if(c.input!=null){this.i[b].input=(typeof(c.input)=="string"?document.getElementById(c.input):c.input)}if(c.button!=null){this.i[b].button=(typeof(c.button)=="string"?document.getElementById(c.button):c.button)}}}}this._attachEventsToObject(b);return b};this.detachObj=function(c){var d=null;if(this.i[c]!=null){d=c}else{if(typeof(c)=="string"){c=document.getElementById(c);d=c._dhtmlxcalendar_uid}else{if(typeof(c.tagName)!="undefined"){d=c._dhtmlxcalendar_uid}else{if(typeof(c)=="object"&&(c.input!=null||c.button!=null)){if(d==null&&c.input!=null){d=(typeof(c.input)=="string"?document.getElementById(c.input):c.input)._dhtmlxcalendar_uid}if(d==null&&c.button!=null){d=(typeof(c.button)=="string"?document.getElementById(c.button):c.button)._dhtmlxcalendar_uid}}}}}if(d!=null&&this.i[d]!=null){this._detachEventsFromObject(d);for(var b in this.i[b]){this.i[d][b]._dhtmlxcalendar_uid=null;this.i[d][b]=null;delete this.i[d][b]}this.i[d]=null;delete this.i[d];return true}return false};this._attachEventsToObject=function(b){if(this.i[b].button!=null){this.i[b].button._dhtmlxcalendar_uid=b;if(typeof(window.addEventListener)=="function"){this.i[b].button.addEventListener("click",r._doOnBtnClick,false);if(this.conf.touch==true){this.i[b].button.addEventListener("touchstart",r._doOnBtnClick,false)}}else{this.i[b].button.attachEvent("onclick",r._doOnBtnClick)}}else{if(this.i[b].input!=null){this.i[b].input._dhtmlxcalendar_uid=b;if(typeof(window.addEventListener)=="function"){this.i[b].input.addEventListener("click",r._doOnInpClick,false);this.i[b].input.addEventListener("keyup",r._doOnInpKeyUp,false);if(this.conf.touch==true){this.i[b].input.addEventListener("touchstart",r._doOnInpClick,false)}}else{this.i[b].input.attachEvent("onclick",r._doOnInpClick);this.i[b].input.attachEvent("onkeyup",r._doOnInpKeyUp)}}}};this._detachEventsFromObject=function(b){if(this.i[b].button!=null){if(typeof(window.addEventListener)=="function"){this.i[b].button.removeEventListener("click",r._doOnBtnClick,false);if(this.conf.touch==true){this.i[b].button.removeEventListener("touchstart",r._doOnBtnClick,false)}}else{this.i[b].button.detachEvent("onclick",r._doOnBtnClick)}}else{if(this.i[b].input!=null){if(typeof(window.addEventListener)=="function"){this.i[b].input.removeEventListener("click",r._doOnInpClick,false);this.i[b].input.removeEventListener("keyup",r._doOnInpKeyUp,false);if(this.conf.touch==true){this.i[b].input.removeEventListener("touchstart",r._doOnInpClick,false)}}else{this.i[b].input.detachEvent("onclick",r._doOnInpClick);this.i[b].input.detachEvent("onkeyup",r._doOnInpKeyUp)}}}};this._updateInp=function(){if(this.i!=null&&this._activeInp!=null&&this.i[this._activeInp]!=null&&this.i[this._activeInp].input!=null){this.i[this._activeInp].input.value=this.getFormatedDate()}};this.enableListener=function(b){if(!b){return}if(typeof(window.addEventListener)=="function"){b.addEventListener("focus",r._listenerEvFocus,false);b.addEventListener("blur",r._listenerEvBlur,false)}else{b.attachEvent("onfocus",r._listenerEvFocus);b.attachEvent("onblur",r._listenerEvBlur)}b=null};this.disableListener=function(b){if(!b){return}b._f0=false;if(this._tmListener){window.clearTimeout(this._tmListener)}if(typeof(window.addEventListener)=="function"){b.removeEventListener("focus",r._listenerEvFocus,false);b.removeEventListener("blur",r._listenerEvBlur,false)}else{b.detachEvent("onfocus",r._listenerEvFocus);b.detachEvent("onblur",r._listenerEvBlur)}b=null};this._startListener=function(b){if(this._tmListener){window.clearTimeout(this._tmListener)}if(typeof(b._v1)=="undefined"){b._v1=b.value}if(b._v1!=b.value){this._updateFromInput(b);b._v1=b.value}if(b._f0){this._tmListener=window.setTimeout(function(){r._startListener(b)},100)}};this._listenerEvFocus=function(b){b=b||event;var c=b.target||b.srcElement;c._f0=true;r._startListener(c);c=null};this._listenerEvBlur=function(b){b=b||event;var c=b.target||b.srcElement;c._f0=false;c=null};for(var o in this.i){this._attachEventsToObject(o)}window.dhx4._eventable(this);this._evOnArrowClick=function(b){return this.callEvent("onArrowClick",b)};this._evOnClick=function(b){return this.callEvent("onClick",b)};this._evOnMouseOut=function(b){return this.callEvent("onMouseOut",b)};this._evOnMouseOver=function(b){return this.callEvent("onMouseOver",b)};this.unload=function(){this._activeDate=null;this._activeDateCell=null;this._activeInp=null;this._activeMonth=null;this._dateFormat=null;this._dateFormatRE=null;this._lastHover=null;if(this._tmListener){window.clearTimeout(this._tmListener)}this._tmListener=null;if(typeof(window.addEventListener)=="function"){document.body.removeEventListener("click",r._doOnClick,false);window.removeEventListener("keydown",r._doOnKeyDown,false);window.removeEventListener("unload",r._doOnUnload,false);if(this.conf.touch==true){document.body.removeEventListener("touchstart",r._doOnClick,false)}}else{document.body.detachEvent("onclick",r._doOnClick);document.body.detachEvent("onkeydown",r._doOnKeyDown);window.detachEvent("onunload",r._doOnKeyDown)}this._doOnClick=null;this._doOnKeyDown=null;this._doOnUnload=null;for(var b in this.i){this.i[b]._dhtmlxcalendar_uid=null;this._detachEventsFromObject(b);this.disableListener(this.i[b].input);this.i[b]=null;delete this.i[b]}this.i=null;this._doOnInpClick=null;this._doOnInpKeyUp=null;window.dhx4._eventable(this,"clear");this.contMonth.onselectstart=null;this.contMonth.firstChild.firstChild.onclick=null;this.contMonth.firstChild.firstChild.ontouchstart=null;this.contMonth.firstChild.firstChild.firstChild.onmouseover=null;this.contMonth.firstChild.firstChild.firstChild.onmouseout=null;this.contMonth.firstChild.firstChild.lastChild.onmouseover=null;this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;while(this.contMonth.firstChild.firstChild.childNodes.length>0){this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild)}this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);this.contMonth.removeChild(this.contMonth.firstChild);this.contMonth.parentNode.removeChild(this.contMonth);this.contMonth=null;while(this.contDays.firstChild.childNodes.length>0){this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild)}this.contDays.removeChild(this.contDays.firstChild);this.contDays.parentNode.removeChild(this.contDays);this.contDays=null;this.contDates.onclick=null;this.contDates.ontouchstart=null;this.contDates.onmouseover=null;this.contDates.onmouseout=null;while(this.contDates.childNodes.length>0){while(this.contDates.lastChild.childNodes.length>0){this.contDates.lastChild.lastChild._css_date=null;this.contDates.lastChild.lastChild._css_month=null;this.contDates.lastChild.lastChild._css_weekend=null;this.contDates.lastChild.lastChild._css_hover=null;this.contDates.lastChild.lastChild._date=null;this.contDates.lastChild.lastChild._q=null;this.contDates.lastChild.lastChild._w=null;this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild)}this.contDates.removeChild(this.contDates.lastChild)}this.contDates.parentNode.removeChild(this.contDates);this.contDates=null;this.contTime.firstChild.firstChild.onclick=null;this.contTime.firstChild.firstChild.ontouchstart=null;while(this.contTime.firstChild.firstChild.childNodes.length>0){this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild)}this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);this.contTime.removeChild(this.contTime.firstChild);this.contTime.parentNode.removeChild(this.contTime);this.contTime=null;this._lastHover=null;this._unloadSelector("month");this._unloadSelector("year");this._unloadSelector("hours");this._unloadSelector("minutes");if(this._selCover){this._selCover.parentNode.removeChild(this._selCover);this._selCover=null}if(this._sel){for(var b in this._sel._ta){this._sel._ta[b]=null}this._sel._ta=null;this._sel._t=null;this._sel.onmouseover=null;this._sel.onmouseout=null;while(this._sel.firstChild.firstChild.firstChild.childNodes.length>0){this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null;this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null;this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null;this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild)}this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);while(this._sel.childNodes.length>0){this._sel.removeChild(this._sel.lastChild)}this._sel.parentNode.removeChild(this._sel);this._sel=null}this.base.onclick=null;this.base.onmousedown=null;this.base.ontouchstart=null;this.base.onmouseout=null;this.base.parentNode.removeChild(this.base);this.base=null;this._clearDayHover=null;this._clearSelHover=null;this._doOnSelectorChange=null;this._doOnSelectorShow=null;this._drawMonth=null;this._fixLength=null;this._ifrSize=null;this._hide=null;this._hideSelector=null;this._initSelector=null;this._isSelectorVisible=null;this._isVisible=null;this._scrollYears=null;this._show=null;this._showSelector=null;this._strToDate=null;this._updateActiveHours=null;this._updateActiveMinutes=null;this._updateActiveMonth=null;this._updateActiveYear=null;this._updateCellStyle=null;this._updateDateStr=null;this._updateVisibleHours=null;this._updateVisibleMinutes=null;this._updateYearsList=null;this.enableIframe=null;this.hide=null;this.hideTime=null;this.setDate=null;this.setDateFormat=null;this.setYearsRange=null;this.show=null;this.showTime=null;this.unload=null;if(this._tipPopup!=null){this._tipPopup.unload();this._tipPopup=null}for(var b in this){delete this[b]}b=r=null};this.setDate(this._activeDate);return this}dhtmlXCalendarObject.prototype.lang="en";dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",hdrformat:"%F %Y",monthesFNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthesSNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysFNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysSNames:["Su","Mo","Tu","We","Th","Fr","Sa"],weekstart:1,weekname:"w",today:"Today",clear:"Clear"}};dhtmlXCalendarObject.prototype._buildMonthHdr=function(h){var f=this;var i=function(a){return(String(a).length==1?"0"+String(a):a)};var g=function(b,a){return"<span class='dhtmlxcalendar_month_label_"+b+"'>"+a+"</span>"};var j=String(this.langData[this.lang].hdrformat||("%F %Y")).replace(/%[a-z]/gi,function(a){switch(a){case"%m":return g("month",i(h.getMonth()+1));case"%n":return g("month",h.getMonth()+1);case"%M":return g("month",f.langData[f.lang].monthesSNames[h.getMonth()]);case"%F":return g("month",f.langData[f.lang].monthesFNames[h.getMonth()]);case"%y":return g("year",i(h.getYear()%100));case"%Y":return g("year",h.getFullYear());case"%%":return"%";default:return a}});f=i=g=null;return j};dhtmlXCalendarObject.prototype.enableIframe=function(b){if(b==true){if(!this._ifr){this._ifr=document.createElement("IFRAME");this._ifr.frameBorder=0;this._ifr.border=0;this._ifr.setAttribute("src","javascript:false;");this._ifr.className="dhtmlxcalendar_ifr";this._ifr.onload=function(){this.onload=null;this.contentWindow.document.open("text/html","replace");this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")};this.base.parentNode.insertBefore(this._ifr,this.base);this._ifrSize()}}else{if(this._ifr){this._ifr.parentNode.removeChild(this._ifr);this._ifr=null}}};dhtmlXCalendarObject.prototype._ifrSize=function(){if(this._ifr){this._ifr.style.left=this.base.style.left;this._ifr.style.top=this.base.style.top;this._ifr.style.width=this.base.offsetWidth+"px";this._ifr.style.height=this.base.offsetHeight+"px"}};dhtmlxCalendarObject=dhtmlXCalendarObject;dhtmlXCalendarObject.prototype._dateStrings=function(){var b=this.langData[this.lang];return{monthFullName:b.monthesFNames,monthShortName:b.monthesSNames,dayFullName:b.daysFNames,dayShortName:b.daysSNames}};dhtmlXCalendarObject.prototype._strToDate=function(c,d){return window.dhx4.str2date(c,d||this._dateFormat,this._dateStrings())};dhtmlXCalendarObject.prototype._dateToStr=function(c,d){return window.dhx4.date2str(c,d||this._dateFormat,this._dateStrings())};window.dhtmlxDblCalendarObject=window.dhtmlXDoubleCalendarObject=window.dhtmlXDoubleCalendar=function(c){var d=this;this.leftCalendar=new dhtmlXCalendarObject(c);this.leftCalendar.hideTime();this.rightCalendar=new dhtmlXCalendarObject(c);this.rightCalendar.hideTime();this.leftCalendar.attachEvent("onClick",function(a){d._updateRange("rightCalendar",a,null);d._evOnClick(["left",a])});this.rightCalendar.attachEvent("onClick",function(a){d._updateRange("leftCalendar",null,a);d._evOnClick(["right",a])});this.leftCalendar.attachEvent("onBeforeChange",function(a){return d._evOnBeforeChange(["left",a])});this.rightCalendar.attachEvent("onBeforeChange",function(a){return d._evOnBeforeChange(["right",a])});this.show=function(){this.leftCalendar.show();this.rightCalendar.base.style.marginLeft=this.leftCalendar.base.offsetWidth-1+"px";this.rightCalendar.show()};this.hide=function(){this.leftCalendar.hide();this.rightCalendar.hide()};this.setDateFormat=function(a){this.leftCalendar.setDateFormat(a);this.rightCalendar.setDateFormat(a)};this.setDates=function(a,b){if(a!=null){this.leftCalendar.setDate(a)}if(b!=null){this.rightCalendar.setDate(b)}this._updateRange()};this._updateRange=function(f,a,b){if(arguments.length==3){(f=="leftCalendar"?this.leftCalendar:this.rightCalendar).setSensitiveRange(a,b)}else{this.leftCalendar.setSensitiveRange(null,this.rightCalendar.getDate());this.rightCalendar.setSensitiveRange(this.leftCalendar.getDate(),null)}};this.getFormatedDate=function(){return this.leftCalendar.getFormatedDate.apply(this.leftCalendar,arguments)};this.unload=function(){window.dhx4._eventable(this,"clear");this.leftCalendar.unload();this.rightCalendar.unload();this.leftCalendar=this.rightCalendar=null;this._updateRange=null;this._evOnClick=null;this._evOnBeforeChange=null;this.show=null;this.hide=null;this.setDateFormat=null;this.setDates=null;this.getFormatedDate=null;this.unload=null;d=null};this._evOnClick=function(a){return this.callEvent("onClick",a)};this._evOnBeforeChange=function(a){return this.callEvent("onBeforeChange",a)};window.dhx4._eventable(this);return this};function dhtmlXCombo(q,m,t,o,r){var p=this;var s=null;var a=null;if(typeof(q)=="object"&&!q.tagName){s=q;q=s.parent;t=s.width;m=s.name;o=s.mode;a=s.skin}this.cont=(typeof(q)=="string"?document.getElementById(q):q);this.conf={skin:null,form_name:m||"dhxcombo",combo_width:(parseInt(t)||this.cont.offsetWidth||120)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),combo_image:false,combo_focus:false,opts_type:(typeof(o)=="string"&&typeof(this.modes[o])!="undefined"?o:"option"),opts_count:8,opts_count_min:3,opts_width:null,item_h:null,list_zi_id:window.dhx4.newId(),allow_free_text:true,allow_empty_value:true,free_text_empty:false,enabled:true,btn_left:((window.dhx4.isIE6||window.dhx4.isIE7||window.dhx4.isIE8)&&typeof(window.addEventListener)=="undefined"?1:0),ro_mode:false,ro_text:"",ro_tm:null,ro_tm_time:750,img_path:"",img_def:"",img_def_dis:true,template:{header:true,input:"#text#",option:"#text#"},f_func:null,f_mode:false,f_url:false,f_cache:false,f_cache_data:{},f_dyn:false,f_dyn_end:false,f_mask:"",f_ac:true,f_ac_text:"",f_server_tm:null,f_server_last:"",f_loading:false,s_tm:null,s_time:200,s_mode:"select",last_hover:null,last_selected:null,last_match:null,last_text:"",last_value:"",tm_hover:null,tm_confirm_blur:null,clear_click:false,clear_blur:false,clear_bsp:false,clear_key:false,i_ofs:23,sp:{dhx_skyblue:{list_ofs:1,hdr_ofs:1,scr_ofs:1},dhx_web:{list_ofs:0,hdr_ofs:1,scr_ofs:0},dhx_terrace:{list_ofs:1,hdr_ofs:1,scr_ofs:1},material:{list_ofs:0,hdr_ofs:1,scr_ofs:1}},col_w:null};this.conf.combo_image=(this.modes[this.conf.opts_type].image==true);this.t={};this.base=document.createElement("DIV");this.base.style.width=this.conf.combo_width+"px";this.base.innerHTML="<input type='text' class='dhxcombo_input' style='width:"+(this.conf.combo_width-(this.conf.i_ofs+1)-(this.conf.combo_image?this.conf.i_ofs:0))+"px;"+(this.conf.combo_image?"margin-left:"+this.conf.i_ofs+"px;":"")+"' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>"+(this.conf.combo_image?"<div class='dhxcombo_top_image'>"+this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)+"</div>":"");this.cont.appendChild(this.base);this.list=document.createElement("DIV");this.list._listId=window.dhx4.newId();this.list.style.display="none";document.body.insertBefore(this.list,document.body.firstChild);this._doOnListScroll=function(){if(p.conf.s_tm!=null){window.clearTimeout(p.conf.s_tm)}p.conf.s_tm=window.setTimeout(p._doOnListScrollAction,p.conf.s_time)};this._doOnListScrollAction=function(){p.conf.s_tm=null;if(p.conf.s_mode=="scroll"&&p.list.scrollHeight-p.list.scrollTop-10<p.list.clientHeight){p._subloadRequest()}};if(typeof(window.addEventListener)=="function"){this.list.addEventListener("scroll",this._doOnListScroll,false)}else{this.list.attachEvent("onscroll",this._doOnListScroll)}this.setSkin(a||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxcombo")||"material");this._updateTopImage=function(b){if(!this.conf.combo_image){return}if(b!=null){this.base.lastChild.innerHTML=this.t[b].obj.getTopImage(this.t[b].item,this.conf.enabled)}else{this.base.lastChild.innerHTML=this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)}};this._filterOpts=function(i){if(this.conf.f_server_tm){window.clearTimeout(this.conf.f_server_tm)}var c=String(this.base.firstChild.value).replace(new RegExp(this._fixRE(this.conf.f_ac_text)+"$","i"),"");if(this.conf.f_server_last==c.toLowerCase()){this._checkForMatch();return}if(this.conf.f_url!=null&&this.checkEvent("onDynXLS")){this.conf.f_server_last=c.toLowerCase();this.callEvent("onDynXLS",[c]);return}if(this.conf.f_url!=null){if(c.length==0){this.conf.f_server_last=c.toLowerCase();this.clearAll();return}if(this.conf.f_cache==true&&this.conf.f_cache_data[c]!=null){this.clearAll();this.conf.f_server_last=c.toLowerCase();for(var d=0;d<this.conf.f_cache_data[c].data.length;d++){this.load(this.conf.f_cache_data[c].data[d])}if(this.conf.f_dyn){this.conf.f_dyn_end=this.conf.f_cache_data[c].dyn_end;this.conf.f_mask=this.conf.f_cache_data[c].mask}if(i!==true){this._showList(true);this._checkForMatch()}}else{this.conf.f_server_tm=window.setTimeout(function(){p.conf.f_server_last=c.toLowerCase();p.conf.f_mask=c;var v="mask="+encodeURIComponent(c);if(p.conf.f_dyn){v+="&pos=0";p.conf.f_dyn_end=false}var l=function(C){if(p.conf.f_cache){if(!p.conf.f_cache_data[c]){p.conf.f_cache_data[c]={data:[],dyn_end:false,mask:c}}p.conf.f_cache_data[c].data.push(C.xmlDoc.responseXML)}p.clearAll();p.load(C.xmlDoc.responseText);var D=(p.base.offsetWidth>0&&p.base.offsetHeight>0);if(D==true&&p.conf.enabled==true&&p.conf.combo_focus==true&&i!==true){if(p.conf.f_ac&&p.conf.f_mode=="start"&&p.conf.clear_bsp==false&&p.list.firstChild!=null){var x=p.list.firstChild._optId;var w=String(p.t[x].obj.getText(p.list.firstChild,true));if(c==p.base.firstChild.value&&String(w).toLowerCase().indexOf(String(c).toLowerCase())===0){p.base.firstChild.value=w;p.conf.f_ac_text=w.substr(c.length);p._selectRange(c.length,w.length)}}p._showList(true);p._checkForMatch()}l=null};if(window.dhx4.ajax.method=="post"){window.dhx4.ajax.post(p.conf.f_url,v,l)}else{if(window.dhx4.ajax.method=="get"){window.dhx4.ajax.get(p.conf.f_url+(String(p.conf.f_url).indexOf("?")>=0?"&":"?")+v,l)}}},200)}}else{this.conf.f_server_last=c.toLowerCase();var e=(c.length==0?true:new RegExp((this.conf.f_mode=="start"?"^":"")+this._fixRE(c),"i"));var b=null;for(var h in this.t){var f=false;if(e!==true){if(this.conf.f_func!=null){var j=this._getOption(this.t[h].item._optId,d);f=(this.conf.f_func.apply(window,[c,j])==true)}else{var g=this.t[h].obj.getText(this.t[h].item,true);f=(e.test(g)==true)}}if(e===true||f==true){this.t[h].item.style.display="";if(b==null&&c.length>0){b=String(this.t[h].obj.getText(this.t[h].item,true))}}else{this.t[h].item.style.display="none"}}if(this.conf.f_ac&&this.conf.f_mode=="start"&&this.conf.clear_bsp==false&&b!=null){this.conf.f_ac_text=b.replace(new RegExp("^"+c,"i"),"");this.base.firstChild.value=b;this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)}if(this.conf.f_mode=="between"&&this.conf.clear_bsp==true){this._checkForMatch(true)}if(i!==true){this._showList(true);this._checkForMatch()}}};this._searchRO=function(b){if(this.conf.ro_tm){window.clearTimeout(this.conf.ro_tm)}this.conf.ro_text+=b;this._showList();for(var e=0;e<this.list.childNodes.length;e++){var c=this.list.childNodes[e]._optId;var d=String(this.t[c].obj.getText(this.list.childNodes[e],true)).toLowerCase();if(d.indexOf(this.conf.ro_text)===0){this._setSelected(c,true,true);this._confirmSelect("script",false);break}}this.conf.ro_tm=window.setTimeout(function(){p.conf.ro_text=""},this.conf.ro_tm_time)};this._fixRE=function(b){return String(b).replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/gi,"\\$&")};this._initObj=function(b){if(typeof(b.template)!="undefined"){this.setTemplate(b.template)}if(b.add!=true&&this.conf.f_loading!=true){this.clearAll(false)}this.addOption(b.options)};this._xmlToObj=function(c,O,P){var j={add:false,options:[]};var L=(O==true?c:c.getElementsByTagName("complete"));if(L.length>0){if(window.dhx4.s2b(L[0].getAttribute("add"))==true){j.add=true}var N=L[0].childNodes;for(var d=0;d<N.length;d++){if(typeof(N[d].tagName)!="undefined"){if(String(N[d].tagName).toLowerCase()=="template"){var e={};for(var w=0;w<N[d].childNodes.length;w++){var b=N[d].childNodes[w];if(b.tagName!=null){var K=b.tagName;if(typeof(this.conf.template[K])!="undefined"){e[K]=window.dhx4._xmlNodeValue(b)}if(K=="columns"){for(var i=0;i<b.childNodes.length;i++){var M=b.childNodes[i];if(M.tagName!=null&&M.tagName=="column"){var f={};for(var g in {width:1,css:1,header:1,option:1}){if(M.getAttribute(g)!=null){f[g]=M.getAttribute(g)}}for(var g in {header:1,option:1}){var l=M.getElementsByTagName(g);if(l[0]!=null&&l[0].firstChild!=null){f[g]=window.dhx4._xmlNodeValue(l[0])}}if(e.columns==null){e.columns=[]}e.columns.push(f)}M=null}}}b=null}this.setTemplate(e)}if(String(N[d].tagName).toLowerCase()=="option"){var h=false;if(O==true){h=(j.options.length==P)}else{h=window.dhx4.s2b(N[d].getAttribute("selected"))}var Q={value:N[d].getAttribute("value"),text:window.dhx4._xmlNodeValue(N[d]),selected:h,checked:window.dhx4.s2b(N[d].getAttribute("checked"))};for(var g in {img:1,img_dis:1,img_src:1,img_src_dis:1,css:1}){if(N[d].getAttribute(g)!=null){Q[g]=N[d].getAttribute(g)}}for(var w=0;w<N[d].childNodes.length;w++){if(N[d].childNodes[w].tagName!=null&&String(N[d].childNodes[w].tagName).toLowerCase()=="text"){Q.text={};var b=N[d].childNodes[w];for(var i=0;i<b.childNodes.length;i++){if(b.childNodes[i].tagName!=null){Q.text[b.childNodes[i].tagName]=window.dhx4._xmlNodeValue(b.childNodes[i])}}}}j.options.push(Q)}}}L=N=null}return j};window.dhx4._enableDataLoading(this,"_initObj","_xmlToObj","complete",{data:true});window.dhx4._eventable(this);this._getNearItem=function(d,b){var c=null;while(d!=null){d=d[b<0?"previousSibling":"nextSibling"];if(c==null&&d!=null&&d.style.display==""&&d._optId!=null){c=d;d=null}}return c};this.setName(this.conf.form_name);this._doOnListMouseMove=function(b){b=b||event;var c=b.target||b.srcElement;while(c!=null&&c!=this){if(typeof(c._optId)!="undefined"){if(p.conf.tm_hover){window.clearTimeout(p.conf.tm_hover)}p._setSelected(c._optId,false,false,true)}c=c.parentNode}c=null};this._doOnListMouseDown=function(b){b=b||event;b.cancelBubble=true;p.conf.clear_click=true;window.setTimeout(function(){p.base.firstChild.focus()},1)};this._doOnListMouseUp=function(d){d=d||event;if(d.button!=p.conf.btn_left){return}var c=d.target||d.srcElement;while(c!=null&&c!=this){if(typeof(c._optId)!="undefined"){var b=true;if(typeof(p.t[c._optId].obj.optionClick)=="function"&&p.t[c._optId].obj.optionClick(c,d,p)!==true){b=false}if(b){p._setSelected(c._optId,null,true);p._confirmSelect("click")}}c=c.parentNode}c=null};this._doOnListMouseOut=function(b){if(p.conf.tm_hover){window.clearTimeout(p.conf.tm_hover)}p.conf.tm_hover=window.setTimeout(function(){var c=p.conf.last_match||p.conf.last_selected;if(p.conf.last_match==null&&p.t[c]!=null){if(p.base.firstChild.value!=p.t[c].obj.getText(p.t[c].item,true)){c=null}}p._setSelected(c,null,true,true)},1)};this._doOnBaseMouseDown=function(d){if(!p.conf.enabled){return}p.conf.clear_click=true;d=d||event;if(d.button!=p.conf.btn_left){return}var b=d.target||d.srcElement;if(b!=this.firstChild){window.setTimeout(function(){p.base.firstChild.focus()},1);var e=b;while(e!=this&&e!=null){if(e==this.lastChild){if(typeof(p.modes[p.conf.opts_type].topImageClick)=="function"){var f=(p.conf.last_hover||p.conf.last_selected);var c=(f!=null?p.t[f].item:null);if(p.modes[p.conf.opts_type].topImageClick(c,p)!==true){f=c=null;return}}e=null}else{e=e.parentNode}}}if(p._isListVisible()){p._hideList()}else{if(b!=this.firstChild){p.conf.clear_blur=true}p._showList();p._setSelected(p.conf.last_selected,true,true)}b=null};this._doOnBodyMouseDown=function(){if(p.conf.clear_click){p.conf.clear_click=false;return}p._confirmSelect("blur")};this._doOnInputFocus=function(){p.conf.clear_blur=false;if(p.conf.tm_confirm_blur){window.clearTimeout(p.conf.tm_confirm_blur)}if(p.conf.combo_focus==false){p.conf.combo_focus=true;if(p.conf.skin=="material"&&p.base.className.match(/dhxcombo_actv/)==null){p.base.className+=" dhxcombo_actv"}p.callEvent("onFocus",[])}};this._doOnInputBlur=function(){if(p.conf.clear_blur==true){p.conf.clear_blur=false;return}if(p.conf.tm_confirm_blur){window.clearTimeout(p.conf.tm_confirm_blur)}p.conf.tm_confirm_blur=window.setTimeout(function(){if(p.conf.clear_click==false){p._confirmSelect("blur");p.conf.combo_focus=false;if(p.conf.skin=="material"&&p.base.className.match(/dhxcombo_actv/)!=null){p.base.className=p.base.className.replace(/\s*dhxcombo_actv/gi,"")}p.callEvent("onBlur",[])}},20)};this._doOnInputKeyUp=function(b){b=b||event;if(p.conf.f_mode!=false){p.conf.clear_bsp=(b.keyCode==8||b.keyCode==46);p._filterOpts();return}else{p._checkForMatch()}};this._doOnInputKeyDown=function(b){b=b||event;if((b.keyCode==38||b.keyCode==40)&&!b.ctrlKey&&!b.shiftKey&&!b.altKey){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}b.cancelBubble=true;p._keyOnUpDown(b.keyCode==38?-1:1)}if(b.keyCode==113){if(!p._isListVisible()){p._showList();if(p.base.firstChild.value==p.conf.last_text){p._setSelected(p.conf.last_selected,true,true);p.base.firstChild.value=p.conf.last_text;p.conf.f_server_last=p.base.firstChild.value.toLowerCase()}else{p.conf.f_server_last=p.base.firstChild.value.toLowerCase();if(p.conf.f_mode==false){p._checkForMatch()}}}else{}}if(b.keyCode==27){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}b.cancelBubble=true;p._cancelSelect()}if(b.keyCode==13){if(b.preventDefault){b.preventDefault()}p._confirmSelect("kbd")}if(p.conf.ro_mode==true&&((b.keyCode>=48&&b.keyCode<=57)||(b.keyCode>=65&&b.keyCode<=90))){p._searchRO(String.fromCharCode(b.keyCode).toLowerCase());b.cancelBubble=true}p.conf.clear_key=true;p.callEvent("onKeyPressed",[b.keyCode||b.charCode])};this._doOnInputKeyPress=function(b){if(p.conf.clear_key){p.conf.clear_key=false;return}b=b||event;p.callEvent("onKeyPressed",[b.keyCode||b.charCode])};this._keyOnUpDown=function(c){var b=null;if(this.conf.last_hover){b=this.t[this.conf.last_hover].item}else{if(this.conf.last_selected){b=this.t[this.conf.last_selected].item}}if(!b&&this._getListVisibleCount()==0){return}if(b!=null&&b.style.display!=""){b=null}this._showList();if(b!=null){if(this.t[b._optId].obj.isSelected(b)){b=this._getNearItem(b,c)}}else{b=this.list.firstChild;if(b.style.display!=""){b=this._getNearItem(b,1)}}if(b==null){return}this._setSelected(b._optId,true,true);if(this.conf.f_mode==false){this.base.firstChild.value=this.t[b._optId].obj.getText(b,true)}else{var d=String(this.t[b._optId].obj.getText(b,true));if(this.conf.f_mode=="start"&&this.conf.f_ac==true){if(d.toLowerCase().indexOf(this.conf.f_server_last)===0){this.conf.f_ac_text=d.substring(this.conf.f_server_last.length,d.length);this.base.firstChild.value=d;this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)}else{this.base.firstChild.value=d;this.conf.f_server_last=this.base.firstChild.value.toLowerCase();this._selectRange(0,this.base.firstChild.value.length)}}else{this.base.firstChild.value=d;this.conf.f_server_last=this.base.firstChild.value.toLowerCase()}}b=null};this.conf.evs_nodes=[{node:document.body,evs:{mousedown:"_doOnBodyMouseDown"}},{node:this.base,evs:{mousedown:"_doOnBaseMouseDown"}},{node:this.base.firstChild,evs:{keyup:"_doOnInputKeyUp",keydown:"_doOnInputKeyDown",keypress:"_doOnInputKeyPress",focus:"_doOnInputFocus",blur:"_doOnInputBlur"}},{node:this.list,evs:{mousemove:"_doOnListMouseMove",mousedown:"_doOnListMouseDown",mouseup:"_doOnListMouseUp",mouseout:"_doOnListMouseOut"}}];for(var u=0;u<this.conf.evs_nodes.length;u++){for(var n in this.conf.evs_nodes[u].evs){if(typeof(window.addEventListener)=="function"){this.conf.evs_nodes[u].node.addEventListener(n,this[this.conf.evs_nodes[u].evs[n]],false)}else{this.conf.evs_nodes[u].node.attachEvent("on"+n,this[this.conf.evs_nodes[u].evs[n]])}}}this.unload=function(){this.clearAll();this.t=null;for(var c=0;c<this.conf.evs_nodes.length;c++){for(var b in this.conf.evs_nodes[c].evs){if(typeof(window.addEventListener)=="function"){this.conf.evs_nodes[c].node.removeEventListener(b,this[this.conf.evs_nodes[c].evs[b]],false)}else{this.conf.evs_nodes[c].node.detachEvent("on"+b,this[this.conf.evs_nodes[c].evs[b]])}this.conf.evs_nodes[c].evs[b]=null;delete this.conf.evs_nodes[c].evs[b]}this.conf.evs_nodes[c].node=null;this.conf.evs_nodes[c].evs=null;delete this.conf.evs_nodes[c].node;delete this.conf.evs_nodes[c].evs;this.conf.evs_nodes[c]=null}window.dhx4._eventable(this,"clear");window.dhx4._enableDataLoading(this,null,null,null,"clear");this._mcDetachHeader();this.DOMelem_input=this.DOMelem_button=this.DOMlist=this.DOMelem=this.DOMParent=null;for(var b in this.conf){this.conf[b]=null;delete this.conf[b]}this.conf=null;if(typeof(window.addEventListener)=="function"){this.list.removeEventListener("scroll",this._doOnListScroll,false)}else{this.list.detachEvent("onscroll",this._doOnListScroll)}this.base.parentNode.removeChild(this.base);this.list.parentNode.removeChild(this.list);this.base=this.list=this.cont=null;this.modes=null;for(var b in this){if(typeof(this[b])=="function"){this[b]=null}}p=null};this.DOMelem_input=this.base.firstChild;this.DOMelem_button=this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)];this.DOMlist=this.list;this.DOMelem=this.base;this.DOMParent=q;q=null;if(s!=null){if(s.filter!=null){if(typeof(s.filter)=="string"){this.enableFilteringMode(true,s.filter,window.dhx4.s2b(s.filter_cache),window.dhx4.s2b(s.filter_sub_load))}else{this.enableFilteringMode(true)}}if(s.image_path!=null){this.setImagePath(s.image_path)}if(s.default_image!=null||s.default_image_dis!=null){this.setDefaultImage(s.default_image,s.default_image_dis)}if(s.items||s.options){this.addOption(s.items||s.options)}if(s.xml||s.json){this.load(s.xml||s.json)}if(typeof(s.readonly)!="undefined"){this.readonly(s.readonly)}s=null}return this}function dhtmlXComboFromSelect(s){if(typeof(s)=="string"){s=document.getElementById(s)}var t=s.offsetWidth;var l=s.getAttribute("name")||null;var r=document.createElement("SPAN");s.parentNode.insertBefore(r,s);var p=s.getAttribute("mode")||s.getAttribute("opt_type")||"option";var q=new dhtmlXCombo(r,l,t,p);r=null;var n=s.getAttribute("imagePath");if(n){q.setImagePath(n)}var m=s.getAttribute("defaultImage");var o=s.getAttribute("defaultImageDis");if(window.dhx4.s2b(o)==true){o=true}if(m!=null||o!=null){q.setDefaultImage(m,o)}var u=q._xmlToObj([s],true,s.selectedIndex);if(u.options.length>0){q.addOption(u.options)}u=null;s.parentNode.removeChild(s);s=null;return q}dhtmlXCombo.prototype.setName=function(b){this.conf.form_name=b;this.base.childNodes[1].name=b;this.base.childNodes[2].name=b.replace(/(\[.*)?$/,"_new_value$1")};dhtmlXCombo.prototype.readonly=function(b){if(window.dhx4.s2b(b)){this.base.firstChild.setAttribute("readOnly","true");this.conf.ro_mode=true}else{this.base.firstChild.removeAttribute("readOnly");this.conf.ro_mode=false}};dhtmlXCombo.prototype.setPlaceholder=function(b){if(typeof(b)=="undefined"||b==null){b=""}this.base.firstChild.setAttribute("placeholder",String(b))};dhtmlXCombo.prototype.setTemplate=function(d){for(var a in d){if(typeof(this.conf.template[a])!="undefined"){if(a=="header"){this.conf.template[a]=window.dhx4.s2b(d[a])}else{this.conf.template[a]=String(d[a])}}}if(d.columns!=null){this._mcMakeTemplate(d.columns)}else{this._mcDetachHeader()}for(var a in this.t){this.t[a].obj.setText(this.t[a].item,this.t[a].item._conf.text)}this._confirmSelect("template")};dhtmlXCombo.prototype.setSkin=function(b){if(b==this.conf.skin){return}this.conf.skin=b;this.base.className="dhxcombo_"+this.conf.skin+(this.conf.enabled?"":" dhxcombo_disabled");this.list.className="dhxcombolist_"+this.conf.skin+(this.hdr!=null?" dhxcombolist_multicolumn":"");if(this.hdr!=null){this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr"}this.conf.i_ofs=(b=="material"?26:23);this._adjustBase()};dhtmlXCombo.prototype.getInput=function(){return this.base.firstChild};dhtmlXCombo.prototype.getButton=function(){return this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)]};dhtmlXCombo.prototype.getList=function(){return this.list};dhtmlXCombo.prototype.getBase=function(){return this.base};dhtmlXCombo.prototype.getParent=function(){return this.DOMParent};dhtmlXCombo.prototype.forEachOption=function(d){for(var c=0;c<this.list.childNodes.length;c++){d.apply(window,[this._getOption(this.list.childNodes[c]._optId,c)])}};dhtmlXCombo.prototype.setFocus=function(){if(this.conf.enabled){this.base.firstChild.focus()}};dhtmlXCombo.prototype.setFontSize=function(d,c){if(d!=null){this.base.firstChild.style.fontSize=d}if(c!=null){this.list.style.fontSize=c}};dhtmlXCombo.prototype.getOption=function(h){var g=null;var j=null;for(var i=0;i<this.list.childNodes.length;i++){if(g==null){var a=this.list.childNodes[i]._optId;if(this.t[a].obj.getValue(this.t[a].item)==h){g=a;j=i}}}return(g==null?null:this._getOption(g,j))};dhtmlXCombo.prototype.getOptionByIndex=function(b){if(b<0){return null}if(this.list.childNodes[b]==null){return null}return this._getOption(this.list.childNodes[b]._optId,b)};dhtmlXCombo.prototype.getOptionByLabel=function(h){var g=null;var j=null;for(var i=0;i<this.list.childNodes.length;i++){if(g==null){var a=this.list.childNodes[i]._optId;if(this.t[a].obj.getText(this.t[a].item,true)==h){g=a;j=i}}}return(g==null?null:this._getOption(g,j))};dhtmlXCombo.prototype.getSelectedIndex=function(){return this._getOptionProp(this.conf.last_selected,"index",-1)};dhtmlXCombo.prototype.getSelectedText=function(){return this._getOptionProp(this.conf.last_selected,"text","")};dhtmlXCombo.prototype.getSelectedValue=function(){return this._getOptionProp(this.conf.temp_selected||this.conf.last_selected,"value",null)};dhtmlXCombo.prototype.getActualValue=function(){return this.base.childNodes[1].value};dhtmlXCombo.prototype.getComboText=function(){return this.base.childNodes[0].value};dhtmlXCombo.prototype.getIndexByValue=function(c){var d=this.getOption(c);return(d!=null?d.index:-1)};dhtmlXCombo.prototype.setComboText=function(b){if(this.conf.allow_free_text!=true){return}this.unSelectOption();this.conf.last_text=this.base.firstChild.value=b;this.conf.f_server_last=this.base.firstChild.value.toLowerCase()};dhtmlXCombo.prototype.setComboValue=function(c){var d=this.getOption(c);if(d!=null){this.selectOption(d.index)}else{this.conf.last_value=c;this.base.childNodes[1].value=this.conf.last_value;this.base.childNodes[2].value="true"}};dhtmlXCombo.prototype.selectOption=function(e,h,f){if(e<0||e>=this.list.childNodes.length){return}var g=this.list.childNodes[e]._optId;this._setSelected(g,this._isListVisible(),true);this._confirmSelect("script")};dhtmlXCombo.prototype.unSelectOption=function(){if(this.conf.last_hover!=null){this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,false);this.conf.last_hover=null}this.base.firstChild.value="";if(this.conf.f_mode!=false){this._filterOpts(true)}this._hideList();this._updateTopImage(null);this._confirmSelect("script")};dhtmlXCombo.prototype.confirmValue=function(){this._confirmSelect("script")};dhtmlXCombo.prototype.enable=function(b){b=(typeof(b)=="undefined"?true:window.dhx4.s2b(b));if(this.conf.enabled==b){return}this.conf.enabled=b;if(b){this.base.className="dhxcombo_"+this.conf.skin;this.base.firstChild.removeAttribute("disabled")}else{this._hideList();this.base.className="dhxcombo_"+this.conf.skin+" dhxcombo_disabled";this.base.firstChild.setAttribute("disabled","true")}this._updateTopImage(this.conf.last_selected)};dhtmlXCombo.prototype.disable=function(b){b=(typeof(b)=="undefined"?true:window.dhx4.s2b(b));this.enable(!b)};dhtmlXCombo.prototype.isEnabled=function(){return(this.conf.enabled==true)};dhtmlXCombo.prototype.show=function(b){if(typeof(b)=="undefined"){b=true}else{b=window.dhx4.s2b(b)}this.base.style.display=(b==true?"":"none")};dhtmlXCombo.prototype.hide=function(b){if(typeof(b)=="undefined"){b=true}this.show(!b)};dhtmlXCombo.prototype.isVisible=function(){return(this.base.style.display=="")};dhtmlXCombo.prototype.setFilterHandler=function(b){if(typeof(b)=="function"){this.conf.f_func=b;this.conf.f_mode=true;this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null}else{if(typeof(b)=="string"&&typeof(window[b])=="function"){this.conf.f_func=window[b];this.conf.f_mode=true;this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null}else{this.conf.f_func=null}}};dhtmlXCombo.prototype.enableFilteringMode=function(g,e,f,h){if(g==true||g=="between"){this.conf.f_mode=(g==true?"start":"between");if(e){this.conf.f_url=e;this.conf.f_cache=window.dhx4.s2b(f);this.conf.f_dyn=window.dhx4.s2b(h)}else{this.conf.f_url=null;this.conf.f_cache=false;this.conf.f_dyn=false}}else{this.conf.f_mode=false;this.conf.f_url=null;this.conf.f_cache=false;this.conf.f_dyn=false}};dhtmlXCombo.prototype.filter=function(h,f){for(var g=0;g<this.list.childNodes.length;g++){var e=h.apply(window,[this._getOption(this.list.childNodes[g]._optId,g)]);this.list.childNodes[g].style.display=(e===true?"":"none")}if(typeof(f)=="undefined"||f==true){this._showList(true)}};dhtmlXCombo.prototype.sort=function(h){var f=[];for(var e=0;e<this.list.childNodes.length;e++){var g=this.list.childNodes[e]._optId;f.push([g,this._getOption(g,e)])}if(h=="asc"||h=="desc"){k=true;f.sort(function(b,c){b=b[1].text_option.toLowerCase();c=c[1].text_option.toLowerCase();var a=(h=="asc"?1:-1);return(b>c?a:-1*a)})}else{if(typeof(h)=="function"||typeof(window[h])=="function"){if(typeof(window[h])=="function"){h=window[h]}f.sort(function(a,b){return h.apply(window,[a[1],b[1]])})}}while(this.list.childNodes.length>0){this.list.removeChild(this.list.lastChild)}for(var e=0;e<f.length;e++){this.list.appendChild(this.t[f[e][0]].item)}};dhtmlXCombo.prototype.enableAutocomplete=function(b){if(typeof(b)=="undefined"){b=true}else{b=window.dhx4.s2b(b)}this.conf.f_ac=b};dhtmlXCombo.prototype.disableAutocomplete=function(b){if(typeof(b)=="undefined"){b=true}else{b=window.dhx4.s2b(b)}this.enableAutocomplete(!b)};dhtmlXCombo.prototype.allowFreeText=function(c,d){this.conf.allow_free_text=(typeof(c)=="undefined"?true:window.dhx4.s2b(c));this.conf.free_text_empty=(typeof(d)=="undefined"?false:window.dhx4.s2b(d))};dhtmlXCombo.prototype._checkForMatch=function(i){var g=window.dhx4.trim(this.base.firstChild.value).toLowerCase();var h=null;var f=this.list.firstChild;while(f!=null){if(f.style.display==""&&f._optId!=null){var j=window.dhx4.trim(this.t[f._optId].obj.getText(f,true)).toLowerCase();if(g==j){h=f._optId;f=null}}if(f!=null){f=f.nextSibling}}if(this.conf.last_match==null){if(h!=null){this._setSelected(h,true,true);this.conf.last_match=h}else{if(this.conf.f_mode!="between"||i==true){this._setSelected(null,true,true);this.conf.last_match=null}}}else{if(h!=null){if(h!=this.conf.last_match){this._setSelected(h,true,true);this.conf.last_match=h}}else{this._setSelected(null,true,true);this.conf.last_match=null}}};dhtmlXCombo.prototype._selectRange=function(c,d){if(this.conf.combo_focus==true){window.dhx4.selectTextRange(this.base.firstChild,c,d)}};dhtmlXCombo.prototype.openSelect=function(){if(!this._isListVisible()){this._showList()}};dhtmlXCombo.prototype.closeAll=function(){this._hideList()};dhtmlXCombo.prototype._showList=function(d){if(this._getListVisibleCount()==0){if(d&&this._isListVisible()){this._hideList()}return}if(this._isListVisible()){this._checkListHeight();return}this.list.style.zIndex=window.dhx4.zim.reserve(this.conf.list_zi_id);if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.zIndex=Number(this.list.style.zIndex)+1}this.list.style.visibility="hidden";this.list.style.display="";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.visibility=this.list.style.visibility;this.hdr.style.display=this.list.style.display}var c=(this.hdr!=null&&this.conf.template.header==true?this.hdr.offsetHeight:0);this.list.style.width=Math.max(this.conf.opts_width||this.conf.col_w||0,this.conf.combo_width)+"px";this.list.style.top=window.dhx4.absTop(this.base)+c+this.base.offsetHeight-1+"px";this.list.style.left=window.dhx4.absLeft(this.base)+"px";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.width=this.list.style.width;this.hdr.style.left=this.list.style.left;this.hdr.style.top=parseInt(this.list.style.top)-c+"px"}this._checkListHeight();this.list.style.visibility="visible";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.visibility="visible"}this.callEvent("onOpen",[])};dhtmlXCombo.prototype._hideList=function(){if(!this._isListVisible()){return}window.dhx4.zim.clear(this.conf.list_zi_id);this.list.style.display="none";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.display="none"}this.conf.clear_click=false;this.callEvent("onClose",[])};dhtmlXCombo.prototype._isListVisible=function(){return(this.list.style.display=="")};dhtmlXCombo.prototype._getListVisibleCount=function(){var d=0;for(var c=0;c<this.list.childNodes.length;c++){d+=(this.list.childNodes[c].style.display==""?1:0)}return d};dhtmlXCombo.prototype._checkListHeight=function(){if(!this._isListVisible()){return}if(this.conf.item_h==null){var o=this.list.firstChild;while(o!=null){if(o.style.display==""){this.conf.item_h=o.offsetHeight+(this.hdr!=null?-1:0);o=null}else{o=o.nextSibling}}o=null}var n=window.dhx4.screenDim();var r=window.dhx4.absTop(this.base);var v=this.base.offsetHeight;var w=(this.hdr!=null&&this.conf.template.header==true?this.hdr.offsetHeight:0);var u=Math.max(0,Math.floor((r-w-n.top)/this.conf.item_h));var p=Math.max(0,Math.floor((n.bottom-(r+v+w))/this.conf.item_h));var h=this._getListVisibleCount();if(p<Math.min(this.conf.opts_count_min,h)&&u>p){p=null}var q=Math.min((p==null?u:p),this.conf.opts_count,h);var t=(q<h?(q*this.conf.item_h)+"px":"");var s=this.conf.sp[this.conf.skin][this.hdr!=null&&this.conf.template.header==true?"hdr_ofs":"list_ofs"];this.list.style.height=t;this.list.style.top=(p==null?r-this.list.offsetHeight+s:r+v+w-s)+"px";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.top=(p==null?r-w-this.list.offsetHeight+s:r+v-s)+"px"}};dhtmlXCombo.prototype._scrollToItem=function(h){var i=this.t[h].item.offsetTop;var j=i+this.t[h].item.offsetHeight;var f=this.list.scrollTop;var g=f+this.list.clientHeight;if(i<f){this.list.scrollTop=i+(this.hdr!=null&&this.conf.template.header==true?1:0)}else{if(j>g){this.list.scrollTop=j-this.list.clientHeight+(this.hdr!=null&&this.conf.template.header==true?-this.conf.sp[this.conf.skin].scr_ofs:0)}}};dhtmlXCombo.prototype._setSelected=function(g,h,e,f){this.conf.temp_selected=null;if(e){this._updateTopImage(g)}if(g!=null&&this.conf.last_hover==g){if(h){this._scrollToItem(g)}return}if(this.conf.last_hover!=null){this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,false);this.conf.last_hover=null;if(g==null){this.callEvent("onSelectionChange",[])}}if(g!=null){this.t[g].obj.setSelected(this.t[g].item,true);this.conf.last_hover=g;if(f!=true){this.conf.temp_selected=g;this.callEvent("onSelectionChange",[])}if(this.conf.s_mode=="select"&&this.t[g].item==this.t[g].item.parentNode.lastChild){this._subloadRequest()}if(h){this._scrollToItem(g)}}};dhtmlXCombo.prototype._subloadRequest=function(){if(this.conf.f_url!=null&&this.conf.f_dyn==true&&this.conf.f_dyn_end==false){var f="mask="+encodeURIComponent(this.conf.f_mask)+"&pos="+this.list.childNodes.length;var e=this;var d=function(a){if(e.conf.f_cache){e.conf.f_cache_data[e.conf.f_mask].data.push(a.xmlDoc.responseXML)}var b=e.list.childNodes.length;e.conf.f_loading=true;e.load(a.xmlDoc.responseXML);e.conf.f_loading=false;if(b==e.list.childNodes.length){e.conf.f_dyn_end=true;if(e.conf.f_cache){e.conf.f_cache_data[e.conf.f_mask].dyn_end=true}}d=e=null};if(window.dhx4.ajax.method=="post"){window.dhx4.ajax.post(this.conf.f_url,f,d)}else{if(window.dhx4.ajax.method=="get"){window.dhx4.ajax.get(this.conf.f_url+(String(this.conf.f_url).indexOf("?")>=0?"&":"?")+f,d)}}}};dhtmlXCombo.prototype.addOption=function(n,m,i,j,p){var q=null;if(!(n instanceof Array)){var l=this._renderOption({value:n,text:m,css:i,img:j});if(q==null&&window.dhx4.s2b(p)==true){q=l}}else{for(var o=0;o<n.length;o++){if(typeof(n[o])=="undefined"){continue}if(n[o] instanceof Array){l=this._renderOption({value:n[o][0],text:n[o][1],css:n[o][2],img:n[o][3]});if(q==null&&window.dhx4.s2b(n[o][4])==true){q=l}}else{var l=this._renderOption(n[o]);if(q==null&&window.dhx4.s2b(n[o].selected)==true){q=l}}}}if(q!=null){this._setSelected(q,this._isListVisible(),true);this._confirmSelect("onInit")}};dhtmlXCombo.prototype.updateOption=function(g,j,f,i){var h=this._getOptionId(g);if(h==null){return}this.t[h].obj.update(this.t[h].item,{value:j,text:f,css:i});if(this.conf.last_selected==h){this.conf.last_text=this.base.firstChild.value=this.t[h].obj.getText(this.t[h].item,true);this.conf.f_server_last=this.base.firstChild.value.toLowerCase()}};dhtmlXCombo.prototype.deleteOption=function(e){for(var a in this.t){var f=this.t[a].obj.getValue(this.t[a].item);if(f==e){this._removeOption(a)}}if(this._isListVisible()){this._showList(true)}};dhtmlXCombo.prototype.clearAll=function(a){a=(typeof(a)=="undefined"?true:window.dhx4.s2b(a));for(var d in this.t){this._removeOption(d)}if(this.conf.tm_hover){window.clearTimeout(this.conf.tm_hover)}this.conf.last_hover=null;this.conf.last_selected=null;this.list.scrollTop=0;if(a==true){this._hideList()}};dhtmlXCombo.prototype._renderOption=function(i){var h=window.dhx4.newId();var j=document.createElement("DIV");j._optId=h;j._tpl=this.conf.template;if(typeof(i.img)=="undefined"&&typeof(i.img_src)!="undefined"){i.img=i.img_src;delete i.img_src}if(typeof(i.img_dis)=="undefined"&&typeof(i.img_src_dis)!="undefined"){i.img_dis=i.img_src_dis;delete i.img_src_dis}i.img_path=this.conf.img_path;i.img_def=this.conf.img_def;i.img_def_dis=this.conf.img_def_dis;this.list.appendChild(j);var f=(this._isListVisible()&&window.dhx4.isFF==true);if(f==true){var g=this.list.scrollTop;this.list.scrollTop-=1}if(this.hdr!=null){i.multicol=true}this.t[j._optId]={obj:this.modes[this.conf.opts_type].render(j,i),item:j,conf:{type:this.conf.opts_type}};j=null;if(f==true){this.list.scrollTop+=1}return h};dhtmlXCombo.prototype._removeOption=function(b){this.t[b].obj.destruct(this.t[b].item);this.t[b].obj=null;this.t[b].item.parentNode.removeChild(this.t[b].item);this.t[b].item=null;this.t[b].conf=null;this.t[b]=null;delete this.t[b];if(this.conf.last_hover==b){this.conf.last_hover=null}if(this.conf.last_selected==b){this.conf.last_selected=null;this._confirmSelect("onDelete")}};dhtmlXCombo.prototype._confirmSelect=function(f,e){var d=false;if(typeof(e)=="undefined"){e=true}if(this.conf.f_server_tm){window.clearTimeout(this.conf.f_server_tm)}if(this.conf.last_hover!=null){d=d||(this.conf.last_value!=this._getOptionValue(this.conf.last_hover));this.conf.last_match=this.conf.last_selected=this.conf.last_hover;this.conf.last_value=this._getOptionValue(this.conf.last_selected);this.conf.last_text=this.base.firstChild.value=this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item,true);this.conf.f_server_last=this.base.firstChild.value.toLowerCase();this.base.childNodes[1].value=this.conf.last_value;this.base.childNodes[2].value="false"}else{if(this.conf.allow_free_text||(this.base.firstChild.value==""&&this.conf.allow_empty_value)){d=d||(this.conf.last_text!=this.base.firstChild.value);this.conf.last_match=this.conf.last_value=this.conf.last_selected=null;this.conf.last_text=this.base.firstChild.value;this.conf.f_server_last=this.base.firstChild.value.toLowerCase();this.base.childNodes[1].value=this.conf.last_text;this.base.childNodes[2].value="true"}else{if(f!="template"){this._cancelSelect(true);this._updateTopImage(this.conf.last_selected);return}}}if(this.conf.f_ac&&this.conf.f_mode=="start"){this.conf.f_ac_text="";if(f!="blur"){this._selectRange(this.base.firstChild.value.length,this.base.firstChild.value.length)}}if(e){this._hideList()}if(d==true&&f!="onInit"&&f!="onDelete"){this.callEvent("onSelectionChange",[]);this.callEvent("onChange",[this.conf.last_value,this.conf.last_text])}};dhtmlXCombo.prototype._cancelSelect=function(b){this._hideList();if(b==true&&this.conf.allow_free_text==false&&this.conf.free_text_empty==true){this.conf.f_server_last=this.conf.last_match=this.conf.last_value=this.conf.last_selected=null;this.base.childNodes[1].value=this.conf.last_text=this.base.firstChild.value="";this.base.childNodes[2].value="false"}else{this.base.firstChild.value=this.conf.last_text}if(this.conf.f_mode!=false){this._filterOpts(true)}};dhtmlXCombo.prototype._getOption=function(h,l){if(!this.t[h]){return null}if(typeof(l)=="undefined"){l=-1}if(l<0){for(var i=0;i<this.list.childNodes.length;i++){if(l<0&&this.list.childNodes[i]._optId==h){l=i}}}var j={value:this.t[h].obj.getValue(this.t[h].item),text:this.t[h].obj.getText(this.t[h].item),text_input:this.t[h].obj.getText(this.t[h].item,true),text_option:this.t[h].obj.getText(this.t[h].item,null,true),css:this.t[h].obj.getCss(this.t[h].item),selected:(h==this.conf.last_selected),index:l};if(typeof(this.t[h].obj.getExtraData)=="function"){var m=this.t[h].obj.getExtraData(this.t[h].item);for(var a in m){if(typeof(j[a])=="undefined"){j[a]=m[a]}}}return j};dhtmlXCombo.prototype._getOptionProp=function(g,h,e){if(g!=null){var f=this._getOption(g);if(f!=null){return f[h]}}return e};dhtmlXCombo.prototype._getOptionId=function(e){var g=null;for(var f=0;f<this.list.childNodes.length;f++){if(g==null){var h=this.list.childNodes[f]._optId;if(e==this.t[h].obj.getValue(this.t[h].item)){g=h}}}return g};dhtmlXCombo.prototype._getOptionValue=function(b){return this._getOptionProp(b,"value",null)};dhtmlXCombo.prototype.setSize=function(b){this.conf.combo_width=parseInt(b)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0);this.base.style.width=Math.max(0,this.conf.combo_width)+"px";this._adjustBase();if(this._isListVisible()){this._hideList();this._showList()}};dhtmlXCombo.prototype._adjustBase=function(){this.base.firstChild.style.width=Math.max(0,(this.conf.combo_width-(this.conf.i_ofs+1)-(this.conf.combo_image?this.conf.i_ofs:0)))+"px";this.base.firstChild.style.marginLeft=(this.conf.combo_image?this.conf.i_ofs+"px":"0px")};dhtmlXCombo.prototype.setOptionWidth=function(b){this.conf.opts_width=(parseInt(b)||null)};dhtmlXCombo.prototype.setOptionIndex=function(h,f){if(isNaN(f)||f<0){return}var g=this.getOption(h);if(g==null){return}if(f==g.index){return}var e=this.list.childNodes[g.index];e.parentNode.removeChild(e);if(this.list.childNodes[f]!=null){this.list.insertBefore(e,this.list.childNodes[f])}else{this.list.appendChild(e)}e=null};dhtmlXCombo.prototype.getOptionsCount=function(){return this.list.childNodes.length};dhtmlXCombo.prototype._mcMakeTemplate=function(l){var o="";var p="";this.conf.col_w=0;for(var n=0;n<l.length;n++){var j=Number(parseInt(l[n].width)||50);var q=(l[n].css||"");var m=(n==0&&window.dhx4.isIE6==true?"_first":"");p+="<div class='dhxcombo_cell"+m+" "+q+"' style='width:"+j+"px;'><div class='dhxcombo_cell_text'>"+(l[n].option||"&nbsp;")+"</div></div>";o+="<div class='dhxcombo_hdrcell"+m+" "+q+"' style='width:"+j+"px;'><div class='dhxcombo_hdrcell_text'>"+(l[n].header||"&nbsp;")+"</div></div>";this.conf.col_w+=j+1}var j=500;var h=document.createElement("DIV");h.style.position="absolute";h.style.top="10px";h.style.left=-j*2+"px";h.style.width=j+"px";h.style.height="50px";h.style.overflowY="scroll";h.innerHTML="<div>&nbsp;</div>";document.body.appendChild(h);this.conf.col_w+=j-h.firstChild.offsetWidth+10;h.parentNode.removeChild(h);h=null;this.conf.template.option=p;this._mcAttachHeader(o);this.list.className+=" dhxcombolist_multicolumn"};dhtmlXCombo.prototype._mcAttachHeader=function(b){if(this.hdr==null){this.hdr=document.createElement("DIV");this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr";this.hdr.style.display="none";this.list.parentNode.insertBefore(this.hdr,this.list);if(typeof(window.addEventListener)=="function"){this.hdr.addEventListener("mousedown",this._doOnListMouseDown,false)}else{this.hdr.attachEvent("onmousedown",this._doOnListMouseDown)}if(this.conf.opts_type=="checkbox"&&this.conf.combo_image==true){this.conf.combo_image=false;if(this.base.lastChild.className.match(/dhxcombo_top_image/)!=null){this.base.removeChild(this.base.lastChild)}this._adjustBase()}}this.hdr.innerHTML="<div class='dhxcombo_hdrtext'>"+b+"</div>"};dhtmlXCombo.prototype._mcDetachHeader=function(){if(this.hdr!=null){if(typeof(window.addEventListener)=="function"){this.hdr.removeEventListener("mousedown",this._doOnListMouseDown,false)}else{this.hdr.detachEvent("onmousedown",this._doOnListMouseDown)}this.hdr.parentNode.removeChild(this.hdr);this.hdr=null}this.conf.col_w=null;this.conf.item_h=null};dhtmlXCombo.prototype.modes={};dhtmlXCombo.prototype.doWithItem=function(i,j,m,o){var l=(i>=0&&i<this.list.childNodes.length?this.list.childNodes[i]._optId:null);if(l==null){return null}if(typeof(this.t[l].obj[j])!="function"){return null}var n=[this.t[l].item];for(var h=2;h<arguments.length;h++){n.push(arguments[h])}return this.t[l].obj[j].apply(this.t[l].obj,n)};function dhtmlXComboExtend(e,f){for(var a in dhtmlXCombo.prototype.modes[f]){if(typeof(dhtmlXCombo.prototype.modes[e][a])=="undefined"){dhtmlXCombo.prototype.modes[e][a]=dhtmlXCombo.prototype.modes[f][a]}}}dhtmlXCombo.prototype.modes.option={image:false,html:false,option_css:"dhxcombo_option_text",render:function(d,c){d._conf={value:c.value,css:""};d.className="dhxcombo_option";d.innerHTML="<div class='"+this.option_css+"'>&nbsp;</div>";if(c.css!=null){d.lastChild.style.cssText=c.css;d._conf.css=c.css}this.setText(d,c.text);return this},destruct:function(b){b._conf=null},update:function(d,c){d._conf.value=c.value;d._conf.css=c.css;d.lastChild.style.cssText=c.css;this.setText(d,c.text)},setText:function(h,g,e){h._conf.text=g;var f=(typeof(g)=="object"?window.dhx4.template(h._tpl.option,this.replaceHtml(h._conf.text,e),true):window.dhx4.trim(this.replaceHtml(h._conf.text,e)||""));h.lastChild.innerHTML=(f.length==0?"&nbsp;":f)},getText:function(f,e,d){if(window.dhx4.s2b(e)&&typeof(f._conf.text)=="object"){return window.dhx4.template(f._tpl.input,f._conf.text,true)}if(window.dhx4.s2b(d)&&typeof(f._conf.text)=="object"){return window.dhx4.template(f._tpl.option,f._conf.text,true)}return f._conf.text},getValue:function(b){return b._conf.value},getCss:function(b){return b._conf.css},setSelected:function(d,c){d.className="dhxcombo_option"+(c?" dhxcombo_option_selected":"")},isSelected:function(b){return String(b.className).indexOf("dhxcombo_option_selected")>=0},getExtraData:function(b){return{type:"option"}},replaceHtml:function(f,g){if(this.html==true){return f}if(typeof(g)=="undefined"||g==null){g={}}if(typeof(f)=="object"){var h={};for(var a in f){h[a]=(g[a]==true?f[a]:this.replaceHtml(f[a]))}}else{var h=(f||"").replace(/[\<\>\&\s]/g,function(b){switch(b){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case" ":return"&nbsp;"}return b})}return h}};dhtmlXCombo.prototype.modes.checkbox={image:true,html:false,image_css:"dhxcombo_checkbox dhxcombo_chbx_#state#",option_css:"dhxcombo_option_text dhxcombo_option_text_chbx",render:function(d,f){if(this.image_css_regexp==null){this.image_css_regexp=new RegExp(this.image_css.replace("#state#","\\d*"))}d._conf={value:f.value,css:"",checked:window.dhx4.s2b(f.checked)};d.className="dhxcombo_option";var e={};if(f.multicol==true){f.text.checkbox="<div class='"+String(this.image_css).replace("#state#",(d._conf.checked?"1":"0"))+"'></div>&nbsp;";e.checkbox=true;d.innerHTML="<div class='"+dhtmlXCombo.prototype.modes.option.option_css+"'></div>"}else{d.innerHTML="<div class='"+String(this.image_css).replace("#state#",(d._conf.checked?"1":"0"))+"'></div><div class='"+this.option_css+"'>&nbsp;</div>"}if(f.css!=null){d.lastChild.style.cssText+=f.css;d._conf.css=f.css}this.setText(d,f.text,e);return this},setChecked:function(d,f){d._conf.checked=window.dhx4.s2b(f);var e=String(this.image_css).replace("#state#",(d._conf.checked?"1":"0"));this._changeChbxCss(d.childNodes,e)},_changeChbxCss:function(e,d){for(var f=0;f<e.length;f++){if(e[f].tagName!=null&&e[f].className!=null&&e[f].className.match(this.image_css_regexp)!=null){e[f].className=d}else{if(e[f].childNodes.length>0){this._changeChbxCss(e[f].childNodes,d)}}}},isChecked:function(b){return(b._conf.checked==true)},getExtraData:function(b){return{type:"checkbox",checked:b._conf.checked}},optionClick:function(j,l,i){var m=true;var g=(l.target||l.srcElement);while(m==true&&g!=null&&g!=j&&g.className!=null){if(g.className.match(this.image_css_regexp)!=null){var h=[j._conf.value,!j._conf.checked];if(i.callEvent("onBeforeCheck",h)===true){this.setChecked(j,!this.isChecked(j));i.callEvent("onCheck",h)}m=false;h=null}else{g=g.parentNode}}g=i=j=null;return m},getTopImage:function(c,d){return""},topImageClick:function(d,c){return true}};dhtmlXComboExtend("checkbox","option");dhtmlXCombo.prototype.setChecked=function(d,c){this.doWithItem(d,"setChecked",c)};dhtmlXCombo.prototype.getChecked=function(e){var d=[];for(var f=0;f<this.list.childNodes.length;f++){if(this.isChecked(f)){d.push(this._getOptionProp(this.list.childNodes[f]._optId,"value",""))}}return d};dhtmlXCombo.prototype.isChecked=function(b){return this.doWithItem(b,"isChecked")};dhtmlXCombo.prototype.modes.image={image:true,html:false,image_css:"dhxcombo_image",option_css:"dhxcombo_option_text dhxcombo_option_text_image",render:function(d,c){d._conf={value:c.value,css:""};d.className="dhxcombo_option";d.innerHTML="<div class='"+this.image_css+"'></div><div class='"+this.option_css+"'>&nbsp;</div>";if(c.css!=null){d.lastChild.style.cssText+=c.css;d._conf.css=c.css}this.setText(d,c.text);this.setImage(d,c.img,c.img_dis,c.img_path,c.img_def,c.img_def_dis);return this},update:function(d,c){d._conf.value=c.value;d._conf.css=c.css;d.lastChild.style.cssText=c.css;this.setText(d,c.text);this.setImage(d,c.img,c.img_dis,c.img_path,c.img_def,c.img_def_dis)},setImage:function(m,h,j,i,l,g){if(h!=null&&h.length>0){h=i+h}else{if(l!=null&&l.length>0){h=i+l}else{h=null}}if(j!=null&&j.length>0){j=i+j}else{if(g!=null&&g.length>0){j=i+g}else{if(g==true){j=h}else{j=null}}}m._conf.img=h;m._conf.img_dis=j;m.firstChild.style.backgroundImage=(h!=null?"url("+h+")":"none")},getExtraData:function(b){return{type:"image"}},getTopImage:function(e,f){var a=(f?"img":"img_dis");if(e!=null&&e._conf[a]!=null){return"<div class='"+this.image_css+"' style='background-image:url("+e._conf[a]+");'></div>"}return""}};dhtmlXComboExtend("image","option");dhtmlXCombo.prototype.setDefaultImage=function(d,c){if(d!=null){this.conf.img_def=d}if(c!=null){this.conf.img_def_dis=c}};dhtmlXCombo.prototype.setImagePath=function(b){this.conf.img_path=b};function dhtmlXMenuObject(h,g){var i=this;this.conf={skin:(g||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxmenu")||"material"),mode:"web",align:"left",is_touched:false,selected:-1,last_click:-1,fixed_pos:false,rtl:false,icons_path:"",icons_css:false,arrow_ff_fix:(navigator.userAgent.indexOf("MSIE")>=0&&document.compatMode=="BackCompat"),live_id:window.dhx4.newId(),tags:{root:"menu",item:"item",text_ext:"itemtext",userdata:"userdata",tooltip:"tooltip",hotkey:"hotkey",href:"href"},autoload:{},hide_tm:{},top_mode:true,top_tmtime:200,v_enabled:false,v:{x1:null,x2:null,y1:null,y2:null},dir_toplv:"bottom",dir_sublv:"right",auto_overflow:false,overflow_limit:0,of_utm:null,of_utime:20,of_ustep:3,of_dtm:null,of_dtime:20,of_dstep:3,of_ah:{dhx_skyblue:24,dhx_web:25,dhx_terrace:27,material:25},of_ih:{dhx_skyblue:24,dhx_web:24,dhx_terrace:24,material:30},tm_sec:400,tm_handler:null,dload:false,dload_url:"",dload_icon:false,dload_params:{action:"loadMenu"},dload_pid:"parentId",tl_botmarg:1,tl_rmarg:0,tl_ofsleft:1,context:false,ctx_zoneid:false,ctx_autoshow:true,ctx_autohide:true,ctx_hideall:true,ctx_zones:{},ctx_baseid:null,selected_sub:[],opened_poly:[]};if(typeof(h)=="object"&&h!=null&&typeof(h.tagName)=="undefined"){if(h.icons_path!=null||h.icon_path!=null){this.conf.icons_path=(h.icons_path||h.icon_path)}if(h.skin!=null){this.conf.skin=h.skin}if(h.visible_area){this.conf.v_enabled=true;this.conf.v={x1:h.visible_area.x1,x2:h.visible_area.x2,y1:h.visible_area.y1,y2:h.visible_area.y2}}for(var j in {json:1,xml:1,items:1,top_text:1,align:1,open_mode:1,overflow:1,dynamic:1,dynamic_icon:1,context:1,onload:1,onclick:1,oncheckboxclick:1,onradioclick:1,iconset:1}){if(h[j]!=null){this.conf.autoload[j]=h[j]}}h=h.parent}if(h==null){this.base=document.body}else{var a=(typeof(h)=="string"?document.getElementById(h):h);if(a!=null){this.base=a;if(!this.base.id){this.base.id="menuBaseId_"+new Date().getTime()}this.base.className+=" dhtmlxMenu_"+this.conf.skin+"_Middle dir_left";this.base._autoSkinUpdate=true;if(this.base.oncontextmenu){this.base._oldContextMenuHandler=this.base.oncontextmenu}this.conf.ctx_baseid=this.base;this.base.onselectstart=function(b){b=b||event;if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}return false};this.base.oncontextmenu=function(b){b=b||event;if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}return false}}else{this.base=document.body}}this.idPrefix="";this.topId="dhxWebMenuTopId";this.idPull={};this.itemPull={};this.userData={};this.radio={};this.setSkin=function(c){var b=this.conf.skin;this.conf.skin=c;switch(this.conf.skin){case"dhx_skyblue":case"dhx_web":this.conf.tl_botmarg=2;this.conf.tl_rmarg=1;this.conf.tl_ofsleft=1;break;case"dhx_terrace":case"material":this.conf.tl_botmarg=0;this.conf.tl_rmarg=0;this.conf.tl_ofsleft=0;break}if(this.base._autoSkinUpdate){this.base.className=this.base.className.replace("dhtmlxMenu_"+b+"_Middle","")+" dhtmlxMenu_"+this.conf.skin+"_Middle"}for(var d in this.idPull){this.idPull[d].className=String(this.idPull[d].className).replace(b,this.conf.skin)}};this.setSkin(this.conf.skin);this._addSubItemToSelected=function(d,e){var b=true;for(var c=0;c<this.conf.selected_sub.length;c++){if((this.conf.selected_sub[c][0]==d)&&(this.conf.selected_sub[c][1]==e)){b=false}}if(b==true){this.conf.selected_sub.push(new Array(d,e))}return b};this._removeSubItemFromSelected=function(d,e){var b=new Array();var f=false;for(var c=0;c<this.conf.selected_sub.length;c++){if((this.conf.selected_sub[c][0]==d)&&(this.conf.selected_sub[c][1]==e)){f=true}else{b[b.length]=this.conf.selected_sub[c]}}if(f==true){this.conf.selected_sub=b}return f};this._getSubItemToDeselectByPolygon=function(d){var b=new Array();for(var c=0;c<this.conf.selected_sub.length;c++){if(this.conf.selected_sub[c][1]==d){b[b.length]=this.conf.selected_sub[c][0];b=b.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[c][0]));var e=true;for(var f=0;f<this.conf.opened_poly.length;f++){if(this.conf.opened_poly[f]==this.conf.selected_sub[c][0]){e=false}}if(e==true){this.conf.opened_poly[this.conf.opened_poly.length]=this.conf.selected_sub[c][0]}this.conf.selected_sub[c][0]=-1;this.conf.selected_sub[c][1]=-1}}return b};this._hidePolygon=function(b){if(this.idPull["polygon_"+b]!=null){if(this.idPull["polygon_"+b]._zId!=null){window.dhx4.zim.clear(this.idPull["polygon_"+b]._zId)}if(typeof(this._menuEffect)!="undefined"&&this._menuEffect!==false){this._hidePolygonEffect("polygon_"+b)}else{if(this.idPull["polygon_"+b].style.display=="none"){return}this.idPull["polygon_"+b].style.display="none";if(this.idPull["arrowup_"+b]!=null){this.idPull["arrowup_"+b].style.display="none"}if(this.idPull["arrowdown_"+b]!=null){this.idPull["arrowdown_"+b].style.display="none"}this._updateItemComplexState(b,true,false);if(window.dhx4.isIE6&&this.idPull["polygon_"+b+"_ie6cover"]!=null){this.idPull["polygon_"+b+"_ie6cover"].style.display="none"}}b=String(b).replace(this.idPrefix,"");if(b==this.topId){b=null}this.callEvent("onHide",[b]);if(b!=null&&this.conf.skin=="dhx_terrace"&&this.itemPull[this.idPrefix+b].parent==this.idPrefix+this.topId){this._improveTerraceButton(this.idPrefix+b,true)}}};this._showPolygon=function(d,U){var x=this._countVisiblePolygonItems(d);if(x==0){return}var b="polygon_"+d;if((this.idPull[b]!=null)&&(this.idPull[d]!=null)){if(this.conf.top_mode&&this.conf.mode=="web"&&!this.conf.context){if(!this.idPull[d]._mouseOver&&U==this.conf.dir_toplv){return}}if(!this.conf.fixed_pos){this._autoDetectVisibleArea()}var M=0;var I=0;var c=null;var y=null;if(this.idPull[b]._zId==null){this.idPull[b]._zId=window.dhx4.newId()}this.idPull[b]._zInd=window.dhx4.zim.reserve(this.idPull[b]._zId);this.idPull[b].style.visibility="hidden";this.idPull[b].style.left="0px";this.idPull[b].style.top="0px";this.idPull[b].style.display="";this.idPull[b].style.zIndex=this.idPull[b]._zInd;if(this.conf.auto_overflow){if(this.idPull[b].childNodes[1].childNodes[0].offsetHeight>this.conf.v.y2-this.conf.v.y1){var K=Math.max(Math.floor((this.conf.v.y2-this.conf.v.y1-this.conf.of_ah[this.conf.skin]*2)/this.conf.of_ih[this.conf.skin]),1);this.conf.overflow_limit=K}else{this.conf.overflow_limit=0;if(this.idPull["arrowup_"+d]!=null){this._removeUpArrow(String(d).replace(this.idPrefix,""))}if(this.idPull["arrowdown_"+d]!=null){this._removeDownArrow(String(d).replace(this.idPrefix,""))}}}if(this.conf.overflow_limit>0&&this.conf.overflow_limit<x){if(this.idPull["arrowup_"+d]==null){this._addUpArrow(String(d).replace(this.idPrefix,""))}if(this.idPull["arrowdown_"+d]==null){this._addDownArrow(String(d).replace(this.idPrefix,""))}c=this.idPull["arrowup_"+d];c.style.display="none";y=this.idPull["arrowdown_"+d];y.style.display="none"}if(this.conf.overflow_limit>0&&this.conf.overflow_limit<x){this.idPull[b].childNodes[1].style.height=this.conf.of_ih[this.conf.skin]*this.conf.overflow_limit+"px";c.style.width=y.style.width=this.idPull[b].childNodes[1].style.width=this.idPull[b].childNodes[1].childNodes[0].offsetWidth+"px";this.idPull[b].childNodes[1].scrollTop=0;c.style.display="";M=c.offsetHeight;y.style.display="";I=y.offsetHeight}else{this.idPull[b].childNodes[1].style.height="";this.idPull[b].childNodes[1].style.width=""}if(this.itemPull[d]!=null){var N="polygon_"+this.itemPull[d]["parent"]}else{if(this.conf.context){var N=this.idPull[this.idPrefix+this.topId]}}var W=(this.idPull[d].tagName!=null?window.dhx4.absLeft(this.idPull[d]):this.idPull[d][0]);var f=(this.idPull[d].tagName!=null?window.dhx4.absTop(this.idPull[d]):this.idPull[d][1]);var V=(this.idPull[d].tagName!=null?this.idPull[d].offsetWidth:0);var T=(this.idPull[d].tagName!=null?this.idPull[d].offsetHeight:0);var O=0;var P=0;var L=this.idPull[b].offsetWidth;var J=this.idPull[b].offsetHeight;if(U=="bottom"){if(this.conf.rtl){O=W+(V!=null?V:0)-L}else{if(this.conf.align=="right"){O=W+V-L}else{O=W-1+(U==this.conf.dir_toplv?this.conf.tl_rmarg:0)}}P=f-1+T+this.conf.tl_botmarg}if(U=="right"){O=W+V-1;P=f+2}if(U=="left"){O=W-this.idPull[b].offsetWidth+2;P=f+2}if(U=="top"){O=W-1;P=f-J+2}if(this.conf.fixed_pos){var e=65536;var w=65536}else{var e=(this.conf.v.x2!=null?this.conf.v.x2:0);var w=(this.conf.v.y2!=null?this.conf.v.y2:0);if(e==0){if(window.innerWidth){e=window.innerWidth;w=window.innerHeight}else{e=document.body.offsetWidth;w=document.body.scrollHeight}}}if(O+L>e&&!this.conf.rtl){O=W-L+2}if(O<this.conf.v.x1&&this.conf.rtl){O=W+V-2}if(O<0){O=0}if(P+J>w&&this.conf.v.y2!=null){P=Math.max(f+T-J+2,(this.conf.v_enabled?this.conf.v.y1+2:2));if(this.conf.context&&this.idPrefix+this.topId==d&&y!=null){P=P-2}if(this.itemPull[d]!=null&&!this.conf.context){if(this.itemPull[d]["parent"]==this.idPrefix+this.topId){P=P-this.base.offsetHeight}}}this.idPull[b].style.left=O+"px";this.idPull[b].style.top=P+"px";if(typeof(this._menuEffect)!="undefined"&&this._menuEffect!==false){this._showPolygonEffect(b)}else{this.idPull[b].style.visibility="";if(this.conf.overflow_limit>0&&this.conf.overflow_limit<x){this.idPull[b].childNodes[1].scrollTop=0;this._checkArrowsState(d)}if(window.dhx4.isIE6){var Q=b+"_ie6cover";if(this.idPull[Q]==null){var S=document.createElement("IFRAME");S.className="dhtmlxMenu_IE6CoverFix_"+this.conf.skin;S.frameBorder=0;S.setAttribute("src","javascript:false;");document.body.insertBefore(S,document.body.firstChild);this.idPull[Q]=S}this.idPull[Q].style.left=O+"px";this.idPull[Q].style.top=P+"px";this.idPull[Q].style.width=this.idPull[b].offsetWidth+"px";this.idPull[Q].style.height=this.idPull[b].offsetHeight+"px";this.idPull[Q].style.zIndex=this.idPull[b].style.zIndex-1;this.idPull[Q].style.display=""}}d=String(d).replace(this.idPrefix,"");if(d==this.topId){d=null}this.callEvent("onShow",[d]);if(d!=null&&this.conf.skin=="dhx_terrace"&&this.itemPull[this.idPrefix+d].parent==this.idPrefix+this.topId){this._improveTerraceButton(this.idPrefix+d,false)}}};this._redistribSubLevelSelection=function(c,d){while(this.conf.opened_poly.length>0){this.conf.opened_poly.pop()}var b=this._getSubItemToDeselectByPolygon(d);this._removeSubItemFromSelected(-1,-1);for(var f=0;f<b.length;f++){if((this.idPull[b[f]]!=null)&&(b[f]!=c)){if(this.itemPull[b[f]]["state"]=="enabled"){this.idPull[b[f]].className="sub_item"}}}for(var f=0;f<this.conf.opened_poly.length;f++){if(this.conf.opened_poly[f]!=d){this._hidePolygon(this.conf.opened_poly[f])}}if(this.itemPull[c]["state"]=="enabled"){this.idPull[c].className="sub_item_selected";if(this.itemPull[c]["complex"]&&this.conf.dload&&(this.itemPull[c]["loaded"]=="no")){if(this.conf.dload_icon==true){this._updateLoaderIcon(c,true)}this.itemPull[c].loaded="get";var e=c.replace(this.idPrefix,"");this._dhxdataload.onBeforeXLS=function(){var l={params:{}};l.params[this.conf.dload_pid]=e;for(var n in this.conf.dload_params){l.params[n]=this.conf.dload_params[n]}return l};this.loadStruct(this.conf.dload_url)}if(this.itemPull[c]["complex"]||(this.conf.dload&&(this.itemPull[c]["loaded"]=="yes"))){if((this.itemPull[c]["complex"])&&(this.idPull["polygon_"+c]!=null)){this._updateItemComplexState(c,true,true);this._showPolygon(c,this.conf.dir_sublv)}}this._addSubItemToSelected(c,d);this.conf.selected=c}};this._doOnClick=function(p,t,f){this.conf.last_click=p;if(this.itemPull[this.idPrefix+p]["href_link"]!=null&&this.itemPull[this.idPrefix+p].state=="enabled"){var e=document.createElement("FORM");var c=String(this.itemPull[this.idPrefix+p]["href_link"]).split("?");e.action=c[0];if(c[1]!=null){var m=String(c[1]).split("&");for(var q=0;q<m.length;q++){var b=String(m[q]).split("=");var d=document.createElement("INPUT");d.type="hidden";d.name=(b[0]||"");d.value=(b[1]||"");e.appendChild(d)}}if(this.itemPull[this.idPrefix+p]["href_target"]!=null){e.target=this.itemPull[this.idPrefix+p]["href_target"]}e.style.display="none";document.body.appendChild(e);e.submit();if(e!=null){document.body.removeChild(e);e=null}return}if(t.charAt(0)=="c"){return}if(t.charAt(1)=="d"){return}if(t.charAt(2)=="s"){return}if(this.checkEvent("onClick")){this.callEvent("onClick",[p,this.conf.ctx_zoneid,f])}else{if((t.charAt(1)=="d")||(this.conf.mode=="win"&&t.charAt(2)=="t")){return}}if(this.conf.context&&this._isContextMenuVisible()&&this.conf.ctx_autohide){this._hideContextMenu()}else{if(this._clearAndHide){this._clearAndHide()}}};this._doOnTouchMenu=function(b){if(this.conf.is_touched==false){this.conf.is_touched=true;if(this.checkEvent("onTouch")){this.callEvent("onTouch",[b])}}};this._searchMenuNode=function(e,c){var b=new Array();for(var d=0;d<c.length;d++){if(typeof(c[d])=="object"){if(c[d].length==5){if(typeof(c[d][0])!="object"){if((c[d][0].replace(this.idPrefix,"")==e)&&(d==0)){b=c}}}var f=this._searchMenuNode(e,c[d]);if(f.length>0){b=f}}}return b};this._getMenuNodes=function(b){var d=new Array;for(var c in this.itemPull){if(this.itemPull[c]["parent"]==b){d[d.length]=c}}return d};this._genStr=function(b){var e="dhxId_";var c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var d=0;d<b;d++){e+=c.charAt(Math.round(Math.random()*(c.length-1)))}return e};this.getItemType=function(b){b=this.idPrefix+b;if(this.itemPull[b]==null){return null}return this.itemPull[b]["type"]};this.forEachItem=function(b){for(var c in this.itemPull){b(String(c).replace(this.idPrefix,""))}};this._clearAndHide=function(){i.conf.selected=-1;i.conf.last_click=-1;while(i.conf.opened_poly.length>0){i.conf.opened_poly.pop()}for(var b=0;b<i.conf.selected_sub.length;b++){var c=i.conf.selected_sub[b][0];if(i.idPull[c]!=null){if(i.itemPull[c]["state"]=="enabled"){if(i.idPull[c].className=="sub_item_selected"){i.idPull[c].className="sub_item"}if(i.idPull[c].className=="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Selected"){if(i.itemPull[c]["cssNormal"]!=null){i.idPull[c].className=i.itemPull[c]["cssNormal"]}else{i.idPull[c].className="dhtmlxMenu_"+i.conf.skin+"_TopLevel_Item_Normal"}}}}i._hidePolygon(c)}i.conf.is_touched=false;if(i.conf.context&&i.conf.ctx_hideall){i._hidePolygon(i.idPrefix+i.topId)}};this._showSubLevelItem=function(c,b){if(document.getElementById("arrow_"+this.idPrefix+c)!=null){document.getElementById("arrow_"+this.idPrefix+c).style.display=(b?"none":"")}if(document.getElementById("image_"+this.idPrefix+c)!=null){document.getElementById("image_"+this.idPrefix+c).style.display=(b?"none":"")}if(document.getElementById(this.idPrefix+c)!=null){document.getElementById(this.idPrefix+c).style.display=(b?"":"none")}};this._hideSubLevelItem=function(b){this._showSubLevelItem(b,true)};this.idPrefix=this._genStr(12)+"_";this._bodyClick=function(b){b=b||event;if(b.button==2||(window.dhx4.isOpera&&b.ctrlKey==true)){return}if(i.conf.context){if(i.conf.ctx_autohide&&(!window.dhx4.isOpera||(i._isContextMenuVisible()&&window.dhx4.isOpera))){i._hideContextMenu()}}else{if(i._clearAndHide){i._clearAndHide()}}};this._bodyContext=function(d){d=d||event;var e=String((d.srcElement||d.target).className);if(e.search("dhtmlxMenu")!=-1&&e.search("SubLevelArea")!=-1){return}var b=true;var c=d.target||d.srcElement;while(c!=null){if(c.id!=null){if(i.isContextZone(c.id)){b=false}}if(c==document.body){b=false}c=c.parentNode}if(b){i.hideContextMenu()}};if(typeof(window.addEventListener)!="undefined"){window.addEventListener("click",this._bodyClick,false);window.addEventListener("contextmenu",this._bodyContext,false)}else{document.body.attachEvent("onclick",this._bodyClick);document.body.attachEvent("oncontextmenu",this._bodyContext)}dhx4.attachEvent("_onGridClick",this._bodyClick);this.unload=function(){window.dhx4._eventable(this,"clear");dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=null;try{delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]}catch(b){}this.conf.live_id=null;if(typeof(window.addEventListener)=="function"){window.removeEventListener("click",this._bodyClick,false);window.removeEventListener("contextmenu",this._bodyContext,false)}else{document.body.detachEvent("onclick",this._bodyClick);document.body.detachEvent("oncontextmenu",this._bodyContext)}this._bodyClick=null;this._bodyContext=null;this.removeItem(this.idPrefix+this.topId,true);this.itemPull=null;this.idPull=null;if(this.conf.context){for(var c in this.conf.ctx_zones){this.removeContextZone(c)}}if(this.cont!=null){this.cont.className="";this.cont.parentNode.removeChild(this.cont);this.cont=null}if(this.base!=null){if(!this.conf.context){this.base.className=""}if(!this.conf.context){this.base.oncontextmenu=(this.base._oldContextMenuHandler||null)}this.base.onselectstart=null;this.base=null}for(var c in this){this[c]=null}i=null};dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=this;window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson",this.conf.tags.root,{struct:true});window.dhx4._eventable(this);if(window.dhx4.s2b(this.conf.autoload.context)==true){this.renderAsContextMenu()}if(this.conf.autoload.iconset=="awesome"){this.conf.icons_css=true}if(this.conf.autoload.dynamic!=null){this.enableDynamicLoading(this.conf.autoload.dynamic,window.dhx4.s2b(this.conf.autoload.dynamic_icon))}else{if(this.conf.autoload.items!=null){this.loadStruct(this.conf.autoload.items,this.conf.autoload.onload)}else{if(this.conf.autoload.json!=null){this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload)}else{if(this.conf.autoload.xml!=null){this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload)}}}}for(var j in {onclick:1,oncheckboxclick:1,onradioclick:1}){if(this.conf.autoload[j]!=null){if(typeof(this.conf.autoload[j])=="function"){this.attachEvent(j,this.conf.autoload[j])}else{if(typeof(window[this.conf.autoload[j]])=="function"){this.attachEvent(j,window[this.conf.autoload[j]])}}}}if(this.conf.autoload.top_text!=null){this.setTopText(this.conf.autoload.top_text)}if(this.conf.autoload.align!=null){this.setAlign(this.conf.autoload.align)}if(this.conf.autoload.open_mode!=null){this.setOpenMode(this.conf.autoload.open_mode)}if(this.conf.autoload.overflow!=null){this.setOverflowHeight(this.conf.autoload.overflow)}for(var j in this.conf.autoload){this.conf.autoload[j]=null;delete this.conf.autoload[j]}this.conf.autoload=null;return this}dhtmlXMenuObject.prototype._init=function(){if(this._isInited==true){return}if(this.conf.dload){this._dhxdataload.onBeforeXLS=function(){var d={params:{}};for(var a in this.conf.dload_params){d.params[a]=this.conf.dload_params[a]}return d};this.loadStruct(this.conf.dload_url)}else{this._initTopLevelMenu();this._isInited=true}};dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(g){var i=0;for(var a in this.itemPull){var j=this.itemPull[a]["parent"];var h=this.itemPull[a]["type"];if(this.idPull[a]!=null){if(j==g&&(h=="item"||h=="radio"||h=="checkbox")&&this.idPull[a].style.display!="none"){i++}}}return i};dhtmlXMenuObject.prototype._redefineComplexState=function(c){if(this.idPrefix+this.topId==c){return}if((this.idPull["polygon_"+c]!=null)&&(this.idPull[c]!=null)){var d=this._countVisiblePolygonItems(c);if((d>0)&&(!this.itemPull[c]["complex"])){this._updateItemComplexState(c,true,false)}if((d==0)&&(this.itemPull[c]["complex"])){this._updateItemComplexState(c,false,false)}}};dhtmlXMenuObject.prototype._updateItemComplexState=function(h,j,i){if((!this.conf.context)&&(this._getItemLevelType(h.replace(this.idPrefix,""))=="TopLevel")){this.itemPull[h]["complex"]=j;return}if((this.idPull[h]==null)||(this.itemPull[h]==null)){return}this.itemPull[h]["complex"]=j;if(h==this.idPrefix+this.topId){return}var g=null;var f=this.idPull[h].childNodes[this.conf.rtl?0:2];if(f.childNodes[0]){if(String(f.childNodes[0].className).search("complex_arrow")===0){g=f.childNodes[0]}}if(this.itemPull[h]["complex"]){if(g==null){g=document.createElement("DIV");g.className="complex_arrow";g.id="arrow_"+h;while(f.childNodes.length>0){f.removeChild(f.childNodes[0])}f.appendChild(g)}if(this.conf.dload&&(this.itemPull[h].loaded=="get")&&this.conf.dload_icon){if(g.className!="complex_arrow_loading"){g.className="complex_arrow_loading"}}else{g.className="complex_arrow"}return}if((!this.itemPull[h]["complex"])&&(g!=null)){f.removeChild(g);if(this.itemPull[h]["hotkey_backup"]!=null&&this.setHotKey){this.setHotKey(h.replace(this.idPrefix,""),this.itemPull[h]["hotkey_backup"])}}};dhtmlXMenuObject.prototype._getItemLevelType=function(b){return(this.itemPull[this.idPrefix+b]["parent"]==this.idPrefix+this.topId?"TopLevel":"SubLevelArea")};dhtmlXMenuObject.prototype.setIconsPath=function(b){this.conf.icons_path=b};dhtmlXMenuObject.prototype._updateItemImage=function(s,r){s=this.idPrefix+s;var n=this.itemPull[s]["type"];if(n=="checkbox"||n=="radio"){return}var q=(this.itemPull[s]["parent"]==this.idPrefix+this.topId&&!this.conf.context);var p=null;if(q){for(var u=0;u<this.idPull[s].childNodes.length;u++){if(p==null&&(this.idPull[s].childNodes[u].className||"")=="dhtmlxMenu_TopLevel_Item_Icon"||(this.idPull[s].childNodes[u].tagName||"").toLowerCase()=="i"){p=this.idPull[s].childNodes[u]}}}else{try{var p=this.idPull[s].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(o){}if(!(p!=null&&typeof(p.className)!="undefined"&&(p.className=="sub_icon"||p.tagName.toLowerCase()=="i"))){p=null}}var e=this.itemPull[s][(this.itemPull[s]["state"]=="enabled"?"imgen":"imgdis")];if(e.length>0){if(p!=null){if(this.conf.icons_css==true){p.className=this.conf.icons_path+e}else{p.src=this.conf.icons_path+e}}else{if(q){if(this.conf.icons_css==true){var p=document.createElement("i");p.className=this.conf.icons_path+e}else{var p=document.createElement("IMG");p.className="dhtmlxMenu_TopLevel_Item_Icon";p.src=this.conf.icons_path+e;p.border="0";p.id="image_"+s}if(!this.conf.rtl&&this.idPull[s].childNodes.length>0){this.idPull[s].insertBefore(p,this.idPull[s].childNodes[0])}else{this.idPull[s].appendChild(p)}}else{if(this.conf.icons_css==true){var m=this.idPull[s].childNodes[this.conf.rtl?2:0];m.innerHTML="<i class='"+this.conf.icons_path+e+"'></i>"}else{var p=document.createElement("IMG");p.className="sub_icon";p.src=this.conf.icons_path+e;p.border="0";p.id="image_"+s;var m=this.idPull[s].childNodes[this.conf.rtl?2:0];while(m.childNodes.length>0){m.removeChild(m.childNodes[0])}m.appendChild(p)}}}}else{if(p!=null){if(q){p.parentNode.removeChild(p);p=null}else{var t=p.parentNode;t.removeChild(p);t.innerHTML="&nbsp;";t=p=null}}}};dhtmlXMenuObject.prototype._getAllParents=function(g){var j=new Array();for(var a in this.itemPull){if(this.itemPull[a]["parent"]==g){j[j.length]=this.itemPull[a]["id"];if(this.itemPull[a]["complex"]){var i=this._getAllParents(this.itemPull[a]["id"]);for(var h=0;h<i.length;h++){j[j.length]=i[h]}}}}return j};dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(this.conf.v_enabled){return}var b=window.dhx4.screenDim();this.conf.v.x1=b.left;this.conf.v.x2=b.right;this.conf.v.y1=b.top;this.conf.v.y2=b.bottom};dhtmlXMenuObject.prototype.getItemPosition=function(h){h=this.idPrefix+h;var i=-1;if(this.itemPull[h]==null){return i}var g=this.itemPull[h]["parent"];var j=(this.idPull["polygon_"+g]!=null?this.idPull["polygon_"+g].tbd:this.cont);for(var f=0;f<j.childNodes.length;f++){if(j.childNodes[f]==this.idPull["separator_"+h]||j.childNodes[f]==this.idPull[h]){i=f}}return i};dhtmlXMenuObject.prototype.setItemPosition=function(j,l){j=this.idPrefix+j;if(this.idPull[j]==null){return}var h=(this.itemPull[j]["parent"]==this.idPrefix+this.topId);var i=this.idPull[j];var n=this.getItemPosition(j.replace(this.idPrefix,""));var o=this.itemPull[j]["parent"];var m=(this.idPull["polygon_"+o]!=null?this.idPull["polygon_"+o].tbd:this.cont);m.removeChild(m.childNodes[n]);if(l<0){l=0}if(h&&l<1){l=1}if(l<m.childNodes.length){m.insertBefore(i,m.childNodes[l])}else{m.appendChild(i)}};dhtmlXMenuObject.prototype.getParentId=function(b){b=this.idPrefix+b;if(this.itemPull[b]==null){return null}return((this.itemPull[b]["parent"]!=null?this.itemPull[b]["parent"]:this.topId).replace(this.idPrefix,""))};dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()};dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,true);this._isInited=false;this.idPrefix=this._genStr(12)+"_";this.itemPull={}};if(typeof(dhtmlXMenuObject.prototype.liveInst)=="undefined"){dhtmlXMenuObject.prototype.liveInst={}}dhtmlXMenuObject.prototype.setIconset=function(b){this.conf.icons_css=(b=="awesome")};dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(g,e){var f=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var h=0;h<f.length;h++){if(f[h]!=g){this._hidePolygon(f[h])}if((this.idPull[f[h]]!=null)&&(f[h]!=g)){this.idPull[f[h]].className=this.idPull[f[h]].className.replace(/Selected/g,"Normal")}}if(this.itemPull[this.idPrefix+g]["state"]=="enabled"){this.idPull[this.idPrefix+g].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_Selected";this._addSubItemToSelected(this.idPrefix+g,"parent");this.conf.selected=(this.conf.mode=="win"?(this.conf.selected!=-1?g:this.conf.selected):g);if((this.itemPull[this.idPrefix+g]["complex"])&&(this.conf.selected!=-1)){this._showPolygon(this.idPrefix+g,this.conf.dir_toplv)}}};dhtmlXMenuObject.prototype._initTopLevelMenu=function(){this.conf.dir_toplv="bottom";this.conf.dir_sublv=(this.conf.rtl?"left":"right");if(this.conf.context){this.idPull[this.idPrefix+this.topId]=new Array(0,0);this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId)}else{var d=this._getMenuNodes(this.idPrefix+this.topId);for(var c=0;c<d.length;c++){if(this.itemPull[d[c]]["type"]=="item"){this._renderToplevelItem(d[c],null)}if(this.itemPull[d[c]]["type"]=="separator"){this._renderSeparator(d[c],null)}}}};dhtmlXMenuObject.prototype._renderToplevelItem=function(l,m){var n=this;var j=document.createElement("DIV");j.id=l;if(this.itemPull[l]["state"]=="enabled"&&this.itemPull[l]["cssNormal"]!=null){j.className=this.itemPull[l]["cssNormal"]}else{j.className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+(this.itemPull[l]["state"]=="enabled"?"Normal":"Disabled")}if(this.itemPull[l]["title"]!=""){var o=document.createElement("DIV");o.className="top_level_text";o.innerHTML=this.itemPull[l]["title"];j.appendChild(o)}if(this.itemPull[l]["tip"].length>0){j.title=this.itemPull[l]["tip"]}if((this.itemPull[l]["imgen"]!="")||(this.itemPull[l]["imgdis"]!="")){var p=this.itemPull[l][(this.itemPull[l]["state"]=="enabled")?"imgen":"imgdis"];if(p){if(this.conf.icons_css==true){var q=document.createElement("i");q.className=this.conf.icons_path+p;if(j.childNodes.length>0&&!this.conf.rtl){j.insertBefore(q,j.childNodes[0])}else{j.appendChild(q)}}else{var i=document.createElement("IMG");i.border="0";i.id="image_"+l;i.src=this.conf.icons_path+p;i.className="dhtmlxMenu_TopLevel_Item_Icon";if(j.childNodes.length>0&&!this.conf.rtl){j.insertBefore(i,j.childNodes[0])}else{j.appendChild(i)}}}}j.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};j.oncontextmenu=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};if(!this.cont){this.cont=document.createElement("DIV");this.cont.dir="ltr";this.cont.className=(this.conf.align=="right"?"align_right":"align_left");this.base.appendChild(this.cont)}if(m!=null){m++;if(m<0){m=0}if(m>this.cont.childNodes.length-1){m=null}}if(m!=null){this.cont.insertBefore(j,this.cont.childNodes[m])}else{this.cont.appendChild(j)}this.idPull[j.id]=j;if(this.itemPull[l]["complex"]&&(!this.conf.dload)){this._addSubMenuPolygon(this.itemPull[l]["id"],this.itemPull[l]["id"])}j.onmouseover=function(){if(n.conf.mode=="web"){window.clearTimeout(n.conf.tm_handler)}var c=n._getSubItemToDeselectByPolygon("parent");n._removeSubItemFromSelected(-1,-1);for(var a=0;a<c.length;a++){if(c[a]!=this.id){n._hidePolygon(c[a])}if((n.idPull[c[a]]!=null)&&(c[a]!=this.id)){if(n.itemPull[c[a]]["cssNormal"]!=null){n.idPull[c[a]].className=n.itemPull[c[a]]["cssNormal"]}else{if(n.idPull[c[a]].className=="sub_item_selected"){n.idPull[c[a]].className="sub_item"}n.idPull[c[a]].className=n.idPull[c[a]].className.replace(/Selected/g,"Normal")}}}if(n.itemPull[this.id]["state"]=="enabled"){this.className="dhtmlxMenu_"+n.conf.skin+"_TopLevel_Item_Selected";n._addSubItemToSelected(this.id,"parent");n.conf.selected=(n.conf.mode=="win"?(n.conf.selected!=-1?this.id:n.conf.selected):this.id);if(n.conf.dload){if(n.itemPull[this.id].loaded=="no"){this._dynLoadTM=new Date().getTime();n.itemPull[this.id].loaded="get";var d=this.id.replace(n.idPrefix,"");n._dhxdataload.onBeforeXLS=function(){var f={params:{}};f.params[this.conf.dload_pid]=d;for(var e in this.conf.dload_params){f.params[e]=this.conf.dload_params[e]}return f};n.loadStruct(n.conf.dload_url)}if(n.conf.top_mode&&n.conf.mode=="web"&&!n.conf.context){this._mouseOver=true}}if((!n.conf.dload)||(n.conf.dload&&(!n.itemPull[this.id]["loaded"]||n.itemPull[this.id]["loaded"]=="yes"))){if((n.itemPull[this.id]["complex"])&&(n.conf.selected!=-1)){if(n.conf.top_mode&&n.conf.mode=="web"&&!n.conf.context){this._mouseOver=true;var b=this.id;this._menuOpenTM=window.setTimeout(function(){n._showPolygon(b,n.conf.dir_toplv)},n.conf.top_tmtime)}else{n._showPolygon(this.id,n.conf.dir_toplv)}}}}n._doOnTouchMenu(this.id.replace(n.idPrefix,""))};j.onmouseout=function(){if(!((n.itemPull[this.id]["complex"])&&(n.conf.selected!=-1))&&(n.itemPull[this.id]["state"]=="enabled")){if(n.itemPull[this.id]["cssNormal"]!=null){j.className=n.itemPull[this.id]["cssNormal"]}else{j.className="dhtmlxMenu_"+n.conf.skin+"_TopLevel_Item_Normal"}}if(n.conf.mode=="web"){window.clearTimeout(n.conf.tm_handler);n.conf.tm_handler=window.setTimeout(function(){n._clearAndHide()},n.conf.tm_sec,"JavaScript")}if(n.conf.top_mode&&n.conf.mode=="web"&&!n.conf.context){this._mouseOver=false;window.clearTimeout(this._menuOpenTM)}};j.onclick=function(a){if(n.conf.mode=="web"){window.clearTimeout(n.conf.tm_handler)}if(n.conf.mode!="web"&&n.itemPull[this.id]["state"]=="disabled"){return}a=a||event;a.cancelBubble=true;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}if(n.conf.mode=="win"){if(n.itemPull[this.id]["complex"]){if(n.conf.selected==this.id){n.conf.selected=-1;var b=false}else{n.conf.selected=this.id;var b=true}if(b){n._showPolygon(this.id,n.conf.dir_toplv)}else{n._hidePolygon(this.id)}}}var d=(n.itemPull[this.id]["complex"]?"c":"-");var e=(n.itemPull[this.id]["state"]!="enabled"?"d":"-");var c={ctrl:a.ctrlKey,alt:a.altKey,shift:a.shiftKey};n._doOnClick(this.id.replace(n.idPrefix,""),d+e+"t",c);return false};if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXMenuObject.prototype._addSubMenuPolygon=function(i,j){var g=this._renderSublevelPolygon(i,j);var h=this._getMenuNodes(j);for(m=0;m<h.length;m++){if(this.itemPull[h[m]]["type"]=="separator"){this._renderSeparator(h[m],null)}else{this._renderSublevelItem(h[m],null)}}if(i==j){var l="topLevel"}else{var l="subLevel"}for(var m=0;m<h.length;m++){if(this.itemPull[h[m]]["complex"]){this._addSubMenuPolygon(i,this.itemPull[h[m]]["id"])}}};dhtmlXMenuObject.prototype._renderSublevelPolygon=function(h,i){var f=document.createElement("DIV");f.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Polygon "+(this.conf.rtl?"dir_right":"");f.dir="ltr";f.oncontextmenu=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}a.cancelBubble=true;return false};f.id="polygon_"+i;f.onclick=function(a){a=a||event;a.cancelBubble=true};f.style.display="none";document.body.insertBefore(f,document.body.firstChild);f.innerHTML='<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';var j=document.createElement("TABLE");j.className="dhtmlxMebu_SubLevelArea_Tbl";j.cellSpacing=0;j.cellPadding=0;j.border=0;var g=document.createElement("TBODY");j.appendChild(g);f.childNodes[1].appendChild(j);f.tbl=j;f.tbd=g;this.idPull[f.id]=f;if(this.sxDacProc!=null){this.idPull["sxDac_"+i]=new this.sxDacProc(f,f.className);if(window.dhx4.isIE){this.idPull["sxDac_"+i]._setSpeed(this.dacSpeedIE);this.idPull["sxDac_"+i]._setCustomCycle(this.dacCyclesIE)}else{this.idPull["sxDac_"+i]._setSpeed(this.dacSpeed);this.idPull["sxDac_"+i]._setCustomCycle(this.dacCycles)}}return f};dhtmlXMenuObject.prototype._renderSublevelItem=function(D,t){var v=this;var u=document.createElement("TR");u.className=(this.itemPull[D]["state"]=="enabled"?"sub_item":"sub_item_dis");var w=document.createElement("TD");w.className="sub_item_icon";var p=this.itemPull[D]["type"];var s=this.itemPull[D][(this.itemPull[D]["state"]=="enabled"?"imgen":"imgdis")];if(s!=""){if(p=="checkbox"||p=="radio"){var y=document.createElement("DIV");y.id="image_"+this.itemPull[D]["id"];y.className="sub_icon "+s;w.appendChild(y)}if(!(p=="checkbox"||p=="radio")){if(this.conf.icons_css==true){w.innerHTML="<i class='"+this.conf.icons_path+s+"'></i>"}else{var y=document.createElement("IMG");y.id="image_"+this.itemPull[D]["id"];y.className="sub_icon";y.src=this.conf.icons_path+s;w.appendChild(y)}}}else{w.innerHTML="&nbsp;"}var x=document.createElement("TD");x.className="sub_item_text";if(this.itemPull[D]["title"]!=""){var q=document.createElement("DIV");q.className="sub_item_text";q.innerHTML=this.itemPull[D]["title"];x.appendChild(q)}else{x.innerHTML="&nbsp;"}var z=document.createElement("TD");z.className="sub_item_hk";if(this.itemPull[D]["complex"]){var C=document.createElement("DIV");C.className="complex_arrow";C.id="arrow_"+this.itemPull[D]["id"];z.appendChild(C)}else{if(this.itemPull[D]["hotkey"].length>0&&!this.itemPull[D]["complex"]){var A=document.createElement("DIV");A.className="sub_item_hk";A.innerHTML=this.itemPull[D]["hotkey"];z.appendChild(A)}else{z.innerHTML="&nbsp;"}}u.appendChild(this.conf.rtl?z:w);u.appendChild(x);u.appendChild(this.conf.rtl?w:z);u.id=this.itemPull[D]["id"];u.parent=this.itemPull[D]["parent"];if(this.itemPull[D]["tip"].length>0){u.title=this.itemPull[D]["tip"]}u.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};u.onmouseover=function(a){if(v.conf.hide_tm[this.id]){window.clearTimeout(v.conf.hide_tm[this.id])}if(v.conf.mode=="web"){window.clearTimeout(v.conf.tm_handler)}if(!this._visible){v._redistribSubLevelSelection(this.id,this.parent)}this._visible=true};u.onmouseout=function(){if(v.conf.mode=="web"){if(v.conf.tm_handler){window.clearTimeout(v.conf.tm_handler)}v.conf.tm_handler=window.setTimeout(function(){if(v&&v._clearAndHide){v._clearAndHide()}},v.conf.tm_sec,"JavaScript")}var a=this;if(v.conf.hide_tm[this.id]){window.clearTimeout(v.conf.hide_tm[this.id])}v.conf.hide_tm[this.id]=window.setTimeout(function(){a._visible=false},50)};u.onclick=function(a){if(!v.checkEvent("onClick")&&v.itemPull[this.id]["complex"]){return}a=a||event;a.cancelBubble=true;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}tc=(v.itemPull[this.id]["complex"]?"c":"-");td=(v.itemPull[this.id]["state"]=="enabled"?"-":"d");var b={ctrl:a.ctrlKey,alt:a.altKey,shift:a.shiftKey};switch(v.itemPull[this.id]["type"]){case"checkbox":v._checkboxOnClickHandler(this.id.replace(v.idPrefix,""),tc+td+"n",b);break;case"radio":v._radioOnClickHandler(this.id.replace(v.idPrefix,""),tc+td+"n",b);break;case"item":v._doOnClick(this.id.replace(v.idPrefix,""),tc+td+"n",b);break}return false};var r=this.idPull["polygon_"+this.itemPull[D]["parent"]];if(t!=null){t++;if(t<0){t=0}if(t>r.tbd.childNodes.length-1){t=null}}if(t!=null&&r.tbd.childNodes[t]!=null){r.tbd.insertBefore(u,r.tbd.childNodes[t])}else{r.tbd.appendChild(u)}this.idPull[u.id]=u};dhtmlXMenuObject.prototype._renderSeparator=function(r,m){var s=(this.conf.context?"SubLevelArea":(this.itemPull[r]["parent"]==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"));if(s=="TopLevel"&&this.conf.context){return}var o=this;if(s!="TopLevel"){var n=document.createElement("TR");n.className="sub_sep";var q=document.createElement("TD");q.colSpan="3";n.appendChild(q)}var p=document.createElement("DIV");p.id="separator_"+r;p.className=(s=="TopLevel"?"top_sep":"sub_sep");p.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};p.onclick=function(a){a=a||event;a.cancelBubble=true;var b={ctrl:a.ctrlKey,alt:a.altKey,shift:a.shiftKey};o._doOnClick(this.id.replace("separator_"+o.idPrefix,""),"--s",b)};if(s=="TopLevel"){if(m!=null){m++;if(m<0){m=0}if(this.cont.childNodes[m]!=null){this.cont.insertBefore(p,this.cont.childNodes[m])}else{this.cont.appendChild(p)}}else{var j=this.cont.childNodes[this.cont.childNodes.length-1];if(String(j).search("TopLevel_Text")==-1){this.cont.appendChild(p)}else{this.cont.insertBefore(p,j)}}this.idPull[p.id]=p}else{var l=this.idPull["polygon_"+this.itemPull[r]["parent"]];if(m!=null){m++;if(m<0){m=0}if(m>l.tbd.childNodes.length-1){m=null}}if(m!=null&&l.tbd.childNodes[m]!=null){l.tbd.insertBefore(n,l.tbd.childNodes[m])}else{l.tbd.appendChild(n)}q.appendChild(p);this.idPull[p.id]=n}};dhtmlXMenuObject.prototype.addNewSeparator=function(e,d){d=this.idPrefix+(d!=null?d:this._genStr(24));var f=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(d,f,"","separator",false,"","");this._renderSeparator(d,this.getItemPosition(e))};dhtmlXMenuObject.prototype._initObj=function(r,q,v){if(!(r instanceof Array)){v=r.parentId;if(v!=null&&String(v).indexOf(this.idPrefix)!==0){v=this.idPrefix+String(v)}r=r.items}for(var z=0;z<r.length;z++){if(typeof(r[z].id)=="undefined"||r[z].id==null){r[z].id=this._genStr(24)}if(r[z].text==null){r[z].text=""}if(String(r[z].id).indexOf(this.idPrefix)!==0){r[z].id=this.idPrefix+String(r[z].id)}var y={type:"item",tip:"",hotkey:"",state:"enabled",imgen:"",imgdis:""};for(var p in y){if(typeof(r[z][p])=="undefined"){r[z][p]=y[p]}}if(r[z].imgen==""&&r[z].img!=null){r[z].imgen=r[z].img}if(r[z].imgdis==""&&r[z].img_disabled!=null){r[z].imgdis=r[z].img_disabled}if(r[z].title==null&&r[z].text!=null){r[z].title=r[z].text}if(r[z].href!=null){if(r[z].href.link!=null){r[z].href_link=r[z].href.link}if(r[z].href.target!=null){r[z].href_target=r[z].href.target}}if(r[z].userdata!=null){for(var p in r[z].userdata){this.userData[r[z].id+"_"+p]=r[z].userdata[p]}}if(typeof(r[z].enabled)!="undefined"&&window.dhx4.s2b(r[z].enabled)==false){r[z].state="disabled"}else{if(typeof(r[z].disabled)!="undefined"&&window.dhx4.s2b(r[z].disabled)==true){r[z].state="disabled"}}if(typeof(r[z].parent)=="undefined"){r[z].parent=(v!=null?v:this.idPrefix+this.topId)}if(r[z].type=="checkbox"){r[z].checked=window.dhx4.s2b(r[z].checked);r[z].imgen=r[z].imgdis="chbx_"+(r[z].checked?"1":"0")}if(r[z].type=="radio"){r[z].checked=window.dhx4.s2b(r[z].checked);r[z].imgen=r[z].imgdis="rdbt_"+(r[z].checked?"1":"0");if(typeof(r[z].group)=="undefined"||r[z].group==null){r[z].group=this._genStr(24)}if(this.radio[r[z].group]==null){this.radio[r[z].group]=[]}this.radio[r[z].group].push(r[z].id)}this.itemPull[r[z].id]=r[z];if(r[z].items!=null&&r[z].items.length>0){this.itemPull[r[z].id].complex=true;this._initObj(r[z].items,true,r[z].id)}else{if(this.conf.dload&&r[z].complex==true){this.itemPull[r[z].id].loaded="no"}}this.itemPull[r[z].id].items=null}if(q!==true){if(this.conf.dload==true){if(v==null){this._initTopLevelMenu()}else{this._addSubMenuPolygon(v,v);if(this.conf.selected==v){var s=(this.itemPull[v].parent==this.idPrefix+this.topId);var A=(s&&!this.conf.context?this.conf.dir_toplv:this.conf.dir_sublv);var x=false;if(s&&this.conf.top_mode&&this.conf.mode=="web"&&!this.conf.context){var a=this.idPull[v];if(a._mouseOver==true){var w=this.conf.top_tmtime-(new Date().getTime()-a._dynLoadTM);if(w>1){var t=v;var u=this;a._menuOpenTM=window.setTimeout(function(){u._showPolygon(t,A);u=t=null},w);x=true}}}if(!x){this._showPolygon(v,A)}}this.itemPull[v].loaded="yes";if(this.conf.dload_icon==true){this._updateLoaderIcon(v,false)}}}else{this._init()}}};dhtmlXMenuObject.prototype._xmlToJson=function(s,t){var q=[];if(t==null){var p=s.getElementsByTagName(this.conf.tags.root);if(p==null||(p!=null&&p.length==0)){return{items:[]}}p=p[0]}else{p=s}if(p.getAttribute("parentId")!=null){t=this.idPrefix+p.getAttribute("parentId")}for(var v=0;v<p.childNodes.length;v++){if(typeof(p.childNodes[v].tagName)!="undefined"&&String(p.childNodes[v].tagName).toLowerCase()==this.conf.tags.item){var w=p.childNodes[v];var d={id:this.idPrefix+(w.getAttribute("id")||this._genStr(24)),title:w.getAttribute("text")||"",imgen:w.getAttribute("img")||"",imgdis:w.getAttribute("imgdis")||"",tip:"",hotkey:"",type:w.getAttribute("type")||"item"};if(w.getAttribute("cssNormal")!=null){d.cssNormal=w.getAttribute("cssNormal")}if(d.type=="checkbox"){d.checked=w.getAttribute("checked")}if(d.type=="radio"){d.checked=w.getAttribute("checked");d.group=w.getAttribute("group")}d.state="enabled";if(w.getAttribute("enabled")!=null&&window.dhx4.s2b(w.getAttribute("enabled"))==false){d.state="disabled"}else{if(w.getAttribute("disabled")!=null&&window.dhx4.s2b(w.getAttribute("disabled"))==true){d.state="disabled"}}d.parent=(t!=null?t:this.idPrefix+this.topId);if(this.conf.dload){d.complex=(w.getAttribute("complex")!=null);if(d.complex){d.loaded="no"}}else{var u=this._xmlToJson(w,d.id);d.items=u.items;d.complex=(d.items.length>0)}for(var o=0;o<w.childNodes.length;o++){if(typeof(w.childNodes[o].tagName)!="undefined"){var i=String(w.childNodes[o].tagName||"").toLowerCase();if(i==this.conf.tags.userdata){var r=w.childNodes[o];if(r.getAttribute("name")!=null){this.userData[d.id+"_"+r.getAttribute("name")]=(r.firstChild!=null&&r.firstChild.nodeValue!=null?r.firstChild.nodeValue:"")}}if(i==this.conf.tags.text_ext){d.title=w.childNodes[o].firstChild.nodeValue}if(i==this.conf.tags.tooltip){d.tip=w.childNodes[o].firstChild.nodeValue}if(i==this.conf.tags.hotkey){d.hotkey=w.childNodes[o].firstChild.nodeValue}if(i==this.conf.tags.href&&d.type=="item"){d.href_link=w.childNodes[o].firstChild.nodeValue;if(w.childNodes[o].getAttribute("target")!=null){d.href_target=w.childNodes[o].getAttribute("target")}}}}q.push(d)}}var w={parentId:t,items:q};return w};dhtmlXMenuObject.prototype.enableDynamicLoading=function(d,c){this.conf.dload=true;this.conf.dload_url=d;this.conf.dload_sign=(String(this.conf.dload_url).search(/\?/)==-1?"?":"&");this.conf.dload_icon=c;this._init()};dhtmlXMenuObject.prototype._updateLoaderIcon=function(g,h){if(this.idPull[g]==null){return}if(String(this.idPull[g].className).search("TopLevel_Item")>=0){return}var e=(this.conf.rtl?0:2);if(!this.idPull[g].childNodes[e]){return}if(!this.idPull[g].childNodes[e].childNodes[0]){return}var f=this.idPull[g].childNodes[e].childNodes[0];if(String(f.className).search("complex_arrow")===0){f.className="complex_arrow"+(h?"_loading":"")}};dhtmlXMenuObject.prototype.addNewSibling=function(p,o,j,i,q,l){var m=this.idPrefix+(o!=null?o:this._genStr(24));var n=this.idPrefix+(p!=null?this.getParentId(p):this.topId);this._addItemIntoGlobalStrorage(m,n,j,"item",i,q,l);if((n==this.idPrefix+this.topId)&&(!this.conf.context)){this._renderToplevelItem(m,this.getItemPosition(p))}else{this._renderSublevelItem(m,this.getItemPosition(p))}};dhtmlXMenuObject.prototype.addNewChild=function(j,l,n,i,h,o,m){if(j==null){if(this.conf.context){j=this.topId}else{this.addNewSibling(j,n,i,h,o,m);if(l!=null){this.setItemPosition(n,l)}return}}n=this.idPrefix+(n!=null?n:this._genStr(24));if(this.setHotKey){this.setHotKey(j,"")}j=this.idPrefix+j;this._addItemIntoGlobalStrorage(n,j,i,"item",h,o,m);if(this.idPull["polygon_"+j]==null){this._renderSublevelPolygon(j,j)}this._renderSublevelItem(n,l-1);this._redefineComplexState(j)};dhtmlXMenuObject.prototype.removeItem=function(u,s,t){if(!s){u=this.idPrefix+u}var r=null;if(u!=this.idPrefix+this.topId){if(this.itemPull[u]==null){return}if(this.idPull["polygon_"+u]&&this.idPull["polygon_"+u]._tmShow){window.clearTimeout(this.idPull["polygon_"+u]._tmShow)}var a=this.itemPull[u]["type"];if(a=="separator"){var n=this.idPull["separator_"+u];if(this.itemPull[u]["parent"]==this.idPrefix+this.topId){n.onclick=null;n.onselectstart=null;n.id=null;n.parentNode.removeChild(n)}else{n.childNodes[0].childNodes[0].onclick=null;n.childNodes[0].childNodes[0].onselectstart=null;n.childNodes[0].childNodes[0].id=null;n.childNodes[0].removeChild(n.childNodes[0].childNodes[0]);n.removeChild(n.childNodes[0]);n.parentNode.removeChild(n)}this.idPull["separator_"+u]=null;this.itemPull[u]=null;delete this.idPull["separator_"+u];delete this.itemPull[u];n=null}else{r=this.itemPull[u]["parent"];var n=this.idPull[u];n.onclick=null;n.oncontextmenu=null;n.onmouseover=null;n.onmouseout=null;n.onselectstart=null;n.id=null;while(n.childNodes.length>0){n.removeChild(n.childNodes[0])}n.parentNode.removeChild(n);this.idPull[u]=null;this.itemPull[u]=null;delete this.idPull[u];delete this.itemPull[u];n=null}a=null}for(var p in this.itemPull){if(this.itemPull[p]["parent"]==u){this.removeItem(p,true,true)}}var o=new Array(u);if(r!=null&&!t){if(this.idPull["polygon_"+r]!=null){if(this.idPull["polygon_"+r].tbd.childNodes.length==0){o.push(r);this._updateItemComplexState(r,false,false)}}}for(var w=0;w<o.length;w++){if(this.idPull["polygon_"+o[w]]){var v=this.idPull["polygon_"+o[w]];v.onclick=null;v.oncontextmenu=null;v.tbl.removeChild(v.tbd);v.tbd=null;v.childNodes[1].removeChild(v.tbl);v.tbl=null;v.id=null;v.parentNode.removeChild(v);v=null;if(window.dhx4.isIE6){var q="polygon_"+o[w]+"_ie6cover";if(this.idPull[q]!=null){document.body.removeChild(this.idPull[q]);delete this.idPull[q]}}if(this.idPull["arrowup_"+u]!=null&&this._removeArrow){this._removeArrow("arrowup_"+u)}if(this.idPull["arrowdown_"+u]!=null&&this._removeArrow){this._removeArrow("arrowdown_"+u)}this.idPull["polygon_"+o[w]]=null;delete this.idPull["polygon_"+o[w]]}}o=null;if(this.conf.skin=="dhx_terrace"&&arguments.length==1){this._improveTerraceSkin()}};dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(l,j,q,m,p,i,n){var o={id:l,title:q,imgen:(i!=null?i:""),imgdis:(n!=null?n:""),type:m,state:(p==true?"disabled":"enabled"),parent:j,complex:false,hotkey:"",tip:""};this.itemPull[o.id]=o};dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.conf.context=true;if(this.base._autoSkinUpdate==true){this.base.className=this.base.className.replace("dhtmlxMenu_"+this.conf.skin+"_Middle","");this.base._autoSkinUpdate=false}if(this.conf.ctx_baseid!=null){this.addContextZone(this.conf.ctx_baseid)}};dhtmlXMenuObject.prototype.addContextZone=function(a){if(a==document.body){a="document.body."+this.idPrefix;var i=document.body}else{if(typeof(a)=="string"){var i=document.getElementById(a)}else{var i=a}}var g=false;for(var j in this.conf.ctx_zones){g=g||(j==a)||(this.conf.ctx_zones[j]==i)}if(g==true){return false}this.conf.ctx_zones[a]=i;var h=this;if(window.dhx4.isOpera){this.operaContext=function(b){h._doOnContextMenuOpera(b,h)};i.addEventListener("mouseup",this.operaContext,false)}else{if(i.oncontextmenu!=null&&!i._oldContextMenuHandler){i._oldContextMenuHandler=i.oncontextmenu}i.oncontextmenu=function(c){for(var b in dhtmlXMenuObject.prototype.liveInst){if(b!=h.conf.live_id){if(dhtmlXMenuObject.prototype.liveInst[b].context){dhtmlXMenuObject.prototype.liveInst[b]._hideContextMenu()}}}c=c||event;c.cancelBubble=true;if(c.preventDefault){c.preventDefault()}else{c.returnValue=false}h._doOnContextBeforeCall(c,this);return false}}};dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(f,e){for(var d in dhtmlXMenuObject.prototype.liveInst){if(d!=e.conf.live_id){if(dhtmlXMenuObject.prototype.liveInst[d].context){dhtmlXMenuObject.prototype.liveInst[d]._hideContextMenu()}}}f.cancelBubble=true;if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}if(f.button==0&&f.ctrlKey==true){e._doOnContextBeforeCall(f,this)}return false};dhtmlXMenuObject.prototype.removeContextZone=function(e){if(!this.isContextZone(e)){return false}if(e==document.body){e="document.body."+this.idPrefix}var d=this.conf.ctx_zones[e];if(window.dhx4.isOpera){d.removeEventListener("mouseup",this.operaContext,false)}else{d.oncontextmenu=(d._oldContextMenuHandler!=null?d._oldContextMenuHandler:null);d._oldContextMenuHandler=null}try{this.conf.ctx_zones[e]=null;delete this.conf.ctx_zones[e]}catch(f){}return true};dhtmlXMenuObject.prototype.isContextZone=function(d){if(d==document.body&&this.conf.ctx_zones["document.body."+this.idPrefix]!=null){return true}var c=false;if(this.conf.ctx_zones[d]!=null){if(this.conf.ctx_zones[d]==document.getElementById(d)){c=true}}return c};dhtmlXMenuObject.prototype._isContextMenuVisible=function(){if(this.idPull["polygon_"+this.idPrefix+this.topId]==null){return false}return(this.idPull["polygon_"+this.idPrefix+this.topId].style.display=="")};dhtmlXMenuObject.prototype._showContextMenu=function(d,f,e){this._clearAndHide();if(this.idPull["polygon_"+this.idPrefix+this.topId]==null){return false}window.clearTimeout(this.conf.tm_handler);this.idPull[this.idPrefix+this.topId]=new Array(d,f);this._showPolygon(this.idPrefix+this.topId,"bottom");this.callEvent("onContextMenu",[e])};dhtmlXMenuObject.prototype._hideContextMenu=function(){if(this.idPull["polygon_"+this.idPrefix+this.topId]==null){return false}this._clearAndHide();this._hidePolygon(this.idPrefix+this.topId)};dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(m,j){this.conf.ctx_zoneid=j.id;this._clearAndHide();this._hideContextMenu();if(window.dhx4.isChrome==true||window.dhx4.isEdge==true||window.dhx4.isOpera==true||window.dhx4.isIE11==true){var l=window.dhx4.absLeft(m.target)+m.offsetX;var n=window.dhx4.absTop(m.target)+m.offsetY}else{if(window.dhx4.isIE6==true||window.dhx4.isIE7==true||window.dhx4.isIE==true){var l=window.dhx4.absLeft(m.srcElement)+m.x||0;var n=window.dhx4.absTop(m.srcElement)+m.y||0}else{var o=(m.srcElement||m.target);var e=(window.dhx4.isIE||window.dhx4.isKHTML?m.offsetX:m.layerX);var i=(window.dhx4.isIE||window.dhx4.isKHTML?m.offsetY:m.layerY);var l=window.dhx4.absLeft(o)+e;var n=window.dhx4.absTop(o)+i}}if(this.checkEvent("onBeforeContextMenu")){if(this.callEvent("onBeforeContextMenu",[j.id,m])){if(this.conf.ctx_autoshow){this._showContextMenu(l,n,j.id);this.callEvent("onAfterContextMenu",[j.id,m])}}}else{if(this.conf.ctx_autoshow){this._showContextMenu(l,n,j.id);this.callEvent("onAfterContextMenu",[j.id])}}};dhtmlXMenuObject.prototype.showContextMenu=function(d,c){this._showContextMenu(d,c,false)};dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()};dhtmlXMenuObject.prototype.setAutoShowMode=function(b){this.conf.ctx_autoshow=(b==true?true:false)};dhtmlXMenuObject.prototype.setAutoHideMode=function(b){this.conf.ctx_autohide=(b==true?true:false)};dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(b){this.conf.ctx_hideall=(b==true?true:false)};dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.conf.ctx_hideall};dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var g in this.itemPull){if(this.itemPull[g].parent==this.idPrefix+this.topId&&this.idPull[g]!=null){var a=false;var b=false;if(this.idPull[g].parentNode.firstChild==this.idPull[g]){a=true}if(this.idPull[g].parentNode.lastChild==this.idPull[g]){b=true}for(var h in this.itemPull){if(this.itemPull[h].type=="separator"&&this.itemPull[h].parent==this.idPrefix+this.topId){if(this.idPull[g].nextSibling==this.idPull["separator_"+h]){b=true}if(this.idPull[g].previousSibling==this.idPull["separator_"+h]){a=true}}}this.idPull[g].style.borderLeftWidth=(a?"1px":"0px");this.idPull[g].style.borderTopLeftRadius=this.idPull[g].style.borderBottomLeftRadius=(a?"3px":"0px");this.idPull[g].style.borderTopRightRadius=this.idPull[g].style.borderBottomRightRadius=(b?"3px":"0px");this.idPull[g]._bl=a;this.idPull[g]._br=b}}};dhtmlXMenuObject.prototype._improveTerraceButton=function(c,d){if(d){this.idPull[c].style.borderBottomLeftRadius=(this.idPull[c]._bl?"3px":"0px");this.idPull[c].style.borderBottomRightRadius=(this.idPull[c]._br?"3px":"0px")}else{this.idPull[c].style.borderBottomLeftRadius="0px";this.idPull[c].style.borderBottomRightRadius="0px"}};if(typeof(window.dhtmlXCellObject)!="undefined"){dhtmlXCellObject.prototype._createNode_menu=function(h,f,i,g,j){if(typeof(j)!="undefined"){h=j}else{h=document.createElement("DIV");h.className="dhx_cell_menu_"+(this.conf.borders?"def":"no_borders");h.appendChild(document.createElement("DIV"))}this.cell.insertBefore(h,this.cell.childNodes[this.conf.idx.toolbar||this.conf.idx.cont]);this.conf.ofs_nodes.t.menu=true;this._updateIdx();return h};dhtmlXCellObject.prototype.attachMenu=function(b){if(this.dataNodes.menu){return}this.callEvent("_onBeforeContentAttach",["menu"]);if(typeof(b)=="undefined"){b={}}if(typeof(b.skin)=="undefined"){b.skin=this.conf.skin}b.parent=this._attachObject("menu").firstChild;this.dataNodes.menu=new dhtmlXMenuObject(b);this._adjustCont(this._idd);b.parent=null;b=null;this.callEvent("_onContentAttach",[]);return this.dataNodes.menu};dhtmlXCellObject.prototype.detachMenu=function(){if(this.dataNodes.menu==null){return}if(typeof(this.dataNodes.menu.unload)=="function"){this.dataNodes.menu.unload()}this.dataNodes.menu=null;delete this.dataNodes.menu;this._detachObject("menu")};dhtmlXCellObject.prototype.showMenu=function(){this._mtbShowHide("menu","")};dhtmlXCellObject.prototype.hideMenu=function(){this._mtbShowHide("menu","none")};dhtmlXCellObject.prototype.getAttachedMenu=function(){return this.dataNodes.menu}}dhtmlXMenuObject.prototype.setItemEnabled=function(b){this._changeItemState(b,"enabled",this._getItemLevelType(b))};dhtmlXMenuObject.prototype.setItemDisabled=function(b){this._changeItemState(b,"disabled",this._getItemLevelType(b))};dhtmlXMenuObject.prototype.isItemEnabled=function(b){return(this.itemPull[this.idPrefix+b]!=null?(this.itemPull[this.idPrefix+b]["state"]=="enabled"):false)};dhtmlXMenuObject.prototype._changeItemState=function(h,i,f){var j=false;var g=this.idPrefix+h;if((this.itemPull[g]!=null)&&(this.idPull[g]!=null)){if(this.itemPull[g]["state"]!=i){this.itemPull[g]["state"]=i;if(this.itemPull[g]["parent"]==this.idPrefix+this.topId&&!this.conf.context){this.idPull[g].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+(this.itemPull[g]["state"]=="enabled"?"Normal":"Disabled")}else{this.idPull[g].className="sub_item"+(this.itemPull[g]["state"]=="enabled"?"":"_dis")}this._updateItemComplexState(this.idPrefix+h,this.itemPull[this.idPrefix+h]["complex"],false);this._updateItemImage(h,f);if((this.idPrefix+this.conf.last_click==g)&&(f!="TopLevel")){this._redistribSubLevelSelection(g,this.itemPull[g]["parent"])}if(f=="TopLevel"&&!this.conf.context){}}}return j};dhtmlXMenuObject.prototype.getItemText=function(b){return(this.itemPull[this.idPrefix+b]!=null?this.itemPull[this.idPrefix+b]["title"]:"")};dhtmlXMenuObject.prototype.setItemText=function(h,i){h=this.idPrefix+h;if((this.itemPull[h]!=null)&&(this.idPull[h]!=null)){this._clearAndHide();this.itemPull[h]["title"]=i;if(this.itemPull[h]["parent"]==this.idPrefix+this.topId&&!this.conf.context){var j=null;for(var g=0;g<this.idPull[h].childNodes.length;g++){try{if(this.idPull[h].childNodes[g].className=="top_level_text"){j=this.idPull[h].childNodes[g]}}catch(e){}}if(String(this.itemPull[h]["title"]).length==""||this.itemPull[h]["title"]==null){if(j!=null){j.parentNode.removeChild(j)}}else{if(!j){j=document.createElement("DIV");j.className="top_level_text";if(this.conf.rtl&&this.idPull[h].childNodes.length>0){this.idPull[h].insertBefore(j,this.idPull[h].childNodes[0])}else{this.idPull[h].appendChild(j)}}j.innerHTML=this.itemPull[h]["title"]}}else{var j=null;for(var g=0;g<this.idPull[h].childNodes[1].childNodes.length;g++){if(String(this.idPull[h].childNodes[1].childNodes[g].className||"")=="sub_item_text"){j=this.idPull[h].childNodes[1].childNodes[g]}}if(String(this.itemPull[h]["title"]).length==""||this.itemPull[h]["title"]==null){if(j){j.parentNode.removeChild(j);j=null;this.idPull[h].childNodes[1].innerHTML="&nbsp;"}}else{if(!j){j=document.createElement("DIV");j.className="sub_item_text";this.idPull[h].childNodes[1].innerHTML="";this.idPull[h].childNodes[1].appendChild(j)}j.innerHTML=this.itemPull[h]["title"]}}}};dhtmlXMenuObject.prototype.loadFromHTML=function(m,i,l){var g=this.conf.tags.item;this.conf.tags.item="div";var j=(typeof(m)=="string"?document.getElementById(m):m);var h=this._xmlToJson(j,this.idPrefix+this.topId);this._initObj(h);this.conf.tags.item=g;if(i){j.parentNode.removeChild(j)}j=objOd=null;if(onload!=null){if(typeof(l)=="function"){l()}else{if(typeof(window[l])=="function"){window[l]()}}}};dhtmlXMenuObject.prototype.hideItem=function(b){this._changeItemVisible(b,false)};dhtmlXMenuObject.prototype.showItem=function(b){this._changeItemVisible(b,true)};dhtmlXMenuObject.prototype.isItemHidden=function(c){var d=null;if(this.idPull[this.idPrefix+c]!=null){d=(this.idPull[this.idPrefix+c].style.display=="none")}return d};dhtmlXMenuObject.prototype._changeItemVisible=function(f,d){var e=this.idPrefix+f;if(this.itemPull[e]==null){return}if(this.itemPull[e]["type"]=="separator"){e="separator_"+e}if(this.idPull[e]==null){return}this.idPull[e].style.display=(d?"":"none");this._redefineComplexState(this.itemPull[this.idPrefix+f]["parent"])};dhtmlXMenuObject.prototype.setUserData=function(f,e,d){this.userData[this.idPrefix+f+"_"+e]=d};dhtmlXMenuObject.prototype.getUserData=function(c,d){return(this.userData[this.idPrefix+c+"_"+d]!=null?this.userData[this.idPrefix+c+"_"+d]:null)};dhtmlXMenuObject.prototype.setOpenMode=function(b){this.conf.mode=(b=="win"?"win":"web")};dhtmlXMenuObject.prototype.setWebModeTimeout=function(b){this.conf.tm_sec=(!isNaN(b)?b:400)};dhtmlXMenuObject.prototype.getItemImage=function(c){var d=new Array(null,null);c=this.idPrefix+c;if(this.itemPull[c]["type"]=="item"){d[0]=this.itemPull[c]["imgen"];d[1]=this.itemPull[c]["imgdis"]}return d};dhtmlXMenuObject.prototype.setItemImage=function(f,e,d){if(this.itemPull[this.idPrefix+f]["type"]!="item"){return}this.itemPull[this.idPrefix+f]["imgen"]=e;this.itemPull[this.idPrefix+f]["imgdis"]=d;this._updateItemImage(f,this._getItemLevelType(f))};dhtmlXMenuObject.prototype.clearItemImage=function(b){this.setItemImage(b,"","")};dhtmlXMenuObject.prototype.setVisibleArea=function(e,f,g,h){this.conf.v_enabled=true;this.conf.v.x1=e;this.conf.v.x2=f;this.conf.v.y1=g;this.conf.v.y2=h};dhtmlXMenuObject.prototype.setTooltip=function(c,d){c=this.idPrefix+c;if(!(this.itemPull[c]!=null&&this.idPull[c]!=null)){return}this.idPull[c].title=(d.length>0?d:null);this.itemPull[c]["tip"]=d};dhtmlXMenuObject.prototype.getTooltip=function(b){if(this.itemPull[this.idPrefix+b]==null){return null}return this.itemPull[this.idPrefix+b]["tip"]};dhtmlXMenuObject.prototype.setTopText=function(b){if(this.conf.context){return}if(this._topText==null){this._topText=document.createElement("DIV");this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this.conf.rtl?"left":(this.conf.align=="left"?"right":"left"));this.base.appendChild(this._topText)}this._topText.innerHTML=b};dhtmlXMenuObject.prototype.setAlign=function(b){if(this.conf.align==b){return}if(b=="left"||b=="right"){this.conf.align=b;if(this.cont){this.cont.className=(this.conf.align=="right"?"align_right":"align_left")}if(this._topText!=null){this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this.conf.align=="left"?"right":"left")}}};dhtmlXMenuObject.prototype.setHref=function(f,e,d){if(this.itemPull[this.idPrefix+f]==null){return}this.itemPull[this.idPrefix+f]["href_link"]=e;if(d!=null){this.itemPull[this.idPrefix+f]["href_target"]=d}};dhtmlXMenuObject.prototype.clearHref=function(b){if(this.itemPull[this.idPrefix+b]==null){return}delete this.itemPull[this.idPrefix+b]["href_link"];delete this.itemPull[this.idPrefix+b]["href_target"]};dhtmlXMenuObject.prototype.getCircuit=function(c){var d=new Array(c);while(this.getParentId(c)!=this.topId){c=this.getParentId(c);d[d.length]=c}return d.reverse()};dhtmlXMenuObject.prototype._getCheckboxState=function(b){if(this.itemPull[this.idPrefix+b]==null){return null}return this.itemPull[this.idPrefix+b]["checked"]};dhtmlXMenuObject.prototype._setCheckboxState=function(c,d){if(this.itemPull[this.idPrefix+c]==null){return}this.itemPull[this.idPrefix+c]["checked"]=d};dhtmlXMenuObject.prototype._updateCheckboxImage=function(c){if(this.idPull[this.idPrefix+c]==null){return}this.itemPull[this.idPrefix+c]["imgen"]="chbx_"+(this._getCheckboxState(c)?"1":"0");this.itemPull[this.idPrefix+c]["imgdis"]=this.itemPull[this.idPrefix+c]["imgen"];try{this.idPull[this.idPrefix+c].childNodes[(this.conf.rtl?2:0)].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+c]["imgen"]}catch(d){}};dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(g,f,e){if(f.charAt(1)=="d"){return}if(this.itemPull[this.idPrefix+g]==null){return}var h=this._getCheckboxState(g);if(this.checkEvent("onCheckboxClick")){if(this.callEvent("onCheckboxClick",[g,h,this.conf.ctx_zoneid,e])){this.setCheckboxState(g,!h)}}else{this.setCheckboxState(g,!h)}if(this.checkEvent("onClick")){this.callEvent("onClick",[g])}};dhtmlXMenuObject.prototype.setCheckboxState=function(c,d){this._setCheckboxState(c,d);this._updateCheckboxImage(c)};dhtmlXMenuObject.prototype.getCheckboxState=function(b){return this._getCheckboxState(b)};dhtmlXMenuObject.prototype.addCheckbox=function(p,t,o,n,m,w,s){if(this.conf.context&&t==this.topId){}else{if(this.itemPull[this.idPrefix+t]==null){return}if(p=="child"&&this.itemPull[this.idPrefix+t]["type"]!="item"){return}}var r="chbx_"+(w?"1":"0");var u=r;if(p=="sibling"){var v=this.idPrefix+(n!=null?n:this._genStr(24));var q=this.idPrefix+this.getParentId(t);this._addItemIntoGlobalStrorage(v,q,m,"checkbox",s,r,u);this.itemPull[v]["checked"]=w;this._renderSublevelItem(v,this.getItemPosition(t))}else{var v=this.idPrefix+(n!=null?n:this._genStr(24));var q=this.idPrefix+t;this._addItemIntoGlobalStrorage(v,q,m,"checkbox",s,r,u);this.itemPull[v]["checked"]=w;if(this.idPull["polygon_"+q]==null){this._renderSublevelPolygon(q,q)}this._renderSublevelItem(v,o-1);this._redefineComplexState(q)}};dhtmlXMenuObject.prototype.setHotKey=function(i,h){i=this.idPrefix+i;if(!(this.itemPull[i]!=null&&this.idPull[i]!=null)){return}if(this.itemPull[i]["parent"]==this.idPrefix+this.topId&&!this.conf.context){return}if(this.itemPull[i]["complex"]){return}var e=this.itemPull[i]["type"];if(!(e=="item"||e=="checkbox"||e=="radio")){return}var j=null;try{if(this.idPull[i].childNodes[this.conf.rtl?0:2].childNodes[0].className=="sub_item_hk"){j=this.idPull[i].childNodes[this.conf.rtl?0:2].childNodes[0]}}catch(l){}if(h.length==0){this.itemPull[i]["hotkey_backup"]=this.itemPull[i]["hotkey"];this.itemPull[i]["hotkey"]="";if(j!=null){j.parentNode.removeChild(j)}}else{this.itemPull[i]["hotkey"]=h;this.itemPull[i]["hotkey_backup"]=null;if(j==null){j=document.createElement("DIV");j.className="sub_item_hk";var m=this.idPull[i].childNodes[this.conf.rtl?0:2];while(m.childNodes.length>0){m.removeChild(m.childNodes[0])}m.appendChild(j)}j.innerHTML=h}};dhtmlXMenuObject.prototype.getHotKey=function(b){if(this.itemPull[this.idPrefix+b]==null){return null}return this.itemPull[this.idPrefix+b]["hotkey"]};dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(e){var f=this._getSubItemToDeselectByPolygon(e);for(var d=0;d<this.conf.opened_poly.length;d++){if(this.conf.opened_poly[d]!=e){this._hidePolygon(this.conf.opened_poly[d])}}for(var d=0;d<f.length;d++){if(this.idPull[f[d]]!=null&&this.itemPull[f[d]]["state"]=="enabled"){this.idPull[f[d]].className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Item_Normal"}}};dhtmlXMenuObject.prototype._checkArrowsState=function(g){var e=this.idPull["polygon_"+g].childNodes[1];var h=this.idPull["arrowup_"+g];var f=this.idPull["arrowdown_"+g];if(e.scrollTop==0){h.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp_Disabled"}else{h.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp"+(h.over?"_Over":"")}if(e.scrollTop+e.offsetHeight<e.scrollHeight){f.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown"+(f.over?"_Over":"")}else{f.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown_Disabled"}e=h=f=null};dhtmlXMenuObject.prototype._addUpArrow=function(g){var e=this;var h=document.createElement("DIV");h.pId=this.idPrefix+g;h.id="arrowup_"+this.idPrefix+g;h.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp";h.over=false;h.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};h.oncontextmenu=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};h.onmouseover=function(){if(e.conf.mode=="web"){window.clearTimeout(e.conf.tm_handler)}e._clearAllSelectedSubItemsInPolygon(this.pId);if(this.className=="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"){return}this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Over";this.over=true;e._canScrollUp=true;e._doScrollUp(this.pId,true)};h.onmouseout=function(){if(e.conf.mode=="web"){window.clearTimeout(e.conf.tm_handler);e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")}this.over=false;e._canScrollUp=false;if(this.className=="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp_Disabled"){return}this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowUp";window.clearTimeout(e.conf.of_utm)};h.onclick=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}a.cancelBubble=true;return false};var f=this.idPull["polygon_"+this.idPrefix+g];f.childNodes[0].appendChild(h);this.idPull[h.id]=h;f=h=null};dhtmlXMenuObject.prototype._addDownArrow=function(g){var e=this;var h=document.createElement("DIV");h.pId=this.idPrefix+g;h.id="arrowdown_"+this.idPrefix+g;h.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown";h.over=false;h.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};h.oncontextmenu=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false};h.onmouseover=function(){if(e.conf.mode=="web"){window.clearTimeout(e.conf.tm_handler)}e._clearAllSelectedSubItemsInPolygon(this.pId);if(this.className=="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"){return}this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Over";this.over=true;e._canScrollDown=true;e._doScrollDown(this.pId,true)};h.onmouseout=function(){if(e.conf.mode=="web"){window.clearTimeout(e.conf.tm_handler);e.conf.tm_handler=window.setTimeout(function(){e._clearAndHide()},e.conf.tm_sec,"JavaScript")}this.over=false;e._canScrollDown=false;if(this.className=="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown_Disabled"){return}this.className="dhtmlxMenu_"+e.conf.skin+"_SubLevelArea_ArrowDown";window.clearTimeout(e.conf.of_dtm)};h.onclick=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}a.cancelBubble=true;return false};var f=this.idPull["polygon_"+this.idPrefix+g];f.childNodes[2].appendChild(h);this.idPull[h.id]=h;f=h=null};dhtmlXMenuObject.prototype._removeUpArrow=function(c){var d="arrowup_"+this.idPrefix+c;this._removeArrow(d)};dhtmlXMenuObject.prototype._removeDownArrow=function(c){var d="arrowdown_"+this.idPrefix+c;this._removeArrow(d)};dhtmlXMenuObject.prototype._removeArrow=function(e){var d=this.idPull[e];d.onselectstart=null;d.oncontextmenu=null;d.onmouseover=null;d.onmouseout=null;d.onclick=null;if(d.parentNode){d.parentNode.removeChild(d)}d=null;this.idPull[e]=null;try{delete this.idPull[e]}catch(f){}};dhtmlXMenuObject.prototype._isArrowExists=function(b){if(this.idPull["arrowup_"+b]!=null&&this.idPull["arrowdown_"+b]!=null){return true}return false};dhtmlXMenuObject.prototype._doScrollUp=function(i,l){var h=this.idPull["polygon_"+i].childNodes[1];if(this._canScrollUp&&h.scrollTop>0){var m=false;var j=h.scrollTop-this.conf.of_ustep;if(j<0){m=true;j=0}h.scrollTop=j;if(!m){var g=this;this.conf.of_utm=window.setTimeout(function(){g._doScrollUp(i,false);g=null},this.conf.of_utime)}else{l=true}}else{this._canScrollUp=false;this._checkArrowsState(i)}if(l){this._checkArrowsState(i)}};dhtmlXMenuObject.prototype._doScrollDown=function(i,l){var h=this.idPull["polygon_"+i].childNodes[1];if(this._canScrollDown&&h.scrollTop+h.offsetHeight<=h.scrollHeight){var m=false;var j=h.scrollTop+this.conf.of_dstep;if(j+h.offsetHeight>=h.scrollHeight){m=true;j=h.scrollHeight-h.offsetHeight}h.scrollTop=j;if(!m){var g=this;this.conf.of_dtm=window.setTimeout(function(){g._doScrollDown(i,false);g=null},this.conf.of_dtime)}else{l=true}}else{this._canScrollDown=false;this._checkArrowsState(i)}if(l){this._checkArrowsState(i)}};dhtmlXMenuObject.prototype._countPolygonItems=function(g){var i=0;for(var a in this.itemPull){var j=this.itemPull[a]["parent"];var h=this.itemPull[a]["type"];if(j==this.idPrefix+g&&(h=="item"||h=="radio"||h=="checkbox")){i++}}return i};dhtmlXMenuObject.prototype.setOverflowHeight=function(a){if(a==="auto"){this.conf.overflow_limit=0;this.conf.auto_overflow=true;return}if(this.conf.overflow_limit==0&&a<=0){return}this._clearAndHide();if(this.conf.overflow_limit>=0&&a>0){this.conf.overflow_limit=a;return}if(this.conf.overflow_limit>0&&a<=0){for(var b in this.itemPull){if(this._isArrowExists(b)){var f=String(b).replace(this.idPrefix,"");this._removeUpArrow(f);this._removeDownArrow(f);this.idPull["polygon_"+b].childNodes[1].style.height=""}}this.conf.overflow_limit=0;return}};dhtmlXMenuObject.prototype._getRadioImgObj=function(f){try{var e=this.idPull[this.idPrefix+f].childNodes[(this.conf.rtl?2:0)].childNodes[0]}catch(d){var e=null}return e};dhtmlXMenuObject.prototype._setRadioState=function(g,h){var e=this._getRadioImgObj(g);if(e!=null){var f=this.itemPull[this.idPrefix+g];f.checked=h;f.imgen="rdbt_"+(f.checked?"1":"0");f.imgdis=f.imgen;e.className="sub_icon "+f.imgen}};dhtmlXMenuObject.prototype._radioOnClickHandler=function(g,f,e){if(f.charAt(1)=="d"||this.itemPull[this.idPrefix+g]["group"]==null){return}var h=this.itemPull[this.idPrefix+g]["group"];if(this.checkEvent("onRadioClick")){if(this.callEvent("onRadioClick",[h,this.getRadioChecked(h),g,this.conf.ctx_zoneid,e])){this.setRadioChecked(h,g)}}else{this.setRadioChecked(h,g)}if(this.checkEvent("onClick")){this.callEvent("onClick",[g])}};dhtmlXMenuObject.prototype.getRadioChecked=function(l){var i=null;for(var m=0;m<this.radio[l].length;m++){var j=this.radio[l][m].replace(this.idPrefix,"");var h=this._getRadioImgObj(j);if(h!=null){var g=(h.className).match(/rdbt_1$/gi);if(g!=null){i=j}}}return i};dhtmlXMenuObject.prototype.setRadioChecked=function(e,g){if(this.radio[e]==null){return}for(var f=0;f<this.radio[e].length;f++){var h=this.radio[e][f].replace(this.idPrefix,"");this._setRadioState(h,(h==g))}};dhtmlXMenuObject.prototype.addRadioButton=function(s,w,r,q,p,o,A,v){if(this.conf.context&&w==this.topId){}else{if(this.itemPull[this.idPrefix+w]==null){return}if(s=="child"&&this.itemPull[this.idPrefix+w]["type"]!="item"){return}}var y=this.idPrefix+(q!=null?q:this._genStr(24));var u="rdbt_"+(A?"1":"0");var z=u;if(s=="sibling"){var t=this.idPrefix+this.getParentId(w);this._addItemIntoGlobalStrorage(y,t,p,"radio",v,u,z);this._renderSublevelItem(y,this.getItemPosition(w))}else{var t=this.idPrefix+w;this._addItemIntoGlobalStrorage(y,t,p,"radio",v,u,z);if(this.idPull["polygon_"+t]==null){this._renderSublevelPolygon(t,t)}this._renderSublevelItem(y,r-1);this._redefineComplexState(t)}var x=(o!=null?o:this._genStr(24));this.itemPull[y]["group"]=x;if(this.radio[x]==null){this.radio[x]=new Array()}this.radio[x][this.radio[x].length]=y;if(A==true){this.setRadioChecked(x,String(y).replace(this.idPrefix,""))}};dhtmlXMenuObject.prototype.serialize=function(){var b="<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>";return b};dhtmlXMenuObject.prototype._readLevel=function(s){var r="";for(var n in this.itemPull){if(this.itemPull[n]["parent"]==s){var u="";var t="";var a="";var o=String(this.itemPull[n]["id"]).replace(this.idPrefix,"");var p="";var m=(this.itemPull[n]["title"]!=""?' text="'+this.itemPull[n]["title"]+'"':"");var q="";if(this.itemPull[n]["type"]=="item"){if(this.itemPull[n]["imgen"]!=""){u=' img="'+this.itemPull[n]["imgen"]+'"'}if(this.itemPull[n]["imgdis"]!=""){t=' imgdis="'+this.itemPull[n]["imgdis"]+'"'}if(this.itemPull[n]["hotkey"]!=""){a="<hotkey>"+this.itemPull[n]["hotkey"]+"</hotkey>"}}if(this.itemPull[n]["type"]=="separator"){p=' type="separator"'}else{if(this.itemPull[n]["state"]=="disabled"){q=' enabled="false"'}}if(this.itemPull[n]["type"]=="checkbox"){p=' type="checkbox"'+(this.itemPull[n]["checked"]?' checked="true"':"")}if(this.itemPull[n]["type"]=="radio"){p=' type="radio" group="'+this.itemPull[n]["group"]+'" '+(this.itemPull[n]["checked"]?' checked="true"':"")}r+="<item id='"+o+"'"+m+p+u+t+q+">";r+=a;if(this.itemPull[n]["complex"]){r+=this._readLevel(n)}r+="</item>"}}return r};dhtmlXMenuObject.prototype.enableEffect=function(h,f,g){this._menuEffect=(h=="opacity"||h=="slide"||h=="slide+"?h:false);this._pOpStyleIE=(navigator.userAgent.search(/MSIE\s[678]\.0/gi)>=0);for(var a in this.idPull){if(a.search(/polygon/)===0){this._pOpacityApply(a,(this._pOpStyleIE?100:1));this.idPull[a].style.height=""}}this._pOpMax=(typeof(f)=="undefined"?100:f)/(this._pOpStyleIE?1:100);this._pOpStyleName=(this._pOpStyleIE?"filter":"opacity");this._pOpStyleValue=(this._pOpStyleIE?"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)":"#");this._pSlSteps=(this._pOpStyleIE?10:20);this._pSlTMTimeMax=g||50};dhtmlXMenuObject.prototype._showPolygonEffect=function(b){this._pShowHide(b,true)};dhtmlXMenuObject.prototype._hidePolygonEffect=function(b){this._pShowHide(b,false)};dhtmlXMenuObject.prototype._pOpacityApply=function(d,c){this.idPull[d].style[this._pOpStyleName]=String(this._pOpStyleValue).replace("#",c||this.idPull[d]._op)};dhtmlXMenuObject.prototype._pShowHide=function(d,c){if(!this.idPull){return}if(this.idPull[d]._tmShow!=null){if((this.idPull[d]._step_h>0&&c==true)||(this.idPull[d]._step_h<0&&c==false)){return}window.clearTimeout(this.idPull[d]._tmShow);this.idPull[d]._tmShow=null;this.idPull[d]._max_h=null}if(c==false&&(this.idPull[d].style.visibility=="hidden"||this.idPull[d].style.display=="none")){return}if(c==true&&this.idPull[d].style.display=="none"){this.idPull[d].style.visibility="hidden";this.idPull[d].style.display=""}if(this.idPull[d]._max_h==null){this.idPull[d]._max_h=parseInt(this.idPull[d].offsetHeight);this.idPull[d]._h=(c==true?0:this.idPull[d]._max_h);this.idPull[d]._step_h=Math.round(this.idPull[d]._max_h/this._pSlSteps)*(c==true?1:-1);if(this.idPull[d]._step_h==0){return}this.idPull[d]._step_tm=Math.round(this._pSlTMTimeMax/this._pSlSteps);if(this._menuEffect=="slide+"||this._menuEffect=="opacity"){this.idPull[d].op_tm=this.idPull[d]._step_tm;this.idPull[d].op_step=(this._pOpMax/this._pSlSteps)*(c==true?1:-1);if(this._pOpStyleIE){this.idPull[d].op_step=Math.round(this.idPull[d].op_step)}this.idPull[d]._op=(c==true?0:this._pOpMax);this._pOpacityApply(d)}else{this.idPull[d]._op=(this._pOpStyleIE?100:1);this._pOpacityApply(d)}if(this._menuEffect.search(/slide/)===0){this.idPull[d].style.height="0px"}this.idPull[d].style.visibility="visible"}this._pEffectSet(d,this.idPull[d]._h+this.idPull[d]._step_h)};dhtmlXMenuObject.prototype._pEffectSet=function(f,d){if(!this.idPull){return}if(this.idPull[f]._tmShow){window.clearTimeout(this.idPull[f]._tmShow)}this.idPull[f]._h=Math.max(0,Math.min(d,this.idPull[f]._max_h));if(this._menuEffect.search(/slide/)===0){this.idPull[f].style.height=this.idPull[f]._h+"px"}d+=this.idPull[f]._step_h;if(this._menuEffect=="slide+"||this._menuEffect=="opacity"){this.idPull[f]._op=Math.max(0,Math.min(this._pOpMax,this.idPull[f]._op+this.idPull[f].op_step));this._pOpacityApply(f)}if((this.idPull[f]._step_h>0&&d<=this.idPull[f]._max_h)||(this.idPull[f]._step_h<0&&d>=0)){var e=this;this.idPull[f]._tmShow=window.setTimeout(function(){e._pEffectSet(f,d)},this.idPull[f]._step_tm)}else{if(this._menuEffect.search(/slide/)===0){this.idPull[f].style.height=""}if(this.idPull[f]._step_h<0){this.idPull[f].style.visibility="hidden"}if(this._menuEffect=="slide+"||this._menuEffect=="opacity"){this.idPull[f]._op=(this.idPull[f]._step_h<0?(this._pOpStyleIE?100:1):this._pOpMax);this._pOpacityApply(f)}this.idPull[f]._tmShow=null;this.idPull[f]._h=null;this.idPull[f]._max_h=null;this.idPull[f]._step_tm=null}};function dhtmlXToolbarObject(d,f){var e=this;this.conf={skin:(f||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxtoolbar")||"material"),align:"left",align_autostart:"left",icons_path:"",icons_css:false,iconSize:18,sel_ofs_x:0,sel_ofs_y:0,xml_autoload:null,items_autoload:null,cssShadow:(dhx4.isIE6||dhx4.isIE7||dhx4.isIE8?"":" dhx_toolbar_shadow")};if(typeof(d)=="object"&&d!=null&&typeof(d.tagName)=="undefined"){if(d.icons_path!=null||d.icon_path!=null){this.conf.icons_path=(d.icons_path||d.icon_path)}if(d.icons_size!=null){this.conf.icons_size_autoload=d.icons_size}if(d.iconset!=null){this.conf.icons_css=(d.iconset=="awesome")}if(d.json!=null){this.conf.json_autoload=d.json}if(d.xml!=null){this.conf.xml_autoload=d.xml}if(d.onload!=null){this.conf.onload_autoload=d.onload}if(d.onclick!=null||d.onClick!=null){this.conf.auto_onclick=(d.onclick||d.onClick)}if(d.items!=null){this.conf.items_autoload=d.items}if(d.skin!=null){this.conf.skin=d.skin}if(d.align!=null){this.conf.align_autostart=d.align}d=d.parent}this.cont=(typeof(d)!="object")?document.getElementById(d):d;while(this.cont.childNodes.length>0){this.cont.removeChild(this.cont.childNodes[0])}d=null;this.cont.dir="ltr";this.base=document.createElement("DIV");this.base.className="dhxtoolbar_float_left";this.cont.appendChild(this.base);this.cont.ontouchstart=function(a){a=a||event;if((String(a.target.tagName||"").toLowerCase()=="input")){return true}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}a.cancelBubble=true;return false};this.setSkin(this.conf.skin);this.objPull={};this.anyUsed=null;this._genStr=function(h){var c="dhxId_";var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var b=0;b<h;b++){c+=a.charAt(Math.round(Math.random()*(a.length-1)))}return c};this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput");this.idPrefix=this._genStr(12);window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson","toolbar",{struct:true});window.dhx4._eventable(this);this._getObj=function(a,h){var c=null;for(var b=0;b<a.childNodes.length;b++){if(a.childNodes[b].tagName!=null){if(String(a.childNodes[b].tagName).toLowerCase()==String(h).toLowerCase()){c=a.childNodes[b]}}}return c};this._addImgObj=function(a){var b=document.createElement(this.conf.icons_css==true?"I":"IMG");if(a.childNodes.length>0){a.insertBefore(b,a.childNodes[0])}else{a.appendChild(b)}return b};this._setItemImage=function(a,c,h){if(h==true){a.imgEn=c}else{a.imgDis=c}if((!a.state&&h==true)||(a.state&&h==false)){return}if(this.conf.icons_css==true){var b=this._getObj(a.obj,"i");if(b==null){b=this._addImgObj(a.obj)}b.className=this.conf.icons_path+c}else{var b=this._getObj(a.obj,"img");if(b==null){b=this._addImgObj(a.obj)}b.src=this.conf.icons_path+c}};this._clearItemImage=function(a,c){if(c==true){a.imgEn=""}else{a.imgDis=""}if((!a.state&&c==true)||(a.state&&c==false)){return}var b=this._getObj(a.obj,(this.conf.icons_css?"i":"img"));if(b!=null){b.parentNode.removeChild(b)}};this._setItemText=function(c,a){var b=this._getObj(c.obj,"div");if(a==null||a.length==0){if(b!=null){b.parentNode.removeChild(b)}return}if(b==null){b=document.createElement("DIV");b.className="dhxtoolbar_text";c.obj.appendChild(b)}b.innerHTML=a};this._getItemText=function(b){var a=this._getObj(b.obj,"div");if(a!=null){return a.innerHTML}return""};this._enableItem=function(a){if(a.state){return}a.state=true;if(this.objPull[a.id]["type"]=="buttonTwoState"&&this.objPull[a.id]["obj"]["pressed"]==true){a.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres";a.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"}else{a.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def";a.obj.renderAs=a.obj.className}if(a.arw){a.arw.className=String(a.obj.className).replace("btn","arw")}var b=this._getObj(a.obj,(this.conf.icons_css?"i":"img"));if(a.imgEn!=""){if(b==null){b=this._addImgObj(a.obj)}b[this.conf.icons_css?"className":"src"]=this.conf.icons_path+a.imgEn}else{if(b!=null){b.parentNode.removeChild(b)}}};this._disableItem=function(a){if(!a.state){return}a.state=false;a.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.objPull[a.id]["type"]=="buttonTwoState"&&a.obj.pressed?"pres_":"")+"dis";a.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def";if(a.arw){a.arw.className=String(a.obj.className).replace("btn","arw")}var b=this._getObj(a.obj,(this.conf.icons_css?"i":"img"));if(a.imgDis!=""){if(b==null){b=this._addImgObj(a.obj)}b[this.conf.icons_css?"className":"src"]=this.conf.icons_path+a.imgDis}else{if(b!=null){b.parentNode.removeChild(b)}}if(a.polygon!=null){if(a.polygon.style.display!="none"){window.dhx4.zim.clear(a.polygon._idd);a.polygon.style.display="none";if(a.polygon._ie6cover){a.polygon._ie6cover.style.display="none"}if(this.conf.skin=="dhx_terrace"){this._improveTerraceButtonSelect(a.id,true)}this.callEvent("onButtonSelectHide",[a.obj.idd])}}this.anyUsed=null};this.clearAll=function(){for(var a in this.objPull){this._removeItem(String(a).replace(this.idPrefix,""))}this._spacer=null};this._doOnClick=function(a){if(e&&e.forEachItem){e.forEachItem(function(b){if(e.objPull[e.idPrefix+b].type=="buttonSelect"){var c=e.objPull[e.idPrefix+b];if(c.arw._skip===true){c.arw._skip=false}else{if(c.polygon.style.display!="none"){c.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_def";c.obj.className=c.obj.renderAs;c.arw.className=String(c.obj.renderAs).replace("btn","arw");e.anyUsed=null;e.conf.touch_id=null;window.dhx4.zim.clear(c.polygon._idd);c.polygon.style.display="none";if(c.polygon._ie6cover){c.polygon._ie6cover.style.display="none"}if(e.conf.skin=="dhx_terrace"){e._improveTerraceButtonSelect(c.id,true)}e.callEvent("onButtonSelectHide",[c.obj.idd])}}}})}};if(typeof(window.addEventListener)!="undefined"){window.addEventListener("mousedown",this._doOnClick,false);window.addEventListener("touchstart",this._doOnClick,false)}else{document.body.attachEvent("onmousedown",this._doOnClick)}if(this.conf.icons_size_autoload!=null){this.setIconSize(this.conf.icons_size_autoload);this.conf.icons_size_autoload=null}if(this.conf.items_autoload!=null){this.loadStruct(this.conf.items_autoload,this.conf.onload_autoload);this.conf.items_autoload=null}else{if(this.conf.json_autoload!=null){this.loadStruct(this.conf.json_autoload,this.conf.onload_autoload);this.conf.json_autoload=null}else{if(this.conf.xml_autoload!=null){this.loadStruct(this.conf.xml_autoload,this.conf.onload_autoload);this.conf.xml_autoload=null}}}if(this.conf.align_autostart!=this.conf.align){this.setAlign(this.conf.align_autostart);this.conf.align_autostart=null}if(typeof(this.conf.auto_onclick)=="function"){this.attachEvent("onClick",this.conf.auto_onclick)}else{if(typeof(this.conf.auto_onclick)=="string"&&typeof(window[this.conf.auto_onclick])=="function"){this.attachEvent("onClick",window[this.conf.auto_onclick])}}return this}dhtmlXToolbarObject.prototype.addSpacer=function(o){var h=this.idPrefix+o;if(this._spacer!=null){if(this._spacer.idd==o){return}if(this._spacer==this.objPull[h].obj.parentNode){var i=true;while(i){var j=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]);if(j==o||this._spacer.childNodes.length==0){if(this.objPull[h].arw!=null){this.base.appendChild(this.objPull[h].arw)}i=false}}this._spacer.idd=o;this._fixSpacer();return}if(this.base==this.objPull[h].obj.parentNode){var i=true;var l=(this.objPull[h].arw!=null);while(i){var n=this.base.childNodes.length-1;if(l==true){if(this.base.childNodes[n]==this.objPull[h].arw){i=false}}if(this.base.childNodes[n].idd==o){i=false}if(i){if(this._spacer.childNodes.length>0){this._spacer.insertBefore(this.base.childNodes[n],this._spacer.childNodes[0])}else{this._spacer.appendChild(this.base.childNodes[n])}}}this._spacer.idd=o;this._fixSpacer();return}}else{var m=null;for(var n=0;n<this.base.childNodes.length;n++){if(this.base.childNodes[n]==this.objPull[this.idPrefix+o].obj){m=n;if(this.objPull[this.idPrefix+o].arw!=null){m=n+1}}}if(m!=null){this._spacer=document.createElement("DIV");this._spacer.className=(this.conf.align=="right"?" dhxtoolbar_float_left":" dhxtoolbar_float_right");this._spacer.dir="ltr";this._spacer.idd=o;while(this.base.childNodes.length>m+1){this._spacer.appendChild(this.base.childNodes[m+1])}this.cont.appendChild(this._spacer);this._fixSpacer()}}if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXToolbarObject.prototype.removeSpacer=function(){if(!this._spacer){return}while(this._spacer.childNodes.length>0){this.base.appendChild(this._spacer.childNodes[0])}this._spacer.parentNode.removeChild(this._spacer);this._spacer=null;if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXToolbarObject.prototype._fixSpacer=function(){if(typeof(window.addEventListener)=="undefined"&&this._spacer!=null){this._spacer.style.borderLeft="1px solid #a4bed4";var b=this._spacer;window.setTimeout(function(){b.style.borderLeft="0px solid #a4bed4";b=null},1)}};dhtmlXToolbarObject.prototype.getType=function(h){var g=this.getParentId(h);if(g!=null){var e=null;var f=this.objPull[this.idPrefix+g]._listOptions[h];if(f!=null){if(f.sep!=null){e="buttonSelectSeparator"}else{e="buttonSelectButton"}}return e}else{if(this.objPull[this.idPrefix+h]==null){return null}return this.objPull[this.idPrefix+h]["type"]}};dhtmlXToolbarObject.prototype.getTypeExt=function(c){var d=this.getType(c);if(d=="buttonSelectButton"||d=="buttonSelectSeparator"){if(d=="buttonSelectButton"){d="button"}else{d="separator"}return d}return null};dhtmlXToolbarObject.prototype.inArray=function(f,d){for(var e=0;e<f.length;e++){if(f[e]==d){return true}}return false};dhtmlXToolbarObject.prototype.getParentId=function(b){var a=null;for(var g in this.objPull){if(this.objPull[g]._listOptions){for(var h in this.objPull[g]._listOptions){if(h==b){a=String(g).replace(this.idPrefix,"")}}}}return a};dhtmlXToolbarObject.prototype._addItem=function(d,c){if(typeof(d.text)=="string"){d.text=window.dhx4.trim(d.text);if(d.text.length==0){d.text=null}}this._addItemToStorage(d,c);if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXToolbarObject.prototype.addButton=function(h,i,f,g,j){this._addItem({id:h,type:"button",text:f,img:g,imgdis:j},i)};dhtmlXToolbarObject.prototype.addText=function(f,d,e){this._addItem({id:f,type:"text",text:e},d)};dhtmlXToolbarObject.prototype.addButtonSelect=function(x,t,q,A,z,s,u,o,w,v){var p=[];for(var y=0;y<A.length;y++){var r={};if(A[y] instanceof Array){r.id=A[y][0];r.type=(A[y][1]=="obj"?"button":"separator");r.text=(A[y][2]||null);r.img=(A[y][3]||null)}else{if(A[y] instanceof Object&&A[y]!=null&&typeof(A[y].id)!="undefined"&&typeof(A[y].type)!="undefined"){r.id=A[y].id;r.type=(A[y].type=="obj"?"button":"separator");r.text=A[y].text;r.img=A[y].img}}p.push(r)}this._addItem({id:x,type:"buttonSelect",text:q,img:z,imgdis:s,renderSelect:u,openAll:o,options:p,maxOpen:w,mode:v},t)};dhtmlXToolbarObject.prototype.addButtonTwoState=function(h,i,f,g,j){this._addItem({id:h,type:"buttonTwoState",img:g,imgdis:j,text:f},i)};dhtmlXToolbarObject.prototype.addSeparator=function(c,d){this._addItem({id:c,type:"separator"},d)};dhtmlXToolbarObject.prototype.addSlider=function(r,m,o,p,j,q,n,s,l){this._addItem({id:r,type:"slider",length:o,valueMin:p,valueMax:j,valueNow:q,textMin:n,textMax:s,toolTip:l},m)};dhtmlXToolbarObject.prototype.addInput=function(g,h,e,f){this._addItem({id:g,type:"buttonInput",value:e,width:f},h)};dhtmlXToolbarObject.prototype.forEachItem=function(d){for(var a in this.objPull){if(this.inArray(this.rootTypes,this.objPull[a]["type"])){d(this.objPull[a]["id"].replace(this.idPrefix,""))}}};(function(){var i="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(",");var m=[false,"","",false,"","","","","","","","","",false,"","","",null,"",[null,null],"",[null,null],"",null];var g=function(b,a){return function(c,d,e){c=this.idPrefix+c;if(this.objPull[c][b]!=null){return this.objPull[c][b].call(this.objPull[c],d,e)}else{return a}}};for(var j=0;j<i.length;j++){var h=i[j];var l=m[j];dhtmlXToolbarObject.prototype[h]=g(h,l)}})();dhtmlXToolbarObject.prototype.showItem=function(b){b=this.idPrefix+b;if(this.objPull[b]!=null&&this.objPull[b].showItem!=null){this.objPull[b].showItem();if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}}};dhtmlXToolbarObject.prototype.hideItem=function(b){b=this.idPrefix+b;if(this.objPull[b]!=null&&this.objPull[b].hideItem!=null){this.objPull[b].hideItem();if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}}};dhtmlXToolbarObject.prototype.getPosition=function(b){return this._getPosition(b)};dhtmlXToolbarObject.prototype._getPosition=function(h,j){if(this.objPull[this.idPrefix+h]==null){return null}var i=null;var g=0;for(var f=0;f<this.base.childNodes.length;f++){if(this.base.childNodes[f].idd!=null){if(this.base.childNodes[f].idd==h){i=g}g++}}if(!i&&this._spacer!=null){for(var f=0;f<this._spacer.childNodes.length;f++){if(this._spacer.childNodes[f].idd!=null){if(this._spacer.childNodes[f].idd==h){i=g}g++}}}return i};dhtmlXToolbarObject.prototype.setPosition=function(d,c){this._setPosition(d,c)};dhtmlXToolbarObject.prototype._setPosition=function(h,i){if(this.objPull[this.idPrefix+h]==null){return}var g=null;if(this._spacer){g=this._spacer.idd;this.removeSpacer()}if(isNaN(i)){i=this.base.childNodes.length}if(i<0){i=0}var j=this.objPull[this.idPrefix+h];this.base.removeChild(j.obj);if(j.arw){this.base.removeChild(j.arw)}var f=this._getIdByPosition(i,true);if(f[0]==null){this.base.appendChild(j.obj);if(j.arw){this.base.appendChild(j.arw)}}else{this.base.insertBefore(j.obj,this.base.childNodes[f[1]]);if(j.arw){this.base.insertBefore(j.arw,this.base.childNodes[f[1]+1])}}if(g!=null){this.addSpacer(g)}};dhtmlXToolbarObject.prototype._getIdByPosition=function(i,g){var j=null;var h=0;var m=0;for(var l=0;l<this.base.childNodes.length;l++){if(this.base.childNodes[l]["idd"]!=null&&j==null){if((h++)==i){j=this.base.childNodes[l]["idd"]}}if(j==null){m++}}m=(j==null?null:m);return(g==true?new Array(j,m):j)};dhtmlXToolbarObject.prototype.removeItem=function(b){this._removeItem(b);if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXToolbarObject.prototype._removeItem=function(f){var h=this.getType(f);f=this.idPrefix+f;var g=this.objPull[f];if({button:1,buttonTwoState:1}[h]==1){if(window.dhx4.isIE){g.obj.onselectstart=null}this._evs.clear.apply(g,[g.obj.evs,g.obj]);for(var a in g.obj){if(typeof(g.obj[a])=="function"){g.obj[a]=null}}g.obj.parentNode.removeChild(g.obj);g.obj=null;for(var a in g){g[a]=null}}if(h=="buttonSelect"){for(var a in g._listOptions){this.removeListOption(f,a)}g._listOptions=null;if(g.polygon._ie6cover){document.body.removeChild(g.polygon._ie6cover);g.polygon._ie6cover=null}g.p_tbl.removeChild(g.p_tbody);g.polygon.removeChild(g.p_tbl);g.polygon.onselectstart=null;document.body.removeChild(g.polygon);if(window.dhx4.isIE){g.obj.onselectstart=null;g.arw.onselectstart=null}this._evs.clear.apply(g,[g.obj.evs,g.obj]);this._evs.clear.apply(g,[g.arw.evs,g.arw]);for(var a in g.obj){if(typeof(g.obj[a])=="function"){g.obj[a]=null}}g.obj.parentNode.removeChild(g.obj);g.obj=null;for(var a in g.arw){if(typeof(g.arw[a])=="function"){g.arw[a]=null}}g.arw.parentNode.removeChild(g.arw);g.arw=null;for(var a in g){g[a]=null}}if(h=="buttonInput"){g.obj.childNodes[0].onkeydown=null;g.obj.removeChild(g.obj.childNodes[0]);g.obj.w=null;g.obj.idd=null;g.obj.parentNode.removeChild(g.obj);g.obj=null;g.id=null;g.type=null;g.enableItem=null;g.disableItem=null;g.isEnabled=null;g.showItem=null;g.hideItem=null;g.isVisible=null;g.setItemToolTip=null;g.getItemToolTip=null;g.setWidth=null;g.getWidth=null;g.setValue=null;g.getValue=null;g.setItemText=null;g.getItemText=null}if(h=="slider"){if(window.dhx4.isIPad){document.removeEventListener("touchmove",pen._doOnMouseMoveStart,false);document.removeEventListener("touchend",pen._doOnMouseMoveEnd,false)}else{if(typeof(window.addEventListener)=="function"){window.removeEventListener("mousemove",g.pen._doOnMouseMoveStart,false);window.removeEventListener("mouseup",g.pen._doOnMouseMoveEnd,false)}else{document.body.detachEvent("onmousemove",g.pen._doOnMouseMoveStart);document.body.detachEvent("onmouseup",g.pen._doOnMouseMoveEnd)}}g.pen.allowMove=null;g.pen.initXY=null;g.pen.maxX=null;g.pen.minX=null;g.pen.nowX=null;g.pen.newNowX=null;g.pen.valueMax=null;g.pen.valueMin=null;g.pen.valueNow=null;g.pen._definePos=null;g.pen._detectLimits=null;g.pen._doOnMouseMoveStart=null;g.pen._doOnMouseMoveEnd=null;g.pen.onmousedown=null;g.obj.removeChild(g.pen);g.pen=null;g.label.tip=null;document.body.removeChild(g.label);g.label=null;g.obj.onselectstart=null;g.obj.idd=null;while(g.obj.childNodes.length>0){g.obj.removeChild(g.obj.childNodes[0])}g.obj.parentNode.removeChild(g.obj);g.obj=null;g.id=null;g.type=null;g.state=null;g.enableItem=null;g.disableItem=null;g.isEnabled=null;g.setItemToolTipTemplate=null;g.getItemToolTipTemplate=null;g.setMaxValue=null;g.setMinValue=null;g.getMaxValue=null;g.getMinValue=null;g.setValue=null;g.getValue=null;g.showItem=null;g.hideItem=null;g.isVisible=null}if(h=="separator"){g.obj.onselectstart=null;g.obj.idd=null;g.obj.parentNode.removeChild(g.obj);g.obj=null;g.id=null;g.type=null;g.showItem=null;g.hideItem=null;g.isVisible=null}if(h=="text"){g.obj.onselectstart=null;g.obj.idd=null;g.obj.parentNode.removeChild(g.obj);g.obj=null;g.id=null;g.type=null;g.showItem=null;g.hideItem=null;g.isVisible=null;g.setWidth=null;g.setItemText=null;g.getItemText=null}h=null;g=null;this.objPull[f]=null;delete this.objPull[f]};(function(){var g="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(",");var e=function(a){return function(b,n,o,c,d,m){b=this.idPrefix+b;if(this.objPull[b]==null){return}if(this.objPull[b]["type"]!="buttonSelect"){return}return this.objPull[b][a].call(this.objPull[b],n,o,c,d,m)}};for(var h=0;h<g.length;h++){var f=g[h];dhtmlXToolbarObject.prototype[f]=e(f)}})();dhtmlXToolbarObject.prototype._rtlParseBtn=function(c,d){return c+d};dhtmlXToolbarObject.prototype._separatorObject=function(e,f,d){this.id=e.idPrefix+f;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_sep";this.obj.style.display=(d.hidden!=null?"none":"");this.obj.idd=String(f);this.obj.title=(d.title||"");this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};this.obj.ontouchstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}a.cancelBubble=true;return false};e.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};return this};dhtmlXToolbarObject.prototype._textObject=function(e,f,d){this.id=e.idPrefix+f;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_text";this.obj.style.display=(d.hidden!=null?"none":"");this.obj.idd=String(f);this.obj.title=(d.title||"");this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};this.obj.ontouchstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}a.cancelBubble=true;return false};this.obj.innerHTML=(d.text||"");e.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(a){this.obj.innerHTML=a};this.getItemText=function(){return this.obj.innerHTML};this.setWidth=function(a){this.obj.style.width=a+"px"};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonObject=function(j,h,i){this.id=j.idPrefix+h;this.state=(i.enabled!=null?false:true);this.imgEn=(i.img||"");this.imgDis=(i.imgdis||"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis");this.obj.style.display=(i.hidden!=null?"none":"");this.obj.allowClick=false;this.obj.extAction=(i.action||null);this.obj.renderAs=this.obj.className;this.obj.idd=String(h);this.obj.title=(i.title||"");this.obj.pressed=false;var g=(j.conf.icons_css?"<i class='"+j.conf.icons_path+this.img+"'></i>":"<img src='"+j.conf.icons_path+this.img+"'>");this.obj.innerHTML=j._rtlParseBtn((this.img!=""?g:""),(i.text!=null?"<div class='dhxtoolbar_text'>"+i.text+"</div>":""));j.base.appendChild(this.obj);if(window.dhx4.isIE){this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false}}var f=this;this._doOnMouseOver=function(a){a=a||event;if(f.state==false||f.obj.pressed==true||f.obj.over==true){return}if(f.obj.className.match(/dhxtoolbar_btn_over/gi)==null){f.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over"}f.obj.over=true};this._doOnMouseOut=function(a){a=a||event;if(f.state==false){return}if(f.obj.className.match(/dhxtoolbar_btn_over/gi)!=null){f.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def"}f.obj.over=f.obj.pressed=false};this._doOnMouseDown=function(a){a=a||event;if(a.type=="touchstart"){if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;if(j.conf.touch_id!=null&&j.conf.touch_id!=f.id){return}j.conf.touch_id=f.id}if(f.state==false){return}if(f.obj.className.match(/dhxtoolbar_btn_pres/gi)==null){f.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres"}f.obj.pressed=true};this._doOnMouseUp=function(a){a=a||event;if(a.type=="touchend"){if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;if(j.conf.touch_id==f.id){j.conf.touch_id=null}}if(f.state==false||f.obj.pressed==false){return}if(f.obj.className.match(/dhxtoolbar_btn_pres/gi)!=null){f.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(f.obj.over?"over":"def")}f.obj.pressed=false;if(f.obj.extAction){window.setTimeout(function(){try{if(f&&f.obj){window[f.obj.extAction](f.id)}}catch(b){}},1)}j.callEvent("onClick",[f.obj.idd.replace(j.idPrefix,"")])};this.obj.evs={mouseover:"_doOnMouseOver",mouseout:"_doOnMouseOut",mousedown:"_doOnMouseDown",mouseup:"_doOnMouseUp",touchstart:"_doOnMouseDown",touchend:"_doOnMouseUp"};j._evs.add.apply(this,[this.obj.evs,this.obj]);this.enableItem=function(){j._enableItem(this)};this.disableItem=function(){j._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(a){j._setItemText(this,a)};this.getItemText=function(){return j._getItemText(this)};this.setItemImage=function(a){j._setItemImage(this,a,true)};this.clearItemImage=function(){j._clearItemImage(this,true)};this.setItemImageDis=function(a){j._setItemImage(this,a,false)};this.clearItemImageDis=function(){j._clearItemImage(this,false)};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonSelectObject=function(n,j,l){this.id=n.idPrefix+j;this.state=(l.enabled!=null?(l.enabled=="true"?true:false):true);this.imgEn=(l.img||"");this.imgDis=(l.imgdis||"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.mode=(l.mode||"button");if(this.mode=="select"){this.openAll=true;this.renderSelect=false;if(!l.text||l.text.length==0){l.text="&nbsp;"}}else{this.openAll=(window.dhx4.s2b(l.openAll)==true);this.renderSelect=(l.renderSelect==null?true:window.dhx4.s2b(l.renderSelect))}this.maxOpen=(!isNaN(l.maxOpen?l.maxOpen:"")?l.maxOpen:null);this._maxOpenTest=function(){if(!isNaN(this.maxOpen)){if(!n._sbw){var a=document.createElement("DIV");a.className="dhxtoolbar_maxopen_test";document.body.appendChild(a);var b=document.createElement("DIV");b.className="dhxtoolbar_maxopen_test2";a.appendChild(b);n._sbw=a.offsetWidth-b.offsetWidth;a.removeChild(b);b=null;document.body.removeChild(a);a=null}}};this._maxOpenTest();this.obj=document.createElement("DIV");this.obj.allowClick=false;this.obj.extAction=(l.action||null);this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis");this.obj.style.display=(l.hidden!=null?"none":"");this.obj.renderAs=this.obj.className;this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};this.obj.idd=String(j);this.obj.title=(l.title||"");this.obj.pressed=false;this.callEvent=false;var h=(n.conf.icons_css?"<i class='"+n.conf.icons_path+this.img+"'></i>":"<img src='"+n.conf.icons_path+this.img+"'>");this.obj.innerHTML=n._rtlParseBtn((this.img!=""?h:""),(l.text!=null?"<div class='dhxtoolbar_text'>"+l.text+"</div>":""));n.base.appendChild(this.obj);this.arw=document.createElement("DIV");this.arw.className="dhx_toolbar_arw dhxtoolbar_btn_"+(this.state?"def":"dis");this.arw.style.display=this.obj.style.display;this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>";this.arw.title=this.obj.title;this.arw.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};n.base.appendChild(this.arw);var i=this;if(window.dhx4.isIE){this.arw.onselectstart=this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false}}this._doOnMouseOver=function(a){a=a||event;if(i.state==false||i.obj.over==true||n.anyUsed==i.obj.idd){return}if(i.obj.className.match(/dhxtoolbar_btn_over/gi)==null){i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over";i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_over"}i.obj.over=true};this._doOnMouseOut=function(a){a=a||event;if(i.state==false||n.anyUsed==i.obj.idd||n.anyUsed==i.obj.idd){return}if(i.obj.className.match(/dhxtoolbar_btn_over/gi)!=null){i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def";i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_def"}i.obj.over=i.obj.pressed=false};this._doOnMouseDown=function(a){a=a||event;if(a.type=="touchstart"){if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;if(n.conf.touch_id!=null&&n.conf.touch_id!=i.id){return}n.conf.touch_id=i.id}if(i.state==false){return}if(n.anyUsed==i.obj.idd){if(i.obj.over==true){i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over";i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_over"}else{i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def";i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_def"}i._hidePoly(true);n.anyUsed=null}else{var b=(a.target||a.srcElement);if(i.openAll==true||b==i.arw||b.parentNode==i.arw){if(a.type=="touchstart"){i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over"}i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres";i.arw._skip=true;i._showPoly(true);n.anyUsed=i.obj.idd}else{if(i.obj.className.match(/dhxtoolbar_btn_pres/gi)==null){i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres";i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_pres"}i.obj.pressed=true}}};this._doOnMouseUp=function(a){a=a||event;if(a.type=="touchend"){if(i.polygon.style.display==""){return}if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;if(n.conf.touch_id==i.id){n.conf.touch_id=null}}if(i.state==false||i.obj.pressed==false){return}if(i.obj.className.match(/dhxtoolbar_btn_pres/gi)!=null){i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(i.obj.over?"over":"def");i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_"+(i.obj.over?"over":"def")}if(this.extAction){var b=this;window.setTimeout(function(){try{window[b.extAction](j)}catch(c){}b=null},1)}n.callEvent("onClick",[i.obj.idd.replace(n.idPrefix,"")])};this.arw.evs={mouseover:"_doOnMouseOver",mouseout:"_doOnMouseOut",mousedown:"_doOnMouseDown",touchstart:"_doOnMouseDown"};n._evs.add.apply(this,[this.arw.evs,this.arw]);this.obj.evs={mouseover:"_doOnMouseOver",mouseout:"_doOnMouseOut",mousedown:"_doOnMouseDown",mouseup:"_doOnMouseUp",touchstart:"_doOnMouseDown",touchend:"_doOnMouseUp"};n._evs.add.apply(this,[this.obj.evs,this.obj]);this._showPoly=function(f){if(n.anyUsed!=null){if(n.objPull[n.idPrefix+n.anyUsed].type=="buttonSelect"){var g=n.objPull[n.idPrefix+n.anyUsed];if(g.polygon.style.display!="none"){g.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def";g.arw.className="dhx_toolbar_arw dhxtoolbar_btn_def";g.obj.over=false;window.dhx4.zim.clear(g.polygon._idd);g.polygon.style.display="none";if(g.polygon._ie6cover){g.polygon._ie6cover.style.display="none"}if(n.conf.skin=="dhx_terrace"){n._improveTerraceButtonSelect(g.id,true)}n.callEvent("onButtonSelectHide",[g.obj.idd])}}}this.polygon.style.top="0px";this.polygon.style.visibility="hidden";this.polygon.style.zIndex=window.dhx4.zim.reserve(this.polygon._idd);this.polygon.style.display="";if(n.conf.skin=="dhx_terrace"){n._improveTerraceButtonSelect(this.id,false)}this._fixMaxOpenHeight(this.maxOpen||null);n._autoDetectVisibleArea();var c=window.dhx4.absTop(this.obj)+this.obj.offsetHeight+n.conf.sel_ofs_y;var a=this.polygon.offsetHeight;if(c+a>n.tY2){var e=(this.maxOpen!=null?Math.floor((n.tY2-c)/22):0);if(e>=1){this._fixMaxOpenHeight(e)}else{c=window.dhx4.absTop(this.obj)-a-n.conf.sel_ofs_y;if(c<0){c=0}}}this.polygon.style.top=c+"px";if(n.rtl){this.polygon.style.left=window.dhx4.absLeft(this.obj)+this.obj.offsetWidth-this.polygon.offsetWidth+n.conf.sel_ofs_x+"px"}else{var b=document.body.scrollLeft;var d=b+(window.innerWidth||document.body.clientWidth);var q=window.dhx4.absLeft(this.obj)+n.conf.sel_ofs_x;if(q+this.polygon.offsetWidth>d){q=window.dhx4.absLeft(this.arw)+this.arw.offsetWidth-this.polygon.offsetWidth}this.polygon.style.left=Math.max(q,5)+"px"}this.polygon.style.visibility="visible";if(this.polygon._ie6cover){this.polygon._ie6cover.style.left=this.polygon.style.left;this.polygon._ie6cover.style.top=this.polygon.style.top;this.polygon._ie6cover.style.width=this.polygon.offsetWidth+"px";this.polygon._ie6cover.style.height=this.polygon.offsetHeight+"px";this.polygon._ie6cover.style.display=""}if(f){n.callEvent("onButtonSelectShow",[this.obj.idd])}};this._hidePoly=function(a){window.dhx4.zim.clear(this.polygon._idd);this.polygon.style.display="none";if(this.polygon._ie6cover){this.polygon._ie6cover.style.display="none"}if(n.conf.skin=="dhx_terrace"){n._improveTerraceButtonSelect(this.id,true)}if(a){n.callEvent("onButtonSelectHide",[this.obj.idd])}n.conf.touch_id=null};this.obj.iddPrefix=n.idPrefix;this._listOptions={};this._fixMaxOpenHeight=function(e){var a="auto";var b=false;if(e!==null){var c=0;for(var d in this._listOptions){c++}if(c>e){this._ph=22*e;a=this._ph+"px"}else{b=true}}this.polygon.style.width="auto";this.polygon.style.height="auto";if(!b&&i.maxOpen!=null){this.polygon.style.width=this.p_tbl.offsetWidth+n._sbw+"px";this.polygon.style.height=a}};this._separatorButtonSelectObject=function(a,c,b){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.className="tr_sep";this.obj.tr.onselectstart=function(d){d=d||event;if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}return false};this.obj.td=document.createElement("TD");this.obj.td.colSpan="2";this.obj.td.className="td_btn_sep";this.obj.td.onselectstart=function(d){d=d||event;if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}return false};if(isNaN(b)){b=i.p_tbody.childNodes.length+1}else{if(b<1){b=1}}if(b>i.p_tbody.childNodes.length){i.p_tbody.appendChild(this.obj.tr)}else{i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[b-1])}this.obj.tr.appendChild(this.obj.td);this.obj.sep=document.createElement("DIV");this.obj.sep.className="btn_sep";this.obj.sep.onselectstart=function(d){d=d||event;if(d.preventDefault){d.preventDefault()}else{d.returnValue=false}return false};this.obj.td.appendChild(this.obj.sep);i._listOptions[a]=this.obj;return this};this._buttonButtonSelectObject=function(a,c,b){var d=true;if(typeof(c.enabled)!="undefined"){d=window.dhx4.s2b(c.enabled)}else{if(typeof(c.disabled)!="undefined"){d=window.dhx4.s2b(c.disabled)}}this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.en=d;this.obj.tr.extAction=(c.action||null);this.obj.tr._selected=(c.selected!=null);this.obj.tr.className="tr_btn"+(this.obj.tr.en?(this.obj.tr._selected&&i.renderSelect?" tr_btn_selected":""):" tr_btn_disabled");this.obj.tr.onselectstart=function(f){f=f||event;if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}return false};this.obj.tr.idd=String(a);if(isNaN(b)){b=i.p_tbody.childNodes.length+1}else{if(b<1){b=1}}if(b>i.p_tbody.childNodes.length){i.p_tbody.appendChild(this.obj.tr)}else{i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[b-1])}this.obj.td_a=document.createElement("TD");this.obj.td_a.className="td_btn_img";this.obj.td_a.onselectstart=function(f){f=f||event;if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}return false};this.obj.td_b=document.createElement("TD");this.obj.td_b.className="td_btn_txt";this.obj.td_b.onselectstart=function(f){f=f||event;if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}return false};if(n.rtl){this.obj.tr.appendChild(this.obj.td_b);this.obj.tr.appendChild(this.obj.td_a)}else{this.obj.tr.appendChild(this.obj.td_a);this.obj.tr.appendChild(this.obj.td_b)}if(c.img!=null){if(n.conf.icons_css==true){this.obj.td_a.innerHTML="<i class='"+n.conf.icons_path+c.img+"'></i>"}else{this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+n.conf.icons_path+c.img+"' border='0'>"}this.obj.tr._img=c.img}else{this.obj.td_a.innerHTML="&nbsp;"}var e=(c.text!=null?c.text:(c.itemText||""));this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+e+"</div>";this.obj.tr.onmouseover=function(f){f=f||event;if(f.type.match(/touch/)!=null){return}if(!this.en||(this._selected&&i.renderSelect)){return}this.className="tr_btn tr_btn_over"};this.obj.tr.onmouseout=function(f){f=f||event;if(f.type.match(/touch/)!=null){return}if(!this.en){return}if(this._selected&&i.renderSelect){if(String(this.className).search("tr_btn_selected")==-1){this.className="tr_btn tr_btn_selected"}}else{this.className="tr_btn"}};this.obj.tr.ontouchstart=this.obj.tr.onmousedown=function(f){f=f||event;if(this._etype==null){this._etype=f.type}};this.obj.tr.onclick=function(g){g=g||event;g.cancelBubble=true;if(!this.en){return}i.setListOptionSelected(this.idd.replace(n.idPrefix,""));i.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def";i.arw.className="dhx_toolbar_arw dhxtoolbar_btn_def";i.obj.over=false;if(this._etype!=null&&this._etype.match(/touch/)==null){window.dhx4.zim.clear(i.polygon._idd);i.polygon.style.display="none";if(i.polygon._ie6cover){i.polygon._ie6cover.style.display="none"}}else{var p=i.polygon;window.setTimeout(function(){window.dhx4.zim.clear(p._idd);p.style.display="none";p=null},500)}this._etype=null;if(n.conf.skin=="dhx_terrace"){n._improveTerraceButtonSelect(i.id,true)}n.anyUsed=null;n.conf.touch_id=null;n.callEvent("onButtonSelectHide",[i.obj.idd]);var f=this.idd.replace(n.idPrefix,"");if(this.extAction){try{window[this.extAction](f)}catch(g){}}n.callEvent("onClick",[f])};i._listOptions[a]=this.obj;return this};this.polygon=document.createElement("DIV");this.polygon.dir="ltr";this.polygon.style.display="none";this.polygon.className="dhx_toolbar_poly_"+n.conf.skin+" dhxtoolbar_icons_"+n.conf.iconSize+n.conf.cssShadow;this.polygon.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};this.polygon.onmousedown=function(a){a=a||event;a.cancelBubble=true};this.polygon.style.overflowY="auto";this.polygon._idd=window.dhx4.newId();this.polygon.ontouchstart=function(a){a=a||event;a.cancelBubble=true};this.polygon.ontouchend=function(a){a=a||event;a.cancelBubble=true};this.p_tbl=document.createElement("TABLE");this.p_tbl.className="buttons_cont";this.p_tbl.cellSpacing="0";this.p_tbl.cellPadding="0";this.p_tbl.border="0";this.polygon.appendChild(this.p_tbl);this.p_tbody=document.createElement("TBODY");this.p_tbl.appendChild(this.p_tbody);if(l.options!=null){for(var m=0;m<l.options.length;m++){var o="_"+(l.options[m].type||"")+"ButtonSelectObject";if(l.options[m].id==null){l.options[m].id=n._genStr(24)}if(typeof(this[o])=="function"){new this[o](l.options[m].id,l.options[m])}}}document.body.appendChild(this.polygon);if(window.dhx4.isIE6){this.polygon._ie6cover=document.createElement("IFRAME");this.polygon._ie6cover.frameBorder=0;this.polygon._ie6cover.style.position="absolute";this.polygon._ie6cover.style.border="none";this.polygon._ie6cover.style.backgroundColor="#000000";this.polygon._ie6cover.style.filter="alpha(opacity=100)";this.polygon._ie6cover.style.display="none";this.polygon._ie6cover.setAttribute("src","javascript:false;");document.body.appendChild(this.polygon._ie6cover)}this.setWidth=function(a){this.obj.style.width=a-this.arw.offsetWidth+"px";this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px";this.p_tbl.style.width=this.polygon.style.width};this.enableItem=function(){n._enableItem(this)};this.disableItem=function(){n._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display="";this.arw.style.display=""};this.hideItem=function(){this.obj.style.display="none";this.arw.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(a){n._setItemText(this,a)};this.getItemText=function(){return n._getItemText(this)};this.setItemImage=function(a){n._setItemImage(this,a,true)};this.clearItemImage=function(){n._clearItemImage(this,true)};this.setItemImageDis=function(a){n._setItemImage(this,a,false)};this.clearItemImageDis=function(){n._clearItemImage(this,false)};this.setItemToolTip=function(a){this.obj.title=a;this.arw.title=a};this.getItemToolTip=function(){return this.obj.title};this.addListOption=function(f,a,c,b,e){if(!(c=="button"||c=="separator")){return}var d={id:f,type:c,text:b,img:e};new this["_"+c+"ButtonSelectObject"](f,d,a)};this.removeListOption=function(a){if(!this._isListButton(a,true)){return}var c=this._listOptions[a];if(c.td_a!=null&&c.td_b!=null){c.td_a.onselectstart=null;c.td_b.onselectstart=null;while(c.td_a.childNodes.length>0){c.td_a.removeChild(c.td_a.childNodes[0])}while(c.td_b.childNodes.length>0){c.td_b.removeChild(c.td_b.childNodes[0])}c.tr.onselectstart=null;c.tr.onmouseover=null;c.tr.onmouseout=null;c.tr.onclick=null;c.tr.ontouchstart=null;c.tr.onmousedown=null;while(c.tr.childNodes.length>0){c.tr.removeChild(c.tr.childNodes[0])}c.tr.parentNode.removeChild(c.tr);c.td_a=null;c.td_b=null;c.tr=null}else{c.sep.onselectstart=null;c.td.onselectstart=null;c.tr.onselectstart=null;while(c.td.childNodes.length>0){c.td.removeChild(c.td.childNodes[0])}while(c.tr.childNodes.length>0){c.tr.removeChild(c.tr.childNodes[0])}c.tr.parentNode.removeChild(c.tr);c.sep=null;c.td=null;c.tr=null}c=null;this._listOptions[a]=null;try{delete this._listOptions[a]}catch(b){}};this.showListOption=function(a){if(!this._isListButton(a,true)){return}this._listOptions[a].tr.style.display=""};this.hideListOption=function(a){if(!this._isListButton(a,true)){return}this._listOptions[a].tr.style.display="none"};this.isListOptionVisible=function(a){if(!this._isListButton(a,true)){return}return(this._listOptions[a].tr.style.display!="none")};this.enableListOption=function(a){if(!this._isListButton(a)){return}this._listOptions[a].tr.en=true;this._listOptions[a].tr.className="tr_btn"+(this._listOptions[a].tr._selected&&n.renderSelect?" tr_btn_selected":"")};this.disableListOption=function(a){if(!this._isListButton(a)){return}this._listOptions[a].tr.en=false;this._listOptions[a].tr.className="tr_btn tr_btn_disabled"};this.isListOptionEnabled=function(a){if(!this._isListButton(a)){return}return this._listOptions[a].tr.en};this.setListOptionPosition=function(a,b){if(!this._listOptions[a]||this.getListOptionPosition(a)==b||isNaN(b)){return}if(b<1){b=1}var c=this._listOptions[a].tr;this.p_tbody.removeChild(c);if(b>this.p_tbody.childNodes.length){this.p_tbody.appendChild(c)}else{this.p_tbody.insertBefore(c,this.p_tbody.childNodes[b-1])}c=null};this.getListOptionPosition=function(a){var b=-1;if(!this._listOptions[a]){return b}for(var c=0;c<this.p_tbody.childNodes.length;c++){if(this.p_tbody.childNodes[c]==this._listOptions[a].tr){b=c+1}}return b};this.setListOptionImage=function(a,c){if(!this._isListButton(a)){return}var b=this._listOptions[a].tr.childNodes[(n.rtl?1:0)];b.innerHTML=(n.conf.icons_css?"<i class='"+n.conf.icons_path+c+"'></i>":"<img src='"+n.conf.icons_path+c+"' class='btn_sel_img'>");b=null};this.getListOptionImage=function(a){if(!this._isListButton(a)){return}var b=this._listOptions[a].tr.childNodes[(n.rtl?1:0)];var c=null;if(b.childNodes.length>0){c=b.childNodes[0][(n.conf.icons_css?"className":"src")]}b=null;return c};this.clearListOptionImage=function(a){if(!this._isListButton(a)){return}var b=this._listOptions[a].tr.childNodes[(n.rtl?1:0)];while(b.childNodes.length>0){b.removeChild(b.childNodes[0])}b.innerHTML="&nbsp;";b=null};this.setListOptionText=function(a,b){if(!this._isListButton(a)){return}this._listOptions[a].tr.childNodes[(n.rtl?0:1)].childNodes[0].innerHTML=b};this.getListOptionText=function(a){if(!this._isListButton(a)){return}return this._listOptions[a].tr.childNodes[(n.rtl?0:1)].childNodes[0].innerHTML};this.setListOptionToolTip=function(a,b){if(!this._isListButton(a)){return}this._listOptions[a].tr.title=b};this.getListOptionToolTip=function(a){if(!this._isListButton(a)){return}return this._listOptions[a].tr.title};this.forEachListOption=function(a){for(var b in this._listOptions){a(b)}};this.getAllListOptions=function(){var a=new Array();for(var b in this._listOptions){a[a.length]=b}return a};this.setListOptionSelected=function(a){for(var c in this._listOptions){var b=this._listOptions[c];if(b.td_a!=null&&b.td_b!=null&&b.tr.en){if(c==a){b.tr._selected=true;b.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":"");if(this.mode=="select"){if(b.tr._img){this.setItemImage(b.tr._img)}else{this.clearItemImage()}this.setItemText(this.getListOptionText(a))}}else{b.tr._selected=false;b.tr.className="tr_btn"}}b=null}};this.getListOptionSelected=function(){var a=null;for(var b in this._listOptions){if(this._listOptions[b].tr._selected==true){a=b}}return a};this._isListButton=function(a,b){if(this._listOptions[a]==null){return false}if(!b&&this._listOptions[a].tr.className=="tr_sep"){return false}return true};this.setMaxOpen=function(a){this._ph=null;if(typeof(a)=="number"){this.maxOpen=a;this._maxOpenTest();return}this.maxOpen=null};if(l.width){this.setWidth(l.width)}if(this.mode=="select"&&typeof(l.selected)!="undefined"){this.setListOptionSelected(l.selected)}return this};dhtmlXToolbarObject.prototype._buttonInputObject=function(j,h,i){this.id=j.idPrefix+h;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def";this.obj.style.display=(i.hidden!=null?"none":"");this.obj.idd=String(h);this.obj.w=(i.width!=null?i.width:100);this.obj.title=(i.title!=null?i.title:"");this.obj.innerHTML="<input class='dhxtoolbar_input' type='text' style='width:"+this.obj.w+"px;'"+(i.value!=null?" value='"+i.value+"'":"")+">";var f=j;var g=this;this.obj.childNodes[0].onkeydown=function(a){a=a||event;if(a.keyCode==13){f.callEvent("onEnter",[g.obj.idd,this.value])}};j.base.appendChild(this.obj);this.enableItem=function(){this.obj.childNodes[0].disabled=false};this.disableItem=function(){this.obj.childNodes[0].disabled=true};this.isEnabled=function(){return(!this.obj.childNodes[0].disabled)};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display!="none")};this.setValue=function(a){this.obj.childNodes[0].value=a};this.getValue=function(){return this.obj.childNodes[0].value};this.setWidth=function(a){this.obj.w=a;this.obj.childNodes[0].style.width=this.obj.w+"px"};this.getWidth=function(){return this.obj.w};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};this.getInput=function(){return this.obj.firstChild};if(typeof(i.enabled)!="undefined"&&window.dhx4.s2b(i.enabled)==false){this.disableItem()}return this};dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(j,h,i){this.id=j.idPrefix+h;this.state=(i.enabled!=null?false:true);this.imgEn=(i.img!=null?i.img:"");this.imgDis=(i.imgdis!=null?i.imgdis:"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.obj=document.createElement("DIV");this.obj.pressed=(i.selected!=null);this.obj.extAction=(i.action||null);this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.obj.pressed?"pres"+(this.state?"":"_dis"):(this.state?"def":"dis"));this.obj.style.display=(i.hidden!=null?"none":"");this.obj.renderAs=this.obj.className;this.obj.idd=String(h);this.obj.title=(i.title||"");if(this.obj.pressed){this.obj.renderAs="dhx_toolbar_btn dhxtoolbar_btn_over"}var g=(j.conf.icons_css?"<i class='"+j.conf.icons_path+this.img+"'></i>":"<img src='"+j.conf.icons_path+this.img+"'>");this.obj.innerHTML=j._rtlParseBtn((this.img!=""?g:""),(i.text!=null?"<div class='dhxtoolbar_text'>"+i.text+"</div>":""));j.base.appendChild(this.obj);if(window.dhx4.isIE){this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}return false}}var f=this;this._doOnMouseOver=function(a){a=a||event;if(f.state==false||f.obj.over==true){return}if(f.obj.pressed!=true&&f.obj.className.match(/dhxtoolbar_btn_over/gi)==null){f.obj.className="dhx_toolbar_btn dhxtoolbar_btn_over"}f.obj.over=true};this._doOnMouseOut=function(a){a=a||event;if(f.state==false){return}if(f.obj.pressed!=true&&f.obj.className.match(/dhxtoolbar_btn_over/gi)!=null){f.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def"}f.obj.over=false};this._doOnMouseDown=function(b){b=b||event;if(b.type=="touchstart"){if(b.preventDefault){b.preventDefault()}b.cancelBubble=true;if(j.conf.touch_id!=null&&j.conf.touch_id!=f.id){return}j.conf.touch_id=f.id}if(f.state==false){return}if(j.callEvent("onBeforeStateChange",[f.obj.idd.replace(j.idPrefix,""),f.obj.pressed])!==true){return}f.obj.pressed=!f.obj.pressed;f.obj.className="dhx_toolbar_btn "+(f.obj.pressed==true?"dhxtoolbar_btn_pres":(f.obj.over==true?"dhxtoolbar_btn_over":"dhxtoolbar_btn_def"));var a=f.obj.idd.replace(j.idPrefix,"");if(f.obj.extAction){try{window[f.obj.extAction](idd,f.obj.pressed)}catch(b){}}j.callEvent("onStateChange",[a,f.obj.pressed])};this._doOnMouseUp=function(a){a=a||event;if(a.type=="touchend"){if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;if(j.conf.touch_id==f.id){j.conf.touch_id=null}}};this.obj.evs={mouseover:"_doOnMouseOver",mouseout:"_doOnMouseOut",mousedown:"_doOnMouseDown",touchstart:"_doOnMouseDown",touchend:"_doOnMouseUp"};j._evs.add.apply(this,[this.obj.evs,this.obj]);this.setItemState=function(d,b){if(this.obj.pressed!=d){if(d==true){this.obj.pressed=true;this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_pres"+(this.state?"":"_dis")}else{this.obj.pressed=false;this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis")}if(b==true){var a=this.obj.idd.replace(j.idPrefix,"");if(this.obj.extAction){try{window[this.obj.extAction](a,this.obj.pressed)}catch(c){}}j.callEvent("onStateChange",[a,this.obj.pressed])}}};this.getItemState=function(){return this.obj.pressed};this.enableItem=function(){j._enableItem(this)};this.disableItem=function(){j._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(a){j._setItemText(this,a)};this.getItemText=function(){return j._getItemText(this)};this.setItemImage=function(a){j._setItemImage(this,a,true)};this.clearItemImage=function(){j._clearItemImage(this,true)};this.setItemImageDis=function(a){j._setItemImage(this,a,false)};this.clearItemImageDis=function(){j._clearItemImage(this,false)};this.setItemToolTip=function(a){this.obj.title=a};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._sliderObject=function(l,i,j){this.id=l.idPrefix+i;this.state=(j.enabled!=null?(j.enabled=="true"?true:false):true);this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_"+(this.state?"def":"dis");this.obj.style.display=(j.hidden!=null?"none":"");this.obj.onselectstart=function(a){a=a||event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};this.obj.idd=String(i);this.obj.len=(j.length!=null?Number(j.length):50);this.obj.innerHTML="<div class='dhxtoolbar_text'>"+(j.textMin||"")+"</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>"+(j.textMax||"")+"</div>";l.base.appendChild(this.obj);var h=this;this.pen=document.createElement("DIV");this.pen.className="dhxtoolbar_sl_pen";this.obj.appendChild(this.pen);var m=this.pen;this.label=document.createElement("DIV");this.label.dir="ltr";this.label.className="dhx_toolbar_slider_label_"+l.conf.skin+(l.rtl?"_rtl":"");this.label.style.display="none";this.label.tip=(j.toolTip||"%v");this.label._zi=window.dhx4.newId();document.body.appendChild(this.label);var g=this.label;this.pen.valueMin=(j.valueMin!=null?Number(j.valueMin):0);this.pen.valueMax=(j.valueMax!=null?Number(j.valueMax):100);if(this.pen.valueMin>this.pen.valueMax){this.pen.valueMin=this.pen.valueMax}this.pen.valueNow=(j.valueNow!=null?Number(j.valueNow):this.pen.valueMax);if(this.pen.valueNow>this.pen.valueMax){this.pen.valueNow=this.pen.valueMax}if(this.pen.valueNow<this.pen.valueMin){this.pen.valueNow=this.pen.valueMin}this.pen._detectLimits=function(){this.minX=h.obj.childNodes[1].offsetLeft+2;this.maxX=h.obj.childNodes[3].offsetLeft-this.offsetWidth+1};this.pen._detectLimits();this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX);this.style.left=this.nowX+"px";this.newNowX=this.nowX};this.pen._definePos();this.pen.initXY=0;this.pen.allowMove=false;this.pen[window.dhx4.isIPad?"ontouchstart":"onmousedown"]=function(a){if(h.state==false){return}a=a||event;this.initXY=(window.dhx4.isIPad?a.touches[0].clientX:a.clientX);this.newValueNow=this.valueNow;this.allowMove=true;this.className="dhxtoolbar_sl_pen dhxtoolbar_over";if(g.tip!=""){g.style.visibility="hidden";g.style.display="";g.innerHTML=g.tip.replace("%v",this.valueNow);g.style.left=Math.round(window.dhx4.absLeft(this)+this.offsetWidth/2-g.offsetWidth/2)+"px";g.style.top=window.dhx4.absTop(this)-g.offsetHeight-3+"px";g.style.visibility="";g.style.zIndex=window.dhx4.zim.reserve(g._zi)}};this.pen._doOnMouseMoveStart=function(b){b=b||event;if(!m.allowMove){return}var c=(window.dhx4.isIPad?b.touches[0].clientX:b.clientX);var a=c-m.initXY;if(c<window.dhx4.absLeft(m)+Math.round(m.offsetWidth/2)&&m.nowX==m.minX){return}if(c>window.dhx4.absLeft(m)+Math.round(m.offsetWidth/2)&&m.nowX==m.maxX){return}m.newNowX=m.nowX+a;if(m.newNowX<m.minX){m.newNowX=m.minX}if(m.newNowX>m.maxX){m.newNowX=m.maxX}m.nowX=m.newNowX;m.style.left=m.nowX+"px";m.initXY=c;m.newValueNow=Math.round((m.valueMax-m.valueMin)*(m.newNowX-m.minX)/(m.maxX-m.minX)+m.valueMin);if(g.tip!=""){g.innerHTML=g.tip.replace(/%v/gi,m.newValueNow);g.style.left=Math.round(window.dhx4.absLeft(m)+m.offsetWidth/2-g.offsetWidth/2)+"px";g.style.top=window.dhx4.absTop(m)-g.offsetHeight-3+"px"}b.cancelBubble=true;if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}return false};this.pen._doOnMouseMoveEnd=function(){if(!m.allowMove){return}m.className="dhxtoolbar_sl_pen";m.allowMove=false;m.nowX=m.newNowX;m.valueNow=m.newValueNow;if(g.tip!=""){g.style.display="none";window.dhx4.zim.clear(g._zi)}l.callEvent("onValueChange",[h.obj.idd.replace(l.idPrefix,""),m.valueNow])};if(window.dhx4.isIPad){document.addEventListener("touchmove",m._doOnMouseMoveStart,false);document.addEventListener("touchend",m._doOnMouseMoveEnd,false)}else{if(typeof(window.addEventListener)!="undefined"){window.addEventListener("mousemove",m._doOnMouseMoveStart,false);window.addEventListener("mouseup",m._doOnMouseMoveEnd,false)}else{document.body.attachEvent("onmousemove",m._doOnMouseMoveStart);document.body.attachEvent("onmouseup",m._doOnMouseMoveEnd)}}this.enableItem=function(){if(this.state){return}this.state=true;this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_def"};this.disableItem=function(){if(!this.state){return}this.state=false;this.obj.className="dhx_toolbar_btn dhxtoolbar_btn_dis"};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setValue=function(b,a){b=Number(b);if(b<this.pen.valueMin){b=this.pen.valueMin}if(b>this.pen.valueMax){b=this.pen.valueMax}this.pen.valueNow=b;this.pen._definePos();if(a==true){l.callEvent("onValueChange",[this.obj.idd.replace(l.idPrefix,""),this.pen.valueNow])}};this.getValue=function(){return this.pen.valueNow};this.setMinValue=function(a,b){a=Number(a);if(a>this.pen.valueMax){return}this.obj.childNodes[0].innerHTML=b;this.obj.childNodes[0].style.display=(b.length>0?"":"none");this.pen.valueMin=a;if(this.pen.valueNow<this.pen.valueMin){this.pen.valueNow=this.pen.valueMin}this.pen._detectLimits();this.pen._definePos()};this.setMaxValue=function(a,b){a=Number(a);if(a<this.pen.valueMin){return}this.obj.childNodes[4].innerHTML=b;this.obj.childNodes[4].style.display=(b.length>0?"":"none");this.pen.valueMax=a;if(this.pen.valueNow>this.pen.valueMax){this.pen.valueNow=this.pen.valueMax}this.pen._detectLimits();this.pen._definePos()};this.getMinValue=function(){var b=this.obj.childNodes[0].innerHTML;var a=this.pen.valueMin;return new Array(a,b)};this.getMaxValue=function(){var b=this.obj.childNodes[4].innerHTML;var a=this.pen.valueMax;return new Array(a,b)};this.setItemToolTipTemplate=function(a){this.label.tip=a};this.getItemToolTipTemplate=function(){return this.label.tip};return this};dhtmlXToolbarObject.prototype.unload=function(){if(typeof(window.addEventListener)=="function"){window.removeEventListener("mousedown",this._doOnClick,false);window.removeEventListener("touchstart",this._doOnClick,false)}else{document.body.detachEvent("onmousedown",this._doOnClick)}this._doOnClick=null;this.clearAll();this.objPull=null;if(this._xmlLoader){this._xmlLoader.destructor();this._xmlLoader=null}while(this.base.childNodes.length>0){this.base.removeChild(this.base.childNodes[0])}this.cont.removeChild(this.base);this.base=null;while(this.cont.childNodes.length>0){this.cont.removeChild(this.cont.childNodes[0])}this.cont.className="";this.cont=null;window.dhx4._enableDataLoading(this,null,null,null,"clear");window.dhx4._eventable(this,"clear");this.tX1=null;this.tX2=null;this.tY1=null;this.tY2=null;this.anyUsed=null;this.idPrefix=null;this.rootTypes=null;this._rtl=null;this._rtlParseBtn=null;this.setRTL=null;this._sbw=null;this._getObj=null;this._addImgObj=null;this._setItemImage=null;this._clearItemImage=null;this._setItemText=null;this._getItemText=null;this._enableItem=null;this._disableItem=null;this._xmlParser=null;this._addItemToStorage=null;this._genStr=null;this._addItem=null;this._getPosition=null;this._setPosition=null;this._getIdByPosition=null;this._separatorObject=null;this._textObject=null;this._buttonObject=null;this._buttonSelectObject=null;this._buttonInputObject=null;this._buttonTwoStateObject=null;this._sliderObject=null;this._autoDetectVisibleArea=null;this._removeItem=null;this.setAlign=null;this.setSkin=null;this.setIconsPath=null;this.setIconPath=null;this.loadXML=null;this.loadXMLString=null;this.clearAll=null;this.addSpacer=null;this.removeSpacer=null;this.getType=null;this.getTypeExt=null;this.inArray=null;this.getParentId=null;this.addButton=null;this.addText=null;this.addButtonSelect=null;this.addButtonTwoState=null;this.addSeparator=null;this.addSlider=null;this.addInput=null;this.forEachItem=null;this.showItem=null;this.hideItem=null;this.isVisible=null;this.enableItem=null;this.disableItem=null;this.isEnabled=null;this.setItemText=null;this.getItemText=null;this.setItemToolTip=null;this.getItemToolTip=null;this.setItemImage=null;this.setItemImageDis=null;this.clearItemImage=null;this.clearItemImageDis=null;this.setItemState=null;this.getItemState=null;this.setItemToolTipTemplate=null;this.getItemToolTipTemplate=null;this.setValue=null;this.getValue=null;this.setMinValue=null;this.getMinValue=null;this.setMaxValue=null;this.getMaxValue=null;this.setWidth=null;this.getWidth=null;this.getPosition=null;this.setPosition=null;this.removeItem=null;this.addListOption=null;this.removeListOption=null;this.showListOption=null;this.hideListOption=null;this.isListOptionVisible=null;this.enableListOption=null;this.disableListOption=null;this.isListOptionEnabled=null;this.setListOptionPosition=null;this.getListOptionPosition=null;this.setListOptionText=null;this.getListOptionText=null;this.setListOptionToolTip=null;this.getListOptionToolTip=null;this.setListOptionImage=null;this.getListOptionImage=null;this.clearListOptionImage=null;this.forEachListOption=null;this.getAllListOptions=null;this.setListOptionSelected=null;this.getListOptionSelected=null;this.unload=null;this.setUserData=null;this.getUserData=null;this.setMaxOpen=null;this.items=null;this.conf=null};dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){var b=window.dhx4.screenDim();this.tX1=b.left;this.tX2=b.right;this.tY1=b.top;this.tY2=b.bottom};dhtmlXToolbarObject.prototype.setIconset=function(b){this.conf.icons_css=(b=="awesome")};dhtmlXToolbarObject.prototype._evs={add:function(f,e){for(var a in f){if(typeof(window.addEventListener)=="function"){e.addEventListener(a,this[f[a]],false)}else{if(a.match(/^touch/)==null){e.attachEvent("on"+a,this[f[a]])}}}e=f=null},clear:function(f,e){for(var a in f){if(typeof(window.addEventListener)=="function"){e.removeEventListener(a,this[f[a]],false)}else{if(a.match(/^touch/)==null){e.detachEvent("on"+a,this[f[a]])}}}e=f=null}};dhtmlXToolbarObject.prototype._initObj=function(c){for(var d=0;d<c.length;d++){this._addItemToStorage(c[d])}if(this.conf.skin=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXToolbarObject.prototype._xmlToJson=function(q){var t=[];var e=q.getElementsByTagName("toolbar");if(e!=null&&e[0]!=null){e=e[0];var p=function(a){var c=null;for(var b=0;b<a.childNodes.length;b++){if(c==null&&a.childNodes[b].tagName=="itemText"){c=window.dhx4._xmlNodeValue(a.childNodes[b]);break}}return c};var D=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","mode","maxOpen","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"];var z=["id","type","enabled","disabled","action","selected","img","text"];for(var A=0;A<e.childNodes.length;A++){if(e.childNodes[A].tagName=="item"){var u={};for(var F=0;F<D.length;F++){var y=e.childNodes[A].getAttribute(D[F]);if(y!=null){u[D[F]]=y}}for(var h=0;h<e.childNodes[A].childNodes.length;h++){if(e.childNodes[A].childNodes[h].tagName=="item"&&u.type=="buttonSelect"){var E={};for(var F=0;F<z.length;F++){var y=e.childNodes[A].childNodes[h].getAttribute(z[F]);if(y!=null){E[z[F]]=y}}var r=e.childNodes[A].childNodes[h].getElementsByTagName("userdata");for(var F=0;F<r.length;F++){if(!E.userdata){E.userdata={}}var C={};try{C.name=r[F].getAttribute("name")}catch(w){C.name=null}try{C.value=r[F].firstChild.nodeValue}catch(w){C.value=""}if(C.name!=null){E.userdata[C.name]=C.value}}E.text=p(e.childNodes[A].childNodes[h])||E.text;if(u.options==null){u.options=[]}u.options.push(E)}if(e.childNodes[A].childNodes[h].tagName=="userdata"){if(u.userdata==null){u.userdata={}}var E={};try{E.name=e.childNodes[A].childNodes[h].getAttribute("name")}catch(w){E.name=null}try{E.value=e.childNodes[A].childNodes[h].firstChild.nodeValue}catch(w){E.value=""}if(E.name!=null){u.userdata[E.name]=E.value}}}u.text=p(e.childNodes[A])||u.text;t.push(u)}}p=null}return t};dhtmlXToolbarObject.prototype._addItemToStorage=function(l,i){var j=(l.id||this._genStr(24));var n=(l.type||"");if(n=="spacer"){this.addSpacer(this._lastId)}else{this._lastId=j}if(n!=""&&this["_"+n+"Object"]!=null){if(n=="buttonSelect"){if(l.options!=null){for(var m=0;m<l.options.length;m++){if(l.options[m].type=="obj"){l.options[m].type="button"}if(l.options[m].type=="sep"){l.options[m].type="separator"}}}}if(n=="slider"){var o={tip_template:"toolTip",value_min:"valueMin",value_max:"valueMax",value_now:"valueNow",text_min:"textMin",text_max:"textMax"};for(var a in o){if(l[o[a]]==null&&l[a]!=null){l[o[a]]=l[a]}}}if(n=="buttonInput"){if(l.value==null&&l.text!=null){l.value=l.text}}if(n=="buttonTwoState"){if(typeof(l.selected)=="undefined"&&typeof(l.pressed)!="undefined"&&window.dhx4.s2b(l.pressed)){l.selected=true}}if(typeof(l.enabled)=="undefined"&&typeof(l.disabled)!="undefined"&&window.dhx4.s2b(l.disabled)){l.enabled=false}if(l.imgDis==null&&l.img_disabled!=null){l.imgdis=l.img_disabled}if((typeof(l.openAll)=="undefined"||l.openAll==null)&&this.conf.skin=="dhx_terrace"){l.openAll=true}this.objPull[this.idPrefix+j]=new this["_"+n+"Object"](this,j,l);this.objPull[this.idPrefix+j]["type"]=n;this.setPosition(j,i)}if(l.userdata!=null){for(var a in l.userdata){this.setUserData(j,a,l.userdata[a])}}if(l.options!=null){for(var m=0;m<l.options.length;m++){if(l.options[m].userdata!=null){for(var a in l.options[m].userdata){this.setListOptionUserData(l.id,l.options[m].id,a,l.options[m].userdata[a])}}}}};dhtmlXToolbarObject.prototype.setSkin=function(f,h){if(h===true){this.cont.className=this.cont.className.replace(/dhxtoolbar_icons_\d{1,}/,"dhxtoolbar_icons_"+this.conf.iconSize)}else{this.conf.skin=f;if(this.conf.skin=="dhx_skyblue"){this.conf.sel_ofs_y=1}if(this.conf.skin=="dhx_web"){this.conf.sel_ofs_y=1;this.conf.sel_ofs_x=1}if(this.conf.skin=="dhx_terrace"){this.conf.sel_ofs_y=-1;this.conf.sel_ofs_x=0}if(this.conf.skin=="material"){this.conf.sel_ofs_y=-1;this.conf.sel_ofs_x=0}this.cont.className="dhx_toolbar_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize+this.conf.cssShadow}for(var a in this.objPull){var g=this.objPull[a];if(g.type=="slider"){g.pen._detectLimits();g.pen._definePos();g.label.className="dhx_toolbar_slider_label_"+this.conf.skin}if(g.type=="buttonSelect"){g.polygon.className="dhx_toolbar_poly_"+this.conf.skin+" dhxtoolbar_icons_"+this.conf.iconSize+this.conf.cssShadow}}if(f=="dhx_terrace"){this._improveTerraceSkin()}};dhtmlXToolbarObject.prototype.setAlign=function(b){this.conf.align=(b=="right"?"right":"left");this.base.className=(b=="right"?"dhxtoolbar_float_right":"dhxtoolbar_float_left");if(this._spacer){this._spacer.className=(b=="right"?" dhxtoolbar_float_left":" dhxtoolbar_float_right")}};dhtmlXToolbarObject.prototype.setIconSize=function(b){this.conf.iconSize=({18:true,24:true,32:true,48:true}[b]?b:18);this.setSkin(this.conf.skin,true);this.callEvent("_onIconSizeChange",[this.conf.iconSize])};dhtmlXToolbarObject.prototype.setIconsPath=function(b){this.conf.icons_path=b};dhtmlXToolbarObject.prototype.setUserData=function(f,e,d){f=this.idPrefix+f;if(this.objPull[f]!=null){if(this.objPull[f].userData==null){this.objPull[f].userData={}}this.objPull[f].userData[e]=d}};dhtmlXToolbarObject.prototype.getUserData=function(c,d){c=this.idPrefix+c;if(this.objPull[c]!=null&&this.objPull[c].userData!=null){return this.objPull[c].userData[d]||null}return null};dhtmlXToolbarObject.prototype._isListOptionExists=function(e,f){if(this.objPull[this.idPrefix+e]==null){return false}var d=this.objPull[this.idPrefix+e];if(d.type!="buttonSelect"){return false}if(d._listOptions[f]==null){return false}return true};dhtmlXToolbarObject.prototype.setListOptionUserData=function(g,h,f,i){if(!this._isListOptionExists(g,h)){return}var j=this.objPull[this.idPrefix+g]._listOptions[h];if(j.userData==null){j.userData={}}j.userData[f]=i};dhtmlXToolbarObject.prototype.getListOptionUserData=function(f,g,e){if(!this._isListOptionExists(f,g)){return null}var h=this.objPull[this.idPrefix+f]._listOptions[g];if(!h.userData){return null}return(h.userData[e]?h.userData[e]:null)};dhtmlXToolbarObject.prototype._improveTerraceSkin=function(){if(this.conf.terrace_radius==null){this.conf.terrace_radius="3px"}var r=[];var q={separator:true,text:true};var o=[this.base];if(this._spacer!=null){o.push(this._spacer)}for(var m=0;m<o.length;m++){r[m]=[];for(var s=0;s<o[m].childNodes.length;s++){if(o[m].childNodes[s].idd!=null&&o[m].childNodes[s].style.display!="none"){var n=this.idPrefix+o[m].childNodes[s].idd;if(this.objPull[n]!=null&&this.objPull[n].obj==o[m].childNodes[s]){r[m].push({a:n,type:this.objPull[n].type,node:this.objPull[n][this.objPull[n].type=="buttonSelect"?"arw":"obj"]})}}}o[m]=null}for(var m=0;m<r.length;m++){for(var s=0;s<r[m].length;s++){var e=r[m][s];var a=false;var p=false;if(!q[e.type]){if(s==r[m].length-1||(r[m][s+1]!=null&&q[r[m][s+1].type])){a=true}if(s==0||(s-1>=0&&r[m][s-1]!=null&&q[r[m][s-1].type])){p=true}}e.node.style.borderRightWidth=(a?"1px":"0px");e.node.style.borderTopRightRadius=e.node.style.borderBottomRightRadius=(a?this.conf.terrace_radius:"0px");if(e.type=="buttonSelect"){e.node.previousSibling.style.borderTopLeftRadius=e.node.previousSibling.style.borderBottomLeftRadius=(p?this.conf.terrace_radius:"0px");e.node.previousSibling._br=a;e.node.previousSibling._bl=p}else{e.node.style.borderTopLeftRadius=e.node.style.borderBottomLeftRadius=(p?this.conf.terrace_radius:"0px")}e.node._br=a;e.node._bl=p}}for(var m=0;m<r.length;m++){for(var s=0;s<r[m].length;s++){for(var n in r[m][s]){r[m][s][n]=null}r[m][s]=null}r[m]=null}r=o=null};dhtmlXToolbarObject.prototype._improveTerraceButtonSelect=function(f,d){var e=this.objPull[f];if(d==true){e.obj.style.borderBottomLeftRadius=(e.obj._bl?this.conf.terrace_radius:"0px");e.arw.style.borderBottomRightRadius=(e.obj._br?this.conf.terrace_radius:"0px")}else{e.obj.style.borderBottomLeftRadius="0px";e.arw.style.borderBottomRightRadius="0px"}e=null};if(typeof(window.dhtmlXCellObject)!="undefined"){dhtmlXCellObject.prototype._createNode_toolbar=function(h,f,i,g,j){if(typeof(j)!="undefined"){h=j}else{h=document.createElement("DIV");h.className="dhx_cell_toolbar_"+(this.conf.borders?"def":"no_borders");h.appendChild(document.createElement("DIV"));h.firstChild.className="dhx_toolbar_base_18_dhx_skyblue"}this.cell.insertBefore(h,this.cell.childNodes[this.conf.idx.cont]);this.conf.ofs_nodes.t.toolbar=true;this._updateIdx();return h};dhtmlXCellObject.prototype.attachToolbar=function(b){if(!(this.dataNodes.ribbon==null&&this.dataNodes.toolbar==null)){return}this.callEvent("_onBeforeContentAttach",["toolbar"]);if(typeof(b)=="undefined"){b={}}else{if(typeof(b)=="string"){b={skin:b}}}if(typeof(b.skin)=="undefined"){b.skin=this.conf.skin}b.parent=this._attachObject("toolbar").firstChild;this.dataNodes.toolbar=new dhtmlXToolbarObject(b);this._adjustCont(this._idd);this.dataNodes.toolbar._masterCell=this;this.dataNodes.toolbar.attachEvent("_onIconSizeChange",function(){this._masterCell._adjustCont()});b.parent=null;b=null;this.callEvent("_onContentAttach",[]);return this.dataNodes.toolbar};dhtmlXCellObject.prototype.detachToolbar=function(){if(this.dataNodes.toolbar==null){return}this.dataNodes.toolbar._masterCell=null;if(typeof(this.dataNodes.toolbar.unload)=="function"){this.dataNodes.toolbar.unload()}this.dataNodes.toolbar=null;delete this.dataNodes.toolbar;this._detachObject("toolbar")};dhtmlXCellObject.prototype.showToolbar=function(){this._mtbShowHide("toolbar","")};dhtmlXCellObject.prototype.hideToolbar=function(){this._mtbShowHide("toolbar","none")};dhtmlXCellObject.prototype.getAttachedToolbar=function(){return this.dataNodes.toolbar}}var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(b){return dhtmlx.extend((b||new Array()),dhtmlxArray._master)}dhtmlxArray._master={_dhx_find:function(c){for(var d=0;d<this.length;d++){if(c==this[d]){return d}}return -1},_dhx_insertAt:function(f,d){this[this.length]=null;for(var e=this.length-1;e>=f;e--){this[e]=this[e-1]}this[f]=d},_dhx_removeAt:function(b){this.splice(b,1)},_dhx_swapItems:function(e,f){var d=this[e];this[e]=this[f];this[f]=d}};function dhtmlXGridObject(id){if(dhtmlxEvent.initTouch){dhtmlxEvent.initTouch()}if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(id){if(typeof(id)=="object"){this.entBox=id;if(!this.entBox.id){this.entBox.id="cgrid2_"+this.uid()}}else{this.entBox=document.getElementById(id)}}else{this.entBox=document.createElement("DIV");this.entBox.id="cgrid2_"+this.uid()}this.entBox.innerHTML="";dhx4._eventable(this);var self=this;this._RaSeCol=[];this._wcorr=0;this.fontWidth=7;this.cell=null;this.row=null;this.iconURL="";this.editor=null;this._f2kE=true;this._dclE=true;this.combos=new Array(0);this.defVal=new Array(0);this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=true;this.xmlLoader=this.doLoadDetails;this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?(this.entBox.style.width||window.getComputedStyle(this.entBox,null)["width"]):(this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0))||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?(this.entBox.style.height||window.getComputedStyle(this.entBox,null)["height"]):(this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0))||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return false};var t_creator=function(name){var t=document.createElement("TABLE");t.cellSpacing=t.cellPadding=0;t.style.cssText="width:100%;table-layout:fixed;";t.className=name.substr(2);return t};this.obj=t_creator("c_obj");this.hdr=t_creator("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";if(dhtmlx.$customScroll){dhtmlx.CustomScroll.enable(this)}this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=new Array(0);this.sortImg=document.createElement("DIV");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=(_isIE&&(document.compatMode!="BackCompat")?22:20);this.imgURL=window.dhx_globalImgPath||"";this.isActive=false;this.isEditable=true;this.useImagesInHeader=false;this.pagingOn=false;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{if(self.destructor){self.destructor()}}catch(e){}});this.setSkin=function(name){this._srdh=window.dhx4.readFromCss("dhxgrid_rh_"+name)+4;this.skin_name=name;if(this._imgURL){this.setImagePath(this._imgURL)}var classname=this.entBox.className.split(" gridbox")[0];this.entBox.className=classname+" gridbox gridbox_"+name+(_isIE?" isIE":" isModern");this.skin_h_correction=0;this.enableAlterCss("ev_"+name,"odd_"+name,this.isTreeGrid());this._fixAlterCss();switch(name){case"dhx_terrace":case"material":this._srdh=33;this.forceDivInHeader=true;break;case"dhx_web":case"material":this.forceDivInHeader=true;this._srdh=31;break;case"dhx_skyblue":this.forceDivInHeader=true;break}if(_isIE&&this.hdr){var d=this.hdr.parentNode;d.removeChild(this.hdr);d.appendChild(this.hdr)}this.setSizes()};if(_isIE){this.preventIECaching(true)}if(window.dhtmlDragAndDropObject){this.dragger=new dhtmlDragAndDropObject()}this._doOnScroll=function(e,mode){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(e,mode)};this.doOnScroll=function(e,mode){var box=this.hdrBox;box._try_header_sync=true;setTimeout(function(){box._try_header_sync=false},2000);this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr){this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft}if(mode){return}if(this._srnd){if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}this._dLoadTimer=window.setTimeout(function(){if(self._update_srnd_view){self._update_srnd_view()}},100)}};this.attachToObject=function(obj){obj.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(fl){if((this.isTreeGrid())&&(!this._h2)){this._h2=this._createHierarchy();if((this._fake)&&(!this._realfake)){this._fake._h2=this._h2}this._tgc={imgURL:null}}if(!this._hstyles){return}if(!this.skin_name){this.setSkin(window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxgrid")||"material")}this.editStop();this.lastClicked=null;this.resized=null;this.fldSorted=this.r_fldSorted=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0){var temp=this.xmlFileUrl;this.clearAll(true);this.xmlFileUrl=temp}var hdrRow=this.hdr.insertRow(0);for(var i=0;i<this.hdrLabels.length;i++){hdrRow.appendChild(document.createElement("TH"));hdrRow.childNodes[i]._cellIndex=i;hdrRow.childNodes[i].style.height="0px"}if(_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined){hdrRow.style.position="absolute"}else{hdrRow.style.height="auto"}var hdrRow=this.hdr.insertRow(_isKHTML?2:1);hdrRow._childIndexes=new Array();var col_ex=0;for(var i=0;i<this.hdrLabels.length;i++){hdrRow._childIndexes[i]=i-col_ex;if((this.hdrLabels[i]==this.splitSign)&&(i!=0)){if(_isKHTML){hdrRow.insertCell(i-col_ex)}hdrRow.cells[i-col_ex-1].colSpan=(hdrRow.cells[i-col_ex-1].colSpan||1)+1;hdrRow.childNodes[i-col_ex-1]._cellIndex++;col_ex++;hdrRow._childIndexes[i]=i-col_ex;continue}hdrRow.insertCell(i-col_ex);hdrRow.childNodes[i-col_ex]._cellIndex=i;hdrRow.childNodes[i-col_ex]._cellIndexS=i;this.setColumnLabel(i,this.hdrLabels[i])}if(col_ex==0){hdrRow._childIndexes=null}this._cCount=this.hdrLabels.length;if(_isIE){window.setTimeout(function(){if(self.setSizes){self.setSizes()}},1)}if(!this.obj.firstChild){this.obj.appendChild(document.createElement("TBODY"))}var tar=this.obj.firstChild;if(!tar.firstChild){tar.appendChild(document.createElement("TR"));tar=tar.firstChild;if(_isIE&&_isIE<8&&document.body.style.msTouchAction==this.undefined){tar.style.position="absolute"}else{tar.style.height="auto"}for(var i=0;i<this.hdrLabels.length;i++){tar.appendChild(document.createElement("TH"));tar.childNodes[i].style.height="0px"}}this._c_order=null;if(this.multiLine!=true){this.obj.className+=" row20px"}this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.className="dhxgrid_sort_desc";this.sortImg.defLeft=0;if(this.noHeader){this.hdrBox.style.display="none"}else{this.noHeader=false}if(this._ivizcol){this.setColHidden()}this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();if(fl){this.parseXML()}this.obj.scrollTop=0;if(this.dragAndDropOff){this.dragger.addDragLanding(this.entBox,this)}if(this._initDrF){this._initD()}dhx4.callEvent("onGridCreated",[this])};this.setColumnSizes=function(gridWidth){var summ=0;var fcols=[];var fix=0;for(var i=0;i<this._cCount;i++){if((this.initCellWidth[i]=="*")&&!this._hrrar[i]){this._awdth=false;fcols.push(i);continue}if(this.cellWidthType=="%"){if(typeof this.cellWidthPC[i]=="undefined"){this.cellWidthPC[i]=this.initCellWidth[i]}var cwidth=(gridWidth*this.cellWidthPC[i]/100)||0;if(fix>0.5){cwidth++;fix--}var rwidth=this.cellWidthPX[i]=Math.floor(cwidth);var fix=fix+cwidth-rwidth}else{if(typeof this.cellWidthPX[i]=="undefined"){this.cellWidthPX[i]=this.initCellWidth[i]}}if(!this._hrrar[i]){summ+=this.cellWidthPX[i]*1}}if(fcols.length){var ms=Math.floor((gridWidth-summ)/fcols.length);if(ms<0){ms=1}for(var i=0;i<fcols.length;i++){var next=Math.max((this._drsclmW?(this._drsclmW[fcols[i]]||0):0),ms);this.cellWidthPX[fcols[i]]=next;summ+=next}if(gridWidth>summ){var last=fcols[fcols.length-1];this.cellWidthPX[last]=this.cellWidthPX[last]+(gridWidth-summ);summ=gridWidth}this._setAutoResize()}this.obj.style.width=summ+"px";this.hdr.style.width=summ+"px";if(this.ftr){this.ftr.style.width=summ+"px"}this.chngCellWidth();return summ};this.setSizes=function(){if((!this.hdr.rows[0])){return}var quirks=this.quirks=(_isIE&&document.compatMode=="BackCompat");var outerBorder=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(!this.dontSetSizes){if(this.globalBox){if(!this.globalBox.clientWidth){return}var ow=this.globalBox.clientWidth;var splitOuterBorder=(this.globalBox.offsetWidth-ow)/2;if(this._delta_x&&!this._realfake){this.globalBox.style.width=this._delta_x;this.globalBox.style.boxSizing="border-box";var owu=this.globalBox.clientWidth;this.entBox.style.width=Math.max(0,(owu+(quirks?splitOuterBorder*2:0))-this._fake.entBox.clientWidth)+"px";if(owu!=this._lastTimeSplitWidth){this._fake._correctSplit(this._fake.entBox.clientWidth);this._lastTimeSplitWidth=owu}}if(this._delta_y&&!this._realfake){this.globalBox.style.height=this._delta_y;this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden";this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(quirks?splitOuterBorder*2:0)+"px"}}else{if(this._delta_x){if(this.entBox.parentNode&&this.entBox.parentNode.tagName=="TD"){this.entBox.style.width="1px";this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-outerBorder*2+"px"}else{this.entBox.style.width=this._delta_x}}if(this._delta_y){this.entBox.style.height=this._delta_y}}}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth)){this._sizeTime=window.setTimeout(function(){if(self.setSizes){self.setSizes()}},250);return}var border_x=((!this._wthB)&&((this.entBox.cmp||this._delta_x)&&((this.skin_name||"").indexOf("dhx")==0||this.skin_name=="material")&&!quirks)?2:0);var border_y=((!this._wthB)&&((this.entBox.cmp||this._delta_y)&&((this.skin_name||"").indexOf("dhx")==0||this.skin_name=="material")&&!quirks)?2:0);if(this._sizeFix){border_x-=this._sizeFix;border_y-=this._sizeFix}var isVScroll=this.parentGrid?false:(this.objBox.scrollHeight>this.objBox.offsetHeight);var scrfix=dhtmlx.$customScroll?0:18;var gridWidth=this.entBox.clientWidth-(this.skin_h_correction||0)*(quirks?0:1)-border_x;var gridWidthActive=this.entBox.clientWidth-(this.skin_h_correction||0)-border_x;var gridHeight=this.entBox.clientHeight-border_y;var summ=this.setColumnSizes(gridWidthActive-(isVScroll?scrfix:0)-(this._correction_x||0));var isHScroll=this.parentGrid?false:((this.objBox.scrollWidth>this.objBox.offsetWidth)||(this.objBox.style.overflowX=="scroll"));var headerHeight=this.hdr.clientHeight;var footerHeight=this.ftr?this.ftr.clientHeight:0;var newWidth=gridWidth;var newHeight=gridHeight-headerHeight-footerHeight;if(this._awdth&&this._awdth[0]&&this._awdth[1]==99999){isHScroll=0}if(this._ahgr){if(this._ahgrMA){newHeight=this.entBox.parentNode.clientHeight-headerHeight-footerHeight}else{newHeight=this.obj.offsetHeight+(isHScroll?scrfix:0)+(this._correction_y||0)}if(this._ahgrM){if(this._ahgrF){newHeight=Math.min(this._ahgrM,newHeight+headerHeight+footerHeight)-headerHeight-footerHeight}else{newHeight=Math.min(this._ahgrM,newHeight)}}if(isVScroll&&newHeight>=this.obj.scrollHeight+(isHScroll?scrfix:0)){isVScroll=false;this.setColumnSizes(gridWidthActive-(this._correction_x||0))}}if((this._awdth)&&(this._awdth[0])){if(this.cellWidthType=="%"){this.cellWidthType="px"}if(this._fake){summ+=this._fake.entBox.clientWidth}var newWidth=Math.min(Math.max(summ+(isVScroll?scrfix:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this.objBox.style.overflowX=(!isVScroll&&this.objBox.scrollWidth<=newWidth)?"hidden":"auto";if(this._fake){newWidth-=this._fake.entBox.clientWidth}}newHeight=Math.max(0,newHeight);this._ff_size_delta=(this._ff_size_delta==0.1)?0.2:0.1;if(!_isFF){this._ff_size_delta=0}if(!this.dontSetSizes){this.entBox.style.width=Math.max(0,newWidth+(quirks?2:0)*outerBorder+this._ff_size_delta)+"px";this.entBox.style.height=newHeight+(quirks?2:0)*outerBorder+headerHeight+footerHeight+"px"}this.objBox.style.height=newHeight+((quirks&&!isVScroll)?2:0)*outerBorder+"px";this.hdrBox.style.height=headerHeight+"px";if(newHeight!=gridHeight){this.doOnScroll(0,!this._srnd)}var ext=this["setSizes_"+this.skin_name];if(ext){ext.call(this)}this.setSortImgPos();if(headerHeight!=this.hdr.clientHeight&&this._ahgr){this.setSizes()}this.callEvent("onSetSizes",[])};this.chngCellWidth=function(){if((_isOpera)&&(this.ftr)){this.ftr.width=this.objBox.scrollWidth+"px"}var l=this._cCount;for(var i=0;i<l;i++){this.hdr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px";this.obj.rows[0].childNodes[i].style.width=this.cellWidthPX[i]+"px";if(this.ftr){this.ftr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px"}}};this.setDelimiter=function(delim){this.delim=delim};this.setInitWidthsP=function(wp){this.cellWidthType="%";this.initCellWidth=wp.split(this.delim.replace(/px/gi,""));if(!arguments[1]){this._setAutoResize()}};this._setAutoResize=function(){if(this._realfake){return}var el=window;var self=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(self._resize_timer);if(self._setAutoResize){self._resize_timer=window.setTimeout(function(){if(self.setSizes){self.setSizes()}if(self._fake){self._fake._correctSplit()}},100)}});this._setAutoResize=function(){}};this.setInitWidths=function(wp){this.cellWidthType="px";this.initCellWidth=wp.split(this.delim);if(_isFF){for(var i=0;i<this.initCellWidth.length;i++){if(this.initCellWidth[i]!="*"){this.initCellWidth[i]=parseInt(this.initCellWidth[i])}}}};this.enableMultiline=function(state){this.multiLine=dhx4.s2b(state)};this.enableMultiselect=function(state){this.selMultiRows=dhx4.s2b(state)};this.setImagePath=function(path){path=path.replace(/imgs\/dhxgrid_[a-z]*\/$/,"imgs/");this._imgURL=path;this.imgURL=path+"dhxgrid_"+(this.skin_name||"dhx_skyblue").replace("dhx_","")+"/";this.iconTree=this.imgURL+"tree/"};this.setImagesPath=this.setImagePath;this.setIconPath=function(path){this.iconURL=path};this.setIconsPath=this.setIconPath;this.changeCursorState=function(ev){var el=ev.target||ev.srcElement;if(el.tagName!="TD"){el=this.getFirstParentOfType(el,"TD")}if(!el){return}if((el.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[el._cellIndex])){return el.style.cursor="default"}var check=(ev.layerX||0)+(((!_isIE)&&(ev.target.tagName=="DIV"))?el.offsetLeft:0);if((el.offsetWidth-(ev.offsetX||(parseInt(this.getPosition(el,this.hdrBox))-check)*-1))<(_isOpera?20:10)){el.style.cursor="E-resize"}else{el.style.cursor="default"}if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(ev){if(this.resized){this.stopColResize()}this.resized=null;var el=ev.target||ev.srcElement;if(el.tagName!="TD"){el=this.getFirstParentOfType(el,"TD")}var x=ev.clientX;var tabW=this.hdr.offsetWidth;var startW=parseInt(el.offsetWidth);if(el.tagName=="TD"&&el.style.cursor!="default"){if((this._drsclmn)&&(!this._drsclmn[el._cellIndex])){return}self._old_d_mm=document.body.onmousemove;self._old_d_mu=document.body.onmouseup;document.body.onmousemove=function(e){if(self){self.doColResize(e||window.event,el,startW,x,tabW)}};document.body.onmouseup=function(){if(self){self.stopColResize()}}}};this.stopColResize=function(){document.body.onmousemove=self._old_d_mm||"";document.body.onmouseup=self._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(ev,el,startW,x,tabW){el.style.cursor="E-resize";this.resized=el;var fcolW=startW+(ev.clientX-x);var wtabW=tabW+(ev.clientX-x);if(!(this.callEvent("onResize",[el._cellIndex,fcolW,this]))){return}if(_isIE){this.objBox.scrollLeft=this.hdrBox.scrollLeft}var result=false;if(el.colSpan>1){var a_sizes=new Array();for(var i=0;i<el.colSpan;i++){a_sizes[i]=Math.round(fcolW*this.hdr.rows[0].childNodes[el._cellIndexS+i].offsetWidth/el.offsetWidth)}for(var i=0;i<el.colSpan;i++){result=this._setColumnSizeR(el._cellIndexS+i*1,a_sizes[i])}}else{result=this._setColumnSizeR(el._cellIndex,fcolW)}this.doOnScroll(0,1);this.setSizes();if(this._fake&&this._awdth){this._fake._correctSplit()}return result};this._setColumnSizeR=function(ind,fcolW){if(fcolW>((this._drsclmW&&!this._notresize)?(this._drsclmW[ind]||10):10)){this.obj.rows[0].childNodes[ind].style.width=fcolW+"px";this.hdr.rows[0].childNodes[ind].style.width=fcolW+"px";if(this.ftr){this.ftr.rows[0].childNodes[ind].style.width=fcolW+"px"}if(this.cellWidthType=="px"){this.cellWidthPX[ind]=fcolW}else{var gridWidth=parseInt(this.entBox.offsetWidth);if(this.objBox.scrollHeight>this.objBox.offsetHeight){gridWidth-=17}var pcWidth=Math.round(fcolW/gridWidth*100);this.cellWidthPC[ind]=pcWidth}if(this.sortImg.style.display!="none"){this.setSortImgPos()}}else{return false}};this.setSortImgState=function(state,ind,order,row){order=(order||"asc").toLowerCase();if(!dhx4.s2b(state)){this.sortImg.style.display="none";if(this.r_fldSorted){this.r_fldSorted.className=""}this.fldSorted=this.r_fldSorted=null;return}if(order=="asc"){this.sortImg.className="dhxgrid_sort_asc"}else{this.sortImg.className="dhxgrid_sort_desc"}this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[ind];var r=this.hdr.rows[row||1];if(!r){return}for(var i=0;i<r.childNodes.length;i++){if(r.childNodes[i]._cellIndexS==ind){this.r_fldSorted=r.childNodes[i];return this.setSortImgPos()}}return this.setSortImgState(state,ind,order,(row||1)+1)};this.setSortImgPos=function(ind,mode,hRowInd,el){if(this._hrrar&&this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:ind]){return}if(this.ar_fldSorted){this.ar_fldSorted.className=""}if(!el){if(!ind){var el=this.r_fldSorted}else{var el=this.hdr.rows[hRowInd||0].cells[ind]}}if(el!=null){var pos=this.getPosition(el,this.hdrBox);var wdth=el.offsetWidth;this.ar_fldSorted=el;el.className=this.sortImg.className+"_col";this.sortImg.style.left=Number(pos[0]+wdth-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(pos[1]+5)+"px";if((!this.useImagesInHeader)&&(!mode)){this.sortImg.style.display="inline"}this.sortImg.style.left=this.sortImg.defLeft+"px"}};this.setActive=function(fl){if(arguments.length==0){var fl=true}if(fl==true){if(globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject!=this)){globalActiveDHTMLGridObject.editStop();globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])}globalActiveDHTMLGridObject=this;this.isActive=true}else{this.isActive=false;this.callEvent("onBlur",[this])}};this._doClick=function(ev){var selMethod=0;var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if(!el||!el.parentNode||!el.parentNode.idd){return}var fl=true;if(this.markedCells){var markMethod=0;if(ev.shiftKey||ev.metaKey){markMethod=1}if(ev.ctrlKey){markMethod=2}this.doMark(el,markMethod);return true}if(this.selMultiRows!=false){if(ev.shiftKey&&this.row!=null&&this.selectedRows.length){selMethod=1}if(ev.ctrlKey||ev.metaKey){selMethod=2}}return this.doClick(el,fl,selMethod,false)};this._doContClick=function(ev){var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if((!el)||(typeof(el.parentNode.idd)=="undefined")){this.callEvent("onEmptyClick",[ev]);return true}if(ev.button==2||(_isMacOS&&ev.ctrlKey)){if(!this.callEvent("onRightClick",[el.parentNode.idd,el._cellIndex,ev])){var z=function(e){(e||event).cancelBubble=true;return false};(ev.srcElement||ev.target).oncontextmenu=z;return z(ev)}if(this._ctmndx){if(!(this.callEvent("onBeforeContextMenu",[el.parentNode.idd,el._cellIndex,this]))){return true}if(_isIE){ev.srcElement.oncontextmenu=function(){event.cancelBubble=true;return false}}if(this._ctmndx.showContextMenu){var dEl0=window.document.documentElement;var dEl1=window.document.body;var corrector=new Array((dEl0.scrollLeft||dEl1.scrollLeft),(dEl0.scrollTop||dEl1.scrollTop));if(_isIE){var x=ev.clientX+corrector[0];var y=ev.clientY+corrector[1]}else{var x=ev.pageX;var y=ev.pageY}this._ctmndx.showContextMenu(x-1,y-1);this.contextID=this._ctmndx.contextMenuZoneId=el.parentNode.idd+"_"+el._cellIndex;this._ctmndx._skip_hide=true}else{el.contextMenuId=el.parentNode.idd+"_"+el._cellIndex;el.contextMenu=this._ctmndx;el.a=this._ctmndx._contextStart;el.a(el,ev);el.a=null}ev.cancelBubble=true;return false}}else{if(this._ctmndx){if(this._ctmndx.hideContextMenu){this._ctmndx.hideContextMenu()}else{this._ctmndx._contextEnd()}}}return true};this.doClick=function(el,fl,selMethod,show){if(!this.selMultiRows){selMethod=0}var psid=this.row?this.row.idd:0;this.setActive(true);if(!selMethod){selMethod=0}if(this.cell!=null){this.cell.className=this.cell.className.replace(/[ \t]*cellselected/g,"")}if(el.tagName=="TD"){if(this.checkEvent("onSelectStateChanged")){var initial=this.getSelectedId()}var prow=this.row;if(selMethod==1){var elRowIndex=this.rowsCol._dhx_find(el.parentNode);var lcRowIndex=this.rowsCol._dhx_find(this.lastClicked);if(elRowIndex>lcRowIndex){var strt=lcRowIndex;var end=elRowIndex}else{var strt=elRowIndex;var end=lcRowIndex}for(var i=0;i<this.rowsCol.length;i++){if((i>=strt&&i<=end)){if(this.rowsCol[i]&&(!this.rowsCol[i]._sRow)){if(!this.rowsCol[i].idd){continue}if(this.rowsCol[i].className.indexOf("rowselected")==-1&&(this.callEvent("onBeforeSelect",[this.rowsCol[i].idd,psid,el._cellIndex]))){this.rowsCol[i].className+=" rowselected";this.selectedRows[this.selectedRows.length]=this.rowsCol[i]}}else{this.clearSelection();return this.doClick(el,fl,0,show)}}}}else{if(selMethod==2){if(el.parentNode.className.indexOf("rowselected")!=-1){el.parentNode.className=el.parentNode.className.replace(/[ \t]*rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(el.parentNode));var skipRowSelection=true;show=false}}}this.editStop();if(typeof(el.parentNode.idd)=="undefined"){return true}if((!skipRowSelection)&&(!el.parentNode._sRow)){if(this.callEvent("onBeforeSelect",[el.parentNode.idd,psid,el._cellIndex])){if(this.getSelectedRowId()!=el.parentNode.idd){if(selMethod==0){this.clearSelection()}this.cell=el;if((prow==el.parentNode)&&(this._chRRS)){fl=false}this.row=el.parentNode;this.row.className+=" rowselected";if(this.selectedRows._dhx_find(this.row)==-1){this.selectedRows[this.selectedRows.length]=this.row}}else{this.cell=el;this.row=el.parentNode}}else{fl=false}}if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1){this.cell.className=this.cell.className.replace(/[ \t]*cellselected/g,"")+" cellselected"}if(selMethod!=1){if(!this.row){return}}this.lastClicked=el.parentNode;var rid=this.row.idd;var cid=this.cell;if(fl&&typeof(rid)!="undefined"&&cid&&!skipRowSelection){self.onRowSelectTime=setTimeout(function(){if(self.callEvent){self.callEvent("onRowSelect",[rid,cid._cellIndex])}},100)}else{this.callEvent("onRowSelectRSOnly",[rid])}if(this.checkEvent("onSelectStateChanged")){var afinal=this.getSelectedId();if(initial!=afinal){this.callEvent("onSelectStateChanged",[afinal,initial])}}if(skipRowSelection){return false}}this.isActive=true;if(show!==false&&this.cell&&this.cell.parentNode.idd){this.moveToVisible(this.cell)}};this.selectAll=function(){this.clearSelection();var coll=this.rowsBuffer;if(this.pagingOn){coll=this.rowsCol}for(var i=0;i<coll.length;i++){this.render_row(i).className+=" rowselected"}this.selectedRows=dhtmlxArray([].concat(coll));if(this.selectedRows.length){this.row=this.selectedRows[0];this.cell=this.row.cells[0]}if((this._fake)&&(!this._realfake)){this._fake.selectAll()}};this.selectCell=function(r,cInd,fl,preserve,edit,show){if(!fl){fl=false}if(typeof(r)!="object"){r=this.render_row(r)}if(!r||r==-1){return null}if(r._childIndexes){var c=r.childNodes[r._childIndexes[cInd]]}else{var c=r.childNodes[cInd]}if(!c){c=r.childNodes[0]}if(!this.markedCells){if(preserve){this.doClick(c,fl,3,show)}else{this.doClick(c,fl,0,show)}}else{this.doMark(c,preserve?2:0)}if(edit){this.editCell()}};this.moveToVisible=function(cell_obj,onlyVScroll){if(this.pagingOn){var newPage=Math.floor(this.getRowIndex(cell_obj.parentNode.idd)/this.rowsBufferOutSize)+1;if(newPage!=this.currentPage){this.changePage(newPage)}}try{if(cell_obj.offsetHeight){var distance=cell_obj.offsetLeft+cell_obj.offsetWidth+20;var scrollLeft=0;if(distance>(this.objBox.offsetWidth+this.objBox.scrollLeft)){if(cell_obj.offsetLeft>this.objBox.scrollLeft){scrollLeft=cell_obj.offsetLeft-(this.objBox.offsetWidth-cell_obj.offsetWidth)+5}}else{if(cell_obj.offsetLeft<this.objBox.scrollLeft){distance-=cell_obj.offsetWidth*2/3;if(distance<this.objBox.scrollLeft){scrollLeft=cell_obj.offsetLeft-5}}}if((scrollLeft)&&(!onlyVScroll)){this.objBox.scrollLeft=scrollLeft}}if(!cell_obj.offsetHeight){var mask=this._realfake?this._fake.rowsAr[cell_obj.parentNode.idd]:cell_obj.parentNode;distance=this.rowsBuffer._dhx_find(mask)*this._srdh}else{distance=cell_obj.offsetTop}var distancemax=distance+cell_obj.offsetHeight+38;if(distancemax>(this.objBox.offsetHeight+this.objBox.scrollTop)){var scrollTop=distance}else{if(distance<this.objBox.scrollTop){var scrollTop=distance-5}}if(scrollTop){this.objBox.scrollTop=scrollTop}}catch(er){}};this.editCell=function(){if(this.editor&&this.cell==this.editor.cell){return}this.editStop();if((this.isEditable!=true)||(!this.cell)){return false}var c=this.cell;if(c.parentNode._locked){return false}this.editor=this.cells4(c);if(this.editor!=null){if(this.editor.isDisabled()){this.editor=null;return false}if(this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=false&&this.editor.edit){this._Opera_stop=(new Date).valueOf();c.className+=" editable";this.editor.edit();this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])}else{this.editor=null}}};this.editStop=function(mode){if(_isOpera){if(this._Opera_stop){if((this._Opera_stop*1+50)>(new Date).valueOf()){return}this._Opera_stop=null}}if(this.editor&&this.editor!=null){this.editor.cell.className=this.editor.cell.className.replace("editable","");if(mode){var t=this.editor.val;this.editor.detach();this.editor.setValue(t);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,t]);return}if(this.editor.detach()){this.cell.wasChanged=true}var g=this.editor;if(g==null){return}this.editor=null;var z=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,g.getValue(),g.val]);if((typeof(z)=="string")||(typeof(z)=="number")){g[g.setImage?"setLabel":"setValue"](z)}else{if(!z){g[g.setImage?"setLabel":"setValue"](g.val)}}if(this._ahgr&&this.multiLine){this.setSizes()}}};this._nextRowCell=function(row,dir,pos){row=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(row),dir);if(!row){return null}return row.childNodes[row._childIndexes?row._childIndexes[pos]:pos]};this._getNextCell=function(acell,dir,i){acell=acell||this.cell;var arow=acell.parentNode;if(this._tabOrder){i=this._tabOrder[acell._cellIndex];if(typeof i!="undefined"){if(i<0){acell=this._nextRowCell(arow,dir,Math.abs(i)-1)}else{acell=arow.childNodes[i]}}}else{var i=acell._cellIndex+dir;if(i>=0&&i<this._cCount){if(arow._childIndexes){i=arow._childIndexes[acell._cellIndex]+dir}acell=arow.childNodes[i]}else{acell=this._nextRowCell(arow,dir,(dir==1?0:(this._cCount-1)))}}if(!acell){if((dir==1)&&this.tabEnd){this.tabEnd.focus();this.tabEnd.focus();this.setActive(false)}if((dir==-1)&&this.tabStart){this.tabStart.focus();this.tabStart.focus();this.setActive(false)}return null}if(acell.style.display!="none"&&(!this.smartTabOrder||!this.cells(acell.parentNode.idd,acell._cellIndex).isDisabled())){return acell}return this._getNextCell(acell,dir)};this._nextRow=function(ind,dir){var r=this.render_row(ind+dir);if(!r||r==-1){return null}if(r&&r.style.display=="none"){return this._nextRow(ind+dir,dir)}return r};this.scrollPage=function(dir){if(!this.rowsBuffer.length){return}var master=this._realfake?this._fake:this;var new_ind=Math.floor((master._r_select||this.getRowIndex(this.row.idd)||0)+(dir)*this.objBox.offsetHeight/(this._srdh||20));if(new_ind<0){new_ind=0}if(new_ind>=this.rowsBuffer.length){new_ind=this.rowsBuffer.length-1}if(this._srnd&&!this.rowsBuffer[new_ind]){this.objBox.scrollTop+=Math.floor((dir)*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}master._r_select=new_ind}else{this.selectCell(new_ind,this.cell._cellIndex,true,false,false,(this.multiLine||this._srnd));if(!this.multiLine&&!this._srnd&&!this._realfake){this.objBox.scrollTop=this.getRowById(this.getRowId(new_ind)).offsetTop;if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}}master._r_select=null}};this.doKey=function(ev){if(!ev){return true}if((ev.target||ev.srcElement).value!==window.undefined){var zx=(ev.target||ev.srcElement);if(zx.className!="dhxcombo_input"&&zx.className!="dhx_tab_ignore"&&((!zx.parentNode)||(zx.parentNode.className.indexOf("editable")==-1))){return true}}if((globalActiveDHTMLGridObject)&&(this!=globalActiveDHTMLGridObject)){return globalActiveDHTMLGridObject.doKey(ev)}if(this.isActive==false){return true}if(this._htkebl){return true}if(!this.callEvent("onKeyPress",[ev.keyCode,ev.ctrlKey,ev.shiftKey,ev])){return false}var code="k"+ev.keyCode+"_"+(ev.ctrlKey?1:0)+"_"+(ev.shiftKey?1:0);if(this.cell){if(this._key_events[code]){if(false===this._key_events[code].call(this)){return true}if(ev.preventDefault){ev.preventDefault()}ev.cancelBubble=true;return false}if(this._key_events.k_other){this._key_events.k_other.call(this,ev)}}return true};this.selectRow=function(r,fl,preserve,show){if(typeof(r)!="object"){r=this.render_row(r)}this.selectCell(r,0,fl,preserve,false,show)};this.wasDblClicked=function(ev){var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if(el){var rowId=el.parentNode.idd;return this.callEvent("onRowDblClicked",[rowId,el._cellIndex,ev])}};this._onHeaderClick=function(e,el){var that=this.grid;el=el||that.getFirstParentOfType(_isIE?event.srcElement:e.target,"TD");if(this.grid.resized==null){if(!(this.grid.callEvent("onHeaderClick",[el._cellIndexS,(e||window.event)]))){return false}that.sortField(el._cellIndexS,false,el)}this.grid.resized=null};this.deleteSelectedRows=function(){var num=this.selectedRows.length;if(num==0){return}var tmpAr=this.selectedRows;this.selectedRows=dhtmlxArray();for(var i=num-1;i>=0;i--){var node=tmpAr[i];if(!this.deleteRow(node.idd,node)){this.selectedRows[this.selectedRows.length]=node}else{if(node==this.row){var ind=i}}}if(ind){try{if(ind+1>this.rowsCol.length){ind--}this.selectCell(ind,0,true)}catch(er){this.row=null;this.cell=null}}};this.getSelectedRowId=function(){var selAr=new Array(0);var uni={};for(var i=0;i<this.selectedRows.length;i++){var id=this.selectedRows[i].idd;if(uni[id]){continue}selAr[selAr.length]=id;uni[id]=true}if(selAr.length==0){return null}else{return selAr.join(this.delim)}};this.getSelectedCellIndex=function(){if(this.cell!=null){return this.cell._cellIndex}else{return -1}};this.getColWidth=function(ind){return parseInt(this.cellWidthPX[ind])};this.setColWidth=function(ind,value){if(value=="*"){this.initCellWidth[ind]="*"}else{if(this._hrrar[ind]){return}if(this.cellWidthType=="px"){this.cellWidthPX[ind]=parseInt(value)}else{this.cellWidthPC[ind]=parseInt(value)}}this.setSizes()};this.getRowIndex=function(row_id){for(var i=0;i<this.rowsBuffer.length;i++){if(this.rowsBuffer[i]&&this.rowsBuffer[i].idd==row_id){return i}}return -1};this.getRowId=function(ind){return this.rowsBuffer[ind]?this.rowsBuffer[ind].idd:this.undefined};this.setRowId=function(ind,row_id){this.changeRowId(this.getRowId(ind),row_id)};this.changeRowId=function(oldRowId,newRowId){if(oldRowId==newRowId){return}var row=this.rowsAr[oldRowId];row.idd=newRowId;if(this.UserData[oldRowId]){this.UserData[newRowId]=this.UserData[oldRowId];this.UserData[oldRowId]=null}if(this._h2&&this._h2.get[oldRowId]){this._h2.get[newRowId]=this._h2.get[oldRowId];this._h2.get[newRowId].id=newRowId;delete this._h2.get[oldRowId]}this.rowsAr[oldRowId]=null;this.rowsAr[newRowId]=row;for(var i=0;i<row.childNodes.length;i++){if(row.childNodes[i]._code){row.childNodes[i]._code=this._compileSCL(row.childNodes[i]._val,row.childNodes[i])}}if(this._mat_links&&this._mat_links[oldRowId]){var a=this._mat_links[oldRowId];delete this._mat_links[oldRowId];for(var c in a){for(var i=0;i<a[c].length;i++){this._compileSCL(a[c][i].original,a[c][i])}}}this.callEvent("onRowIdChange",[oldRowId,newRowId])};this.setColumnIds=function(ids){this.columnIds=ids.split(this.delim)};this.setColumnId=function(ind,id){this.columnIds[ind]=id};this.getColIndexById=function(id){for(var i=0;i<this.columnIds.length;i++){if(this.columnIds[i]==id){return i}}};this.getColumnId=function(cin){return this.columnIds[cin]};this.getColumnLabel=function(cin,ind,hdr,raw){var z=(hdr||this.hdr).rows[(ind||0)+1];for(var i=0;i<z.cells.length;i++){if(z.cells[i]._cellIndexS==cin){return raw?z.cells[i].firstChild.innerHTML:(_isIE?z.cells[i].innerText:z.cells[i].textContent)}}return""};this.getColLabel=this.getColumnLabel;this.getFooterLabel=function(cin,ind,raw){return this.getColumnLabel(cin,ind,this.ftr,raw)};this.setRowTextBold=function(row_id){var r=this.getRowById(row_id);if(r){r.style.fontWeight="bold"}};this.setRowTextStyle=function(row_id,styleString){var r=this.getRowById(row_id);if(!r){return}for(var i=0;i<r.childNodes.length;i++){var pfix=r.childNodes[i]._attrs.style||"";if((this._hrrar)&&(this._hrrar[i])){pfix="display:none;"}if(_isIE){r.childNodes[i].style.cssText=pfix+"width:"+r.childNodes[i].style.width+";"+styleString}else{r.childNodes[i].style.cssText=pfix+"width:"+r.childNodes[i].style.width+";"+styleString}}};this.setRowColor=function(row_id,color){var r=this.getRowById(row_id);for(var i=0;i<r.childNodes.length;i++){r.childNodes[i].bgColor=color}};this.setCellTextStyle=function(row_id,ind,styleString){var r=this.getRowById(row_id);if(!r){return}var cell=r.childNodes[r._childIndexes?r._childIndexes[ind]:ind];if(!cell){return}var pfix="";if((this._hrrar)&&(this._hrrar[ind])){pfix="display:none;"}if(_isIE){cell.style.cssText=pfix+"width:"+cell.style.width+";"+styleString}else{cell.style.cssText=pfix+"width:"+cell.style.width+";"+styleString}};this.setRowTextNormal=function(row_id){var r=this.getRowById(row_id);if(r){r.style.fontWeight="normal"}};this.doesRowExist=function(row_id){if(this.getRowById(row_id)!=null){return true}else{return false}};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(row_id){var r=this.getRowById(row_id);if(this.isTreeGrid()){return this.moveRowUDTG(row_id,-1)}var rInd=this.rowsCol._dhx_find(r);if((r.previousSibling)&&(rInd!=0)){r.parentNode.insertBefore(r,r.previousSibling);this.rowsCol._dhx_swapItems(rInd,rInd-1);this.setSizes();var bInd=this.rowsBuffer._dhx_find(r);this.rowsBuffer._dhx_swapItems(bInd,bInd-1);if(this._cssEven){this._fixAlterCss(rInd-1)}}};this.moveRowDown=function(row_id){var r=this.getRowById(row_id);if(this.isTreeGrid()){return this.moveRowUDTG(row_id,1)}var rInd=this.rowsCol._dhx_find(r);if(r.nextSibling){this.rowsCol._dhx_swapItems(rInd,rInd+1);if(r.nextSibling.nextSibling){r.parentNode.insertBefore(r,r.nextSibling.nextSibling)}else{r.parentNode.appendChild(r)}this.setSizes();var bInd=this.rowsBuffer._dhx_find(r);this.rowsBuffer._dhx_swapItems(bInd,bInd+1);if(this._cssEven){this._fixAlterCss(rInd)}}};this.getCombo=function(col_ind){if(!this.combos[col_ind]){this.combos[col_ind]=new dhtmlXGridComboObject()}return this.combos[col_ind]};this.setUserData=function(row_id,name,value){if(!row_id){row_id="gridglobaluserdata"}if(!this.UserData[row_id]){this.UserData[row_id]=new Hashtable()}this.UserData[row_id].put(name,value)};this.getUserData=function(row_id,name){if(!row_id){row_id="gridglobaluserdata"}this.getRowById(row_id);var z=this.UserData[row_id];return(z?z.get(name):"")};this.setEditable=function(fl){this.isEditable=dhx4.s2b(fl)};this.selectRowById=function(row_id,multiFL,show,call){if(!call){call=false}this.selectCell(this.getRowById(row_id),0,call,multiFL,false,show)};this.clearSelection=function(){this.editStop();for(var i=0;i<this.selectedRows.length;i++){var r=this.rowsAr[this.selectedRows[i].idd];if(r){r.className=r.className.replace(/[ \t]*rowselected/g,"")}}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/[ \t]*cellselected/g,"");this.cell=null}this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(from_row_id,to_row_id){var frRow=this.getRowById(from_row_id);if(!this.isTreeGrid()){for(var i=0;i<frRow.cells.length;i++){this.cells(to_row_id,i).setValue(this.cells(from_row_id,i).getValue())}}else{this._copyTreeGridRowContent(frRow,from_row_id,to_row_id)}if(!_isIE){this.getRowById(from_row_id).cells[0].height=frRow.cells[0].offsetHeight}};this.setFooterLabel=function(c,label,ind){return this.setColumnLabel(c,label,ind,this.ftr)};this.setColumnLabel=function(c,label,ind,hdr){var z=(hdr||this.hdr).rows[ind||1];var col=(z._childIndexes?z._childIndexes[c]:c);if(!z.cells[col]){return}if(!this.useImagesInHeader){var hdrHTML="<div class='hdrcell'>";if(label.indexOf("img:[")!=-1){var imUrl=label.replace(/.*\[([^>]+)\].*/,"$1");label=label.substr(label.indexOf("]")+1,label.length);hdrHTML+="<img width='18px' height='18px' align='absmiddle' src='"+imUrl+"' hspace='2'>"}hdrHTML+=label;hdrHTML+="</div>";z.cells[col].innerHTML=hdrHTML;if(this._hstyles[c]){z.cells[col].style.cssText=this._hstyles[c]}}else{z.cells[col].style.textAlign="left";z.cells[col].innerHTML="<img src='"+label+"'>";var a=new Image();a.src=""+label.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=a;var b=new Image();b.src=""+label.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=b}if((label||"").indexOf("#")!=-1){var t=label.match(/(^|{)#([^}]+)(}|$)/);if(t){var tn="_in_header_"+t[2];if(this[tn]){this[tn]((this.forceDivInHeader?z.cells[col].firstChild:z.cells[col]),col,label.split(t[0]))}}}};this.setColLabel=function(a,b,ind,c){return this.setColumnLabel(a,b,(ind||0)+1,c)};this.clearAll=function(header){if(!this.obj.rows[0]){return}if(this._h2){this._h2=this._createHierarchy();if(this._fake){if(this._realfake){this._h2=this._fake._h2}else{this._fake._h2=this._h2}}}this.limit=this._limitC=0;this.editStop(true);if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}if(this._dload){this.objBox.scrollTop=0;this.limit=this._limitC||0;this._initDrF=true}var len=this.rowsCol.length;len=this.obj.rows.length;for(var i=len-1;i>0;i--){var t_r=this.obj.rows[i];t_r.parentNode.removeChild(t_r)}if(header){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(var i=this.hdr.rows.length-1;i>=0;i--){var t_r=this.hdr.rows[i];t_r.parentNode.removeChild(t_r)}if(this.ftr){this.ftr.parentNode.removeChild(this.ftr);this.ftr=null}this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._strangeParams=[];this.defVal=[];this._ivizcol=null}this.row=null;this.cell=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd){this.xmlFileUrl=""}if(this.pagingOn){this.changePage(1)}if(this._contextCallTimer){window.clearTimeout(this._contextCallTimer)}if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;this.setSortImgState(false);this.setSizes();this.callEvent("onClearAll",[])};this.sortField=function(ind,repeatFl,r_el){if(this.getRowsNum()==0){return false}var el=this.hdr.rows[0].cells[ind];if(!el){return}if(el.tagName=="TH"&&(this.fldSort.length-1)>=el._cellIndex&&this.fldSort[el._cellIndex]!="na"){var data=this.getSortingState();var sortType=(data[0]==ind&&data[1]=="asc")?"des":"asc";if(!this.callEvent("onBeforeSorting",[ind,this.fldSort[ind],sortType])){return}this.sortImg.className="dhxgrid_sort_"+(sortType=="asc"?"asc":"desc");if(this.useImagesInHeader){var cel=this.hdr.rows[1].cells[el._cellIndex].firstChild;if(this.fldSorted!=null){var celT=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;celT.src=celT.src.replace(/(\.asc\.)|(\.des\.)/,".")}cel.src=cel.src.replace(/(\.[a-z]+)$/,"."+sortType+"$1")}this.sortRows(el._cellIndex,this.fldSort[el._cellIndex],sortType);this.fldSorted=el;if(r_el&&r_el.tagName.toLowerCase()!="th"){this.r_fldSorted=r_el}var c=this.hdr.rows[1];var c=r_el.parentNode;var real_el=c._childIndexes?c._childIndexes[el._cellIndex]:el._cellIndex;this.setSortImgPos(false,false,false,r_el)}};this.setCustomSorting=function(func,col){if(!this._customSorts){this._customSorts=new Array()}this._customSorts[col]=(typeof(func)=="string")?eval(func):func;this.fldSort[col]="cus"};this.enableHeaderImages=function(fl){this.useImagesInHeader=fl};this.setHeader=function(hdrStr,splitSign,styles){if(typeof(hdrStr)!="object"){var arLab=this._eSplit(hdrStr)}else{arLab=[].concat(hdrStr)}var arWdth=new Array(0);var arTyp=new dhtmlxArray(0);var arAlg=new Array(0);var arVAlg=new Array(0);var arSrt=new Array(0);for(var i=0;i<arLab.length;i++){arWdth[arWdth.length]=Math.round(100/arLab.length);arTyp[arTyp.length]="ed";arAlg[arAlg.length]="left";arVAlg[arVAlg.length]="middle";arSrt[arSrt.length]="na"}this.splitSign=splitSign||"#cspan";this.hdrLabels=arLab;this.cellWidth=arWdth;if(!this.initCellWidth.length){this.setInitWidthsP(arWdth.join(this.delim),true)}this.cellType=arTyp;this.cellAlign=arAlg;this.cellVAlign=arVAlg;this.fldSort=arSrt;this._hstyles=styles||[]};this._eSplit=function(str){if(![].push){return str.split(this.delim)}var a="r"+(new Date()).valueOf();var z=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(str||"").replace(RegExp(z,"g"),a).replace(RegExp("\\\\"+a,"g"),this.delim).split(a)};this.getColType=function(cInd){return this.cellType[cInd]};this.getColTypeById=function(cID){return this.cellType[this.getColIndexById(cID)]};this.setColTypes=function(typeStr){this.cellType=dhtmlxArray(typeStr.split(this.delim));this._strangeParams=new Array();for(var i=0;i<this.cellType.length;i++){if((this.cellType[i].indexOf("[")!=-1)){var z=this.cellType[i].split(/[\[\]]+/g);this.cellType[i]=z[0];this.defVal[i]=z[1];if(z[1].indexOf("=")==0){this.cellType[i]="math";this._strangeParams[i]=z[0]}}if(!window["eXcell_"+this.cellType[i]]){dhx4.callEvent("onConfigurationError",["Incorrect cell type: "+this.cellType[i],this,this.cellType[i]])}}};this.setColSorting=function(sortStr){this.fldSort=sortStr.split(this.delim);var check={str:1,"int":1,date:1};for(var i=0;i<this.fldSort.length;i++){if((!check[this.fldSort[i]])&&(typeof(window[this.fldSort[i]])=="function")){if(!this._customSorts){this._customSorts=new Array()}this._customSorts[i]=window[this.fldSort[i]];this.fldSort[i]="cus"}}};this.setColAlign=function(alStr){this.cellAlign=alStr.split(this.delim);for(var i=0;i<this.cellAlign.length;i++){this.cellAlign[i]=this.cellAlign[i]._dhx_trim()}};this.setColVAlign=function(valStr){this.cellVAlign=valStr.split(this.delim)};this.setNoHeader=function(fl){this.noHeader=dhx4.s2b(fl)};this.showRow=function(rowID){this.getRowById(rowID);if(this._h2){this.openItem(this._h2.get[rowID].parent.id)}var c=this.getRowById(rowID).childNodes[0];while(c&&c.style.display=="none"){c=c.nextSibling}if(c){this.moveToVisible(c,true)}};this.setStyle=function(ss_header,ss_grid,ss_selCell,ss_selRow){this.ssModifier=[ss_header,ss_grid,ss_selCell,ss_selCell,ss_selRow];var prefs=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"];var index=0;while(!_isIE){try{var temp=document.styleSheets[index].cssRules.length}catch(e){index++;continue}break}for(var i=0;i<prefs.length;i++){if(this.ssModifier[i]){if(_isIE){document.styleSheets[0].addRule(prefs[i],this.ssModifier[i])}else{document.styleSheets[index].insertRule(prefs[i]+(" { "+this.ssModifier[i]+" }"),document.styleSheets[index].cssRules.length)}}}};this.setColumnColor=function(clr){this.columnColor=clr.split(this.delim)};this.enableAlterCss=function(cssE,cssU,perLevel,levelUnique){if(cssE||cssU){this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();if(this._fake){this._fake._fixAlterCss()}})}this._cssSP=perLevel;this._cssSU=levelUnique;this._cssEven=cssE;this._cssUnEven=cssU};this._fixAlterCss=function(ind){if(this._h2&&(this._cssSP||this._cssSU)){return this._fixAlterCssTGR(ind)}if(!this._cssEven&&!this._cssUnEven){return}ind=ind||0;var j=ind;for(var i=ind;i<this.rowsCol.length;i++){if(!this.rowsCol[i]){continue}if(this.rowsCol[i].style.display!="none"){if(this.rowsCol[i]._cntr){j=1;continue}if(this.rowsCol[i].className.indexOf("rowselected")!=-1){if(j%2==1){this.rowsCol[i].className=this._cssUnEven+" rowselected "+(this.rowsCol[i]._css||"")}else{this.rowsCol[i].className=this._cssEven+" rowselected "+(this.rowsCol[i]._css||"")}}else{if(j%2==1){this.rowsCol[i].className=this._cssUnEven+" "+(this.rowsCol[i]._css||"")}else{this.rowsCol[i].className=this._cssEven+" "+(this.rowsCol[i]._css||"")}}j++}}};this.clearChangedState=function(clear_added){for(var i=0;i<this.rowsCol.length;i++){var row=this.rowsCol[i];if(row&&row.childNodes){var cols=row.childNodes.length;for(var j=0;j<cols;j++){row.childNodes[j].wasChanged=false}if(clear_added){row._added=false}}}};this.getChangedRows=function(and_added){var res=new Array();this.forEachRow(function(id){var row=this.rowsAr[id];if(row.tagName!="TR"){return}var cols=row.childNodes.length;if(and_added&&row._added){res[res.length]=row.idd}else{for(var j=0;j<cols;j++){if(row.childNodes[j].wasChanged){res[res.length]=row.idd;break}}}});return res.join(this.delim)};this._sUDa=false;this._sAll=false;this.setSerializationLevel=function(userData,fullXML,config,changedAttr,onlyChanged,asCDATA){this._sUDa=userData;this._sAll=fullXML;this._sConfig=config;this._chAttr=changedAttr;this._onlChAttr=onlyChanged;this._asCDATA=asCDATA};this.setSerializableColumns=function(list){if(!list){this._srClmn=null;return}this._srClmn=(list||"").split(",");for(var i=0;i<this._srClmn.length;i++){this._srClmn[i]=dhx4.s2b(this._srClmn[i])}};this._serialise=function(rCol,inner,closed){this.editStop();var out=[];var close="</"+this.xml.s_row+">";if(this.isTreeGrid()){this._h2.forEachChildF(0,function(el){var temp=this._serializeRow(this.render_row_tree(-1,el.id));out.push(temp);if(temp){return true}else{return false}},this,function(){out.push(close)})}else{for(var i=0;i<this.rowsBuffer.length;i++){if(this.rowsBuffer[i]){if(this._chAttr&&this.rowsBuffer[i]._locator){continue}var temp=this._serializeRow(this.render_row(i));out.push(temp);if(temp){out.push(close)}}}}return[out.join("")]};this._serializeRow=function(r,i){var out=[];var ra=this.xml.row_attrs;var ca=this.xml.cell_attrs;out.push("<"+this.xml.s_row);out.push(" id='"+r.idd+"'");if((this._sAll)&&this.selectedRows._dhx_find(r)!=-1){out.push(" selected='1'")}if(this._h2&&this._h2.get[r.idd].state=="minus"){out.push(" open='1'")}if(ra.length){for(var i=0;i<ra.length;i++){out.push(" "+ra[i]+"='"+r._attrs[ra[i]]+"'")}}out.push(">");if(this._sUDa&&this.UserData[r.idd]){keysAr=this.UserData[r.idd].getKeys();for(var ii=0;ii<keysAr.length;ii++){var subkey=keysAr[ii];if(subkey.indexOf("__")!==0){out.push("<userdata name='"+subkey+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[r.idd].get(subkey)+(this._asCDATA?"]]>":"")+"</userdata>")}}}var changeFl=false;for(var jj=0;jj<this._cCount;jj++){if((!this._srClmn)||(this._srClmn[jj])){var zx=this.cells3(r,jj);out.push("<cell");if(ca.length){for(var i=0;i<ca.length;i++){out.push(" "+ca[i]+"='"+zx.cell._attrs[ca[i]]+"'")}}zxVal=zx[this._agetm]();if(this._asCDATA){zxVal="<![CDATA["+zxVal+"]]>"}if((this._ecspn)&&(zx.cell.colSpan)&&zx.cell.colSpan>1){out.push(' colspan="'+zx.cell.colSpan+'" ')}if(this._chAttr){if(zx.wasChanged()){out.push(' changed="1"');changeFl=true}}else{if((this._onlChAttr)&&(zx.wasChanged())){changeFl=true}}if(this._sAll&&this.cellType[jj]=="tree"){out.push((this._h2?(" image='"+this._h2.get[r.idd].image+"'"):"")+">"+zxVal+"</cell>")}else{out.push(">"+zxVal+"</cell>")}if((this._ecspn)&&(zx.cell.colSpan)){for(var u=0;u<zx.cell.colSpan-1;u++){out.push("<cell/>");jj++}}}}if((this._onlChAttr)&&(!changeFl)&&(!r._added)){return""}return out.join("")};this._serialiseConfig=function(){var out="<head>";for(var i=0;i<this.hdr.rows[0].cells.length;i++){if(this._srClmn&&!this._srClmn[i]){continue}var sort=this.fldSort[i];if(sort=="cus"){sort=this._customSorts[i].toString();sort=sort.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}out+="<column width='"+this.getColWidth(i)+"' align='"+this.cellAlign[i]+"' type='"+this.cellType[i]+"' sort='"+(sort||"na")+"' color='"+(this.columnColor[i]||"")+"'"+(this.columnIds[i]?(" id='"+this.columnIds[i]+"'"):"")+">";if(this._asCDATA){out+="<![CDATA["+this.getColumnLabel(i)+"]]>"}else{out+=this.getColumnLabel(i)}var z=this.getCombo(i);if(z){for(var j=0;j<z.keys.length;j++){out+="<option value='"+z.keys[j]+"'>"+z.values[j]+"</option>"}}out+="</column>"}return out+="</head>"};this.serialize=function(){var out='<?xml version="1.0"?><rows>';if(this._mathSerialization){this._agetm="getMathValue"}else{this._agetm="getValue"}if(this._sUDa&&this.UserData.gridglobaluserdata){var keysAr=this.UserData.gridglobaluserdata.getKeys();for(var i=0;i<keysAr.length;i++){out+="<userdata name='"+keysAr[i]+"'>"+this.UserData.gridglobaluserdata.get(keysAr[i])+"</userdata>"}}if(this._sConfig){out+=this._serialiseConfig()}out+=this._serialise();out+="</rows>";return out};this.getPosition=function(oNode,pNode){if(!pNode){var pos=dhx4.getOffset(oNode);return[pos.left,pos.top]}pNode=pNode||document.body;var oCurrentNode=oNode;var iLeft=0;var iTop=0;while((oCurrentNode)&&(oCurrentNode!=pNode)){iLeft+=oCurrentNode.offsetLeft-oCurrentNode.scrollLeft;iTop+=oCurrentNode.offsetTop-oCurrentNode.scrollTop;oCurrentNode=oCurrentNode.offsetParent}if(pNode==document.body){if(_isIE){iTop+=document.body.offsetTop||document.documentElement.offsetTop;iLeft+=document.body.offsetLeft||document.documentElement.offsetLeft}else{if(!_isFF){iLeft+=document.body.offsetLeft;iTop+=document.body.offsetTop}}}return[iLeft,iTop]};this.getFirstParentOfType=function(obj,tag){while(obj&&obj.tagName!=tag&&obj.tagName!="BODY"){obj=obj.parentNode}return obj};this.objBox.onscroll=function(){this.grid._doOnScroll()};this.hdrBox.onscroll=function(){if(this._try_header_sync){return}this._try_header_sync=true;if(Math.abs(this.grid.objBox.scrollLeft-this.scrollLeft)>1){this.grid.objBox.scrollLeft=this.scrollLeft}this._try_header_sync=false};if((!_isOpera)||(_OperaRv>8.5)){this.hdr.onmousemove=function(e){this.grid.changeCursorState(e||window.event)};this.hdr.onmousedown=function(e){return this.grid.startColResize(e||window.event)}}this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(e){e=e||event;e.cancelBubble=true;this.firstChild.grid.setActive(true);window.dhx4.callEvent("_onGridClick",[e,this.firstChild.grid])};this.obj.onclick=function(e){if(this.grid._doClick(e||window.event)!==false){if(this.grid._sclE){this.grid.editCell(e||window.event)}else{this.grid.editStop()}}e=e||event;e.cancelBubble=true;window.dhx4.callEvent("_onGridClick",[e,this.grid])};if(_isMacOS){this.entBox.oncontextmenu=function(e){e.cancelBubble=true;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}var that=this.grid;if(that._realfake){that=that._fake}return that._doContClick(e||window.event)}}else{this.entBox.onmousedown=function(e){return this.grid._doContClick(e||window.event)};this.entBox.oncontextmenu=function(e){if(this.grid._ctmndx){(e||event).cancelBubble=true}return !this.grid._ctmndx}}this.obj.ondblclick=function(e){if(!this.grid.wasDblClicked(e||window.event)){return false}if(this.grid._dclE){var row=this.grid.getFirstParentOfType((_isIE?event.srcElement:e.target),"TR");if(row==this.grid.row){this.grid.editCell(e||window.event)}}(e||event).cancelBubble=true;if(_isOpera){return false}};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){self._onHeaderClick.apply({grid:self},[null,self.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown){dhtmlxEvent(document,"keydown",function(e){if(globalActiveDHTMLGridObject){return globalActiveDHTMLGridObject.doKey(e||window.event)}});document.body._dhtmlxgrid_onkeydown=true}dhtmlxEvent(document.body,"click",function(){if(self.editStop){self.editStop()}if(self.isActive){self.setActive(false)}});if(this.entBox.style.height.toString().indexOf("%")!=-1){this._delta_y=this.entBox.style.height}if(this.entBox.style.width.toString().indexOf("%")!=-1){this._delta_x=this.entBox.style.width}if(this._delta_x||this._delta_y){this._setAutoResize()}this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;if(dhtmlx.image_path){this.setImagePath(dhtmlx.image_path)}if(dhtmlx.skin){this.setSkin(dhtmlx.skin)}return this}dhtmlXGridObject.prototype={getRowAttribute:function(c,d){return this.getRowById(c)._attrs[d]},setRowAttribute:function(f,e,d){this.getRowById(f)._attrs[e]=d},isTreeGrid:function(){return(this.cellType._dhx_find("tree")!=-1)},setRowHidden:function(i,m){var f=dhx4.s2b(m);var j=this.getRowById(i);if(!j){return}if(j.expand===""){this.collapseKids(j)}if((m)&&(j.style.display!="none")){j.style.display="none";var l=this.selectedRows._dhx_find(j);if(l!=-1){j.className=j.className.replace("rowselected","");for(var h=0;h<j.childNodes.length;h++){j.childNodes[h].className=j.childNodes[h].className.replace(/cellselected/g,"")}this.selectedRows._dhx_removeAt(l)}this.callEvent("onGridReconstructed",[])}if((!m)&&(j.style.display=="none")){j.style.display="";this.callEvent("onGridReconstructed",[])}this.callEvent("onRowHide",[i,m]);this.setSizes()},setColumnHidden:function(f,d){if(!this.hdr.rows.length){if(!this._ivizcol){this._ivizcol=[]}return this._ivizcol[f]=d}if((this.fldSorted)&&(this.fldSorted.cellIndex==f)&&(d)){this.sortImg.style.display="none"}var e=dhx4.s2b(d);if(e){if(!this._hrrar){this._hrrar=new Array()}else{if(this._hrrar[f]){return}}this._hrrar[f]="display:none;";this._hideShowColumn(f,"none")}else{if((!this._hrrar)||(!this._hrrar[f])){return}this._hrrar[f]="";this._hideShowColumn(f,"")}if((this.fldSorted)&&(this.fldSorted.cellIndex==f)&&(!d)){this.sortImg.style.display="inline"}this.setSortImgPos();this.callEvent("onColumnHidden",[f,d])},isColumnHidden:function(b){if((this._hrrar)&&(this._hrrar[b])){return true}return false},setColumnsVisibility:function(c){if(c){this._ivizcol=c.split(this.delim)}if(this.hdr.rows.length&&this._ivizcol){for(var d=0;d<this._ivizcol.length;d++){this.setColumnHidden(d,this._ivizcol[d])}}},_fixHiddenRowsAll:function(j,q,s,r,n){n=n||"_cellIndex";var m=j.rows.length;for(var o=0;o<m;o++){var i=j.rows[o].childNodes;if(i.length!=this._cCount){for(var p=0;p<i.length;p++){if(i[p][n]==q){i[p].style[s]=r;break}}}else{i[q].style[s]=r}}},_hideShowColumn:function(h,i){var g=h;if(this.hdr.rows[1]&&(this.hdr.rows[1]._childIndexes)&&(this.hdr.rows[1]._childIndexes[h]!=h)){g=this.hdr.rows[1]._childIndexes[h]}if(i=="none"){this.hdr.rows[0].cells[h]._oldWidth=this.hdr.rows[0].cells[h].style.width||(this.initCellWidth[h]+"px");this.hdr.rows[0].cells[h]._oldWidthP=this.cellWidthPC[h];this.obj.rows[0].cells[h].style.width="0px";var f={rows:[this.obj.rows[0]]};this.forEachRow(function(a){if(this.rowsAr[a].tagName=="TR"){f.rows.push(this.rowsAr[a])}});this._fixHiddenRowsAll(f,h,"display","none");if(this.isTreeGrid()){this._fixHiddenRowsAllTG(h,"none")}if((_isOpera&&_OperaRv<9)||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,h,"display","none","_cellIndexS")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],h,"display","none")}this._fixHiddenRowsAll(this.hdr,h,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length){this.cellWidthPX=[].concat(this.initCellWidth)}if(this.cellWidthPX[h]){this.cellWidthPX[h]=0}if(this.cellWidthPC[h]){this.cellWidthPC[h]=0}}else{if(this.hdr.rows[0].cells[h]._oldWidth){var j=this.hdr.rows[0].cells[h];if(_isOpera||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,h,"display","","_cellIndexS")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],h,"display","")}var f={rows:[this.obj.rows[0]]};this.forEachRow(function(a){if(this.rowsAr[a].tagName=="TR"){f.rows.push(this.rowsAr[a])}});this._fixHiddenRowsAll(f,h,"display","");if(this.isTreeGrid()){this._fixHiddenRowsAllTG(h,"")}this._fixHiddenRowsAll(this.hdr,h,"whiteSpace","normal","_cellIndexS");if(j._oldWidthP){this.cellWidthPC[h]=j._oldWidthP}if(j._oldWidth){this.cellWidthPX[h]=parseInt(j._oldWidth)}}}if(!i&&this._realfake){this.setColumnSizes(this.entBox.clientWidth)}this.setSizes();if((!_isIE)&&(!_isFF)){this.obj.border=1;this.obj.border=0}},enableColSpan:function(b){this._ecspn=dhx4.s2b(b)},enableRowsHover:function(c,d){this._unsetRowHover(false,true);this._hvrCss=d;if(dhx4.s2b(c)){if(!this._elmnh){this.obj._honmousemove=this.obj.onmousemove;this.obj.onmousemove=this._setRowHover;if(_isIE){this.obj.onmouseleave=this._unsetRowHover}else{this.obj.onmouseout=this._unsetRowHover}this._elmnh=true}}else{if(this._elmnh){this.obj.onmousemove=this.obj._honmousemove;if(_isIE){this.obj.onmouseleave=null}else{this.obj.onmouseout=null}this._elmnh=false}}},enableEditEvents:function(d,f,e){this._sclE=dhx4.s2b(d);this._dclE=dhx4.s2b(f);this._f2kE=dhx4.s2b(e)},enableLightMouseNavigation:function(b){if(dhx4.s2b(b)){if(!this._elmn){this.entBox._onclick=this.entBox.onclick;this.entBox.onclick=function(){return true};this.obj._onclick=this.obj.onclick;this.obj.onclick=function(a){var c=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(!c){return}this.grid.editStop();this.grid.doClick(c);this.grid.editCell();(a||event).cancelBubble=true};this.obj._onmousemove=this.obj.onmousemove;this.obj.onmousemove=this._autoMoveSelect;this._elmn=true}}else{if(this._elmn){this.entBox.onclick=this.entBox._onclick;this.obj.onclick=this.obj._onclick;this.obj.onmousemove=this.obj._onmousemove;this._elmn=false}}},_unsetRowHover:function(c,f){if(f){that=this}else{that=this.grid}if((that._lahRw)&&(that._lahRw!=f)){for(var e=0;e<that._lahRw.childNodes.length;e++){that._lahRw.childNodes[e].className=that._lahRw.childNodes[e].className.replace(that._hvrCss,"")}that._lahRw=null}},_setRowHover:function(c){var f=this.grid.getFirstParentOfType(c?c.target:event.srcElement,"TD");if(f&&f.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,f);f=f.parentNode;if(!f.idd||f.idd=="__filler__"){return}for(var e=0;e<f.childNodes.length;e++){f.childNodes[e].className+=" "+this.grid._hvrCss}this.grid._lahRw=f}this._honmousemove(c)},_autoMoveSelect:function(d){if(!this.grid.editor){var c=this.grid.getFirstParentOfType(d?d.target:event.srcElement,"TD");if(c.parentNode.idd){this.grid.doClick(c,true,0)}}this._onmousemove(d)},enableDistributedParsing:function(f,e,d){if(dhx4.s2b(f)){this._ads_count=e||10;this._ads_time=d||250}else{this._ads_count=0}},destructor:function(){this.editStop(true);if(this._sizeTime){this._sizeTime=window.clearTimeout(this._sizeTime)}this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs){for(var f=0;f<this.formInputs.length;f++){this.parentForm.removeChild(this.formInputs[f])}}var a;for(var f=0;f<this.rowsCol.length;f++){if(this.rowsCol[f]){this.rowsCol[f].grid=null}}for(f in this.rowsAr){if(this.rowsAr[f]){this.rowsAr[f]=null}}this.rowsCol=new dhtmlxArray();this.rowsAr={};this.entBox.innerHTML="";var e=function(){};this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=e;this.setSizes=this._update_srnd_view=this.callEvent=e;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;if(this._fake){this.globalBox.innerHTML="";this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=e;this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=e}for(a in this){if((this[a])&&(this[a].m_obj)){this[a].m_obj=null}this[a]=null}if(this==globalActiveDHTMLGridObject){globalActiveDHTMLGridObject=null}return null},getSortingState:function(){var b=new Array();if(this.fldSorted){b[0]=this.fldSorted._cellIndex;b[1]=(this.sortImg.className=="dhxgrid_sort_desc"?"des":"asc")}return b},enableAutoHeight:function(f,d,e){this._ahgr=dhx4.s2b(f);this._ahgrF=dhx4.s2b(e);this._ahgrM=d||null;if(arguments.length==1){this.objBox.style.overflowY=f?"hidden":"auto"}if(d=="auto"){this._ahgrM=null;this._ahgrMA=true;this._setAutoResize()}},enableStableSorting:function(b){this._sst=dhx4.s2b(b);this.rowsCol.stablesort=function(g){var h=this.length-1;for(var i=0;i<this.length-1;i++){for(var j=0;j<h;j++){if(g(this[j],this[j+1])>0){var a=this[j];this[j]=this[j+1];this[j+1]=a}}h--}}},enableKeyboardSupport:function(b){this._htkebl=!dhx4.s2b(b)},enableContextMenu:function(b){this._ctmndx=b},setScrollbarWidthCorrection:function(b){},enableTooltips:function(c){this._enbTts=c.split(",");for(var d=0;d<this._enbTts.length;d++){this._enbTts[d]=dhx4.s2b(this._enbTts[d])}},enableResizing:function(c){this._drsclmn=c.split(",");for(var d=0;d<this._drsclmn.length;d++){this._drsclmn[d]=dhx4.s2b(this._drsclmn[d])}},setColumnMinWidth:function(d,c){if(arguments.length==2){if(!this._drsclmW){this._drsclmW=new Array()}this._drsclmW[c]=d}else{this._drsclmW=d.split(",")}},enableCellIds:function(b){this._enbCid=dhx4.s2b(b)},lockRow:function(e,f){var d=this.getRowById(e);if(d){d._locked=dhx4.s2b(f);if((this.cell)&&(this.cell.parentNode.idd==e)){this.editStop()}}},_getRowArray:function(f){var g=new Array();for(var h=0;h<f.childNodes.length;h++){var a=this.cells3(f,h);g[h]=a.getValue()}return g},setDateFormat:function(c,d){this._dtmask=c;this._dtmask_inc=d},setNumberFormat:function(l,q,o,m){var p=l.replace(/[^0\,\.]*/g,"");var s=p.indexOf(".");if(s>-1){s=p.length-s-1}var r=p.indexOf(",");if(r>-1){r=p.length-s-2-r}if(typeof o!="string"){o=this.i18n.decimal_separator}if(typeof m!="string"){m=this.i18n.group_separator}var j=l.split(p)[0];var n=l.split(p)[1];this._maskArr[q]=[s,r,j,n,o,m]},_aplNFb:function(f,g){var a=this._maskArr[g];if(!a){return f}var h=parseFloat(f.toString().replace(/[^0-9]*/g,""));if(f.toString().substr(0,1)=="-"){h=h*-1}if(a[0]>0){h=h/Math.pow(10,a[0])}return h},_aplNF:function(h,i){var a=this._maskArr[i];if(!a){return h}var c=(parseFloat(h)<0?"-":"")+a[2];h=Math.abs(Math.round(parseFloat(h)*Math.pow(10,a[0]>0?a[0]:0))).toString();h=(h.length<a[0]?Math.pow(10,a[0]+1-h.length).toString().substr(1,a[0]+1)+h.toString():h).split("").reverse();h[a[0]]=(h[a[0]]||"0")+a[4];if(a[1]>0){for(var j=(a[0]>0?0:1)+a[0]+a[1];j<h.length;j+=a[1]){h[j]+=a[5]}}return c+h.reverse().join("")+a[3]},_launchCommands:function(f){for(var g=0;g<f.length;g++){var h=new Array();for(var e=0;e<f[g].childNodes.length;e++){if(f[g].childNodes[e].nodeType==1){h[h.length]=f[g].childNodes[e].firstChild.data}}this[f[g].getAttribute("command")].apply(this,h)}},_parseHead:function(K){var L=dhx4.ajax.xpath("./head",K);if(L.length){var J=dhx4.ajax.xpath("./column",L[0]);var I=dhx4.ajax.xpath("./settings",L[0]);var s="setInitWidths";var A=false;if(I[0]){for(var H=0;H<I[0].childNodes.length;H++){switch(I[0].childNodes[H].tagName){case"colwidth":if(I[0].childNodes[H].firstChild&&I[0].childNodes[H].firstChild.data=="%"){s="setInitWidthsP"}break;case"splitat":A=(I[0].childNodes[H].firstChild?I[0].childNodes[H].firstChild.data:false);break}}}this._launchCommands(dhx4.ajax.xpath("./beforeInit/call",L[0]));if(J.length>0){if(this.hdr.rows.length>0){this.clearAll(true)}var O=[[],[],[],[],[],[],[],[],[]];var C=["","width","type","align","sort","color","format","hidden","id"];var D=["",s,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"];for(var x=0;x<J.length;x++){for(var y=1;y<C.length;y++){O[y].push(J[x].getAttribute(C[y]))}O[0].push((J[x].firstChild?J[x].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(O[0]);for(var x=0;x<D.length;x++){if(D[x]){this[D[x]](O[x].join(this.delim))}}for(var x=0;x<J.length;x++){if((this.cellType[x].indexOf("co")==0)||(this.cellType[x]=="clist")){var F=dhx4.ajax.xpath("./option",J[x]);if(F.length){var z=new Array();if(this.cellType[x]=="clist"){for(var y=0;y<F.length;y++){z[z.length]=F[y].firstChild?F[y].firstChild.data:""}this.registerCList(x,z)}else{var j=this.getCombo(x);for(var y=0;y<F.length;y++){j.put(F[y].getAttribute("value"),F[y].firstChild?F[y].firstChild.data:"")}}}}else{if(O[6][x]){if((this.cellType[x].toLowerCase().indexOf("calendar")!=-1)||(this.fldSort[x]=="date")){this.setDateFormat(O[6][x])}else{this.setNumberFormat(O[6][x],x)}}}}this.init();var M=O[7].join(this.delim);if(this.setColHidden&&M.replace(/,/g,"")!=""){this.setColHidden(M)}if((A)&&(this.splitAt)){this.splitAt(A)}}this._launchCommands(dhx4.ajax.xpath("./afterInit/call",L[0]))}var N=dhx4.ajax.xpath("//rows/userdata",K);if(N.length>0){if(!this.UserData.gridglobaluserdata){this.UserData.gridglobaluserdata=new Hashtable()}for(var y=0;y<N.length;y++){var i="";for(var E=0;E<N[y].childNodes.length;E++){i+=N[y].childNodes[E].nodeValue}this.UserData.gridglobaluserdata.put(N[y].getAttribute("name"),i)}}},getCheckedRows:function(d){var c=new Array();this.forEachRowA(function(a){var b=this.cells(a,d);if(b.changeState&&b.getValue()!=0){c.push(a)}},true);return c.join(",")},checkAll:function(){var c=arguments.length?arguments[0]:1;for(var d=0;d<this.getColumnsNum();d++){if(this.getColType(d)=="ch"){this.setCheckedRows(d,c)}}},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(c,d){this.forEachRowA(function(a){if(this.cells(a,c).isCheckbox()){this.cells(a,c).setValue(d)}})},_drawTooltip:function(i){var h=this.grid.getFirstParentOfType(i?i.target:event.srcElement,"TD");if(!h||((this.grid.editor)&&(this.grid.editor.cell==h))){return true}var j=h.parentNode;if(!j.idd||j.idd=="__filler__"){return}var c=(i?i.target:event.srcElement);if(j.idd==window.unknown){return true}if(!this.grid.callEvent("onMouseOver",[j.idd,h._cellIndex,(i||window.event)])){return true}if((this.grid._enbTts)&&(!this.grid._enbTts[h._cellIndex])){if(c.title){c.title=""}return true}if(h._cellIndex>=this.grid._cCount){return}var e=this.grid.cells3(j,h._cellIndex);if(!e||!e.cell||!e.cell._attrs){return}if(c._title){e.cell.title=""}if(!e.cell._attrs.title){c._title=true}if(e){c.title=e.cell._attrs.title||(e.getTitle?e.getTitle():(e.getValue()||"").toString().replace(/<[^>]*>/gi,""))}return true},enableCellWidthCorrection:function(b){if(_isFF){this._wcorr=parseInt(b)}},getAllRowIds:function(f){var e=[];for(var d=0;d<this.rowsBuffer.length;d++){if(this.rowsBuffer[d]){e.push(this.rowsBuffer[d].idd)}}return e.join(f||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(v,c,u){if(!this._ecspn){return}var w=this.getRowById(v);if((w._childIndexes)&&(w.childNodes[w._childIndexes[c]])){var r=w._childIndexes[c];var t=w.childNodes[r];var s=t.colSpan;t.colSpan=1;if((s)&&(s!=1)){for(var m=1;m<s;m++){var i=document.createElement("TD");if(t.nextSibling){w.insertBefore(i,t.nextSibling)}else{w.appendChild(i)}w._childIndexes[c+m]=r+m;i._cellIndex=c+m;i.style.textAlign=this.cellAlign[m];i.style.verticalAlign=this.cellVAlign[m];t=i;this.cells3(w,c+m).setValue("")}}for(var j=c*1+1*s;j<w._childIndexes.length;j++){w._childIndexes[j]+=(s-1)*1}}if((u)&&(u>1)){if(w._childIndexes){var r=w._childIndexes[c]}else{var r=c;w._childIndexes=new Array();for(var j=0;j<w.childNodes.length;j++){w._childIndexes[j]=j}}w.childNodes[r].colSpan=u;for(var j=1;j<u;j++){w._childIndexes[w.childNodes[r+1]._cellIndex]=r;w.removeChild(w.childNodes[r+1])}var n=w.childNodes[w._childIndexes[c]]._cellIndex;for(var j=n*1+1*u;j<w._childIndexes.length;j++){w._childIndexes[j]-=(u-1)}}},preventIECaching:function(b){dhx4.ajax.cache=!b},enableColumnAutoSize:function(b){this._eCAS=dhx4.s2b(b)},_onHeaderDblClick:function(f){var d=this.grid;var e=d.getFirstParentOfType(_isIE?event.srcElement:f.target,"TD");if(!d._eCAS){return false}d.adjustColumnSize(e._cellIndexS)},adjustColumnSize:function(l,w){if(this._hrrar&&this._hrrar[l]){return}this._notresize=true;var v=0;this._setColumnSizeR(l,20);for(var t=1;t<this.hdr.rows.length;t++){var d=this.hdr.rows[t];d=d.childNodes[(d._childIndexes)?d._childIndexes[l]:l];if((d)&&((!d.colSpan)||(d.colSpan<2))&&d._cellIndex==l){if((d.childNodes[0])&&(d.childNodes[0].className=="hdrcell")){d=d.childNodes[0]}v=Math.max(v,d.scrollWidth)}}var u=this.obj.rows.length;var i=0;var y=this.cellType._dhx_find("tree");var j=document.createElement("DIV");j.className="dhx_grid_adjust";j.style.cssText="width:auto;height:auto;visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden; white-space:nowrap;";document.body.appendChild(j);for(var m=1;m<u;m++){var a=this.obj.rows[m];var x=l;if(!this.rowsAr[a.idd]){continue}if(a._childIndexes){if(a._childIndexes[l]==a._childIndexes[l+1]){continue}x=a._childIndexes[l]}if(!a.childNodes[x]||a.childNodes[x]._cellIndex!=l){continue}j.innerHTML=(a.childNodes[x].innerText||a.childNodes[x].textContent||"");i=j.offsetWidth;if(this._h2&&l==y){i+=this._h2.get[a.idd].level*22}if(i>v){v=i}}document.body.removeChild(j);v+=20+(w||0);this._setColumnSizeR(l,v);this._notresize=false;this.setSizes()},detachHeader:function(e,f){f=f||this.hdr;var d=f.rows[e+1];if(d){d.parentNode.removeChild(d)}this.setSizes()},detachFooter:function(b){this.detachHeader(b,this.ftr)},attachHeader:function(f,g,e){if(typeof(f)=="string"){f=this._eSplit(f)}if(typeof(g)=="string"){g=g.split(this.delim)}e=e||"_aHead";if(this.hdr.rows.length){if(f){this._createHRow([f,g],this[(e=="_aHead")?"hdr":"ftr"])}else{if(this[e]){for(var h=0;h<this[e].length;h++){this.attachHeader.apply(this,this[e][h])}}}}else{if(!this[e]){this[e]=new Array()}this[e][this[e].length]=[f,g,e]}},_createHRow:function(D,v){if(!v){if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}var y=document.createElement("DIV");y.className="c_ftr".substr(2);this.entBox.appendChild(y);var s=document.createElement("TABLE");s.cellPadding=s.cellSpacing=0;if(!_isIE||_isIE==8){s.width="100%";s.style.paddingRight="20px"}s.style.marginRight="20px";s.style.tableLayout="fixed";y.appendChild(s);s.appendChild(document.createElement("TBODY"));this.ftr=v=s;var z=s.insertRow(0);var F=((this.hdrLabels.length<=1)?D[0].length:this.hdrLabels.length);for(var C=0;C<F;C++){z.appendChild(document.createElement("TH"));z.childNodes[C]._cellIndex=C}if(_isIE&&_isIE<8){z.style.position="absolute"}else{z.style.height="auto"}}var A=D[1];var y=document.createElement("TR");v.rows[0].parentNode.appendChild(y);for(var C=0;C<D[0].length;C++){if(D[0][C]=="#cspan"){var x=y.cells[y.cells.length-1];x.colSpan=(x.colSpan||1)+1;continue}if((D[0][C]=="#rspan")&&(v.rows.length>1)){var i=v.rows.length-2;var j=false;var x=null;while(!j){var x=v.rows[i];for(var E=0;E<x.cells.length;E++){if(x.cells[E]._cellIndex==C){j=E+1;break}}i--}x=x.cells[j-1];x.rowSpan=(x.rowSpan||1)+1;continue}var w=document.createElement("TD");w._cellIndex=w._cellIndexS=C;if(this._hrrar&&this._hrrar[C]&&!_isIE){w.style.display="none"}if(typeof D[0][C]=="object"){w.appendChild(D[0][C])}else{if(this.forceDivInHeader){w.innerHTML="<div class='hdrcell'>"+(D[0][C]||"&nbsp;")+"</div>"}else{w.innerHTML=(D[0][C]||"&nbsp;")}if((D[0][C]||"").indexOf("#")!=-1){var s=D[0][C].match(/(^|{)#([^}]+)(}|$)/);if(s){var u="_in_header_"+s[2];if(this[u]){this[u]((this.forceDivInHeader?w.firstChild:w),C,D[0][C].split(s[0]))}}}}if(A){w.style.cssText=A[C]}y.appendChild(w)}var t=v;if(_isKHTML){if(v._kTimer){window.clearTimeout(v._kTimer)}v._kTimer=window.setTimeout(function(){v.rows[1].style.display="none";window.setTimeout(function(){v.rows[1].style.display=""},1)},500)}},attachFooter:function(d,c){this.attachHeader(d,c,"_aFoot")},setCellExcellType:function(f,e,d){this.changeCellType(this.getRowById(f),e,d)},getCellExcellType:function(e,f){var g=this.getRowById(e);var h=this.cells3(g,f);return h.cell._cellType||this.cellType[f]},changeCellType:function(j,i,f){f=f||this.cellType[i];var h=this.cells3(j,i);var g=h.getValue();h.cell._cellType=f;var h=this.cells3(j,i);h.setValue(g)},setRowExcellType:function(h,e){var g=this.rowsAr[h];for(var f=0;f<g.childNodes.length;f++){this.changeCellType(g,f,e)}},setColumnExcellType:function(e,f){for(var d=0;d<this.rowsBuffer.length;d++){if(this.rowsBuffer[d]&&this.rowsBuffer[d].tagName=="TR"){this.changeCellType(this.rowsBuffer[d],e,f)}}if(this.cellType[e]=="math"){this._strangeParams[d]=f}else{this.cellType[e]=f}},forEachRow:function(d){for(var a in this.rowsAr){if(this.rowsAr[a]&&this.rowsAr[a].idd){d.apply(this,[this.rowsAr[a].idd])}}},forEachRowA:function(d){for(var a=0;a<this.rowsBuffer.length;a++){if(this.rowsBuffer[a]){d.call(this,this.render_row(a).idd)}}},forEachCell:function(h,e){var g=this.getRowById(h);if(!g){return}for(var f=0;f<this._cCount;f++){e(this.cells3(g,f),f)}},enableAutoWidth:function(f,e,d){this._awdth=[dhx4.s2b(f),parseInt(e||99999),parseInt(d||0)];if(arguments.length==1){this.objBox.style.overflowX=f?"hidden":"auto"}},updateFromXML:function(f,g,e,h){if(typeof g=="undefined"){g=true}this._refresh_mode=[true,g,e];this.load(f,h)},_refreshFromXML:function(t){if(this._f_rowsBuffer){this.filterBy(0,"")}reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(b){var a=this.grid._h2.get[this.cell.parentNode.idd];if(a&&this.cell.parentNode.valTag){this.setLabel(b)}else{this.setValueX(b)}}}var i=this.cellType._dhx_find("tree");var r=dhx4.ajax.xmltop("rows",t);var s=r.getAttribute("parent")||0;var p={};if(this._refresh_mode[2]){if(i!=-1){this._h2.forEachChild(s,function(a){p[a.id]=true},this)}else{this.forEachRow(function(a){p[a]=true})}}var n=dhx4.ajax.xpath("//row",r);for(var u=0;u<n.length;u++){var o=n[u];var w=o.getAttribute("id");p[w]=false;var s=o.parentNode.getAttribute("id")||s;if(this.rowsAr[w]&&this.rowsAr[w].tagName!="TR"){if(this._h2){this._h2.get[w].buff.data=o}else{this.rowsBuffer[this.getRowIndex(w)].data=o}this.rowsAr[w]=o}else{if(this.rowsAr[w]){this._process_xml_row(this.rowsAr[w],o,-1);this._postRowProcessing(this.rowsAr[w],true);if(this._fake&&this._fake.rowsAr[w]){this._fake._process_xml_row(this._fake.rowsAr[w],o,-1)}}else{if(this._refresh_mode[1]){var q={idd:w,data:o,_parser:this._process_xml_row,_locator:this._get_xml_data};var v=this.rowsBuffer.length;if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(q);v=0}else{this.rowsBuffer.push(q)}if(this._h2){reset=true;(this._h2.add(w,(o.parentNode.getAttribute("id")||o.parentNode.getAttribute("parent")))).buff=this.rowsBuffer[this.rowsBuffer.length-1]}else{if(this._srnd){reset=true}}this.rowsAr[w]=o;o=this.render_row(v);this._insertRowAt(o,v?-1:0)}}}}if(this._refresh_mode[2]){for(w in p){if(p[w]&&this.rowsAr[w]){this.deleteRow(w)}}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}if(reset){if(this._h2){this._renderSort()}else{this.render_dataset()}}if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},getCustomCombo:function(f,d){var e=this.cells(f,d).cell;if(!e._combo){e._combo=new dhtmlXGridComboObject()}return e._combo},setTabOrder:function(e){var g=e.split(this.delim);this._tabOrder=[];var f=this._cCount||e.length;for(var h=0;h<f;h++){g[h]={c:parseInt(g[h]),ind:h}}g.sort(function(a,b){return(a.c>b.c?1:-1)});for(var h=0;h<f;h++){if(!g[h+1]||(typeof g[h].c=="undefined")){this._tabOrder[g[h].ind]=(g[0].ind+1)*-1}else{this._tabOrder[g[h].ind]=g[h+1].ind}}},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var b=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[b+1],this.cell._cellIndex,true)},k13_0_1:function(){var b=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[b-1],this.cell._cellIndex,true)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell._cellIndex:null)]);this._still_active=true},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[true])){return true}var b=this._getNextCell(null,1);if(b){this.selectCell(b.parentNode,b._cellIndex,(this.row!=b.parentNode),false,true);this._still_active=true}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[false])){return false}var b=this._getNextCell(null,-1);if(b){this.selectCell(b.parentNode,b._cellIndex,(this.row!=b.parentNode),false,true);this._still_active=true}},k113_0_0:function(){if(this._f2kE){this.editCell()}},k32_0_0:function(){var b=this.cells4(this.cell);if(!b.changeState||(b.changeState()===false)){return false}},k27_0_0:function(){this.editStop(true)},k33_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage-1)}else{this.scrollPage(-1)}},k34_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage+1)}else{this.scrollPage(1)}},k37_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.collapseKids(this.row)}else{return false}},k39_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.expandKids(this.row)}else{return false}},k40_0_0:function(){var d=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{if(!this.row.idd){return}var e=Math.max((d._r_select||0),this.getRowIndex(this.row.idd));var f=this._nextRow(e,1);if(f){d._r_select=null;this.selectCell(f,this.cell._cellIndex,true);if(d.pagingOn){d.showRow(f.idd)}}else{if(!this.callEvent("onLastRow",[])){return false}this._key_events.k34_0_0.apply(this,[]);if(this.pagingOn&&this.rowsCol[e+1]){this.selectCell(e+1,0,true)}}}this._still_active=true},k38_0_0:function(){var d=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{if(!this.row.idd){return}var e=this.getRowIndex(this.row.idd)+1;if(e!=-1&&(!this.pagingOn||(e!=1))){var f=this._nextRow(e-1,-1);this.selectCell(f,this.cell._cellIndex,true);if(d.pagingOn&&f){d.showRow(f.idd)}}else{this._key_events.k33_0_0.apply(this,[])}}this._still_active=true}},_build_master_row:function(){var f=document.createElement("DIV");var d=["<table><tr>"];for(var e=0;e<this._cCount;e++){d.push("<td></td>")}d.push("</tr></table>");f.innerHTML=d.join("");this._master_row=f.firstChild.rows[0]},_prepareRow:function(e){if(!this._master_row){this._build_master_row()}var f=this._master_row.cloneNode(true);for(var d=0;d<f.childNodes.length;d++){f.childNodes[d]._cellIndex=d;if(this._enbCid){f.childNodes[d].id="c_"+e+"_"+d}if(this.dragAndDropOff){this.dragger.addDraggableItem(f.childNodes[d],this)}}f.idd=e;f.grid=this;return f},_process_jsarray_row:function(d,f){d._attrs={};for(var e=0;e<d.childNodes.length;e++){d.childNodes[e]._attrs={}}this._fillRow(d,(this._c_order?this._swapColumns(f):f));return d},_get_jsarray_data:function(c,d){return c[d]},_process_json_row:function(d,c){c=this._c_order?this._swapColumns(c.data):c.data;return this._process_some_row(d,c)},_process_some_row:function(d,f){d._attrs={};for(var e=0;e<d.childNodes.length;e++){d.childNodes[e]._attrs={}}this._fillRow(d,f);return d},_get_json_data:function(c,d){return c.data[d]},_process_js_row:function(h,g){var f=[];for(var e=0;e<this.columnIds.length;e++){f[e]=g[this.columnIds[e]];if(!f[e]&&f[e]!==0){f[e]=""}}this._process_some_row(h,f);h._attrs=g;return h},_get_js_data:function(c,d){return c[this.columnIds[d]]},_process_csv_row:function(d,f){d._attrs={};for(var e=0;e<d.childNodes.length;e++){d.childNodes[e]._attrs={}}this._fillRow(d,(this._c_order?this._swapColumns(f.split(this.csv.cell)):f.split(this.csv.cell)));return d},_get_csv_data:function(c,d){return c.split(this.csv.cell)[d]},_process_store_row:function(h,i){var g=[];for(var j=0;j<this.columnIds.length;j++){g[j]=i[this.columnIds[j]]}for(var f=0;f<h.childNodes.length;f++){h.childNodes[f]._attrs={}}h._attrs=i;this._fillRow(h,g)},_process_xml_row:function(w,r){var i=dhx4.ajax.xpath(this.xml.cell,r);var o=[];w._attrs=this._xml_attrs(r);if(this._ud_enabled){var j=dhx4.ajax.xpath("./userdata",r);for(var s=j.length-1;s>=0;s--){var p="";for(var u=0;u<j[s].childNodes.length;u++){p+=j[s].childNodes[u].nodeValue}this.setUserData(w.idd,j[s].getAttribute("name"),p)}}for(var u=0;u<i.length;u++){var t=i[this._c_order?this._c_order[u]:u];if(!t){continue}var v=w._childIndexes?w._childIndexes[u]:u;var q=t.getAttribute("type");if(w.childNodes[v]){if(q){w.childNodes[v]._cellType=q}w.childNodes[v]._attrs=this._xml_attrs(t)}if(!t.getAttribute("xmlcontent")){if(t.firstChild){t=t.firstChild.wholeText||t.firstChild.data}else{t=""}}o.push(t)}for(u<i.length;u<w.childNodes.length;u++){w.childNodes[u]._attrs={}}if(w.parentNode&&w.parentNode.tagName=="row"){w._attrs.parent=w.parentNode.getAttribute("idd")}this._fillRow(w,o);return w},_get_xml_data:function(c,d){c=c.firstChild;while(true){if(!c){return""}if(c.tagName=="cell"){d--}if(d<0){break}c=c.nextSibling}return(c.firstChild?c.firstChild.data:"")},_fillRow:function(l,i){if(this.editor&&this.editor.parentNode&&this.editor.parentNode.idd==l.idd){this.editStop()}for(var g=0;g<l.childNodes.length;g++){if((g<i.length)||(this.defVal[g])){var m=l.childNodes[g]._cellIndex;var j=i[m];var h=this.cells4(l.childNodes[g]);if((this.defVal[m])&&((j=="")||(typeof(j)=="undefined"))){j=this.defVal[m]}if(h){h.setValue(j)}}else{l.childNodes[g].innerHTML="&nbsp;";l.childNodes[g]._clearCell=true}}return l},_postRowProcessing:function(o,m){if(o._attrs["class"]){o._css=o.className=o._attrs["class"]}if(o._attrs.locked){o._locked=true}if(o._attrs.bgColor){o.bgColor=o._attrs.bgColor}var n=0;for(var c=0;c<o.childNodes.length;c++){var l=o.childNodes[c];var p=l._cellIndex;var q=l._attrs.style||o._attrs.style;if(q){l.style.cssText+=";"+q}if(l._attrs["class"]){l.className=l._attrs["class"]}q=l._attrs.align||this.cellAlign[p];if(q){l.align=q}l.vAlign=l._attrs.valign||this.cellVAlign[p];var i=l._attrs.bgColor||this.columnColor[p];if(i){l.bgColor=i}if(l._attrs.colspan&&!m){this.setColspan(o.idd,c+n,l._attrs.colspan);n+=(l._attrs.colspan-1)}if(this._hrrar&&this._hrrar[p]&&!m){l.style.display="none"}}this.callEvent("onRowCreated",[o.idd,o,null])},load:function(f,h,e){this.callEvent("onXLS",[this]);if(arguments.length==2&&typeof h!="function"){e=h;h=null}this._last_load_type=e=e||this._last_load_type||"xml";if(!this.xmlFileUrl){this.xmlFileUrl=f}this._data_type=e;this.xmlLoader=this.doLoadDetails;var g=this;this.xmlLoader=function(a){if(!g.callEvent){return}g["_process_"+e](a.xmlDoc);if(!g._contextCallTimer){g.callEvent("onXLE",[g,0,0,a.xmlDoc,e])}if(h){h();h=null}};return dhx4.ajax.get(f,this.xmlLoader)},loadXMLString:function(c,d){if(window.console&&window.console.info){window.console.info("loadXMLString was deprecated","http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44")}this.parse({responseXML:dhx4.ajax.parse(c)},d,"xml")},loadXML:function(d,c){if(window.console&&window.console.info){window.console.info("loadXML was deprecated","http://docs.dhtmlx.com/migration__index.html#migrationfrom43to44")}this.load(d,c,"xml")},parse:function(f,d,e){if(arguments.length==2&&typeof d!="function"){e=d;d=null}this._last_load_type=e=e||this._last_load_type||"xml";this._data_type=e;if(e=="xml"&&typeof f=="string"){f={responseXML:dhx4.ajax.parse(f)}}this["_process_"+e](f);if(!this._contextCallTimer){this.callEvent("onXLE",[this,0,0,f,e])}if(d){d()}},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(d){var f={};if(d.attributes.length){for(var e=0;e<d.attributes.length;e++){f[d.attributes[e].name]=d.attributes[e].value}}return f},_process_xml:function(i){if(this._refresh_mode){return this._refreshFromXML(i)}this._parsing=true;var p=dhx4.ajax.xmltop(this.xml.top,i);if(p.tagName!=this.xml.top){return}var n=p.getAttribute("dhx_security");if(n){dhtmlx.security_key=n}this._parseHead(p);var h=dhx4.ajax.xpath(this.xml.row,p);var q=parseInt(p.getAttribute("pos")||0);var o=parseInt(p.getAttribute("total_count")||0);if(!this.pagingOn){var o=Math.min(o,32000000/this._srdh)}var r=false;if(o&&o!=this.rowsBuffer.length){if(!this.rowsBuffer[o-1]){if(this.rowsBuffer.length){r=true}this.rowsBuffer[o-1]=null}if(o<this.rowsBuffer.length){this.rowsBuffer.splice(o,this.rowsBuffer.length-o);r=true}}if(this.isTreeGrid()){return this._process_tree_xml(p)}for(var t=0;t<h.length;t++){if(this.rowsBuffer[t+q]){continue}var u=h[t].getAttribute("id")||(t+q+1);this.rowsBuffer[t+q]={idd:u,data:h[t],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[u]=h[t]}this.callEvent("onDataReady",[]);if(r&&this._srnd){var s=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=s}else{this.render_dataset()}this._parsing=false},_process_jsarray:function(data){this._parsing=true;data=data.responseText||data;if(typeof data=="string"){eval("dhtmlx.temp="+data+";");data=dhtmlx.temp}for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[id]=data[i]}this.render_dataset();this._parsing=false},_process_csv:function(i){this._parsing=true;i=i.responseText||i;i=i.replace(/\r/g,"");i=i.split(this.csv.row);if(this._csvHdr){this.clearAll();var j=i.splice(0,1)[0].split(this.csv.cell);if(!this._csvAID){j.splice(0,1)}this.setHeader(j.join(this.delim));this.init()}for(var f=0;f<i.length;f++){if(!i[f]&&f==i.length-1){continue}if(this._csvAID){var h=f+1;this.rowsBuffer.push({idd:h,data:i[f],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var g=i[f].split(this.csv.cell);var h=g.splice(0,1)[0];this.rowsBuffer.push({idd:h,data:g,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[h]=i[f]}this.render_dataset();this._parsing=false},_process_js:function(b){return this._process_json(b,"js")},_process_json:function(data,mode){this._parsing=true;var data=data.responseText||data;if(typeof data=="string"){eval("dhtmlx.temp="+data+";");data=dhtmlx.temp}if(mode=="js"){if(data.data){data=data.data}for(var i=0;i<data.length;i++){var row=data[i];var id=row.id||(i+1);this.rowsBuffer.push({idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data});this.rowsAr[id]=data[i]}}else{if(data.rows){for(var i=0;i<data.rows.length;i++){var id=data.rows[i].id;this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[id]=data.rows[i]}}}if(data.dhx_security){dhtmlx.security_key=data.dhx_security}this.callEvent("onDataReady",[]);this.render_dataset();this._parsing=false},render_dataset:function(p,i){if(this._srnd){if(this._fillers){return this._update_srnd_view()}i=Math.min((this._get_view_size()+(this._srnd_pr||0)),this.rowsBuffer.length)}if(this.pagingOn){p=Math.max((p||0),(this.currentPage-1)*this.rowsBufferOutSize);i=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)}else{p=p||0;i=i||this.rowsBuffer.length}for(var o=p;o<i;o++){var s=this.render_row(o);if(s==-1){if(this.xmlFileUrl){if(this.callEvent("onDynXLS",[o,(this._dpref?this._dpref:(i-o))])){this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+o+"&count="+(this._dpref?this._dpref:(i-o)),this._data_type)}}i=o;break}if(!s.parentNode||!s.parentNode.tagName){this._insertRowAt(s,o);if(s._attrs.selected||s._attrs.select){this.selectRow(s,s._attrs.call?true:false,true);s._attrs.selected=s._attrs.select=null}}if(this._ads_count&&o-p==this._ads_count){var l=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){l._contextCallTimer=null;l.render_dataset(o,i);if(!l._contextCallTimer){if(l._context_parsing){l.callEvent("onXLE",[])}else{l._fixAlterCss()}l._context_parsing=false}},this._ads_time)}}if(this._ads_count&&o==i){this.callEvent("onDistributedEnd",[])}if(this._srnd&&!this._fillers){var r=this.rowsBuffer.length-i;this._fillers=[];if(this._fake&&!this._realfake){this._fake._fillers=[]}var q=Math.round(990000/this._srdh);while(r>0){var n=(_isIE||window._FFrv)?Math.min(r,q):r;var m=this._add_filler(i,n);if(m){this._fillers.push(m)}r-=n;i+=n}}this.setSizes()},render_row:function(d){if(!this.rowsBuffer[d]){return -1}if(this.rowsBuffer[d]._parser){var e=this.rowsBuffer[d];if(this.rowsAr[e.idd]&&this.rowsAr[e.idd].tagName=="TR"){return this.rowsBuffer[d]=this.rowsAr[e.idd]}var f=this._prepareRow(e.idd);this.rowsBuffer[d]=f;this.rowsAr[e.idd]=f;e._parser.call(this,f,e.data);this._postRowProcessing(f);return f}return this.rowsBuffer[d]},_get_cell_value:function(d,e,f){if(d._locator){if(this._c_order){e=this._c_order[e]}return d._locator.call(this,d.data,e)}return this.cells3(d,e)[f?f:"getValue"]()},sortRows:function(o,l,h){this.editStop();h=(h||"asc").toLowerCase();l=(l||this.fldSort[o]);o=o||0;if(this.isTreeGrid()){this.sortTreeRows(o,l,h)}else{var i={};var m=this.cellType[o];var j="getValue";if(m=="link"){j="getContent"}if(m=="dhxCalendar"||m=="dhxCalendarA"){j="getDate"}if(m=="co"||m=="coro"){j="getText"}for(var n=0;n<this.rowsBuffer.length;n++){i[this.rowsBuffer[n].idd]=this._get_cell_value(this.rowsBuffer[n],o,j)}this._sortRows(o,l,h,i)}this.callEvent("onAfterSorting",[o,l,h])},_sortCore:function(o,l,h,i,m){var n="sort";if(this._sst){m.stablesort=this.rowsCol.stablesort;n="stablesort"}if(l.length>4){l=window[l]}if(l=="cus"){var j=this._customSorts[o];m[n](function(a,b){return j(i[a.idd],i[b.idd],h,a.idd,b.idd)})}else{if(typeof(l)=="function"){m[n](function(a,b){return l(i[a.idd],i[b.idd],h,a.idd,b.idd)})}else{if(l=="str"){m[n](function(a,b){if(h=="asc"){return i[a.idd]>i[b.idd]?1:(i[a.idd]<i[b.idd]?-1:0)}else{return i[a.idd]<i[b.idd]?1:(i[a.idd]>i[b.idd]?-1:0)}})}else{if(l=="int"){m[n](function(b,c){var d=parseFloat(i[b.idd]);d=isNaN(d)?-99999999999999:d;var a=parseFloat(i[c.idd]);a=isNaN(a)?-99999999999999:a;if(h=="asc"){return d-a}else{return a-d}})}else{if(l=="date"){m[n](function(b,c){var d=Date.parse(i[b.idd])||(Date.parse("01/01/1900"));var a=Date.parse(i[c.idd])||(Date.parse("01/01/1900"));if(h=="asc"){return d-a}else{return a-d}})}}}}}},_sortRows:function(h,g,e,f){this._sortCore(h,g,e,f,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(h){if(!this.obj.rows[0]){return}if(this._lahRw){this._unsetRowHover(0,true)}this.callEvent("onResetView",[]);var f=this.obj.rows[0].parentNode;var g=f.removeChild(f.childNodes[0],true);if(_isKHTML){for(var e=f.parentNode.childNodes.length-1;e>=0;e--){if(f.parentNode.childNodes[e].tagName=="TR"){f.parentNode.removeChild(f.parentNode.childNodes[e],true)}}}else{if(_isIE){for(var e=f.childNodes.length-1;e>=0;e--){f.childNodes[e].removeNode(true)}}else{f.innerHTML=""}}f.appendChild(g);this.rowsCol=dhtmlxArray();if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;if(!h){if(_isIE&&this._srnd){this.render_dataset()}else{this.render_dataset()}}},deleteRow:function(f,l){if(!l){l=this.getRowById(f)}if(!l){return}this.editStop();if(!this._realfake){if(this.callEvent("onBeforeRowDeleted",[f])==false){return false}}var h=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake){h=this._h2.get[f].parent.id;this._removeTrGrRow(l)}else{if(l.parentNode){l.parentNode.removeChild(l)}var i=this.rowsCol._dhx_find(l);if(i!=-1){this.rowsCol._dhx_removeAt(i)}for(var m=0;m<this.rowsBuffer.length;m++){if(this.rowsBuffer[m]&&this.rowsBuffer[m].idd==f){this.rowsBuffer._dhx_removeAt(m);i=m;break}}}this.rowsAr[f]=null;for(var m=0;m<this.selectedRows.length;m++){if(this.selectedRows[m].idd==f){this.selectedRows._dhx_removeAt(m)}}if(this._srnd){for(var m=0;m<this._fillers.length;m++){var j=this._fillers[m];if(!j){continue}if(j[0]>=i){this._update_fillers(m,0,-1)}else{if(j[0]+j[1]>i){this._update_fillers(m,-1,0)}}}this._update_srnd_view()}if(this.pagingOn){this.changePage()}if(!this._realfake){this.callEvent("onAfterRowDeleted",[f,h])}this.callEvent("onGridReconstructed",[]);if(this._ahgr){this.setSizes()}return true},_addRow:function(n,j,r){if(r==-1||typeof r=="undefined"){r=this.rowsBuffer.length}if(typeof j=="string"){j=j.split(this.delim)}var i=this._prepareRow(n);i._attrs={};for(var q=0;q<i.childNodes.length;q++){i.childNodes[q]._attrs={}}this.rowsAr[i.idd]=i;if(this._h2){this._h2.get[i.idd].buff=i}this._fillRow(i,j);this._postRowProcessing(i);if(this._skipInsert){this._skipInsert=false;return this.rowsAr[i.idd]=i}if(this.pagingOn){this.rowsBuffer._dhx_insertAt(r,i);this.rowsAr[i.idd]=i;return i}if(this._fillers){this.rowsCol._dhx_insertAt(r,null);this.rowsBuffer._dhx_insertAt(r,i);if(this._fake){this._fake.rowsCol._dhx_insertAt(r,null)}this.rowsAr[i.idd]=i;var f=false;for(var p=0;p<this._fillers.length;p++){var o=this._fillers[p];if(o&&o[0]<=r&&(o[0]+o[1])>=r){o[1]=o[1]+1;var s=o[2].firstChild.style.height=parseInt(o[2].firstChild.style.height)+this._srdh+"px";f=true;if(this._fake){this._fake._fillers[p][1]++;this._fake._fillers[p][2].firstChild.style.height=s}}if(o&&o[0]>r){o[0]=o[0]+1;if(this._fake){this._fake._fillers[p][0]++}}}if(!f){this._fillers.push(this._add_filler(r,1,(r==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:(this.rowsCol[1])}:this.rowsCol[r-1])))}return i}this.rowsBuffer._dhx_insertAt(r,i);return this._insertRowAt(i,r)},addRow:function(f,g,h){var e=this._addRow(f,g,h);if(!this.dragContext){this.callEvent("onRowAdded",[f])}if(this.pagingOn){this.changePage(this.currentPage)}if(this._srnd){this._update_srnd_view()}e._added=true;if(this._srnd&&!this._fillers){this._fillers=[]}if(this._ahgr){this.setSizes()}this.callEvent("onGridReconstructed",[]);return e},_insertRowAt:function(h,g,e){this.rowsAr[h.idd]=h;if(this._skipInsert){this._skipInsert=false;return h}if((g<0)||((!g)&&(parseInt(g)!==0))){g=this.rowsCol.length}else{if(g>this.rowsCol.length){g=this.rowsCol.length}}if(this._cssEven){var f=h.className.replace(this._cssUnEven,"");if((this._cssSP?this.getLevel(h.idd):g)%2==1){h.className=f+" "+this._cssUnEven+(this._cssSU?(" "+this._cssUnEven+"_"+this.getLevel(h.idd)):"")}else{h.className=f+" "+this._cssEven+(this._cssSU?(" "+this._cssEven+"_"+this.getLevel(h.idd)):"")}}if(!e){if((g==(this.obj.rows.length-1))||(!this.rowsCol[g])){if(_isKHTML){this.obj.appendChild(h)}else{this.obj.firstChild.appendChild(h)}}else{this.rowsCol[g].parentNode.insertBefore(h,this.rowsCol[g])}}this.rowsCol._dhx_insertAt(g,h);this.callEvent("onRowInserted",[h,g]);return h},getRowById:function(f){var d=this.rowsAr[f];if(d){if(d.tagName!="TR"){for(var e=0;e<this.rowsBuffer.length;e++){if(this.rowsBuffer[e]&&this.rowsBuffer[e].idd==f){return this.render_row(e)}}if(this._h2){return this.render_row(null,d.idd)}}return d}return null},cellById:function(c,d){return this.cells(c,d)},cells:function(h,c){if(arguments.length==0){return this.cells4(this.cell)}else{var g=this.getRowById(h)}var f=(g._childIndexes?g.childNodes[g._childIndexes[c]]:g.childNodes[c]);if(!f&&g._childIndexes){f=g.firstChild||{}}return this.cells4(f)},cellByIndex:function(c,d){return this.cells2(c,d)},cells2:function(h,c){var g=this.render_row(h);var f=(g._childIndexes?g.childNodes[g._childIndexes[c]]:g.childNodes[c]);if(!f&&g._childIndexes){f=g.firstChild||{}}return this.cells4(f)},cells3:function(f,d){var e=(f._childIndexes?f.childNodes[f._childIndexes[d]]:f.childNodes[d]);return this.cells4(e)},cells4:function(d){var c=window["eXcell_"+(d._cellType||this.cellType[d._cellIndex])];if(c){return new c(d)}},cells5:function(e,f){var f=f||(e._cellType||this.cellType[e._cellIndex]);if(!this._ecache[f]){if(!window["eXcell_"+f]){var d=eXcell_ro}else{var d=window["eXcell_"+f]}this._ecache[f]=new d(e)}this._ecache[f].cell=e;return this._ecache[f]},dma:function(b){if(!this._ecache){this._ecache={}}if(b&&!this._dma){this._dma=this.cells4;this.cells4=this.cells5}else{if(!b&&this._dma){this.cells4=this._dma;this._dma=null}}},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(b){if(arguments.length>0){this.smartTabOrder=dhx4.s2b(b)}else{this.smartTabOrder=true}},setExternalTabOrder:function(h,g){var f=this;this.tabStart=(typeof(h)=="object")?h:document.getElementById(h);var j=this.tabStart.onkeydown;this.tabStart.onkeydown=function(a){if(j){j.call(this,a)}var b=(a||window.event);if(b.keyCode==9&&!b.shiftKey){b.cancelBubble=true;f.selectCell(0,0,0,0,1);if(f.smartTabOrder&&f.cells2(0,0).isDisabled()){f._key_events.k9_0_0.call(f)}this.blur();return false}};if(_isOpera){this.tabStart.onkeypress=this.tabStart.onkeydown}this.tabEnd=(typeof(g)=="object")?g:document.getElementById(g);var i=this.tabEnd.onkeydown;this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(a){if(i){i.call(this,a)}var b=(a||window.event);if(b.keyCode==9&&b.shiftKey){b.cancelBubble=true;f.selectCell((f.getRowsNum()-1),(f.getColumnCount()-1),0,0,1);if(f.smartTabOrder&&f.cells2((f.getRowsNum()-1),(f.getColumnCount()-1)).isDisabled()){f._key_events.k9_0_1.call(f)}this.blur();return false}};if(_isOpera){this.tabEnd.onkeypress=this.tabEnd.onkeydown}},uid:function(){if(!this._ui_seed){this._ui_seed=(new Date()).valueOf()}return this._ui_seed++},setIconset:function(b){this.iconset=b},clearAndLoad:function(){if(this._last_load_request){var d=this._last_load_request.xmlDoc;if(d.readyState!=4){try{d.onreadystatechange=function(){};d.abort()}catch(f){}}}var e=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=e;this._last_load_request=this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var g=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,g,Math.min(g+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}var e=Math.floor(this.objBox.scrollTop/this._srdh);var f=Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh);if(this.multiLine){var h=this.objBox.scrollTop;e=0;while(h>=0){h-=this.rowsCol[e]?this.rowsCol[e].offsetHeight:this._srdh;e++}e--;h+=this.objBox.offsetHeight;f=0;while(h>=0){h-=this.rowsCol[e+f]?this.rowsCol[e+f].offsetHeight:this._srdh;f++}}return[e,f,this.rowsBuffer.length]}};(function(){function l(b,a){this[b]=a}function i(b,a){this[b].call(this,a)}function m(b,a){this[b].call(this,a.join(this.delim))}function h(e,b){for(var c=0;c<b.length;c++){if(typeof b[c]=="object"){var a=this.getCombo(c);for(var d in b[c]){a.put(d,b[c][d])}}}}function j(v,a,e){var w=1;var b=[];function x(o,p,n){if(!b[p]){b[p]=[]}if(typeof n=="object"){n.toString=function(){return this.text}}b[p][o]=n}for(var d=0;d<a.length;d++){if(typeof(a[d])=="object"&&a[d].length){for(var f=0;f<a[d].length;f++){x(d,f,a[d][f])}}else{x(d,0,a[d])}}for(var d=0;d<b.length;d++){for(var f=0;f<b[0].length;f++){var c=b[d][f];b[d][f]=(c||"").toString()||"&nbsp;";if(c&&c.colspan){for(var u=1;u<c.colspan;u++){x(f+u,d,"#cspan")}}if(c&&c.rowspan){for(var u=1;u<c.rowspan;u++){x(f,d+u,"#rspan")}}}}this.setHeader(b[0]);for(var d=1;d<b.length;d++){this.attachHeader(b[d])}}var g=[{name:"label",def:"&nbsp;",operation:"setHeader",type:j},{name:"id",def:"",operation:"columnIds",type:l},{name:"width",def:"*",operation:"setInitWidths",type:m},{name:"align",def:"left",operation:"cellAlign",type:l},{name:"valign",def:"middle",operation:"cellVAlign",type:l},{name:"sort",def:"na",operation:"fldSort",type:l},{name:"type",def:"ro",operation:"setColTypes",type:m},{name:"options",def:"",operation:"",type:h}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(a){return[a.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(e){for(var d=0;d<g.length;d++){var a=[];for(var c=0;c<e.length;c++){a[c]=e[c][g[d].name]||g[d].def}var b=g[d].type||i;b.call(this,g[d].operation,a,e)}this.init()},rows:function(a){},headers:function(a){for(var b=0;b<a.length;b++){this.attachHeader(a[b])}}})})();dhtmlXGridObject.prototype._dp_init=function(b){b.attachEvent("insertCallback",function(a,e){if(this.obj._h2){this.obj.addRow(e,f,null,parent)}else{this.obj.addRow(e,[],0)}var f=this.obj.getRowById(e);if(f){this.obj._process_xml_row(f,a.firstChild);this.obj._postRowProcessing(f)}});b.attachEvent("updateCallback",function(a,e){var f=this.obj.getRowById(e);if(f){this.obj._process_xml_row(f,a.firstChild);this.obj._postRowProcessing(f)}});b.attachEvent("deleteCallback",function(a,d){this.obj.setUserData(d,this.action_param,"true_deleted");this.obj.deleteRow(d)});b._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(g,f,h){if(b._columns&&!b._columns[h]){return true}var a=this.cells(f,h);if(g==1){if(a.isCheckbox()){b.setUpdated(f,true)}}else{if(g==2){if(a.wasChanged()){b.setUpdated(f,true)}}}return true});this.attachEvent("onRowPaste",function(a){b.setUpdated(a,true)});this.attachEvent("onUndo",function(a){b.setUpdated(a,true)});this.attachEvent("onRowIdChange",function(e,a){var f=b.findRow(e);if(f<b.updatedRows.length){b.updatedRows[f]=a}});this.attachEvent("onSelectStateChanged",function(a){if(b.updateMode=="row"){b.sendData()}return true});this.attachEvent("onEnter",function(d,a){if(b.updateMode=="row"){b.sendData()}return true});this.attachEvent("onBeforeRowDeleted",function(a){if(b._silent_mode||(!this.rowsAr[a])){return true}if(this.dragContext&&b.dnd){window.setTimeout(function(){b.setUpdated(a,true)},1);return true}var d=b.getState(a);if(this._h2){this._h2.forEachChild(a,function(c){b.setUpdated(c.id,false);b.markRow(c.id,true,"deleted")},this)}if(d=="inserted"){b.set_invalid(a,false);b.setUpdated(a,false);return true}if(d=="deleted"){return false}if(d=="true_deleted"){b.setUpdated(a,false);return true}b.setUpdated(a,true,"deleted");return false});this.attachEvent("onBindUpdate",function(f,a,e){b.setUpdated(e,true)});this.attachEvent("onRowAdded",function(a){if(this.dragContext&&b.dnd){return true}b.setUpdated(a,true,"inserted");return true});b._getRowData=function(r,a){var o={};o.gr_id=r;if(this.obj.isTreeGrid()){o.gr_pid=this.obj.getParentId(r)}var s=this.obj.getRowById(r);for(var j=0;j<this.obj._cCount;j++){if(this.obj._c_order){var i=this.obj._c_order[j]}else{var i=j}var c=this.obj.cells(s.idd,j);if(this._changed&&!c.wasChanged()){continue}if(this._endnm){o[this.obj.getColumnId(j)]=c.getValue()}else{o["c"+i]=c.getValue()}}var q=this.obj.UserData[r];if(q){for(var p=0;p<q.keys.length;p++){if(q.keys[p]&&q.keys[p].indexOf("__")!=0){o[q.keys[p]]=q.values[p]}}}var q=this.obj.UserData.gridglobaluserdata;if(q){for(var p=0;p<q.keys.length;p++){o[q.keys[p]]=q.values[p]}}return o};b._clearUpdateFlag=function(f){var e=this.obj.getRowById(f);if(e){for(var a=0;a<this.obj._cCount;a++){this.obj.cells(f,a).cell.wasChanged=false}}};b.checkBeforeUpdate=function(g){var h=true;var a=[];for(var i=0;i<this.obj._cCount;i++){if(this.mandatoryFields[i]){var j=this.mandatoryFields[i].call(this.obj,this.obj.cells(g,i).getValue(),g,i);if(typeof j=="string"){this.messages.push(j);h=false}else{h&=j;a[i]=!j}}}if(!h){this.set_invalid(g,"invalid",a);this.setUpdated(g,false)}return h}};dhx4.attachEvent("onGridCreated",function(f){f._con_f_used=[].concat(f._con_f_used);dhtmlXGridObject.prototype._con_f_used=[];if(f._was_created_once){return}f._was_created_once=true;var g=function(a){a=a.replace(/(\?|\&)connector[^\f]*/g,"");return a+(a.indexOf("?")!=-1?"&":"?")+"connector=true"+(this.hdr.rows.length>0?"&dhx_no_header=1":"")};var h=function(a){return g.call(this,a)+(this._connector_sorting||"")+(this._connector_filter||"")};var i=function(b,a,c){this._connector_sorting="&dhx_sort["+a+"]="+c;return h.call(this,b)};var j=function(d,e,b){var a=[];for(var c=0;c<e.length;c++){a[c]="dhx_filter["+e[c]+"]="+encodeURIComponent(b[c])}this._connector_filter="&"+a.join("&");return h.call(this,d)};f.attachEvent("onCollectValues",function(a){if(this._con_f_used[a]){if(typeof(this._con_f_used[a])=="object"){return this._con_f_used[a]}else{return false}}return true});f.attachEvent("onDynXLS",function(){if(this.xmlFileUrl){this.xmlFileUrl=h.call(this,this.xmlFileUrl)}return true});f.attachEvent("onBeforeSorting",function(a,b,c){if(b=="connector"){var d=this;this.clearAndLoad(i.call(this,this.xmlFileUrl,a,c),function(){d.setSortImgState(true,a,c)});return false}return true});f.attachEvent("onFilterStart",function(c,d){if(this._con_f_used.length){var a=this.getSortingState();var b=this;this.clearAndLoad(j.call(this,this.xmlFileUrl,c,d));if(a.length){b.setSortImgState(true,a[0],a[1])}return false}return true})});dhtmlXGridObject.prototype._con_f_used=[];dhtmlXGridObject.prototype._in_header_connector_text_filter=function(c,d){if(!this._con_f_used[d]){this._con_f_used[d]=1}return this._in_header_text_filter(c,d)};dhtmlXGridObject.prototype._in_header_connector_select_filter=function(c,d){if(!this._con_f_used[d]){this._con_f_used[d]=2}return this._in_header_select_filter(c,d)};if(!dhtmlXGridObject.prototype.load_connector){dhtmlXGridObject.prototype.load_connector=dhtmlXGridObject.prototype.load;dhtmlXGridObject.prototype.load=function(f,h,i){if(!this._colls_loaded&&this.cellType){var g=[];for(var j=0;j<this.cellType.length;j++){if(this.cellType[j].indexOf("co")==0||this.cellType[j].indexOf("clist")==0||this._con_f_used[j]==2){g.push(j)}}if(g.length){arguments[0]+=(arguments[0].indexOf("?")!=-1?"&":"?")+"connector=true&dhx_colls="+g.join(",")}}return this.load_connector.apply(this,arguments)};dhtmlXGridObject.prototype._parseHead_connector=dhtmlXGridObject.prototype._parseHead;dhtmlXGridObject.prototype._parseHead=function(z,f,r){this._parseHead_connector.apply(this,arguments);if(!this._colls_loaded){var j=dhx4.ajax.xpath("./coll_options",arguments[0]);for(var u=0;u<j.length;u++){var s=j[u].getAttribute("for");var i=[];var x=null;if(this.cellType[s]=="combo"){x=this.getColumnCombo(s)}else{if(this.cellType[s].indexOf("co")==0){x=this.getCombo(s)}}var v=dhx4.ajax.xpath("./item",j[u]);var A=[];for(var w=0;w<v.length;w++){var y=v[w].getAttribute("value");if(x){var t=v[w].getAttribute("label")||y;if(x.addOption){A.push([y,t])}else{x.put(y,t)}i[i.length]=t}else{i[i.length]=y}}if(A.length){if(x){x.addOption(A)}}else{if(i.length&&!x){if(this.registerCList){this.registerCList(s*1,i)}}}if(this._con_f_used[s*1]){this._con_f_used[s*1]=i}}this._colls_loaded=true}}}dhtmlXGridObject.prototype.getRowData=function(h){var f={};var g=this.getColumnsNum();for(var j=0;j<g;j++){var i=this.getColumnId(j);if(i){f[i]=this.cells(h,j).getValue()}}return f};dhtmlXGridObject.prototype.setRowData=function(h,j){var g=this.getColumnsNum();for(var f=0;f<g;f++){var i=this.getColumnId(f);if(i&&j.hasOwnProperty(i)){this.cells(h,f).setValue(j[i])}}};function dhtmlXGridCellObject(b){this.destructor=function(){this.cell.obj=null;this.cell=null;this.grid=null;this.base=null;return null};this.cell=b;this.getValue=function(){if((this.cell.textContent)&&(this.cell.textContent.tagName=="TEXTAREA")){return this.cell.textContent.value}else{return this.cell.innerHTML._dhx_trim()}};this.getMathValue=function(){if(this.cell.original){return this.cell.original}else{return this.getValue()}};this.getFont=function(){arOut=new Array(3);if(this.cell.style.fontFamily){arOut[0]=this.cell.style.fontFamily}if(this.cell.style.fontWeight=="bold"||this.cell.parentNode.style.fontWeight=="bold"){arOut[1]="bold"}if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic"){arOut[1]+="italic"}if(this.cell.style.fontSize){arOut[2]=this.cell.style.fontSize}else{arOut[2]=""}return arOut.join("-")};this.getTextColor=function(){if(this.cell.style.color){return this.cell.style.color}else{return"#000000"}};this.getBgColor=function(){return this.cell.style.backgroundColor||"#FFFFFF"};this.getHorAlign=function(){if(this.cell.style.textAlign){return this.cell.style.textAlign}else{if(this.cell.style.textAlign){return this.cell.style.textAlign}else{return"left"}}};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(a){fntAr=a.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1])){this.cell.style.fontWeight="bold"}if(/italic/.test(fntAr[1])){this.cell.style.fontStyle="italic"}if(/underline/.test(fntAr[1])){this.cell.style.textDecoration="underline"}}};this.setTextColor=function(a){this.cell.style.color=a};this.setBgColor=function(a){if(a==""){a=null}this.cell.style.background=a};this.setHorAlign=function(a){if(a.length==1){if(a=="c"){this.cell.style.textAlign="center"}else{if(a=="l"){this.cell.style.textAlign="left"}else{this.cell.style.textAlign="right"}}}else{this.cell.style.textAlign=a}};this.wasChanged=function(){if(this.cell.wasChanged){return true}else{return false}};this.isCheckbox=function(){var a=this.cell.firstChild;if(a&&a.tagName=="INPUT"){type=a.type;if(type=="radio"||type=="checkbox"){return true}else{return false}}else{return false}};this.isChecked=function(){if(this.isCheckbox()){return this.cell.firstChild.checked}};this.isDisabled=function(){return this.cell._disabled};this.setChecked=function(a){if(this.isCheckbox()){if(a!="true"&&a!=1){a=false}this.cell.firstChild.checked=a}};this.setDisabled=function(a){if(a!="true"&&a!=1){a=false}if(this.isCheckbox()){this.cell.firstChild.disabled=a;if(this.disabledF){this.disabledF(a)}}this.cell._disabled=a}}dhtmlXGridCellObject.prototype={getAttribute:function(b){return this.cell._attrs[b]},setAttribute:function(d,c){this.cell._attrs[d]=c},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA")){return this.obj}var b=(this.obj||this.cell).getElementsByTagName("TEXTAREA");if(!b.length){b=(this.obj||this.cell).getElementsByTagName("INPUT")}return b[0]}};dhtmlXGridCellObject.prototype.setValue=function(b){if((typeof(b)!="number")&&(!b||b.toString()._dhx_trim()=="")){b="&nbsp;";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCValue(b)};dhtmlXGridCellObject.prototype.getTitle=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};dhtmlXGridCellObject.prototype.setCValue=function(c,d){this.cell.innerHTML=c;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,(arguments.length>1?d:c)])};dhtmlXGridCellObject.prototype.setCTxtValue=function(b){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(b));this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,b])};dhtmlXGridCellObject.prototype.setLabel=function(b){this.cell.innerHTML=b};dhtmlXGridCellObject.prototype.getMath=function(){if(this._val){return this.val}else{return this.getValue()}};function eXcell(){this.obj=null;this.val=null;this.changeState=function(){return false};this.edit=function(){this.val=this.getValue()};this.detach=function(){return false};this.getPosition=function(g){var f=g;var h=0;var e=0;while(f.tagName!="BODY"){h+=f.offsetLeft;e+=f.offsetTop;f=f.offsetParent}return new Array(h,e)}}eXcell.prototype=new dhtmlXGridCellObject;function eXcell_ed(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.atag=(!this.grid.multiLine)?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=(this.cell.offsetHeight-(this.grid.multiLine?9:4))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(a){(a||event).cancelBubble=true};this.obj.onmousedown=function(a){(a||event).cancelBubble=true};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);this.obj.onselectstart=function(a){if(!a){a=event}a.cancelBubble=true;return true};if(_isIE){this.obj.focus();this.obj.blur()}this.obj.focus()};this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(a){if(!a||a.toString()._dhx_trim()==""){a=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(a)}}eXcell_edtxt.prototype=new eXcell_ed;function eXcell_edn(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var a=this.obj.value;this.setValue(a);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;eXcell_edn.prototype.setValue=function(b){if(!b||b.toString()._dhx_trim()==""){this.cell._clearCell=true;return this.setCValue("&nbsp;",0)}else{this.cell._clearCell=false;this.cell._orig_value=b}this.setCValue(this.grid._aplNF(b,this.cell._cellIndex),b)};function eXcell_ch(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.disabledF=function(a){if((a==true)||(a==1)){this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis.")}else{this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")}};this.changeState=function(a){if(a===true&&!this.grid.isActive){if(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive){window.globalActiveDHTMLGridObject.setActive(false)}this.grid.setActive(true)}if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return}if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])){this.val=this.getValue();if(this.val=="1"){this.setValue("0")}else{this.setValue("1")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return true};this.isChecked=function(){if(this.getValue()=="1"){return true}else{return false}};this.setChecked=function(a){this.setValue(a.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;eXcell_ch.prototype.setValue=function(c){this.cell.style.verticalAlign="middle";if(c){c=c.toString()._dhx_trim();if((c=="false")||(c=="0")){c=""}}if(c){c="1";this.cell.chstate="1"}else{c="0";this.cell.chstate="0"}var d=this;this.cell.setAttribute("excell","ch");this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+c+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)};function eXcell_ra(b){this.base=eXcell_ch;this.base(b);this.grid=b.parentNode.grid;this.disabledF=function(a){if((a==true)||(a==1)){this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis.")}else{this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")}};this.changeState=function(a){if(a===false&&this.getValue()==1){return}if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return}if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=false){this.val=this.getValue();if(this.val=="1"){this.setValue("0")}else{this.setValue("1")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.edit=null}eXcell_ra.prototype=new eXcell_ch;eXcell_ra.prototype.setValue=function(d){this.cell.style.verticalAlign="middle";if(d){d=d.toString()._dhx_trim();if((d=="false")||(d=="0")){d=""}}if(d){if(!this.grid._RaSeCol){this.grid._RaSeCol=[]}if(this.grid._RaSeCol[this.cell._cellIndex]){var f=this.grid._RaSeCol[this.cell._cellIndex];if(this.grid.rowsAr[f]){var e=this.grid.cells(f,this.cell._cellIndex);e.setValue("0");if(this.grid.rowsAr[e.cell.parentNode.idd]){this.grid.callEvent("onEditCell",[1,e.cell.parentNode.idd,e.cell._cellIndex])}}}this.grid._RaSeCol[this.cell._cellIndex]=this.cell.parentNode.idd;d="1";this.cell.chstate="1"}else{d="0";this.cell.chstate="0"}this.cell.setAttribute("excell","ra");this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+d+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};function eXcell_txt(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(c){(c||event).cancelBubble=true};var a=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;document.body.appendChild(this.obj);if(_isOpera){this.obj.onkeypress=function(c){if(c.keyCode==9||c.keyCode==27){return false}}}this.obj.onkeydown=function(c){var e=(c||event);if(e.keyCode==9||e.keyCode==27){globalActiveDHTMLGridObject.entBox.focus();globalActiveDHTMLGridObject.doKey({keyCode:e.keyCode,shiftKey:e.shiftKey,srcElement:"0"});return false}};this.obj.style.left=a[0]+"px";this.obj.style.top=a[1]+this.cell.offsetHeight+"px";if(this.cell.offsetWidth<200){var d=200}else{var d=this.cell.offsetWidth}this.obj.style.width=d+16+"px";if(_isIE){this.obj.select();this.obj.value=this.obj.value}this.obj.focus()};this.detach=function(){var a="";a=this.obj.value;if(a==""){this.cell._clearCell=true}else{this.cell._clearCell=false}this.setValue(a);document.body.removeChild(this.obj);this.obj=null;return this.val!=this.getValue()};this.getValue=function(){if(this.obj){return this.obj.value}if(this.cell._clearCell){return""}if(typeof this.cell._brval!="undefined"){return this.cell._brval}if((!this.grid.multiLine)){return this.cell._brval||this.cell.innerHTML}else{return this.cell._brval||this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim()}}}eXcell_txt.prototype=new eXcell;function eXcell_txttxt(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}if(this.cell._clearCell){return""}if((!this.grid.multiLine)&&this.cell._brval){return this.cell._brval}return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(a){this.cell._brval=a;if(!a||a.toString()._dhx_trim()==""){a=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(a)}}eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(b){this.cell._brval=b;if(!b||b.toString()._dhx_trim()==""){b="&nbsp;";this.cell._clearCell=true}else{this.cell._clearCell=false}if((!this.grid.multiLine)||this.cell._clearCell){this.setCValue(b,this.cell._brval)}else{this.setCValue(b.replace(/\n/g,"<br/>"),b)}};function eXcell_co(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.combo=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));this.editable=true}this.shiftNext=function(){var a=this.list.options[this.list.selectedIndex+1];if(a){a.selected=true}this.obj.value=this.list.options[this.list.selectedIndex].text;return true};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var a=this.list.options[this.list.selectedIndex-1];if(a){a.selected=true}this.obj.value=this.list.options[this.list.selectedIndex].text}return true};this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var n=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=(this.cell.offsetHeight-(this.grid.multiLine?9:4))+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(c){(c||event).cancelBubble=true};this.obj.onmousedown=function(c){(c||event).cancelBubble=true};this.obj.value=this.text;this.obj.onselectstart=function(c){if(!c){c=event}c.cancelBubble=true;return true};var l=this;this.obj.onkeyup=function(c){var d=(c||event).keyCode;if(d==38||d==40||d==9){return}var g=this.readonly?String.fromCharCode(d):this.value;var f=l.list.options;for(var e=0;e<f.length;e++){if(f[e].text.indexOf(g)==0){return f[e].selected=true}}};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=n[0]+"px";this.list.style.top=n[1]+this.cell.offsetHeight+"px";this.list.onclick=function(c){var d=c||window.event;var e=d.target||d.srcElement;if(e.tagName=="OPTION"){e=e.parentNode}l.editable=false;l.grid.editStop();d.cancelBubble=true};var a=this.combo.getKeys();var m=false;var i=0;for(var o=0;o<a.length;o++){var j=this.combo.get(a[o]);this.list.options[this.list.options.length]=new Option(j,a[o]);if(a[o]==this.val){i=this.list.options.length-1;m=true}}if(m==false){this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val);i=this.list.options.length-1}document.body.appendChild(this.list);this.list.size="6";this.cstate=1;if(this.editable){this.cell.innerHTML=""}else{this.obj.style.width="0px";this.obj.style.height="0px"}this.cell.appendChild(this.obj);this.list.options[i].selected=true;if(this.editable){this.obj.focus();this.obj.focus()}if(!this.editable){this.obj.style.visibility="hidden";this.obj.style.position="absolute";this.list.focus();this.list.onkeydown=function(c){c=c||window.event;l.grid.setActive(true);if(c.keyCode<30){return l.grid.doKey({target:l.cell,keyCode:c.keyCode,shiftKey:c.shiftKey,ctrlKey:c.ctrlKey})}}}};this.getValue=function(){return((this.cell.combo_value==window.undefined)?"":this.cell.combo_value)};this.detach=function(){if(this.val!=this.getValue()){this.cell.wasChanged=true}if(this.list.parentNode!=null){if(this.editable){var a=this.list.options[this.list.selectedIndex];if(a&&a.text==this.obj.value){this.setValue(this.list.value)}else{var f=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));var e=f.values._dhx_find(this.obj.value);if(e!=-1){this.setValue(f.keys[e])}else{this.setValue(this.cell.combo_value=this.obj.value)}}}else{this.setValue(this.list.value)}}if(this.list.parentNode){this.list.parentNode.removeChild(this.list)}if(this.obj.parentNode){this.obj.parentNode.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};eXcell_co.prototype.setValue=function(g){if(typeof(g)=="object"){var h=dhx4.ajax.xpath("./option",g);if(h.length){this.cell._combo=new dhtmlXGridComboObject()}for(var e=0;e<h.length;e++){this.cell._combo.put(h[e].getAttribute("value"),h[e].firstChild?h[e].firstChild.data:"")}g=g.firstChild.data}if((g||"").toString()._dhx_trim()==""){g=null}this.cell.combo_value=g;if(g!==null){var f=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(g);this.setCValue(f===null?g:f,g)}else{this.setCValue("&nbsp;",g)}};function eXcell_coro(b){this.base=eXcell_co;this.base(b);this.editable=false}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(b){this.base=eXcell_co;this.base(b)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};eXcell_cotxt.prototype.setValue=function(f){if(typeof(f)=="object"){var d=dhx4.ajax.xpath("./option",f);if(d.length){this.cell._combo=new dhtmlXGridComboObject()}for(var e=0;e<d.length;e++){this.cell._combo.put(d[e].getAttribute("value"),d[e].firstChild?d[e].firstChild.data:"")}f=f.firstChild.data}if((f||"").toString()._dhx_trim()==""){f=null}if(f!==null){this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(f)||f,f)}else{this.setCTxtValue(" ",f)}this.cell.combo_value=f};function eXcell_corotxt(b){this.base=eXcell_co;this.base(b);this.editable=false}eXcell_corotxt.prototype=new eXcell_cotxt;function eXcell_cp(d){try{this.cell=d;this.grid=this.cell.parentNode.grid}catch(c){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var a=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=a[0]+"px";this.obj.style.zIndex=1000;this.obj.style.top=a[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(a){if(a.length==1){a="0"+a}return a};this.colorPanel=function(j,a){var r=document.createElement("TABLE");a.appendChild(r);r.cellSpacing=0;r.editor_obj=this;r.style.cursor="default";r.onclick=function(h){var e=h||window.event;var g=e.target||e.srcElement;var f=g.parentNode.parentNode.parentNode.editor_obj;if(f){f.setValue(g._bg);f.grid.editStop()}};var t=256/j;for(var s=0;s<=(256/t);s++){var v=r.insertRow(s);for(var n=0;n<=(256/t);n++){for(var u=0;u<=(256/t);u++){R=new Number(t*s)-(s==0?0:1);G=new Number(t*n)-(n==0?0:1);B=new Number(t*u)-(u==0?0:1);var b=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16));var i=v.insertCell(n);i.width="10px";i.innerHTML="&nbsp;";i.title=b.toUpperCase();i.style.backgroundColor="#"+b;i._bg="#"+b;if(this.val!=null&&"#"+b.toUpperCase()==this.val.toUpperCase()){i.style.border="2px solid white"}}}}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){if(this.obj.offsetParent!=null){document.body.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(b){this.setCValue("<div style='width:100%;height:"+((this.grid.multiLine?"100%":23))+";background-color:"+(b||"")+";border:0px;'>&nbsp;</div>",b);this.cell.firstChild._bg=b};function eXcell_img(d){try{this.cell=d;this.grid=this.cell.parentNode.grid}catch(c){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG"){return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"")}else{if(this.cell.firstChild.tagName=="A"){var a=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");a+="^"+this.cell.lnk;if(this.cell.trg){a+="^"+this.cell.trg}return a}}};this.isDisabled=function(){return true}}eXcell_img.prototype=new eXcell;eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(f){var d=f;if((f||"").indexOf("^")!=-1){var e=f.split("^");f=e[0];d=this.cell._attrs.title||e[1];if(e.length>2){this.cell.lnk=e[2];if(e[3]){this.cell.trg=e[3]}}this.cell.titFl="1"}if(!this.grid.multiLine){this.setCValue("<img src='"+this.grid.iconURL+(f||"")._dhx_trim()+"' border='0' style='max-height:"+(this.grid._srdh-4)+"px'>",f)}else{this.setCValue("<img src='"+this.grid.iconURL+(f||"")._dhx_trim()+"' border='0'>",f)}if(this.cell.lnk){this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"}this.cell._brval=d};function eXcell_icon(d){this.base=eXcell_ed;this.base(d);try{this.cell=d;this.grid=this.cell.parentNode.grid}catch(c){}this.setValue=function(a){this.cell._raw_value=a;this.setCValue('<div class="dhx_grid_icon"><i class="fa fa-'+a.toString()._dhx_trim()+'"></i></div>')};this.getValue=function(){return this.cell._raw_value};this.isDisabled=function(){return true}}eXcell_icon.prototype=new eXcell_ed;function eXcell_price(b){this.base=eXcell_ed;this.base(b);this.getValue=function(){if(this.cell.childNodes.length>1){return this.cell.childNodes[1].innerHTML.toString()._dhx_trim()}else{return"0"}}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(c){if(isNaN(parseFloat(c))){c=this.val||0}var d="green";if(c<0){d="red"}this.setCValue("<span>$</span><span style='padding-right:2px;color:"+d+";'>"+c+"</span>",c)};function eXcell_dyn(b){this.base=eXcell_ed;this.base(b);this.getValue=function(){if(!this.cell.firstChild.childNodes[1]){return""}var d=this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim();var a=this.grid._aplNFb(d,this.cell._cellIndex);if(isNaN(Number(a))){return d}return a}}eXcell_dyn.prototype=new eXcell_ed;eXcell_dyn.prototype.getValue=function(){var b=eXcell_ed.prototype.getValue.call(this);return};eXcell_dyn.prototype.setValue=function(f){if(!f||isNaN(Number(f))){if(f!==""){f=0}}else{if(f>0){var d="green";var e="dyn_up.gif"}else{if(f==0){var d="black";var e="dyn_.gif"}else{var d="red";var e="dyn_down.gif"}}f=this.grid._aplNF(f,this.cell._cellIndex)}this.setCValue("<div class='grid_cell_dyn'><img src='"+this.grid.imgURL+""+e+"'><span style='color:"+d+";'>"+f+"</span></div>",f)};function eXcell_ro(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;window.eXcell_hidden=function(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell.val}};eXcell_hidden.prototype=new eXcell;eXcell_hidden.prototype.setValue=function(b){this.cell.val=b};function eXcell_ron(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex).toString()}}eXcell_ron.prototype=new eXcell;eXcell_ron.prototype.setValue=function(b){if(b===0){}else{if(!b||b.toString()._dhx_trim()==""){this.setCValue("&nbsp;");return this.cell._clearCell=true}}this.cell._orig_value=b;this.cell._clearCell=false;this.setCValue(b?this.grid._aplNF(b,this.cell._cellIndex):"0")};function eXcell_rotxt(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.setValue=function(a){if(!a){a=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(a)};this.getValue=function(){if(this.cell._clearCell){return""}return(_isIE?this.cell.innerText:this.cell.textContent)}}eXcell_rotxt.prototype=new eXcell;function dhtmlXGridComboObject(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();this.put=function(d,f){for(var e=0;e<this.keys.length;e++){if(this.keys[e]==d){this.values[e]=f;return true}}this.values[this.values.length]=f;this.keys[this.keys.length]=d};this.get=function(c){for(var d=0;d<this.keys.length;d++){if(this.keys[d]==c){return this.values[d]}}return null};this.clear=function(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray()};this.remove=function(c){for(var d=0;d<this.keys.length;d++){if(this.keys[d]==c){this.keys._dhx_removeAt(d);this.values._dhx_removeAt(d);return true}}};this.size=function(){var d=0;for(var c=0;c<this.keys.length;c++){if(this.keys[c]!=null){d++}}return d};this.getKeys=function(){var d=new Array(0);for(var c=0;c<this.keys.length;c++){if(this.keys[c]!=null){d[d.length]=this.keys[c]}}return d};this.save=function(){this._save=new Array();for(var b=0;b<this.keys.length;b++){this._save[b]=[this.keys[b],this.values[b]]}};this.restore=function(){if(this._save){this.keys[b]=new Array();this.values[b]=new Array();for(var b=0;b<this._save.length;b++){this.keys[b]=this._save[b][0];this.values[b]=this._save[b][1]}}};return this}function Hashtable(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();return this}Hashtable.prototype=new dhtmlXGridComboObject;if(typeof(window.dhtmlXCellObject)!="undefined"){dhtmlXCellObject.prototype.attachGrid=function(d){this.callEvent("_onBeforeContentAttach",["grid"]);var c=document.createElement("DIV");c.style.width="100%";c.style.height="100%";c.style.position="relative";c.style.overflow="hidden";this._attachObject(c);this.dataType="grid";if(d&&typeof d==="object"&&!d.tagName){d.parent=c;c=d}this.dataObj=new dhtmlXGridObject(c);this.dataObj.setSkin(this.conf.skin);if(typeof(window.dhtmlXTabBarCell)=="function"&&this instanceof window.dhtmlXTabBarCell&&navigator.userAgent.match(/7[\.\d]* mobile/gi)!=null&&navigator.userAgent.match(/AppleWebKit/gi)!=null){this.dataObj.objBox.style.webkitOverflowScrolling="auto"}if(this.conf.skin=="material"&&typeof(window.dhtmlXLayoutCell)=="function"&&this instanceof window.dhtmlXLayoutCell){this.cell.childNodes[this.conf.idx.cont].style.overflow="hidden"}if(this.conf.skin=="dhx_skyblue"&&typeof(window.dhtmlXWindowsCell)=="function"&&this instanceof window.dhtmlXWindowsCell){this.dataObj.entBox.style.border="1px solid #a4bed4";this.dataObj._sizeFix=0}else{this.dataObj.entBox.style.border="0px solid white";this.dataObj._sizeFix=2}c=null;this.callEvent("_onContentAttach",[]);return this.dataObj}}dhtmlXGridObject.prototype.enableDragAndDrop=function(b){if(b=="temporary_disabled"){this.dADTempOff=false;b=true}else{this.dADTempOff=true}this.dragAndDropOff=dhx4.s2b(b);this._drag_validate=true;if(b){this.objBox.ondragstart=function(a){(a||event).cancelBubble=true;return false}}};dhtmlXGridObject.prototype.setDragBehavior=function(b){this.dadmodec=this.dadmodefix=0;switch(b){case"child":this.dadmode=0;this._sbmod=false;break;case"sibling":this.dadmode=1;this._sbmod=false;break;case"sibling-next":this.dadmode=1;this._sbmod=true;break;case"complex":this.dadmode=2;this._sbmod=false;break;case"complex-next":this.dadmode=2;this._sbmod=true;break}};dhtmlXGridObject.prototype.enableDragOrder=function(b){this._dndorder=dhx4.s2b(b)};dhtmlXGridObject.prototype._checkParent=function(g,e){var h=this._h2.get[g.idd].parent;if(!h.parent){return}for(var f=0;f<e.length;f++){if(e[f]==h.id){return true}}return this._checkParent(this.rowsAr[h.id],e)};dhtmlXGridObject.prototype._createDragNode=function(q,p){this.editStop();if(window.dhtmlDragAndDrop.dragNode){return null}if(!this.dADTempOff){return null}q.parentObject=new Object();q.parentObject.treeNod=this;var i=this.callEvent("onBeforeDrag",[q.parentNode.idd,q._cellIndex,p]);if(!i){return null}var o=new Array();o=this.getSelectedId();o=(((o)&&(o!=""))?o.split(this.delim):[]);var n=false;for(var r=0;r<o.length;r++){if(o[r]==q.parentNode.idd){n=true}}if(!n){this.selectRow(this.rowsAr[q.parentNode.idd],false,p.ctrlKey,false);if(!p.ctrlKey){o=[]}o[this.selMultiRows?o.length:0]=q.parentNode.idd}if(this.isTreeGrid()){for(var r=o.length-1;r>=0;r--){if(this._checkParent(this.rowsAr[o[r]],o)){o.splice(r,1)}}}var e=this;if(o.length&&this._dndorder){o.sort(function(a,b){return(e.rowsAr[a].rowIndex>e.rowsAr[b].rowIndex?1:-1)})}var s=this.getFirstParentOfType(_isIE?p.srcElement:p.target,"TD");if(s){this._dndExtra=s._cellIndex}this._dragged=new Array();for(var r=0;r<o.length;r++){if(this.rowsAr[o[r]]){this._dragged[this._dragged.length]=this.rowsAr[o[r]];this.rowsAr[o[r]].treeNod=this}}q.parentObject.parentNode=q.parentNode;var m=document.createElement("div");m.innerHTML=(i!==true?i:this.rowToDragElement(q.parentNode.idd));m.style.position="absolute";m.className="dragSpanDiv";return m};dhtmlXGridObject.prototype._createSdrgc=function(){this._sdrgc=document.createElement("DIV");this._sdrgc.innerHTML="&nbsp;";this._sdrgc.className="gridDragLine";this.objBox.appendChild(this._sdrgc)};function dragContext(j,l,m,w,a,b,d,c,e,f,h){this.source=j||"grid";this.target=l||"grid";this.mode=m||"move";this.dropmode=w||"child";this.sid=a||0;this.tid=b;this.sobj=d||null;this.tobj=c||null;this.sExtra=e||null;this.tExtra=f||null;this.before=h||false;return this}dragContext.prototype.valid=function(){if(this.sobj!=this.tobj){return true}if(this.sid==this.tid){return false}if(this.target=="treeGrid"){var b=this.tid;while(b=this.tobj.getParentId(b)){if(this.sid==b){return false}}}return true};dragContext.prototype.close=function(){this.sobj=null;this.tobj=null};dragContext.prototype.copy=function(){return new dragContext(this.source,this.target,this.mode,this.dropmode,this.sid,this.tid,this.sobj,this.tobj,this.sExtra,this.tExtra,this.before)};dragContext.prototype.set=function(a,b){this[a]=b;return this};dragContext.prototype.uid=function(a,b){this.nid=this.sid;while(this.tobj.rowsAr[this.nid]){this.nid=this.nid+((new Date()).valueOf())}return this};dragContext.prototype.data=function(){if(this.sobj==this.tobj){return this.sobj._getRowArray(this.sobj.rowsAr[this.sid])}if(this.source=="tree"){return this.tobj.treeToGridElement(this.sobj,this.sid,this.tid)}else{return this.tobj.gridToGrid(this.sid,this.sobj,this.tobj)}};dragContext.prototype.attrs=function(){if(this.source=="tree"){return{}}else{return this.sobj.rowsAr[this.sid]._attrs}};dragContext.prototype.childs=function(){if(this.source=="treeGrid"){return this.sobj._h2.get[this.sid]._xml_await?this.sobj._h2.get[this.sid].has_kids:null}return null};dragContext.prototype.pid=function(){if(!this.tid){return 0}if(!this.tobj._h2){return 0}if(this.target=="treeGrid"){if(this.dropmode=="child"){return this.tid}else{var d=this.tobj.rowsAr[this.tid];var e=this.tobj._h2.get[d.idd].parent.id;if((this.alfa)&&(this.tobj._sbmod)&&(d.nextSibling)){var f=this.tobj._h2.get[d.nextSibling.idd].parent.id;if(f==this.tid){return this.tid}if(f!=e){return f}}return e}}};dragContext.prototype.ind=function(){if(this.tid==window.unknown){return this.tobj.rowsBuffer.length}if(this.target=="treeGrid"){if(this.dropmode=="child"){this.tobj.openItem(this.tid)}else{this.tobj.openItem(this.tobj.getParentId(this.tid))}}var d=this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);if((this.alfa)&&(this.tobj._sbmod)&&(this.dropmode=="sibling")){var c=this.tobj.rowsAr[this.tid];if((c.nextSibling)&&(this._h2.get[c.nextSibling.idd].parent.id==this.tid)){return d+1}}return(d+1+((this.target=="treeGrid"&&d>=0&&this.tobj._h2.get[this.tobj.rowsBuffer[d].idd].state=="minus")?this.tobj._getOpenLenght(this.tobj.rowsBuffer[d].idd,0):0))};dragContext.prototype.img=function(){if((this.target!="grid")&&(this.sobj._h2)){return this.sobj.getItemImage(this.sid)}else{return null}};dragContext.prototype.slist=function(){var c=new Array();for(var d=0;d<this.sid.length;d++){c[c.length]=this.sid[d][(this.source=="tree")?"id":"idd"]}return c.join(",")};dhtmlXGridObject.prototype._drag=function(p,v,q,i){if(this._realfake){return this._fake._drag()}var r=(this.lastLanding);if(this._autoOpenTimer){window.clearTimeout(this._autoOpenTimer)}var w=q.parentNode;var x=p.parentObject;if(!w.idd){w.grid=this;this.dadmodefix=0}var s=new dragContext(0,0,0,((w.grid.dadmode==1||w.grid.dadmodec)?"sibling":"child"));if(x&&x.childNodes){s.set("source","tree").set("sobj",x.treeNod).set("sid",s.sobj._dragged)}else{if(!x){return true}if(x.treeNod.isTreeGrid&&x.treeNod.isTreeGrid()){s.set("source","treeGrid")}s.set("sobj",x.treeNod).set("sid",s.sobj._dragged)}if(w.grid.isTreeGrid()){s.set("target","treeGrid")}else{s.set("dropmode","sibling")}s.set("tobj",w.grid).set("tid",w.idd);if(((s.tobj.dadmode==2)&&(s.tobj.dadmodec==1))&&(s.tobj.dadmodefix<0)){if(s.tobj.obj.rows[1].idd!=s.tid){s.tid=w.previousSibling.idd}else{if(this._h2&&s.tid){s.before=true}else{s.tid=0}}}var y=this.getFirstParentOfType(i,"TD");if(y){s.set("tExtra",y._cellIndex)}if(y){s.set("sExtra",s.sobj._dndExtra)}if(s.sobj.dpcpy){s.set("mode","copy")}if(s.tobj._realfake){s.tobj=s.tobj._fake}if(s.sobj._realfake){s.sobj=s.sobj._fake}s.tobj._clearMove();if(x&&x.treeNod&&x.treeNod._nonTrivialRow){x.treeNod._nonTrivialRow(this,s.tid,s.dropmode,x)}else{s.tobj.dragContext=s;if(!s.tobj.callEvent("onDrag",[s.slist(),s.tid,s.sobj,s.tobj,s.sExtra,s.tExtra])){return s.tobj.dragContext=null}var c=new Array();if(typeof(s.sid)=="object"){var t=s.copy();for(var u=0;u<s.sid.length;u++){if(!t.set("alfa",(!u)).set("sid",s.sid[u][(s.source=="tree"?"id":"idd")]).valid()){continue}t.tobj._dragRoutine(t);if(t.target=="treeGrid"&&t.dropmode=="child"){t.tobj.openItem(t.tid)}c[c.length]=t.nid;t.set("dropmode","sibling").set("tid",t.nid)}t.close()}else{s.tobj._dragRoutine(s)}if(s.tobj.laterLink){s.tobj.laterLink()}s.tobj.callEvent("onDrop",[s.slist(),s.tid,c.join(","),s.sobj,s.tobj,s.sExtra,s.tExtra])}s.tobj.dragContext=null;s.close()};dhtmlXGridObject.prototype._dragRoutine=function(j){if((j.sobj==j.tobj)&&(j.source=="grid")&&(j.mode=="move")&&!this._fake){if(j.sobj._dndProblematic){return}var o=j.sobj.rowsAr[j.sid];var l=j.sobj.rowsCol._dhx_find(o);j.sobj.rowsCol._dhx_removeAt(j.sobj.rowsCol._dhx_find(o));j.sobj.rowsBuffer._dhx_removeAt(j.sobj.rowsBuffer._dhx_find(o));j.sobj.rowsBuffer._dhx_insertAt(j.ind(),o);if(j.tobj._fake){j.tobj._fake.rowsCol._dhx_removeAt(l);var c=j.tobj._fake.rowsAr[j.sid];c.parentNode.removeChild(c)}j.sobj._insertRowAt(o,j.ind()-(this.pagingOn?((this.currentPage-1)*this.rowsBufferOutSize):0));j.nid=j.sid;j.sobj.callEvent("onGridReconstructed",[]);return}var p;if(this._h2&&typeof j.tid!="undefined"&&j.dropmode=="sibling"&&(this._sbmod||j.tid)){if(j.before){p=j.uid().tobj.addRowBefore(j.nid,j.data(),j.tid,j.img(),j.childs())}else{if(j.alfa&&this._sbmod&&this._h2.get[j.tid].childs.length){this.openItem(j.tid);p=j.uid().tobj.addRowBefore(j.nid,j.data(),this._h2.get[j.tid].childs[0].id,j.img(),j.childs())}else{p=j.uid().tobj.addRowAfter(j.nid,j.data(),j.tid,j.img(),j.childs())}}}else{p=j.uid().tobj.addRow(j.nid,j.data(),j.ind(),j.pid(),j.img(),j.childs())}p._attrs=j.attrs();if(j.source=="tree"){this.callEvent("onRowAdded",[j.nid]);var u=j.sobj._globalIdStorageFind(j.sid);if(u.childsCount){var q=j.copy().set("tid",j.nid).set("dropmode",j.target=="grid"?"sibling":"child");for(var s=0;s<u.childsCount;s++){j.tobj._dragRoutine(q.set("sid",u.childNodes[s].id));if(j.mode=="move"){s--}}q.close()}}else{j.tobj._copyUserData(j);this.callEvent("onRowAdded",[j.nid]);if((j.source=="treeGrid")){if(j.sobj==j.tobj){p._xml=j.sobj.rowsAr[j.sid]._xml}var r=j.sobj._h2.get[j.sid];if((r)&&(r.childs.length)){var q=j.copy().set("tid",j.nid);if(j.target=="grid"){q.set("dropmode","sibling")}else{if(!q.tobj.kidsXmlFile){q.tobj.openItem(j.tid)}q.set("dropmode","child")}var t=r.childs.length;if(!q.tobj.kidsXmlFile){for(var s=0;s<t;s++){j.sobj.render_row_tree(null,r.childs[s].id);j.tobj._dragRoutine(q.set("sid",r.childs[s].id));if(t!=r.childs.length){s--;t=r.childs.length}}}q.close()}}}if(j.mode=="move"){j.sobj[(j.source=="tree")?"deleteItem":"deleteRow"](j.sid);if((j.sobj==j.tobj)&&(!j.tobj.rowsAr[j.sid])){j.tobj.changeRowId(j.nid,j.sid);j.nid=j.sid}}};dhtmlXGridObject.prototype.gridToGrid=function(i,g,j){var h=new Array();for(var f=0;f<g.hdr.rows[0].cells.length;f++){h[f]=g.cells(i,f).getValue()}return h};dhtmlXGridObject.prototype.checkParentLine=function(d,c){if((!this._h2)||(!c)||(!d)){return false}if(d.id==c){return true}else{return this.checkParentLine(d.parent,c)}};dhtmlXGridObject.prototype._dragIn=function(l,n,h,j){if(!this.dADTempOff){return 0}var i=this.isTreeGrid();var m=n.parentNode.idd?n.parentNode:n.parentObject;if(this._drag_validate){if(l.parentNode==n.parentNode){return 0}if((i)&&(this==m.grid)&&((this.checkParentLine(this._h2.get[l.parentNode.idd],n.parentNode.idd)))){return 0}}if(!this.callEvent("onDragIn",[m.idd||m.id,l.parentNode.idd,m.grid||m.treeNod,(l.grid||l.parentNode.grid)])){return this._setMove(l,h,j,true)}this._setMove(l,h,j);if((i)&&(l.parentNode.expand!="")){var o=this;this._autoOpenTimer=window.setTimeout(function(){o._autoOpenItem(null,o);o=null},1000);this._autoOpenId=l.parentNode.idd}else{if(this._autoOpenTimer){window.clearTimeout(this._autoOpenTimer)}}return l};dhtmlXGridObject.prototype._autoOpenItem=function(d,c){c.openItem(c._autoOpenId)};dhtmlXGridObject.prototype._dragOut=function(c){this._clearMove();var d=c.parentNode.parentObject?c.parentObject.id:c.parentNode.idd;this.callEvent("onDragOut",[d]);if(this._autoOpenTimer){window.clearTimeout(this._autoOpenTimer)}};dhtmlXGridObject.prototype._setMove=function(n,i,l,o){if(!n.parentNode.idd){return}var q=dhx4.absTop(n);var j=dhx4.absTop(this.objBox);if((q-j)>(parseInt(this.objBox.offsetHeight)-50)){this.objBox.scrollTop=parseInt(this.objBox.scrollTop)+20}if((q-j+parseInt(this.objBox.scrollTop))<(parseInt(this.objBox.scrollTop)+30)){this.objBox.scrollTop=parseInt(this.objBox.scrollTop)-20}if(o){return 0}if(this.dadmode==2){var m=l-q+(document.body.scrollTop||document.documentElement.scrollTop)-2-n.offsetHeight/2;if((Math.abs(m)-n.offsetHeight/6)>0){this.dadmodec=1;if(m<0){this.dadmodefix=-1}else{this.dadmodefix=1}}else{this.dadmodec=0}}else{this.dadmodec=this.dadmode}if(this.dadmodec){if(!this._sdrgc){this._createSdrgc()}this._sdrgc.style.display="block";this._sdrgc.style.top=q-j+parseInt(this.objBox.scrollTop)+((this.dadmodefix>=0)?n.offsetHeight:0)+"px"}else{this._llSelD=n;if(n.parentNode.tagName=="TR"){for(var p=0;p<n.parentNode.childNodes.length;p++){var m=n.parentNode.childNodes[p];m._bgCol=m.style.backgroundColor;m.style.backgroundColor="#FFCCCC"}}}};dhtmlXGridObject.prototype._clearMove=function(){if(this._sdrgc){this._sdrgc.style.display="none"}if((this._llSelD)&&(this._llSelD.parentNode.tagName=="TR")){var c=this._llSelD.parentNode.childNodes;for(var d=0;d<c.length;d++){c[d].style.backgroundColor=c[d]._bgCol}}this._llSelD=null};dhtmlXGridObject.prototype.rowToDragElement=function(d){var c=this.cells(d,0).getValue();return c};dhtmlXGridObject.prototype._copyUserData=function(f){if(!f.tobj.UserData[f.nid]||f.tobj!=f.sobj){f.tobj.UserData[f.nid]=new Hashtable()}else{return}var c=f.sobj.UserData[f.sid];var e=f.tobj.UserData[f.nid];if(c){e.keys=e.keys.concat(c.keys);e.values=e.values.concat(c.values)}};dhtmlXGridObject.prototype.moveRow=function(h,g,f,e){switch(g){case"row_sibling":this.moveRowTo(h,f,"move","sibling",this,e);break;case"up":this.moveRowUp(h);break;case"down":this.moveRowDown(h);break}};dhtmlXGridObject.prototype._nonTrivialNode=function(i,n,q,p,u){if((i.callEvent)&&(!u)){if(!i.callEvent("onDrag",[p.idd,n.id,(q?q.id:null),this,i])){return false}}var o=p.idd;var w=o;while(i._idpull[w]){w+=(new Date()).getMilliseconds().toString()}var s=(this.isTreeGrid()?this.getItemImage(o):"");if(q){for(t=0;t<n.childsCount;t++){if(n.childNodes[t]==q){break}}if(t!=0){q=n.childNodes[t-1]}else{st="TOP";q=""}}var v=i._attachChildNode(n,w,this.gridToTreeElement(i,w,o),"",s,s,s,"","",q);if(this._h2){var r=this._h2.get[o];if(r.childs.length){for(var t=0;t<r.childs.length;t++){this._nonTrivialNode(i,v,0,this.rowsAr[r.childs[t].id],1);if(!this.dpcpy){t--}}}}if(!this.dpcpy){this.deleteRow(o)}if((i.callEvent)&&(!u)){i.callEvent("onDrop",[w,n.id,(q?q.id:null),this,i])}};dhtmlXGridObject.prototype.gridToTreeElement=function(d,f,e){return this.cells(e,0).getValue()};dhtmlXGridObject.prototype.treeToGridElement=function(l,j,h){var g=new Array();var i=this.cellType._dhx_find("tree");if(i==-1){i=0}for(var m=0;m<this.getColumnCount();m++){g[g.length]=(m!=i)?(l.getUserData(j,this.getColumnId(m))||""):l.getItemText(j)}return g};dhtmlXGridObject.prototype.moveRowTo=function(o,c,l,m,i,n){var j=new dragContext((i||this).isTreeGrid()?"treeGrid":"grid",(n||this).isTreeGrid()?"treeGrid":"grid",l,m||"sibling",o,c,i||this,n||this);j.tobj._dragRoutine(j);j.close();return j.nid};dhtmlXGridObject.prototype.enableMercyDrag=function(b){this.dpcpy=dhx4.s2b(b)};dhtmlXGridObject.prototype.toPDF=function(L,E,z,C,H,d){var K={row:(this.getSelectedRowId()||"").split(this.delim),col:this.getSelectedCellIndex()};if(K.row===null||K.col===-1){K=false}else{if(K.row){for(var y=0;y<K.row.length;y++){if(K.row[y]){var N=this.cells(K.row[y],K.col).cell;N.parentNode.className=N.parentNode.className.replace(" rowselected","");N.className=N.className.replace(" cellselected","");K.row[y]=N}}}else{K=false}}E=E||"color";var x=E=="full_color";var O=this;O._asCDATA=true;if(typeof(d)==="undefined"){this.target=' target="_blank"'}else{this.target=d}eXcell_ch.prototype.getContent=function(){return this.getValue()};eXcell_ra.prototype.getContent=function(){return this.getValue()};function i(l){var q=[];for(var b=1;b<O.hdr.rows.length;b++){q[b]=[];for(var c=0;c<O._cCount;c++){var o=O.hdr.rows[b].childNodes[c];if(!q[b][c]){q[b][c]=[0,0]}if(o){q[b][o._cellIndexS]=[o.colSpan,o.rowSpan]}}}var a="<rows profile='"+l+"'";if(z){a+=" header='"+z+"'"}if(C){a+=" footer='"+C+"'"}a+="><head>"+O._serialiseExportConfig(q).replace(/^<head/,"<columns").replace(/head>$/,"columns>");for(var b=2;b<O.hdr.rows.length;b++){var e=0;var h=O.hdr.rows[b];var p="";for(var c=0;c<O._cCount;c++){if((O._srClmn&&!O._srClmn[c])||(O._hrrar[c]&&(!O._fake||c>=O._fake.hdrLabels.length))){e++;continue}var j=q[b][c];var n=((j[0]&&j[0]>1)?' colspan="'+j[0]+'" ':"");if(j[1]&&j[1]>1){n+=' rowspan="'+j[1]+'" ';e=-1}var m="";var f=h;if(O._fake&&c<O._fake._cCount){f=O._fake.hdr.rows[b]}for(var g=0;g<f.cells.length;g++){if(f.cells[g]._cellIndexS==c){if(f.cells[g].getElementsByTagName("SELECT").length){m=""}else{m=_isIE?f.cells[g].innerText:f.cells[g].textContent}m=m.replace(/[ \n\r\t\xA0]+/," ");break}}if(!m||m==" "){e++}p+="<column"+n+"><![CDATA["+m+"]]></column>"}if(e!=O._cCount){a+="\n<columns>"+p+"</columns>"}}a+="</head>\n";a+=F();return a}function M(){var b=[];if(H){for(var a=0;a<H.length;a++){b.push(A(O.getRowIndex(H[a])))}}else{for(var a=0;a<O.getRowsNum();a++){b.push(A(a))}}return b.join("\n")}function F(){var b=["<foot>"];if(!O.ftr){return""}for(var h=1;h<O.ftr.rows.length;h++){b.push("<columns>");var g=O.ftr.rows[h];for(var c=0;c<O._cCount;c++){if(O._srClmn&&!O._srClmn[c]){continue}if(O._hrrar[c]&&(!O._fake||c>=O._fake.hdrLabels.length)){continue}for(var f=0;f<g.cells.length;f++){var a="";var e="";if(g.cells[f]._cellIndexS==c){a=_isIE?g.cells[f].innerText:g.cells[f].textContent;a=a.replace(/[ \n\r\t\xA0]+/," ");if(g.cells[f].colSpan&&g.cells[f].colSpan!=1){e=" colspan='"+g.cells[f].colSpan+"' "}if(g.cells[f].rowSpan&&g.cells[f].rowSpan!=1){e=" rowspan='"+g.cells[f].rowSpan+"' "}break}}b.push("<column"+e+"><![CDATA["+a+"]]></column>")}b.push("</columns>")}b.push("</foot>");return b.join("\n")}function I(a,b){return(window.getComputedStyle?(window.getComputedStyle(a,null)[b]):(a.currentStyle?a.currentStyle[b]:null))||""}function A(g){if(!O.rowsBuffer[g]){return""}var e=O.render_row(g);if(e.style.display=="none"){return""}var l=O.isTreeGrid()?' level="'+O.getLevel(e.idd)+'"':"";var a="<row"+l+">";for(var c=0;c<O._cCount;c++){if(((!O._srClmn)||(O._srClmn[c]))&&(!O._hrrar[c]||(O._fake&&c<O._fake.hdrLabels.length))){var j=O.cells(e.idd,c);if(x){var f=I(j.cell,"color");var m=I(j.cell,"backgroundColor");var n=I(j.cell,"font-weight")||I(j.cell,"fontWeight");var b=I(j.cell,"font-style")||I(j.cell,"fontStyle");var o=I(j.cell,"text-align")||I(j.cell,"textAlign");var h=I(j.cell,"font-family")||I(j.cell,"fontFamily");if(m=="transparent"||m=="rgba(0, 0, 0, 0)"){m="rgb(255,255,255)"}a+="<cell bgColor='"+m+"' textColor='"+f+"' bold='"+n+"' italic='"+b+"' align='"+o+"' font='"+h+"'>"}else{a+="<cell>"}a+="<![CDATA["+(j.getContent?j.getContent():j.getTitle())+"]]></cell>"}}return a+"</row>"}function D(){var a="</rows>";return a}var w=document.createElement("div");w.style.display="none";document.body.appendChild(w);var J="form_"+O.uid();w.innerHTML='<form id="'+J+'" method="post" action="'+L+'" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"'+this.target+'><input type="hidden" name="grid_xml" id="grid_xml"/> </form>';document.getElementById(J).firstChild.value=encodeURIComponent(i(E).replace("\u2013","-")+M()+D());document.getElementById(J).submit();w.parentNode.removeChild(w);O=null;if(K&&K.row.length){for(var y=0;y<K.row.length;y++){K.row[y].parentNode.className+=" rowselected";if(K.row.length==1){K.row[y].className+=" cellselected"}}}K=null};dhtmlXGridObject.prototype._serialiseExportConfig=function(n){function o(a){if(typeof(a)!=="string"){return a}a=a.replace(/&/g,"&amp;");a=a.replace(/"/g,"&quot;");a=a.replace(/'/g,"&apos;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a}var r="<head>";for(var q=0;q<this.hdr.rows[0].cells.length;q++){if(this._srClmn&&!this._srClmn[q]){continue}if(this._hrrar[q]&&(!this._fake||q>=this._fake.hdrLabels.length)){continue}var p=this.fldSort[q];if(p=="cus"){p=this._customSorts[q].toString();p=p.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}var i=n[1][q];var m=((i[1]&&i[1]>1)?' rowspan="'+i[1]+'" ':"")+((i[0]&&i[0]>1)?' colspan="'+i[0]+'" ':"");r+="<column "+m+" width='"+this.getColWidth(q)+"' align='"+this.cellAlign[q]+"' type='"+this.cellType[q]+"' hidden='"+((this.isColumnHidden&&this.isColumnHidden(q))?"true":"false")+"' sort='"+(p||"na")+"' color='"+(this.columnColor[q]||"")+"'"+(this.columnIds[q]?(" id='"+this.columnIds[q]+"'"):"")+">";if(this._asCDATA){r+="<![CDATA["+this.getColumnLabel(q)+"]]>"}else{r+=this.getColumnLabel(q)}var j=this.combos[q]?this.getCombo(q):null;if(j){for(var s=0;s<j.keys.length;s++){r+="<option value='"+o(j.keys[s])+"'><![CDATA["+j.values[s]+"]]></option>"}}r+="</column>"}return r+="</head>"};if(window.eXcell_sub_row_grid){window.eXcell_sub_row_grid.prototype.getContent=function(){return""}}dhtmlXGridObject.prototype.toExcel=function(i,n,j,l,h){if(!document.getElementById("ifr")){var m=document.createElement("iframe");m.style.display="none";m.setAttribute("name","dhx_export_iframe");m.setAttribute("src","");m.setAttribute("id","dhx_export_iframe");document.body.appendChild(m)}var o=' target="dhx_export_iframe"';this.toPDF(i,n,j,l,h,o)};dhtmlXGridObject.prototype.filterBy=function(j,i,d){if(this.isTreeGrid()){return this.filterTreeBy(j,i,d)}if(this._f_rowsBuffer){if(!d){this.rowsBuffer=dhtmlxArray([].concat(this._f_rowsBuffer));if(this._fake){this._fake.rowsBuffer=this.rowsBuffer}}}else{this._f_rowsBuffer=[].concat(this.rowsBuffer)}if(!this.rowsBuffer.length){return}var h=true;this.dma(true);if(typeof(j)=="object"){for(var g=0;g<i.length;g++){this._filterA(j[g],i[g])}}else{this._filterA(j,i)}this.dma(false);if(this.pagingOn&&this.rowsBuffer.length/this.rowsBufferOutSize<(this.currentPage-1)){this.changePage(0)}this._reset_view();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._filterA=function(d,h){if(h==""){return}var g=true;if(typeof(h)=="function"){g=false}else{h=(h||"").toString().toLowerCase()}if(!this.rowsBuffer.length){return}for(var f=this.rowsBuffer.length-1;f>=0;f--){if(g?(this._get_cell_value(this.rowsBuffer[f],d).toString().toLowerCase().indexOf(h)==-1):(!h.call(this,this._get_cell_value(this.rowsBuffer[f],d),this.rowsBuffer[f].idd))){this.rowsBuffer.splice(f,1)}}};dhtmlXGridObject.prototype.getFilterElement=function(d){if(!this.filters){return}for(var c=0;c<this.filters.length;c++){if(this.filters[c][1]==d){return(this.filters[c][0].combo||this.filters[c][0])}}return null};dhtmlXGridObject.prototype.collectValues=function(z){var d=this.dhxevs.data.oncollectvalues;if(d){var t=true;for(var i in d){var D=d[i].call(this,z);if(D!==true){t=D||t}}if(t!==true){return t}}if(this.isTreeGrid()){return this.collectTreeValues(z)}this.dma(true);this._build_m_order();z=this._m_order?this._m_order[z]:z;var v={};var x=[];var A=this._f_rowsBuffer||this.rowsBuffer;for(var y=0;y<A.length;y++){var C=this._get_cell_value(A[y],z);if(C&&(!A[y]._childIndexes||A[y]._childIndexes[z]!=A[y]._childIndexes[z-1])){v[C]=true}}this.dma(false);var u=(this.combos[z]||(this._col_combos&&this._col_combos[z]?this._col_combos[z]:((this._sub_trees&&this._sub_trees[z])?this._sub_trees[z][0]:false)));for(var w in v){if(v[w]===true){if(u){if(u.get&&u.get(w)){w=u.get(w)}else{if(u.getOption&&u.getOption(w)){w=u.getOption(w).text}else{if(u.getItemText){var f=u.getItemText(w);var c=this._sub_trees[z][1]=this._sub_trees[z][1]||{};c[f]=w;w=f}}}}x.push(w)}}return x.sort()};dhtmlXGridObject.prototype._build_m_order=function(){if(this._c_order){this._m_order=[];for(var b=0;b<this._c_order.length;b++){this._m_order[this._c_order[b]]=b}}};dhtmlXGridObject.prototype.filterByAll=function(){var l=[];var m=[];this._build_m_order();for(var j=0;j<this.filters.length;j++){var b=this._m_order?this._m_order[this.filters[j][1]]:this.filters[j][1];if(b>=this._cCount){continue}m.push(b);var a=this.filters[j][0].old_value=this.filters[j][0].value;if(this.filters[j][0]._filter){a=this.filters[j][0]._filter()}var i;if(typeof a!="function"&&(i=(this.combos[b]||((this._col_combos&&this._col_combos[b])?this._col_combos[b]:((this._sub_trees&&this._sub_trees[b])?this._sub_trees[b][1]:false))))){if(i.values){b=i.values._dhx_find(a);a=(b==-1)?a:i.keys[b]}else{if(i.getOptionByLabel){a=(i.getOptionByLabel(a)?i.getOptionByLabel(a).value:a)}else{a=i[a]}}}l.push(a)}if(!this.callEvent("onFilterStart",[m,l])){return}this.filterBy(m,l);if(this._cssEven){this._fixAlterCss()}this.callEvent("onFilterEnd",[this.filters]);if(this._f_rowsBuffer&&this.rowsBuffer.length==this._f_rowsBuffer.length){this._f_rowsBuffer=null}};dhtmlXGridObject.prototype.makeFilter=function(h,j,f){if(!this.filters){this.filters=[]}if(typeof(h)!="object"){h=document.getElementById(h)}if(!h){return}var g=this;if(!h.style.width){h.style.width="90%"}if(h.tagName=="SELECT"){this.filters.push([h,j]);this._loadSelectOptins(h,j);h.onchange=function(){g.filterByAll()};if(_isIE){h.style.marginTop="1px"}this.attachEvent("onEditCell",function(b,c,a){this._build_m_order();if(b==2&&this.filters&&(this._m_order?(a==this._m_order[j]):(a==j))){this._loadSelectOptins(h,j)}return true})}else{if(h.tagName=="INPUT"){this.filters.push([h,j]);h.old_value=h.value="";h.onkeydown=function(){if(this._timer){window.clearTimeout(this._timer)}this._timer=window.setTimeout(function(){if(h.value!=h.old_value){g.filterByAll();h.old_value=h.value}},500)}}else{if(h.tagName=="DIV"){this.filters.push([h,j]);h.style.padding="0px";h.style.margin="0px";if(!window.dhx_globalImgPath){window.dhx_globalImgPath=this.imgURL}var i=new dhtmlXCombo(h,"_filter","90%");i.filterSelfA=i.filterSelf;i.filterSelf=function(){if(this.getSelectedIndex()==0){this.setComboText("")}this.filterSelfA.apply(this,arguments);this.optionsArr[0].hide(false)};i.enableFilteringMode(true);h.combo=i;h.value="";this._loadComboOptins(h,j);i.attachEvent("onChange",function(){h.value=i.getSelectedValue();if(h.value===null){h.value=""}g.filterByAll()})}}}if(h.parentNode){h.parentNode.className+=" filter"}this._filters_ready()};dhtmlXGridObject.prototype.findCell=function(l,j,n,m){var m=m||(function(a,b){return b.toString().toLowerCase().indexOf(a)!=-1});if(m===true){m=function(a,b){return b.toString().toLowerCase()==a}}var o=new Array();l=l.toString().toLowerCase();if(typeof n!="number"){n=n?1:0}if(!this.rowsBuffer.length){return o}for(var h=(j||0);h<this._cCount;h++){if(this._h2){this._h2.forEachChild(0,function(a){if(n&&o.length==n){return o}if(m(l,this._get_cell_value(a.buff,h))){o.push([a.id,h])}},this)}else{for(var i=0;i<this.rowsBuffer.length;i++){if(m(l,this._get_cell_value(this.rowsBuffer[i],h))){o.push([this.rowsBuffer[i].idd,h]);if(n&&o.length==n){return o}}}}if(typeof(j)!="undefined"){return o}}return o};dhtmlXGridObject.prototype.makeSearch=function(g,h,f){if(typeof(g)!="object"){g=document.getElementById(g)}if(!g){return}var e=this;if(g.tagName=="INPUT"){g.onkeypress=function(){if(this._timer){window.clearTimeout(this._timer)}this._timer=window.setTimeout(function(){if(g.value==""){return}var a=e.findCell(g.value,h,true,f);if(a.length){if(e._h2){e.openItem(a[0][0])}e.selectCell(e.getRowIndex(a[0][0]),(h||0))}},500)}}if(g.parentNode){g.parentNode.className+=" filter"}};dhtmlXGridObject.prototype._loadSelectOptins=function(l,i){var f=this.collectValues(i);var c=l.value;l.innerHTML="";l.options[0]=new Option("","");var j=this._filter_tr?this._filter_tr[i]:null;for(var m=0;m<f.length;m++){l.options[l.options.length]=new Option(j?j(f[m]):f[m],f[m])}l.value=c};dhtmlXGridObject.prototype.setSelectFilterLabel=function(c,d){if(!this._filter_tr){this._filter_tr=[]}this._filter_tr[c]=d};dhtmlXGridObject.prototype._loadComboOptins=function(j,h){if(!j.combo){return}var g=this.collectValues(h);j.combo.clearAll();var i=[["",""]];for(var c=0;c<g.length;c++){i.push([g[c],g[c]])}j.combo.addOption(i)};dhtmlXGridObject.prototype.refreshFilters=function(){if(!this.filters){return}for(var b=0;b<this.filters.length;b++){switch(this.filters[b][0].tagName.toLowerCase()){case"input":break;case"select":this._loadSelectOptins.apply(this,this.filters[b]);break;case"div":this._loadComboOptins.apply(this,this.filters[b]);break}}};dhtmlXGridObject.prototype._filters_ready=function(c,d){this.attachEvent("onXLE",this.refreshFilters);this.attachEvent("onSyncApply",this.refreshFilters);this.attachEvent("onRowCreated",function(a,b){if(this._f_rowsBuffer){for(var f=0;f<this._f_rowsBuffer.length;f++){if(this._f_rowsBuffer[f].idd==a){return this._f_rowsBuffer[f]=b}}}});this.attachEvent("onClearAll",function(){this._f_rowsBuffer=null;if(!this.hdr.rows.length){this.filters=[]}});this.attachEvent("onSetSizes",this._filters_resize_combo);this.attachEvent("onResize",this._filters_resize_combo);this._filters_ready=function(){}};dhtmlXGridObject.prototype._filters_resize_combo=function(){if(!this.filters){return}for(var b=0;b<this.filters.length;b++){if(this.filters[b][0].combo!=null){this.filters[b][0].combo.setSize(Math.round(this.filters[b][0].offsetWidth*90/100))}}return true};dhtmlXGridObject.prototype._in_header_text_filter=function(c,d){c.innerHTML="<input type='text'>";c.onclick=c.onmousedown=function(a){(a||event).cancelBubble=true;return true};c.onselectstart=function(){return(event.cancelBubble=true)};this.makeFilter(c.firstChild,d)};dhtmlXGridObject.prototype._in_header_text_filter_inc=function(c,d){c.innerHTML="<input type='text'>";c.onclick=c.onmousedown=function(a){(a||event).cancelBubble=true;return true};c.onselectstart=function(){return(event.cancelBubble=true)};this.makeFilter(c.firstChild,d);c.firstChild._filter=function(){if(c.firstChild.value==""){return""}return function(a){return(a.toString().toLowerCase().indexOf(c.firstChild.value.toLowerCase())==0)}};this._filters_ready()};dhtmlXGridObject.prototype._in_header_select_filter=function(c,d){c.innerHTML="<select></select>";c.onclick=function(a){(a||event).cancelBubble=true;return false};this.makeFilter(c.firstChild,d)};dhtmlXGridObject.prototype._in_header_select_filter_strict=function(f,d){f.innerHTML="<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>";f.onclick=function(a){(a||event).cancelBubble=true;return false};this.makeFilter(f.firstChild,d);var e=this.combos;f.firstChild._filter=function(){var a=f.firstChild.value;if(!a){return""}if(e[d]){a=e[d].keys[e[d].values._dhx_find(a)]}a=a.toLowerCase();return function(b){return(b.toString().toLowerCase()==a)}};this._filters_ready()};dhtmlXGridObject.prototype._in_header_combo_filter=function(c,d){c.innerHTML="<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>";c.onselectstart=function(){return(event.cancelBubble=true)};c.onclick=c.onmousedown=function(a){(a||event).cancelBubble=true;return true};this.makeFilter(c.firstChild,d)};dhtmlXGridObject.prototype._search_common=function(c,d){c.innerHTML="<input type='text' style='width:90%; '>";c.onclick=c.onmousedown=function(a){(a||event).cancelBubble=true;return true};c.onselectstart=function(){return(event.cancelBubble=true)}};dhtmlXGridObject.prototype._in_header_text_search=function(f,d,e){this._search_common(f,d);this.makeSearch(f.firstChild,d)};dhtmlXGridObject.prototype._in_header_text_search_strict=function(c,d){this._search_common(c,d);this.makeSearch(c.firstChild,d,true)};dhtmlXGridObject.prototype._in_header_numeric_filter=function(c,d){this._in_header_text_filter.call(this,c,d);c.firstChild._filter=function(){var j=this.value;var h;var a="==";var i=parseFloat(j.replace("=",""));var b=null;if(j){if(j.indexOf("..")!=-1){j=j.split("..");i=parseFloat(j[0]);b=parseFloat(j[1]);return function(e){if(e>=i&&e<=b){return true}return false}}h=j.match(/>=|<=|>|</);if(h){a=h[0];i=parseFloat(j.replace(a,""))}return Function("v"," if (v "+a+" "+i+" ) return true; return false;")}return""}};dhtmlXGridObject.prototype._in_header_master_checkbox=function(h,c,g){h.innerHTML=g[0]+"<input type='checkbox' />"+g[1];var f=this;h.getElementsByTagName("input")[0].onclick=function(b){f._build_m_order();var d=f._m_order?f._m_order[c]:c;var a=this.checked?1:0;f.forEachRowA(function(e){var j=this.cells(e,d);if(j.isCheckbox()&&!j.isDisabled()){j.setValue(a);j.cell.wasChanged=true}this.callEvent("onEditCell",[1,e,d,a]);this.callEvent("onCheckbox",[e,d,a]);this.callEvent("onCheck",[e,d,a])});(b||event).cancelBubble=true}};dhtmlXGridObject.prototype._in_header_stat_total=function(c,f,g){var h=function(){var a=0;this._build_m_order();var b=this._m_order?this._m_order[f]:f;for(var d=0;d<this.rowsBuffer.length;d++){var e=parseFloat(this._get_cell_value(this.rowsBuffer[d],b));a+=isNaN(e)?0:e}return this._maskArr[b]?this._aplNF(a,b):(Math.round(a*100)/100)};this._stat_in_header(c,h,f,g,g)};dhtmlXGridObject.prototype._in_header_stat_multi_total=function(p,q,l){var m=l[1].split(":");l[1]="";for(var c=0;c<m.length;c++){m[c]=parseInt(m[c])}var o=function(){var a=0;for(var b=0;b<this.rowsBuffer.length;b++){var d=1;for(var e=0;e<m.length;e++){d*=parseFloat(this._get_cell_value(this.rowsBuffer[b],m[e]))}a+=isNaN(d)?0:d}return this._maskArr[q]?this._aplNF(a,q):(Math.round(a*100)/100)};var i=[];for(var n=0;n<m.length;n++){i[m[n]]=true}this._stat_in_header(p,o,i,l,l)};dhtmlXGridObject.prototype._in_header_stat_max=function(c,f,g){var h=function(){this._build_m_order();var b=this._m_order?this._m_order[f]:f;var a=-999999999;if(this.getRowsNum()==0){return"&nbsp;"}for(var d=0;d<this.rowsBuffer.length;d++){a=Math.max(a,parseFloat(this._get_cell_value(this.rowsBuffer[d],b)))}return this._maskArr[f]?this._aplNF(a,f):a};this._stat_in_header(c,h,f,g)};dhtmlXGridObject.prototype._in_header_stat_min=function(c,f,g){var h=function(){this._build_m_order();var b=this._m_order?this._m_order[f]:f;var a=999999999;if(this.getRowsNum()==0){return"&nbsp;"}for(var d=0;d<this.rowsBuffer.length;d++){a=Math.min(a,parseFloat(this._get_cell_value(this.rowsBuffer[d],b)))}return this._maskArr[f]?this._aplNF(a,f):a};this._stat_in_header(c,h,f,g)};dhtmlXGridObject.prototype._in_header_stat_average=function(c,f,g){var h=function(){this._build_m_order();var d=this._m_order?this._m_order[f]:f;var a=0;var b=0;if(this.getRowsNum()==0){return"&nbsp;"}for(var e=0;e<this.rowsBuffer.length;e++){var j=parseFloat(this._get_cell_value(this.rowsBuffer[e],d));if(!isNaN(j)){a+=j;b++}}return this._maskArr[f]?this._aplNF(a/b,f):(Math.round(a/b*100)/100)};this._stat_in_header(c,h,f,g)};dhtmlXGridObject.prototype._in_header_stat_count=function(c,f,g){var h=function(){return this.getRowsNum()};this._stat_in_header(c,h,f,g)};dhtmlXGridObject.prototype._stat_in_header=function(c,m,f,i){var l=this;var j=function(){this.dma(true);c.innerHTML=(i[0]?i[0]:"")+m.call(this)+(i[1]?i[1]:"");this.dma(false);this.callEvent("onStatReady",[])};if(!this._stat_events){this._stat_events=[];this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var a=0;a<this._stat_events.length;a++){for(var b=0;b<4;b++){this.detachEvent(this._stat_events[a][b])}}this._stat_events=[]}})}this._stat_events.push([this.attachEvent("onGridReconstructed",j),this.attachEvent("onXLE",j),this.attachEvent("onFilterEnd",j),this.attachEvent("onEditCell",function(d,a,b){if(d==2&&(b==f||(f&&f[b]))){j.call(this)}return true})]);c.innerHTML=""};dhtmlXGridObject.prototype.loadCSVFile=function(c,d){this.load(c,d,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(b){this._csvAID=dhx4.s2b(b)};dhtmlXGridObject.prototype.enableCSVHeader=function(b){this._csvHdr=dhx4.s2b(b)};dhtmlXGridObject.prototype.setCSVDelimiter=function(b){this.csv.cell=b};dhtmlXGridObject.prototype._csvAID=true;dhtmlXGridObject.prototype.loadCSVString=function(b){this.parse(b,"csv")};dhtmlXGridObject.prototype.serializeToCSV=function(i){this.editStop();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText||i){this._agetm="getTitle"}else{this._agetm="getValue"}}var l=[];if(this._csvHdr){for(var m=1;m<this.hdr.rows.length;m++){var a=[];for(var j=0;j<this._cCount;j++){if((!this._srClmn)||(this._srClmn[j])){a.push(this.getColumnLabel(j,m-1))}}l.push(this.csvParser.str(a,this.csv.cell,this.csv.row))}}var j=0;var n=this.rowsBuffer.length;for(j;j<n;j++){var o=this._serializeRowToCVS(null,j);if(o!=""){l.push(o)}}return this.csvParser.block(l,this.csv.row)};dhtmlXGridObject.prototype._serializeRowToCVS=function(y,q,w,s){var r=new Array();if(!y){y=this.render_row(q);if(this._fake&&!this._fake.rowsAr[y.idd]){this._fake.render_row(q)}}if(!this._csvAID){r[r.length]=y.idd}w=w||0;s=s||this._cCount;var o=false;var v=w;while(y.childNodes[w]._cellIndex>v&&w){w--}for(var p=w;v<s;p++){if(!y.childNodes[p]){break}var x=y.childNodes[p]._cellIndex;if(((!this._srClmn)||(this._srClmn[x]))&&(!this._serialize_visible||!this._hrrar[x])){var u=y.childNodes[p];var t=this.cells(y.idd,x);while(v!=x){v++;r.push("");if(v>=s){break}}if(v>=s){break}v++;if(t.cell){zxVal=t[this._agetm]()}else{zxVal=""}if((this._chAttr)&&(t.wasChanged())){o=true}r[r.length]=((zxVal===null)?"":zxVal);if(this._ecspn&&u.colSpan&&u.colSpan>1){u=u.colSpan-1;for(var i=0;i<u;i++){r[r.length]="";v++}}}else{v++}}if((this._onlChAttr)&&(!o)){return""}return this.csvParser.str(r,this.csv.cell,this.csv.row)};dhtmlXGridObject.prototype.toClipBoard=function(b){if(window.clipboardData){window.clipboardData.setData("Text",b)}else{(new Clipboard()).copy(b)}};dhtmlXGridObject.prototype.fromClipBoard=function(){if(window.clipboardData){return window.clipboardData.getData("Text")}else{return(new Clipboard()).paste()}};dhtmlXGridObject.prototype.cellToClipboard=function(f,d){if((!f)||(!d&&d!==0)){if(!this.selectedRows[0]){return}f=this.selectedRows[0].idd;d=this.cell._cellIndex}var e=this.cells(f,d);this.toClipBoard(((e.getLabel?e.getLabel():e.getValue())||"").toString())};dhtmlXGridObject.prototype.updateCellFromClipboard=function(f,d){if((!f)||(!d)){if(!this.selectedRows[0]){return}f=this.selectedRows[0].idd;d=this.cell._cellIndex}var e=this.cells(f,d);e[e.setImage?"setLabel":"setValue"](this.fromClipBoard())};dhtmlXGridObject.prototype.rowToClipboard=function(g){var f="";if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}this._serialize_visible=!this._fake;if(g){f=this._serializeRowToCVS(this.getRowById(g))}else{var h=[];for(var e=0;e<this.selectedRows.length;e++){h[h.length]=this._serializeRowToCVS(this.selectedRows[e]);f=this.csvParser.block(h,this.csv.row)}}this._serialize_visible=false;this.toClipBoard(f)};dhtmlXGridObject.prototype.updateRowFromClipboard=function(j){var h=this.fromClipBoard();if(!h){return}if(j){var l=this.getRowById(j)}else{var l=this.selectedRows[0]}if(!l){return}var i=this.csvParser;h=i.unblock(h,this.csv.cell,this.csv.row)[0];if(!this._csvAID){h.splice(0,1)}for(var m=0;m<h.length;m++){var g=this.cells3(l,m);g[g.setImage?"setLabel":"setValue"](h[m])}};dhtmlXGridObject.prototype.csvParser={block:function(d,c){return d.join(c)},unblock:function(i,h,j){var l=(i||"").split(j);for(var g=0;g<l.length;g++){l[g]=(l[g]||"").split(h)}var m=l.length-1;if(l[m].length==1&&l[m][0]==""){l.splice(m,1)}return l},str:function(d,e,f){return d.join(e)}};dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('""',"g"),block:function(d,c){return d.join(c)},unblock:function(t,q,i){var y=[[]];var z=0;if(!t){return y}var s=/^[ ]*"/;var u=/"[ ]*$/;var A=new RegExp(".*"+i+".*$");var w=t.split(q);for(var x=0;x<w.length;x++){if(w[x].match(s)){var p=w[x].replace(s,"");while(!w[x].match(u)){x++;p+=w[x]}y[z].push(p.replace(u,"").replace(this._quote_esc,'"'))}else{if(w[x].match(A)){var v=w[x].indexOf(i);y[z].push(w[x].substr(0,v));z++;y[z]=[];w[x]=w[x].substr(v+1);x--}else{if(w[x]||x!=w.length-1){y[z].push(w[x])}}}}var r=y.length-1;if(r>0&&!y[r].length){y.splice(r,1)}return y},str:function(h,f,g){for(var e=0;e<h.length;e++){h[e]='"'+h[e].replace(this._quote,'""')+'"'}return h.join(f)}};dhtmlXGridObject.prototype.addRowFromClipboard=function(){var e=this.fromClipBoard();if(!e){return}var f=this.csvParser.unblock(e,this.csv.cell,this.csv.row);for(var d=0;d<f.length;d++){if(f[d]){e=f[d];if(!e.length){continue}if(this._csvAID){this.addRow(this.getRowsNum()+2,e)}else{if(this.rowsAr[e[0]]){e[0]=this.uid()}this.addRow(e[0],e.slice(1))}}}};dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var b=this.fromClipBoard();if(!b){return}this.loadCSVString(b)};dhtmlXGridObject.prototype.getXLS=function(l){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(l||"")+"xls.php";this.xslform.method="post";this.xslform.target=(_isIE?"_blank":"");document.body.appendChild(this.xslform);var m=document.createElement("INPUT");m.type="hidden";m.name="csv";this.xslform.appendChild(m);var n=document.createElement("INPUT");n.type="hidden";n.name="csv_header";this.xslform.appendChild(n)}var j=this.serializeToCSV();this.xslform.childNodes[0].value=j;var o=[];var i=this._cCount;for(var h=0;h<i;h++){o.push(this.getHeaderCol(h))}o=o.join(",");this.xslform.childNodes[1].value=o;this.xslform.submit()};dhtmlXGridObject.prototype.printView=function(K,W){var O="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }	\n  </style>";var i=null;if(this._fake){i=[].concat(this._hrrar);for(var j=0;j<this._fake._cCount;j++){this._hrrar[j]=null}}var P=document.location.port;var N=document.location.hostname;O+="<base  href='"+(document.location.protocol+"//"+N+(P?(":"+P):"")+document.location.pathname)+"'></base>";if(!this.parentGrid){O+=(K||"")}O+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var M=Math.max(this.rowsBuffer.length,this.rowsCol.length);var Q=this._cCount;var J=this._printWidth();O+='<tr class="header_row_1">';for(var j=0;j<Q;j++){if(this._hrrar&&this._hrrar[j]){continue}var U=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(j)]:j];var X=(U.colSpan||1);var I=(U.rowSpan||1);for(var D=1;D<X;D++){J[j]+=J[D]}O+='<td rowspan="'+I+'" width="'+J[j]+'%" style="background-color:lightgrey;" colspan="'+X+'">'+this.getHeaderCol(j)+"</td>";j+=X-1}O+="</tr>";for(var j=2;j<this.hdr.rows.length;j++){if(_isIE){O+="<tr style='background-color:lightgrey' class='header_row_"+j+"'>";var V=this.hdr.rows[j].childNodes;for(var D=0;D<V.length;D++){if(!this._hrrar||!this._hrrar[V[D]._cellIndex]){O+=V[D].outerHTML}}O+="</tr>"}else{O+="<tr class='header_row_"+j+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[j].innerHTML:"")+this.hdr.rows[j].innerHTML+"</tr>"}}for(var j=0;j<M;j++){O+="<tr>";if(this.rowsCol[j]&&this.rowsCol[j]._cntr){O+=this.rowsCol[j].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";continue}if(this.rowsCol[j]&&this.rowsCol[j].style.display=="none"){continue}var S;if(this.rowsCol[j]){S=this.rowsCol[j].idd}else{if(this.rowsBuffer[j]){S=this.rowsBuffer[j].idd}else{continue}}for(var D=0;D<Q;D++){if(this._hrrar&&this._hrrar[D]){continue}if(this.rowsAr[S]&&this.rowsAr[S].tagName=="TR"){var L=this.cells(S,D);if(L._setState){var H=""}else{if(L.getContent){H=L.getContent()}else{if(L.getImage||L.combo){var H=L.cell.innerHTML}else{var H=L.getValue()}}}}else{var H=this._get_cell_value(this.rowsBuffer[j],D)}var F=this.columnColor[D]?"background-color:"+this.columnColor[D]+";":"";var E=this.cellAlign[D]?"text-align:"+this.cellAlign[D]+";":"";var d=L.getAttribute("colspan");O+='<td style="'+F+E+'" '+(d?'colSpan="'+d+'"':"")+">"+(H===""?"&nbsp;":H)+"</td>";if(d){D+=d-1}}O+="</tr>";if(this.rowsCol[j]&&this.rowsCol[j]._expanded){var T=this.cells4(this.rowsCol[j]._expanded.ctrl);if(T.getSubGrid){O+='<tr><td colspan="'+Q+'">'+T.getSubGrid().printView()+"</td></tr>"}else{O+='<tr><td colspan="'+Q+'">'+this.rowsCol[j]._expanded.innerHTML+"</td></tr>"}}}if(this.ftr){for(var j=1;j<this.ftr.childNodes[0].rows.length;j++){O+="<tr style='background-color:lightgrey'>"+((this._fake)?this._fake.ftr.childNodes[0].rows[j].innerHTML:"")+this.ftr.childNodes[0].rows[j].innerHTML+"</tr>"}}O+="</table>";if(this.parentGrid){return O}O+=(W||"");var c=window.open("","_blank");c.document.write(O);c.document.write("<script>window.onerror=function(){return true;}<\/script>");c.document.close();if(this._fake){this._hrrar=i}};dhtmlXGridObject.prototype._printWidth=function(){var m=[];var n=0;for(var o=0;o<this._cCount;o++){var i=this.getColWidth(o);m.push(i);n+=i}var j=[];var h=0;for(var o=0;o<m.length;o++){var l=Math.floor((m[o]/n)*100);h+=l;j.push(l)}j[j.length-1]+=100-h;return j};dhtmlXGridObject.prototype.enableBlockSelection=function(f){if(typeof this._bs_mode=="undefined"){var e=this;this.obj.onmousedown=function(a){if(e._bs_mode){e._OnSelectionStart((a||event),this)}return true};this._CSVRowDelimiter=this.csv.row;this.attachEvent("onResize",function(){e._HideSelection();return true});this.attachEvent("onGridReconstructed",function(){e._HideSelection();return true});this.attachEvent("onFilterEnd",this._HideSelection)}if(f===false){this._bs_mode=false;return this._HideSelection()}else{this._bs_mode=true}if(!window.dhx4.isIPad){var d=this._clip_area=document.createElement("textarea");d.className="dhx_tab_ignore";d.style.cssText="position:absolute; width:1px; height:1px; overflow:hidden; color:transparent; background-color:transparent; bottom:1px; right:1px; border:none;";d.onkeydown=function(a){a=a||event;if(a.keyCode==86&&(a.ctrlKey||a.metaKey)){e.pasteBlockFromClipboard()}};document.body.insertBefore(this._clip_area,document.body.firstChild);dhtmlxEvent(this.entBox,"click",function(){if(!e.editor&&e._clip_area){e._clip_area.select()}})}};dhtmlXGridObject.prototype.forceLabelSelection=function(b){this._strictText=dhx4.s2b(b)};dhtmlXGridObject.prototype.selectBlock=function(g,h,e,f){h=this.getRowIndex(h);f=this.getRowIndex(f);this._CreateSelection(h,g);this._selectionArea=this._RedrawSelectionPos(this.cells2(h,g).cell,this.cells2(f,e).cell);this._ShowSelection()};dhtmlXGridObject.prototype._OnSelectionStart=function(o,n){var h=this;if(o.button==2){return}var m=o.srcElement||o.target;if(this.editor){if(m.tagName&&(m.tagName=="INPUT"||m.tagName=="TEXTAREA")){return}this.editStop()}h.setActive(true);var j=this.getPosition(this.obj);var i=o.clientX-j[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0));var l=o.clientY-j[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));this._CreateSelection(i-4,l-4);if(m==this._selectionObj){this._HideSelection();this._startSelectionCell=null}else{while(m&&(!m.tagName||m.tagName.toLowerCase()!="td")){m=m.parentNode}this._startSelectionCell=m}if(this._startSelectionCell){if(!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex])){return this._startSelectionCell=null}}this.obj.onmousedown=null;this.obj[_isIE?"onmouseleave":"onmouseout"]=function(a){if(h._blsTimer){window.clearTimeout(h._blsTimer)}};this.obj.onmmold=this.obj.onmousemove;this._init_pos=[i,l];this._selectionObj.onmousemove=this.obj.onmousemove=function(a){a=a||o;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}h._OnSelectionMove(a)};this._oldDMP=document.body.onmouseup;document.body.onmouseup=function(a){a=a||o;h._OnSelectionStop(a,this);return true};this.callEvent("onBeforeBlockSelection",[]);document.body.onselectstart=function(){return false}};dhtmlXGridObject.prototype._getCellByPos=function(f,g){f=f;if(this._fake){f+=this._fake.objBox.scrollWidth}g=g;var e=0;for(var h=0;h<this.obj.rows.length;h++){g-=this.obj.rows[h].offsetHeight;if(g<=0){e=this.obj.rows[h];break}}if(!e||!e.idd){return null}for(var h=0;h<this._cCount;h++){f-=this.getColWidth(h);if(f<=0){while(true){if(e._childIndexes&&e._childIndexes[h+1]==e._childIndexes[h]){e=e.previousSibling}else{return this.cells(e.idd,h).cell}}}}return null};dhtmlXGridObject.prototype._OnSelectionMove=function(A){var a=this;this._ShowSelection();var t=this.getPosition(this.obj);var x=A.clientX-t[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0));var y=A.clientY-t[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if((Math.abs(this._init_pos[0]-x)<5)&&(Math.abs(this._init_pos[1]-y)<5)){return this._HideSelection()}var r=this._endSelectionCell;if(this._startSelectionCell==null){this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(A.srcElement||A.target,"TD")}else{if(A.srcElement||A.target){if((A.srcElement||A.target).className=="dhtmlxGrid_selection"){this._endSelectionCell=(this._getCellByPos(x,y)||this._endSelectionCell)}else{var b=this.getFirstParentOfType(A.srcElement||A.target,"TD");if(b.parentNode.idd){this._endSelectionCell=b}}}}if(this._endSelectionCell){if(!this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex])){this._endSelectionCell=r}}var z=this.objBox.scrollLeft+this.objBox.clientWidth;var D=this.objBox.scrollTop+this.objBox.clientHeight;var v=this.objBox.scrollLeft;var w=this.objBox.scrollTop;var C=false;if(this._blsTimer){window.clearTimeout(this._blsTimer)}if(x+20>=z){this.objBox.scrollLeft=this.objBox.scrollLeft+20;C=true}else{if(x-20<v){this.objBox.scrollLeft=this.objBox.scrollLeft-20;C=true}}if(y+20>=D&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop+20;C=true}else{if(y-20<w&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop-20;C=true}}this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell);if(C){var s=A.clientX;var u=A.clientY;this._blsTimer=window.setTimeout(function(){a._OnSelectionMove({clientX:s,clientY:u})},100)}};dhtmlXGridObject.prototype._OnSelectionStop=function(d){var e=this;if(this._blsTimer){window.clearTimeout(this._blsTimer)}this.obj.onmousedown=function(a){if(e._bs_mode){e._OnSelectionStart((a||d),this)}return true};this.obj.onmousemove=this.obj.onmmold||null;this._selectionObj.onmousemove=null;document.body.onmouseup=this._oldDMP||null;if(parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2){this._HideSelection()}else{var f=this.getFirstParentOfType(d.srcElement||d.target,"TD");if((!f)||(!f.parentNode.idd)){f=this._endSelectionCell}while(f&&(!f.tagName||f.tagName.toLowerCase()!="td")){f=f.parentNode}if(!f){return this._HideSelection()}this._stopSelectionCell=f;this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell);this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}};dhtmlXGridObject.prototype._RedrawSelectionPos=function(r,w){if(r.parentNode.grid!=w.parentNode.grid){return this._selectionArea}var t={};t.LeftTopCol=r._cellIndex;t.LeftTopRow=this.getRowIndex(r.parentNode.idd);t.RightBottomCol=w._cellIndex;t.RightBottomRow=this.getRowIndex(w.parentNode.idd);var z=r.offsetWidth;var A=r.offsetHeight;r=this.getPosition(r,this.obj);var q=w.offsetWidth;var v=w.offsetHeight;w=this.getPosition(w,this.obj);if(r[0]<w[0]){var y=r[0];var x=w[0]+q}else{var u=t.RightBottomCol;t.RightBottomCol=t.LeftTopCol;t.LeftTopCol=u;var y=w[0];var x=r[0]+z}if(r[1]<w[1]){var s=r[1];var D=w[1]+v}else{var u=t.RightBottomRow;t.RightBottomRow=t.LeftTopRow;t.LeftTopRow=u;var s=w[1];var D=r[1]+A}var p=x-y;var C=D-s;this._selectionObj.style.left=y+"px";this._selectionObj.style.top=s+"px";this._selectionObj.style.width=p+"px";this._selectionObj.style.height=C+"px";return t};dhtmlXGridObject.prototype._CreateSelection=function(e,f){if(this._selectionObj==null){var d=document.createElement("div");d.style.position="absolute";d.style.display="none";d.className="dhtmlxGrid_selection";this._selectionObj=d;this._selectionObj.onmousedown=function(a){a=a||event;if(a.button==2||(_isMacOS&&a.ctrlKey)){return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",a])}};this._selectionObj.oncontextmenu=function(a){(a||event).cancelBubble=true;return false};this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px";this._selectionObj.style.height="0px";this._selectionObj.style.left=e+"px";this._selectionObj.style.top=f+"px";this._selectionObj.startX=e;this._selectionObj.startY=f};dhtmlXGridObject.prototype._ShowSelection=function(){if(this._selectionObj){this._selectionObj.style.display=""}};dhtmlXGridObject.prototype._HideSelection=function(){if(this._selectionObj){this._selectionObj.style.display="none"}this._selectionArea=null;if(this._clip_area){this._clip_area.value="";this._clip_area.blur()}};dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(!this._clip_area){return}if(this._selectionArea!=null){var f=new Array();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}this._serialize_visible=true;for(var e=this._selectionArea.LeftTopRow;e<=this._selectionArea.RightBottomRow;e++){var d=this._serializeRowToCVS(this.rowsBuffer[e],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);if(!this._csvAID){f[f.length]=d.substr(d.indexOf(this.csv.cell)+1)}else{f[f.length]=d}}f=f.join(this._CSVRowDelimiter);this._clip_area.value=f;this._clip_area.select();this._serialize_visible=false}};dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){if(!this._clip_area){return}this._clip_area.select();var b=this;window.setTimeout(function(){b._pasteBlockFromClipboard();b=null},1)};dhtmlXGridObject.prototype._pasteBlockFromClipboard=function(){var v=this._clip_area.value;if(!v){return}if(this._selectionArea!=null){var j=this._selectionArea.LeftTopRow;var A=this._selectionArea.LeftTopCol}else{if(this.cell!=null&&!this.editor){var j=this.getRowIndex(this.cell.parentNode.idd);var A=this.cell._cellIndex}else{return false}}v=this.csvParser.unblock(v,this.csv.cell,this.csv.row);var u=j+v.length;var n=A+v[0].length;if(n>this._cCount){n=this._cCount}var x=0;for(var t=j;t<u;t++){var i=this.render_row(t);if(i==-1){continue}var y=0;for(var w=A;w<n;w++){if(this._hrrar[w]&&!this._fake){n=Math.min(n+1,this._cCount);continue}var s=this.cells3(i,w);if(s.isDisabled()){y++;continue}if(this._onEditUndoRedo){this._onEditUndoRedo(2,i.idd,w,v[x][y],s.getValue())}if(s.combo){var l=s.combo.values;for(var z=0;z<l.length;z++){if(v[x][y]==l[z]){s.setValue(s.combo.keys[z]);l=null;break}}if(l!=null&&s.editable){s.setValue(v[x][y++])}else{y++}}else{s[s.setImage?"setLabel":"setValue"](v[x][y++])}s.cell.wasChanged=true}this.callEvent("onRowPaste",[i.idd]);x++}};dhtmlXGridObject.prototype.getSelectedBlock=function(){if(this._selectionArea){return this._selectionArea}else{if(this.getSelectedRowId()!==null){return{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()}}else{return null}}};dhtmlXGridObject.prototype.enableSmartRendering=function(f,d,e){if(arguments.length>2){if(d&&!this.rowsBuffer[d-1]){this.rowsBuffer[d-1]=0}d=e}this._srnd=dhx4.s2b(f);this._srdh=this._srdh||20;this._dpref=d||0};dhtmlXGridObject.prototype.enablePreRendering=function(b){this._srnd_pr=parseInt(b||50)};dhtmlXGridObject.prototype.forceFullLoading=function(g,h){for(var j=0;j<this.rowsBuffer.length;j++){if(!this.rowsBuffer[j]){var i=g||(this.rowsBuffer.length-j);if(this.callEvent("onDynXLS",[j,i])){var f=this;this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+j+"&count="+i,function(){window.setTimeout(function(){f.forceFullLoading(g,h)},100)},this._data_type)}return}}if(h){h.call(this)}};dhtmlXGridObject.prototype.setAwaitedRowHeight=function(b){this._srdh=parseInt(b)};dhtmlXGridObject.prototype._get_view_size=function(){return Math.floor(parseInt(this.entBox.offsetHeight)/this._srdh)+2};dhtmlXGridObject.prototype._add_filler=function(j,i,h,n){if(!i){return null}var l="__filler__";var m=this._prepareRow(l);m.firstChild.style.width="1px";m.firstChild.style.borderWidth=m.firstChild.style.padding=m.firstChild.style.margin="0px";for(var o=1;o<m.childNodes.length;o++){m.childNodes[o].style.display="none"}m.firstChild.style.height=i*this._srdh+"px";h=h||this.rowsCol[j];if(h&&h.nextSibling){h.parentNode.insertBefore(m,h.nextSibling)}else{if(_isKHTML){this.obj.appendChild(m)}else{this.obj.rows[0].parentNode.appendChild(m)}}this.callEvent("onAddFiller",[j,i,m,h,n]);return[j,i,m]};dhtmlXGridObject.prototype._update_srnd_view=function(){var l=Math.floor(this.objBox.scrollTop/this._srdh);var h=l+this._get_view_size();if(this.multiLine){var j=this.objBox.scrollTop;l=0;while(j>0){j-=this.rowsCol[l]?this.rowsCol[l].offsetHeight:this._srdh;l++}h=l+this._get_view_size();if(l>0){l--}}h+=(this._srnd_pr||0);if(h>this.rowsBuffer.length){h=this.rowsBuffer.length}for(var n=l;n<h;n++){if(!this.rowsCol[n]){var m=this._add_from_buffer(n);if(m==-1){if(this.xmlFileUrl){if(this._dpref&&this.rowsBuffer[h-1]){var o=this._dpref?this._dpref:(h-n);var i=Math.max(0,Math.min(n,h-this._dpref));this._current_load=[i,h-i]}else{this._current_load=[n,(this._dpref?this._dpref:(h-n))]}if(this.callEvent("onDynXLS",this._current_load)){this.load(this.xmlFileUrl+dhtmlx.url(this.xmlFileUrl)+"posStart="+this._current_load[0]+"&count="+this._current_load[1],this._data_type)}}return}else{if(this._tgle){this._updateLine(this._h2.get[this.rowsBuffer[n].idd],this.rowsBuffer[n]);this._updateParentLine(this._h2.get[this.rowsBuffer[n].idd],this.rowsBuffer[n])}if(n&&n==(this._realfake?this._fake:this)["_r_select"]){this.selectCell(n,this.cell?this.cell._cellIndex:0,true)}}}}if(this._fake&&!this._realfake&&this.multiLine){this._fake.objBox.scrollTop=this.objBox.scrollTop}};dhtmlXGridObject.prototype._add_from_buffer=function(l){var j=this.render_row(l);if(j==-1){return -1}if(j._attrs.selected||j._attrs.select){this.selectRow(j,false,true);j._attrs.selected=j._attrs.select=null}if(!this._cssSP){if(this._cssEven&&l%2==0){j.className=this._cssEven+((j.className.indexOf("rowselected")!=-1)?" rowselected ":" ")+(j._css||"")}else{if(this._cssUnEven&&l%2==1){j.className=this._cssUnEven+((j.className.indexOf("rowselected")!=-1)?" rowselected ":" ")+(j._css||"")}}}else{if(this._h2){var h=this._h2.get[j.idd];j.className+=" "+((h.level%2)?(this._cssUnEven+" "+this._cssUnEven):(this._cssEven+" "+this._cssEven))+"_"+h.level+(this.rowsAr[h.id]._css||"")}}for(var f=0;f<this._fillers.length;f++){var m=this._fillers[f];if(m&&m[0]<=l&&(m[0]+m[1])>l){var i=l-m[0];if(i==0){this._insert_before(l,j,m[2]);this._update_fillers(f,-1,1)}else{if(i==m[1]-1){this._insert_after(l,j,m[2]);this._update_fillers(f,-1,0)}else{this._fillers.push(this._add_filler(l+1,m[1]-i-1,m[2],1));this._insert_after(l,j,m[2]);this._update_fillers(f,-m[1]+i,0)}}return}}};dhtmlXGridObject.prototype._update_fillers=function(h,f,g){var e=this._fillers[h];e[1]=e[1]+f;e[0]=e[0]+g;if(!e[1]){this.callEvent("onRemoveFiller",[e[2]]);e[2].parentNode.removeChild(e[2]);this._fillers.splice(h,1)}else{e[2].firstChild.style.height=parseFloat(e[2].firstChild.style.height)+f*this._srdh+"px";this.callEvent("onUpdateFiller",[e[2]])}};dhtmlXGridObject.prototype._insert_before=function(d,f,e){e.parentNode.insertBefore(f,e);this.rowsCol[d]=f;this.callEvent("onRowInserted",[f,null,e,"before"])};dhtmlXGridObject.prototype._insert_after=function(d,f,e){if(e.nextSibling){e.parentNode.insertBefore(f,e.nextSibling)}else{e.parentNode.appendChild(f)}this.rowsCol[d]=f;this.callEvent("onRowInserted",[f,null,e,"after"])};if(typeof(window.dhtmlxValidation)!="undefined"){dhtmlxValidation.trackInput=function(h,g,e,f){dhtmlxEvent(h,"keyup",function(a){if(dhtmlxValidation._timer){window.clearTimeout(dhtmlxValidation._timer);dhtmlxValidation._timer=null}dhtmlxValidation._timer=window.setTimeout(function(){if(!dhtmlxValidation.checkInput(h,g)){if(!e||e(h,h.value,g)){h.className+=" dhtmlx_live_validation_error"}}else{h.className=h.className.replace(/[ ]*dhtmlx_live_validation_error/g,"");if(f){f(h,h.value,g)}}},250)})};dhtmlxValidation.checkInput=function(d,c){return dhtmlxValidation.checkValue(d.value,c)};dhtmlxValidation.checkValue=function(h,g){if(typeof g=="string"){g=g.split(",")}var f=true;for(var e=0;e<g.length;e++){if(!this["is"+g[e]]){alert("Incorrect validation rule: "+g[e])}else{f=f&&this["is"+g[e]](h)}}return f}}dhtmlXGridObject.prototype.enableValidation=function(c,d){c=dhx4.s2b(c);if(c){this._validators={data:[]}}else{this._validators=false}if(arguments.length>1){this._validators._live=d}if(!this._validators._event){this._validators._event=this.attachEvent("onEditCell",this.validationEvent)}};dhtmlXGridObject.prototype.setColValidators=function(b){if(!this._validators){this.enableValidation(true)}if(typeof b=="string"){b=b.split(this.delim)}this._validators.data=b};dhtmlXGridObject.prototype.validationEvent=function(n,r,p,q,l){var j=this._validators;if(!j){return true}var m=(j.data[p]||this.cells(r,p).getAttribute("validate"))||"";if(n==1&&m){var o=this.editor||(this._fake||{}).editor;if(!o){return true}o.cell.className=o.cell.className.replace(/[ ]*dhtmlx_validation_error/g,"");if(j._live){var s=this;dhtmlxValidation.trackInput(o.getInput(),m,function(c,b,a){return s.callEvent("onLiveValidationError",[r,p,b,c,a])},function(c,b,a){return s.callEvent("onLiveValidationCorrect",[r,p,b,c,a])})}}if(n==2){this.validateCell(r,p,m,q)}return true};dhtmlXGridObject.prototype.validateCell=function(j,m,l,n){l=l||(this._validators.data[m]||this.cells(j,m).getAttribute("validate"));n=n||this.cells(j,m).getValue();if(!l){return}var h=this.cells(j,m).cell;var i=true;if(typeof l=="string"){l=l.split(this.delim)}for(var o=0;o<l.length;o++){if(!dhtmlxValidation.checkValue(n,l[o])){if(this.callEvent("onValidationError",[j,m,n,l[o]])){h.className+=" dhtmlx_validation_error"}i=false}}if(i){this.callEvent("onValidationCorrect",[j,m,n,l]);h.className=h.className.replace(/[ ]*dhtmlx_validation_error/g,"")}return i};function eXcell_stree(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid;if(!this.grid._sub_trees){return}this._sub=this.grid._sub_trees[b._cellIndex];if(!this._sub){return}this._sub=this._sub[0]}this.getValue=function(){return this.cell._val};this.setValue=function(a){this.cell._val=a;a=this._sub.getItemText(this.cell._val);this.setCValue((a||"&nbsp;"),a)};this.edit=function(){this._sub.parentObject.style.display="block";var d=this.grid.getPosition(this.cell);this._sub.parentObject.style.top=d[1]+"px";this._sub.parentObject.style.left=d[0]+"px";this._sub.parentObject.style.position="absolute";var a=this.grid.editStop;this.grid.editStop=function(){};this.grid.editStop=a};this.detach=function(){this._sub.parentObject.style.display="none";if(this.grid._sub_id!=null){var a=this.cell._val;this.setValue(this._sub.getSelectedItemId());this.grid._sub_id=null;return this.cell._val!=a}}}eXcell_stree.prototype=new eXcell;dhtmlXGridObject.prototype.setSubTree=function(e,d){if(!this._sub_trees){this._sub_trees=[]}this._sub_trees[d]=[e];e.parentObject.style.display="none";var f=this;e.parentObject.onclick=function(a){(a||window.event).cancelBubble=true;return false};e.ev_onDblClick=null;e.attachEvent("onDblClick",function(a){f._sub_id=a;f.editStop();return true});e._chRRS=true};function eXcell_link(b){this.cell=b;this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return true};this.edit=function(){};this.getValue=function(){if(this.cell.firstChild.getAttribute){var a=this.cell.firstChild.getAttribute("target");return this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href")+(a?("^"+a):"")}else{return""}};this.setValue=function(d){if((typeof(d)!="number")&&(!d||d.toString()._dhx_trim()=="")){this.setCValue("&nbsp;",a);return(this.cell._clearCell=true)}var a=d.split("^");if(a.length==1){a[1]=""}else{if(a.length>1){a[1]="href='"+a[1]+"'";if(a.length==3){a[1]+=" target='"+a[2]+"'"}else{a[1]+=" target='_blank'"}}}this.setCValue("<a "+a[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+a[0]+"</a>",a)}}eXcell_link.prototype=new eXcell;eXcell_link.prototype.getTitle=function(){var b=this.cell.firstChild;return((b&&b.tagName)?b.getAttribute("href"):"")};eXcell_link.prototype.getContent=function(){var b=this.cell.firstChild;return((b&&b.tagName)?b.innerHTML:"")};function eXcell_grid(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid;if(!this.grid._sub_grids){return}this._sub=this.grid._sub_grids[b._cellIndex];if(!this._sub){return}this._sindex=this._sub[1];this._sub=this._sub[0]}this.getValue=function(){return this.cell.val};this.setValue=function(a){this.cell.val=a;if(this._sub.getRowById(a)){a=this._sub.cells(a,this._sindex);if(a){a=a.getValue()}else{a=""}}this.setCValue((a||"&nbsp;"),a)};this.edit=function(){this.val=this.cell.val;this._sub.entBox.style.display="block";var d=this.grid.getPosition(this.cell);this._sub.entBox.style.top=d[1]+"px";this._sub.entBox.style.left=d[0]+"px";this._sub.entBox.style.position="absolute";this._sub.setSizes();var a=this.grid.editStop;this.grid.editStop=function(){};if(this._sub.getRowById(this.cell.val)){this._sub.setSelectedRow(this.cell.val)}this._sub.setActive(true);this.grid.editStop=a};this.detach=function(){var a=this.cell.val;this._sub.entBox.style.display="none";if(this._sub.getSelectedId()===null){return false}this.setValue(this._sub.getSelectedId());this.grid.setActive(true);return this.cell.val!=a}}eXcell_grid.prototype=new eXcell;dhtmlXGridObject.prototype.setSubGrid=function(e,f,g){if(!this._sub_grids){this._sub_grids=[]}this._sub_grids[f]=[e,g];e.entBox.style.display="none";var h=this;e.entBox.onclick=function(a){(a||window.event).cancelBubble=true;return false};e.attachEvent("onRowSelect",function(a){h.editStop();return true});e._chRRS=false};function eXcell_dhxCalendar(f){if(f){this.cell=f;this.grid=this.cell.parentNode.grid;if(!this.grid._grid_calendarA){var h=this.grid._grid_calendarA=new dhtmlxCalendarObject();this.grid.callEvent("onDhxCalendarCreated",[h]);var e=this.grid;h.attachEvent("onClick",function(){this._last_operation_calendar=true;window.setTimeout(function(){e.editStop()},1);return true});var g=function(a){(a||event).cancelBubble=true};dhtmlxEvent(h.base,"click",g);h=null}}}eXcell_dhxCalendar.prototype=new eXcell;eXcell_dhxCalendar.prototype.edit=function(){var e=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(false,false);var h=0;if(!window.innerHeight||(e[1]+this.grid._grid_calendarA.base.offsetHeight+this.cell.offsetHeight<window.innerHeight)){h=e[1]+this.cell.offsetHeight}else{h=e[1]-(this.grid._grid_calendarA.base.offsetHeight)}var g=e[0];if(window.innerWidth&&(g+this.grid._grid_calendarA.base.clientWidth+this.cell.offsetWidth>window.innerWidth)){g=window.innerWidth-this.grid._grid_calendarA.base.clientWidth}this.grid._grid_calendarA.setPosition(g,h);this.grid._grid_calendarA._last_operation_calendar=false;this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.cell._cediton=true;this.val=this.cell.val;this._val=this.cell.innerHTML;var f=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat((this.grid._dtmask||"%d/%m/%Y"));this.grid._grid_calendarA.setDate(this.val||(new Date()));this.grid._grid_calendarA.draw=f};eXcell_dhxCalendar.prototype.getDate=function(){if(this.cell.val){return this.cell.val}return null};eXcell_dhxCalendar.prototype.getValue=function(){if(this.cell._clearCell){return""}if(this.grid._dtmask_inc&&this.cell.val){return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString()}return this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendar.prototype.detach=function(){if(!this.grid._grid_calendarA){return}this.grid._grid_calendarA.hide();if(this.cell._cediton){this.cell._cediton=false}else{return}if(this.grid._grid_calendarA._last_operation_calendar){var f=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"));var d=this.grid._grid_calendarA.getDate();this.cell.val=new Date(d);this.setCValue(f,d);this.cell._clearCell=!f;var e=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(e||"").valueOf())}return false};eXcell_dhxCalendar.prototype.setValue=function(b){if(b&&typeof b=="object"){this.cell.val=b;this.cell._clearCell=false;this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),b).toString(),this.cell.val);return}if(!b||b.toString()._dhx_trim()==""){b="&nbsp";this.cell._clearCell=true;this.cell.val=""}else{this.cell._clearCell=false;this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y"),b.toString(),null,true));if(this.grid._dtmask_inc){b=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),this.cell.val)}}if((this.cell.val=="NaN")||(this.cell.val=="Invalid Date")){this.cell._clearCell=true;this.cell.val=new Date();this.setCValue("&nbsp;",0)}else{this.setCValue((b||"").toString(),this.cell.val)}};function eXcell_dhxCalendarA(f){if(f){this.cell=f;this.grid=this.cell.parentNode.grid;if(!this.grid._grid_calendarA){var h=this.grid._grid_calendarA=new dhtmlxCalendarObject();this.grid.callEvent("onDhxCalendarCreated",[h]);var e=this.grid;h.attachEvent("onClick",function(){this._last_operation_calendar=true;window.setTimeout(function(){e.editStop()},1);return true});var g=function(a){(a||event).cancelBubble=true};dhtmlxEvent(h.base,"click",g)}}}eXcell_dhxCalendarA.prototype=new eXcell;eXcell_dhxCalendarA.prototype.edit=function(){var c=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(false,false);this.grid._grid_calendarA.setPosition(c[0]*1+this.cell.offsetWidth,c[1]*1);this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid._grid_calendarA._last_operation_calendar=false;this.cell._cediton=true;this.val=this.cell.val;this._val=this.cell.innerHTML;var d=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat((this.grid._dtmask||"%d/%m/%Y"));this.grid._grid_calendarA.setDate(this.val);this.grid._grid_calendarA.draw=d;this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.atag);this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(a){(a||event).cancelBubble=true};this.obj.onmousedown=function(a){(a||event).cancelBubble=true};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(window.dhx4.isIE){this.obj.style.overflow="visible";if((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}}this.obj.onselectstart=function(a){if(!a){a=event}a.cancelBubble=true;return true};this.obj.focus();this.obj.focus()};eXcell_dhxCalendarA.prototype.getDate=function(){if(this.cell.val){return this.cell.val}return null};eXcell_dhxCalendarA.prototype.getValue=function(){if(this.cell._clearCell){return""}if(this.grid._dtmask_inc&&this.cell.val){return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString()}return this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendarA.prototype.detach=function(){if(!this.grid._grid_calendarA){return}this.grid._grid_calendarA.hide();if(this.cell._cediton){this.cell._cediton=false}else{return}if(this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=false;var f=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y");var d=this.grid._grid_calendarA.getDate();this.cell.val=new Date(d);this.setCValue(f,d);this.cell._clearCell=!f;var e=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(e||"").valueOf())}this.setValue(this.obj.value);var e=this.val;this.val=this._val;return(this.cell.val.valueOf()!=(e||"").valueOf())};eXcell_dhxCalendarA.prototype.setValue=function(b){if(b&&typeof b=="object"){this.cell.val=b;this.cell._clearCell=false;this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),b).toString(),this.cell.val);return}if(!b||b.toString()._dhx_trim()==""){b="&nbsp";this.cell._clearCell=true;this.cell.val=""}else{this.cell._clearCell=false;this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y"),b.toString(),null,true));if(this.grid._dtmask_inc){b=this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask||"%d/%m/%Y"),this.cell.val)}}if((this.cell.val=="NaN")||(this.cell.val=="Invalid Date")){this.cell.val=new Date();this.cell._clearCell=true;this.setCValue("&nbsp;",0)}else{this.setCValue((b||"").toString(),this.cell.val)}};function eXcell_cntr(d){this.cell=d;this.grid=this.cell.parentNode.grid;if(!this.grid._ex_cntr_ready&&!this._realfake){this.grid._ex_cntr_ready=true;if(this.grid._h2){this.grid.attachEvent("onOpenEn",function(a){this.resetCounter(d._cellIndex)})}var c=function(){var a=this;window.setTimeout(function(){if(!a.resetCounter){return}if(a._fake&&!a._realfake&&d._cellIndex<a._fake._cCount){a._fake.resetCounter(d._cellIndex)}else{a.resetCounter(d._cellIndex)}},1);return true};this.grid.attachEvent("onBeforeSorting",c);this.grid.attachEvent("onFilterEnd",c)}this.edit=function(){};this.getValue=function(){return this.cell.innerHTML};this.setValue=function(a){this.cell.style.paddingRight="2px";var b=this.cell;window.setTimeout(function(){if(!b.parentNode){return}var f=b.parentNode.rowIndex;if(b.parentNode.grid.currentPage||f<0||b.parentNode.grid._srnd){f=b.parentNode.grid.rowsBuffer._dhx_find(b.parentNode)+1}if(f<=0){return}b.innerHTML=f;if(b.parentNode.grid._fake&&b._cellIndex<b.parentNode.grid._fake._cCount&&b.parentNode.grid._fake.rowsAr[b.parentNode.idd]){b.parentNode.grid._fake.cells(b.parentNode.idd,b._cellIndex).setCValue(f)}b=null},100)}}dhtmlXGridObject.prototype.resetCounter=function(c){if(this._fake&&!this._realfake&&c<this._fake._cCount){this._fake.resetCounter(c,this.currentPage)}var d=arguments[0]||0;if(this.currentPage){d=(this.currentPage-1)*this.rowsBufferOutSize}for(d=0;d<this.rowsBuffer.length;d++){if(this.rowsBuffer[d]&&this.rowsBuffer[d].tagName=="TR"&&this.rowsAr[this.rowsBuffer[d].idd]){this.rowsAr[this.rowsBuffer[d].idd].childNodes[c].innerHTML=d+1}}};eXcell_cntr.prototype=new eXcell;function eXcell_acheck(d){try{this.cell=d;this.grid=this.cell.parentNode.grid;this.cell.obj=this}catch(c){}this.changeState=function(){if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return}if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=false){this.val=this.getValue();if(this.val=="1"){this.setValue("<checkbox state='false'>")}else{this.setValue("<checkbox state='true'>")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.getValue=function(){try{return this.cell.chstate.toString()}catch(a){return null}};this.isCheckbox=function(){return true};this.isChecked=function(){if(this.getValue()=="1"){return true}else{return false}};this.setChecked=function(a){this.setValue(a.toString())};this.detach=function(){return this.val!=this.getValue()};this.drawCurrentState=function(){if(this.cell.chstate==1){return"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;'  style='cursor:pointer; font-weight:bold; text-align:center; '><span style='height:8px; width:8px; background:green; display:inline-block;'></span>&nbsp;Yes</div>"}else{return"<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;' style='cursor:pointer;  text-align:center; '><span style='height:8px; width:8px; background:red; display:inline-block;'></span>&nbsp;No</div>"}}}eXcell_acheck.prototype=new eXcell;eXcell_acheck.prototype.setValue=function(c){c=(c||"").toString();if(c.indexOf("1")!=-1||c.indexOf("true")!=-1){c="1";this.cell.chstate="1"}else{c="0";this.cell.chstate="0"}var d=this;this.setCValue(this.drawCurrentState(),this.cell.chstate)};function eXcell_context(b){if(b){this.cell=b;this.grid=this.cell.parentNode.grid;if(!this.grid._sub_context){return}this._sub=this.grid._sub_context[b._cellIndex];if(!this._sub){return}this._sindex=this._sub[1];this._sub=this._sub[0]}this.getValue=function(){return _isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(d){this.cell._val=d;var a=this._sub.itemPull[this._sub.idPrefix+this.cell._val];d=a?a.title:d;this.setCValue((d||"&nbsp;"),d)};this.edit=function(){var d=this.grid.getPosition(this.cell);this._sub.showContextMenu(d[0]+this.cell.offsetWidth,d[1]);var a=this.grid.editStop;this.grid.editStop=function(){};this.grid.editStop=a};this.detach=function(){if(this.grid._sub_id!=null){var a=this.cell._val;this.setValue(this.grid._sub_id);this.grid._sub_id=null;return this.cell._val!=a}this._sub.hideContextMenu()}}eXcell_context.prototype=new eXcell;dhtmlXGridObject.prototype.setSubContext=function(f,e,g){var h=this;f.attachEvent("onClick",function(a,b){h._sub_id=a;h.editStop();f.hideContextMenu();return true});if(!this._sub_context){this._sub_context=[]}this._sub_context[e]=[f,g];f.hideContextMenu()};dhtmlXGridObject.prototype._process_json_row=function(h,g){h._attrs=g;for(var j=0;j<h.childNodes.length;j++){h.childNodes[j]._attrs={}}if(g.userdata){for(var a in g.userdata){this.setUserData(h.idd,a,g.userdata[a])}}g=this._c_order?this._swapColumns(g.data):g.data;for(var i=0;i<g.length;i++){if(typeof g[i]=="object"&&g[i]!=null){h.childNodes[i]._attrs=g[i];if(g[i].type){h.childNodes[i]._cellType=g[i].type}g[i]=g[i].value}}this._fillRow(h,g);return h};dhtmlXGridObject.prototype._process_js_row=function(i,h){i._attrs=h;for(var l=0;l<i.childNodes.length;l++){i.childNodes[l]._attrs={}}if(h.userdata){for(var m in h.userdata){this.setUserData(i.idd,m,h.userdata[m])}}var a=[];for(var j=0;j<this.columnIds.length;j++){a[j]=h[this.columnIds[j]];if(typeof a[j]=="object"&&a[j]!=null){i.childNodes[j]._attrs=a[j];if(a[j].type){i.childNodes[j]._cellType=a[j].type}a[j]=a[j].value}if(!a[j]&&a[j]!==0){a[j]=""}}this._fillRow(i,a);return i};dhtmlXGridObject.prototype.updateFromJSON=function(f,g,e,h){if(typeof g=="undefined"){g=true}this._refresh_mode=[true,g,e];this.load(f,h,"json")},dhtmlXGridObject.prototype._refreshFromJSON=function(s){if(this._f_rowsBuffer){this.filterBy(0,"")}reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(a){var b=this.grid._h2.get[this.cell.parentNode.idd];if(b&&this.cell.parentNode.valTag){this.setLabel(a)}else{this.setValueX(a)}}}var i=this.cellType._dhx_find("tree");var q=s.parent||0;var o={};if(this._refresh_mode[2]){if(i!=-1){this._h2.forEachChild(q,function(a){o[a.id]=true},this)}else{this.forEachRow(function(a){o[a]=true})}}var m=s.rows;for(var r=0;r<m.length;r++){var n=m[r];var u=n.id;o[u]=false;if(this.rowsAr[u]&&this.rowsAr[u].tagName!="TR"){if(this._h2){this._h2.get[u].buff.data=n}else{this.rowsBuffer[this.getRowIndex(u)].data=n}this.rowsAr[u]=n}else{if(this.rowsAr[u]){this._process_json_row(this.rowsAr[u],n,-1);this._postRowProcessing(this.rowsAr[u],true)}else{if(this._refresh_mode[1]){var p={idd:u,data:n,_parser:this._process_json_row,_locator:this._get_json_data};var t=this.rowsBuffer.length;if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(p);t=0}else{this.rowsBuffer.push(p)}if(this._h2){reset=true;(this._h2.add(u,q)).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[u]=n;n=this.render_row(t);this._insertRowAt(n,t?-1:0)}}}}if(this._refresh_mode[2]){for(u in o){if(o[u]&&this.rowsAr[u]){this.deleteRow(u)}}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}if(reset){this._renderSort()}if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},dhtmlXGridObject.prototype._process_js=function(b){return this._process_json(b,"js")};dhtmlXGridObject.prototype._parseOptionsJson=function(m){if(m.coll_options){for(var g in m.coll_options){var j=m.coll_options[g];var l=this.getColIndexById(g);var i;if(this.cellType[l]=="combo"){var i=this.getColumnCombo(l);i.addOption(j)}else{if(this.cellType[l].indexOf("co")==0){var i=this.getCombo(l);for(var h=0;h<j.length;h++){i.put(j[h].value,j[h].label)}}}}this._colls_loaded=true}};dhtmlXGridObject.prototype._parseHeadJson=function(q){if(!q.head||!q.head.length){return}var A=q.head;var x=q.settings;var u="setInitWidths";var s=false;if(x&&x.colwidth=="%"){u="setInitWidthsP"}if(x&&x.splitat=="%"){s=x.splitat}if(this.hdr.rows.length>0){this.clearAll(true)}var t=[[],[],[],[],[],[],[]];var r=["value","width","type","align","sort","hidden","id"];var i=["",u,"setColTypes","setColAlign","setColSorting","","setColumnIds"];for(var v=0;v<A.length;v++){for(var w=0;w<r.length;w++){t[w].push(A[v][r[w]])}}this.setHeader(t[0]);for(var v=0;v<i.length;v++){if(i[v]){this[i[v]](t[v].join(this.delim))}}for(var v=0;v<A.length;v++){var j=A[v].options;if(A[v].options){if(this.cellType[v]=="clist"){this.registerCList(v,j)}else{var z=this.getCombo(v);for(var w=0;w<j.length;w++){z.put(j[w].id,j[w].value)}}}}this.init();var y=t[5].join(this.delim);if(this.setColHidden&&y.replace(/,/g,"")!=""){this.setColHidden(y)}if((s)&&(this.splitAt)){this.splitAt(s)}};dhtmlXGridObject.prototype._process_json=function(data,mode){this._parsing=true;try{var data=data.responseText||data;if(typeof data=="string"){eval("dhtmlx.temp="+data+";");data=dhtmlx.temp}}catch(e){dhx4.callEvent("onLoadXMLError",["Incorrect JSON",(data.xmlDoc||data),this]);data={rows:[]}}if(this._refresh_mode){return this._refreshFromJSON(data)}if(data.head){this._parseHeadJson(data)}this._parseOptionsJson(data);var cr=parseInt(data.pos||0);var total=parseInt(data.total_count||0);var reset=false;if(total){if(!this.rowsBuffer[total-1]){if(this.rowsBuffer.length){reset=true}this.rowsBuffer[total-1]=null}if(total<this.rowsBuffer.length){this.rowsBuffer.splice(total,this.rowsBuffer.length-total);reset=true}}var userdata=mode==="js"?data.userdata:data;for(var key in userdata){if(mode==="js"||key!="rows"){this.setUserData("",key,userdata[key])}}if(mode=="js"&&data.collections){for(var colkey in data.collections){var index=this.getColIndexById(colkey);var colrecs=data.collections[colkey];if(index!==window.undefined){if(this.cellType[index]=="clist"){colplaindata=[];for(var j=0;j<colrecs.length;j++){colplaindata.push(colrecs[j].label)}this.registerCList(index,colplaindata)}else{var combo=this.getCombo(index);for(var j=0;j<colrecs.length;j++){combo.put(colrecs[j].value,colrecs[j].label)}}}}}if(this.isTreeGrid()){return this._process_tree_json(data,null,null,mode)}if(mode=="js"){if(data.data){data=data.data}for(var i=0;i<data.length;i++){if(this.rowsBuffer[i+cr]){continue}var row=data[i];var id=row.id||(i+1);this.rowsBuffer[i+cr]={idd:id,data:row,_parser:this._process_js_row,_locator:this._get_js_data};this.rowsAr[id]=data[i]}}else{for(var i=0;i<data.rows.length;i++){if(this.rowsBuffer[i+cr]){continue}var id=data.rows[i].id;this.rowsBuffer[i+cr]={idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data};this.rowsAr[id]=data.rows[i]}}this.callEvent("onDataReady",[]);if(reset&&this._srnd){var h=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=h}else{this.render_dataset()}this._parsing=false};dhtmlXGridObject.prototype._get_json_data=function(d,e){var f=d.data[e];if(typeof f=="object"){return f?f.value:""}else{return f}};dhtmlXGridObject.prototype._process_tree_json=function(p,o,i,m){this._parsing=true;var j=false;if(!o){this.render_row=this.render_row_tree;j=true;o=p;i=o.parent||0;if(i=="0"){i=0}if(!this._h2){this._h2=this._createHierarchy()}if(this._fake){this._fake._h2=this._h2}}if(m=="js"){if(o.data&&!i){p=o.data}if(o.rows){o=o.rows}for(var q=0;q<o.length;q++){var l=o[q].id;var n=this._h2.add(l,i);n.buff={idd:l,data:o[q],_parser:this._process_js_row,_locator:this._get_js_data};if(o[q].open){n.state="minus"}this.rowsAr[l]=n.buff;this._process_tree_json(o[q],o[q],l,m)}}else{if(o.rows){for(var q=0;q<o.rows.length;q++){var l=o.rows[q].id;var n=this._h2.add(l,i);n.buff={idd:l,data:o.rows[q],_parser:this._process_json_row,_locator:this._get_json_data};if(o.rows[q].open){n.state="minus"}this.rowsAr[l]=n.buff;this._process_tree_json(o.rows[q],o.rows[q],l,m)}}}if(j){if(i!=0){this._h2.change(i,"state","minus")}this._updateTGRState(this._h2.get[i]);this._h2_to_buff();this.callEvent("onDataReady",[]);if(i!=0&&(this._srnd||this.pagingOn)){this._renderSort()}else{this.render_dataset()}if(this._slowParse===false){this.forEachRow(function(a){this.render_row_tree(0,a)})}this._parsing=false;if(i!=0&&!this._srnd){this.callEvent("onOpenEnd",[i,1])}}};function dhtmlXGridFromTable(obj,init){if(typeof(obj)!="object"){obj=document.getElementById(obj)}var w=document.createElement("DIV");w.setAttribute("width",obj.getAttribute("gridWidth")||(obj.offsetWidth?(obj.offsetWidth+"px"):0)||(window.getComputedStyle?window.getComputedStyle(obj,null)["width"]:(obj.currentStyle?obj.currentStyle.width:0)));w.setAttribute("height",obj.getAttribute("gridHeight")||(obj.offsetHeight?(obj.offsetHeight+"px"):0)||(window.getComputedStyle?window.getComputedStyle(obj,null)["height"]:(obj.currentStyle?obj.currentStyle.height:0)));w.className=obj.className;obj.className="";if(obj.id){w.id=obj.id}var mr=obj;var drag=obj.getAttribute("dragAndDrop");mr.parentNode.insertBefore(w,mr);var f=mr.getAttribute("name")||("name_"+(new Date()).valueOf());var windowf=new dhtmlXGridObject(w);window[f]=windowf;var acs=mr.getAttribute("onbeforeinit");var acs2=mr.getAttribute("oninit");if(acs){eval(acs)}windowf.setImagePath(windowf.imgURL||(mr.getAttribute("imgpath")||mr.getAttribute("image_path")||""));var skin=mr.getAttribute("skin");if(skin){windowf.setSkin(skin)}if(init){init(windowf)}var hrow=mr.rows[0];var za=[];var zb="";var zc="";var zd="";var ze="";for(var i=0;i<hrow.cells.length;i++){za.push(hrow.cells[i].innerHTML);var width=hrow.cells[i].getAttribute("width")||hrow.cells[i].offsetWidth||(window.getComputedStyle?window.getComputedStyle(hrow.cells[i],null)["width"]:(hrow.cells[i].currentStyle?hrow.cells[i].currentStyle.width:0));zb+=(zb?",":"")+(width=="*"?width:parseInt(width));zc+=(zc?",":"")+(hrow.cells[i].getAttribute("align")||"left");zd+=(zd?",":"")+(hrow.cells[i].getAttribute("type")||"ed");ze+=(ze?",":"")+(hrow.cells[i].getAttribute("sort")||"str");var f_a=hrow.cells[i].getAttribute("format");if(f_a){if(hrow.cells[i].getAttribute("type").toLowerCase().indexOf("calendar")!=-1){windowf._dtmask=f_a}else{windowf.setNumberFormat(f_a,i)}}}windowf.setHeader(za);windowf.setInitWidths(zb);windowf.setColAlign(zc);windowf.setColTypes(zd);windowf.setColSorting(ze);if(obj.getAttribute("gridHeight")=="auto"){windowf.enableAutoHeigth(true)}if(obj.getAttribute("multiline")){windowf.enableMultiline(true)}var lmn=mr.getAttribute("lightnavigation");if(lmn){windowf.enableLightMouseNavigation(lmn)}var evr=mr.getAttribute("evenrow");var uevr=mr.getAttribute("unevenrow");if(evr||uevr){windowf.enableAlterCss(evr,uevr)}if(drag){windowf.enableDragAndDrop(true)}windowf.init();if(obj.getAttribute("split")){windowf.splitAt(obj.getAttribute("split"))}windowf.callEvent("onXLS",[]);windowf._process_inner_html(mr,1);if(acs2){eval(acs2)}if(obj.parentNode&&obj.parentNode.removeChild){obj.parentNode.removeChild(obj)}windowf.callEvent("onXLE",[]);return windowf}dhtmlXGridObject.prototype._process_html=function(d){if(d.tagName&&d.tagName=="TABLE"){return this._process_inner_html(d,0)}var e=document.createElement("DIV");e.innerHTML=d.xmlDoc.responseText;var f=e.getElementsByTagName("TABLE")[0];this._process_inner_html(f,0)};dhtmlXGridObject.prototype._process_inner_html=function(j,h){var f=j.rows.length;for(var g=h;g<f;g++){var i=j.rows[g].getAttribute("id")||g;this.rowsBuffer.push({idd:i,data:j.rows[g],_parser:this._process_html_row,_locator:this._get_html_data})}this.render_dataset();this.setSizes()};dhtmlXGridObject.prototype._process_html_row=function(l,o){var m=o.getElementsByTagName("TD");var i=[];l._attrs=this._xml_attrs(o);for(var p=0;p<m.length;p++){var n=m[p];var j=n.getAttribute("type");if(l.childNodes[p]){if(j){l.childNodes[p]._cellType=j}l.childNodes[p]._attrs=this._xml_attrs(m[p])}if(n.firstChild){i.push(n.innerHTML)}else{i.push("")}if(n.colSpan>1){l.childNodes[p]._attrs.colspan=n.colSpan;for(var q=1;q<n.colSpan;q++){i.push("")}}}for(p<m.length;p<l.childNodes.length;p++){l.childNodes[p]._attrs={}}this._fillRow(l,(this._c_order?this._swapColumns(i):i));return l};dhtmlXGridObject.prototype._get_html_data=function(c,d){c=c.firstChild;while(true){if(!c){return""}if(c.tagName=="TD"){d--}if(d<0){break}c=c.nextSibling}return(c.firstChild?c.firstChild.data:"")};dhtmlxEvent(window,"load",function(){var d=document.getElementsByTagName("table");for(var a=0;a<d.length;a++){if(d[a].className=="dhtmlxGrid"){dhtmlXGridFromTable(d[a])}}});if(!window.dhtmlx){window.dhtmlx={}}(function(){var t=null;function r(a,c){var b=a.callback;s(false);a.box.parentNode.removeChild(a.box);t=a.box=null;if(b){b(c)}}function D(a){if(t){a=a||event;var b=a.which||event.keyCode;if(dhtmlx.message.keyboard){if(b==13||b==32){r(t,true)}if(b==27){r(t,false)}}if(a.preventDefault){a.preventDefault()}return !(a.cancelBubble=true)}}if(document.attachEvent){document.attachEvent("onkeydown",D)}else{document.addEventListener("keydown",D,true)}function s(a){if(!s.cover){s.cover=document.createElement("DIV");s.cover.onkeydown=D;s.cover.className="dhx_modal_cover";document.body.appendChild(s.cover)}var b=document.body.scrollHeight;s.cover.style.display=a?"inline-block":"none"}function x(a,b){return"<div class='dhtmlx_popup_button' result='"+b+"' ><div>"+a+"</div></div>"}function A(a){if(!q.area){q.area=document.createElement("DIV");q.area.className="dhtmlx_message_area";q.area.style[q.position]="15px";document.body.appendChild(q.area)}q.hide(a.id);var b=document.createElement("DIV");b.innerHTML="<div>"+a.text+"</div>";b.className="dhtmlx-info dhtmlx-"+a.type;b.onclick=function(){if(a){q.hide(a.id)}a=null};if(q.position=="bottom"&&q.area.firstChild){q.area.insertBefore(b,q.area.firstChild)}else{q.area.appendChild(b)}if(a.expire>0){q.timers[a.id]=window.setTimeout(function(){q.hide(a.id)},a.expire)}q.pull[a.id]=b;b=null;return a.id}function w(f,d,a){var b=document.createElement("DIV");b.className=" dhtmlx_modal_box dhtmlx-"+f.type;b.setAttribute("dhxbox",1);var g="";if(f.width){b.style.width=f.width}if(f.height){b.style.height=f.height}if(f.title){g+='<div class="dhtmlx_popup_title">'+f.title+"</div>"}g+='<div class="dhtmlx_popup_text"><span>'+(f.content?"":f.text)+'</span></div><div  class="dhtmlx_popup_controls">';if(d){g+=x(f.ok||"OK",true)}if(a){g+=x(f.cancel||"Cancel",false)}if(f.buttons){for(var e=0;e<f.buttons.length;e++){g+=x(f.buttons[e],e)}}g+="</div>";b.innerHTML=g;if(f.content){var c=f.content;if(typeof c=="string"){c=document.getElementById(c)}if(c.style.display=="none"){c.style.display=""}b.childNodes[f.title?1:0].appendChild(c)}b.onclick=function(j){j=j||event;var h=j.target||j.srcElement;if(!h.className){h=h.parentNode}if(h.className=="dhtmlx_popup_button"){var i=h.getAttribute("result");i=(i=="true")||(i=="false"?false:i);r(f,i)}};f.box=b;if(d||a){t=f}return b}function p(e,d,b){var c=e.tagName?e:w(e,d,b);if(!e.hidden){s(true)}document.body.appendChild(c);var f=e.left||Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-c.offsetWidth)/2));var a=e.top||Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-c.offsetHeight)/2));if(e.position=="top"){c.style.top="-3px"}else{c.style.top=a+"px"}c.style.left=f+"px";c.onkeydown=D;c.focus();if(e.hidden){dhtmlx.modalbox.hide(c)}return c}function u(a){return p(a,true,false)}function C(a){return p(a,true,true)}function y(a){return p(a)}function v(b,c,a){if(typeof b!="object"){if(typeof c=="function"){a=c;c=""}b={text:b,type:c,callback:a}}return b}function z(b,c,d,a){if(typeof b!="object"||!b){b={text:b,type:c,expire:d,id:a}}b.id=b.id||q.uid();b.expire=b.expire||q.expire;return b}dhtmlx.alert=function(){var a=v.apply(this,arguments);a.type=a.type||"confirm";return u(a)};dhtmlx.confirm=function(){var a=v.apply(this,arguments);a.type=a.type||"alert";return C(a)};dhtmlx.modalbox=function(){var a=v.apply(this,arguments);a.type=a.type||"alert";return y(a)};dhtmlx.modalbox.hide=function(a){while(a&&a.getAttribute&&!a.getAttribute("dhxbox")){a=a.parentNode}if(a){a.parentNode.removeChild(a);s(false);t=null}};var q=dhtmlx.message=function(b,c,d,a){b=z.apply(this,arguments);b.type=b.type||"info";var e=b.type.split("-")[0];switch(e){case"alert":return u(b);case"confirm":return C(b);case"modalbox":return y(b);default:return A(b);break}};q.seed=(new Date()).valueOf();q.uid=function(){return q.seed++};q.expire=4000;q.keyboard=true;q.position="top";q.pull={};q.timers={};q.hideAll=function(){for(var a in q.pull){q.hide(a)}};q.hide=function(a){var b=q.pull[a];if(b&&b.parentNode){window.setTimeout(function(){b.parentNode.removeChild(b);b=null},2000);b.className+=" hidden";if(q.timers[a]){window.clearTimeout(q.timers[a])}delete q.pull[a]}}})();function dataProcessor(b){this.serverProcessor=b;this.action_param="!nativeeditor_status";this.object=null;this.updatedRows=[];this.autoUpdate=true;this.updateMode="cell";this._tMode="GET";this._headers=null;this._payload=null;this.post_delim="_";this._waitMode=0;this._in_progress={};this._invalid={};this.mandatoryFields=[];this.messages=[];this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"};this.enableUTFencoding(true);dhx4._eventable(this);if(this.connector_init){this.setTransactionMode("POST",true);this.serverProcessor+=(this.serverProcessor.indexOf("?")!=-1?"&":"?")+"editing=true"}return this}dataProcessor.prototype={url:function(b){if(b.indexOf("?")!=-1){return"&"}else{return"?"}},setTransactionMode:function(c,d){if(typeof c=="object"){this._tMode=c.mode||this._tMode;this._headers=this._headers||c.headers;this._payload=this._payload||c.payload}else{this._tMode=c;this._tSend=d}if(this._tMode=="REST"){this._tSend=false;this._endnm=true}if(this._tMode=="JSON"){this._tSend=false;this._endnm=true;this._headers=this._headers||{};this._headers["Content-type"]="application/json"}},escape:function(b){if(this._utf){return encodeURIComponent(b)}else{return escape(b)}},enableUTFencoding:function(b){this._utf=dhx4.s2b(b)},setDataColumns:function(b){this._columns=(typeof b=="string")?b.split(","):b},getSyncState:function(){return !this.updatedRows.length},enableDataNames:function(b){this._endnm=dhx4.s2b(b)},enablePartialDataSend:function(b){this._changed=dhx4.s2b(b)},setUpdateMode:function(c,d){this.autoUpdate=(c=="cell");this.updateMode=c;this.dnd=d},ignore:function(c,d){this._silent_mode=true;c.call(d||window);this._silent_mode=false},setUpdated:function(i,j,h){this._log("item "+i+" "+(j?"marked":"unmarked")+" ["+(h||"updated")+"]");if(this._silent_mode){return}var f=this.findRow(i);h=h||"updated";var g=this.obj.getUserData(i,this.action_param);if(g&&h=="updated"){h=g}if(j){this.set_invalid(i,false);this.updatedRows[f]=i;this.obj.setUserData(i,this.action_param,h);if(this._in_progress[i]){this._in_progress[i]="wait"}}else{if(!this.is_invalid(i)){this.updatedRows.splice(f,1);this.obj.setUserData(i,this.action_param,"")}}if(!j){this._clearUpdateFlag(i)}this.markRow(i,j,h);if(j&&this.autoUpdate){this.sendData(i)}},_clearUpdateFlag:function(b){},markRow:function(i,m,j){var l="";var g=this.is_invalid(i);if(g){l=this.styles[g];m=true}if(this.callEvent("onRowMark",[i,m,j,g])){l=this.styles[m?j:"clear"]+l;this.obj[this._methods[0]](i,l);if(g&&g.details){l+=this.styles[g+"_cell"];for(var h=0;h<g.details.length;h++){if(g.details[h]){this.obj[this._methods[1]](i,h,l)}}}}},getState:function(b){return this.obj.getUserData(b,this.action_param)},is_invalid:function(b){return this._invalid[b]},set_invalid:function(f,d,e){if(e){d={value:d,details:e,toString:function(){return this.value.toString()}}}this._invalid[f]=d},checkBeforeUpdate:function(b){return true},sendData:function(b){if(b){this._log("Sending: "+b)}if(this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2)){return}if(this.obj.editStop){this.obj.editStop()}if(typeof b=="undefined"||this._tSend){return this.sendAllData()}if(this._in_progress[b]){return false}this.messages=[];if(this.getState(b)!=="deleted"){if(!this.checkBeforeUpdate(b)&&this.callEvent("onValidationError",[b,this.messages])){return false}}this._beforeSendData(this._getRowData(b),b)},_beforeSendData:function(d,c){if(!this.callEvent("onBeforeUpdate",[c,this.getState(c),d])){return false}this._sendData(d,c)},serialize:function(i,h){if(typeof i=="string"){return i}if(typeof h!="undefined"){return this.serialize_one(i,"")}else{var g=[];var j=[];for(var f in i){if(i.hasOwnProperty(f)){g.push(this.serialize_one(i[f],f+this.post_delim));j.push(f)}}g.push("ids="+this.escape(j.join(",")));if(window.dhtmlx&&dhtmlx.security_key){g.push("dhx_security="+dhtmlx.security_key)}return g.join("&")}},serialize_one:function(g,e){if(typeof g=="string"){return g}var f=[];for(var h in g){if(g.hasOwnProperty(h)){if((h=="id"||h==this.action_param)&&this._tMode=="REST"){continue}f.push(this.escape((e||"")+h)+"="+this.escape(g[h]))}}return f.join("&")},_applyPayload:function(d){if(this._payload){for(var c in this._payload){d=d+(d.indexOf("?")===-1?"?":"&")+this.escape(c)+"="+this.escape(this._payload[c])}}return d},_sendData:function(w,v){this._log("url: "+this.serverProcessor);this._log(w);if(!w){return}if(!this.callEvent("onBeforeDataSending",v?[v,this.getState(v),w]:[null,null,w])){return false}if(v){this._in_progress[v]=(new Date()).valueOf()}var q=this;var r=function(c){var a=[];if(v){a.push(v)}else{if(w){for(var b in w){a.push(b)}}}return q.afterUpdate(q,c,a)};var z=this.serverProcessor+(this._user?(this.url(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&")):"");var o=this._applyPayload(z);if(this._tMode=="GET"){dhx4.ajax.query({url:o+((o.indexOf("?")!=-1)?"&":"?")+this.serialize(w,v),method:"GET",headers:this._headers,callback:r})}else{if(this._tMode=="POST"){dhx4.ajax.query({url:o,method:"POST",headers:this._headers,callback:r,data:this.serialize(w,v)})}else{if(this._tMode=="JSON"){var u=w[this.action_param];var s={};for(var p in w){s[p]=w[p]}delete s[this.action_param];delete s.id;delete s.gr_id;dhx4.ajax.query({url:o,method:"POST",headers:this._headers,callback:r,data:JSON.stringify({id:v,action:u,data:s})})}else{if(this._tMode=="REST"){var x=this.getState(v);var y=z.replace(/(\&|\?)editing\=true/,"");var t=y.split("?");if(t[1]){t[1]="?"+t[1]}var s="";var A="post";if(x=="inserted"){s=this.serialize(w,v)}else{if(x=="deleted"){A="DELETE";y=t[0]+v+(t[1]||"")}else{A="PUT";s=this.serialize(w,v);y=t[0]+v+(t[1]||"")}}this._applyPayload(y);dhx4.ajax.query({url:y,method:A,headers:this._headers,data:s,callback:r})}}}}this._waitMode++},sendAllData:function(){this._log("Sending all updated items");if(!this.updatedRows.length){return}this.messages=[];var c=true;for(var d=0;d<this.updatedRows.length;d++){if(this.getState(this.updatedRows[d])!=="deleted"){c&=this.checkBeforeUpdate(this.updatedRows[d])}}if(!c&&!this.callEvent("onValidationError",["",this.messages])){return false}if(this._tSend){this._sendData(this._getAllData())}else{for(var d=0;d<this.updatedRows.length;d++){if(!this._in_progress[this.updatedRows[d]]){if(this.is_invalid(this.updatedRows[d])){continue}this._beforeSendData(this._getRowData(this.updatedRows[d]),this.updatedRows[d]);if(this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2)){return}}}}},_getAllData:function(i){var f={};var g=false;for(var j=0;j<this.updatedRows.length;j++){var h=this.updatedRows[j];if(this._in_progress[h]||this.is_invalid(h)){continue}if(!this.callEvent("onBeforeUpdate",[h,this.getState(h),this._getRowData(h)])){continue}f[h]=this._getRowData(h,h+this.post_delim);g=true;this._in_progress[h]=(new Date()).valueOf()}return g?f:null},setVerificator:function(c,d){this.mandatoryFields[c]=d||(function(a){return(a!=="")})},clearVerificator:function(b){this.mandatoryFields[b]=false},findRow:function(c){var d=0;for(d=0;d<this.updatedRows.length;d++){if(c==this.updatedRows[d]){break}}return d},defineAction:function(d,c){if(!this._uActions){this._uActions=[]}this._uActions[d]=c},afterUpdateCallback:function(h,j,l,m){this._log("Action: "+l+" SID:"+h+" TID:"+j,m);var i=h;var n=(l!="error"&&l!="invalid");if(!n){this.set_invalid(h,l)}if((this._uActions)&&(this._uActions[l])&&(!this._uActions[l](m))){return(delete this._in_progress[i])}if(this._in_progress[i]!="wait"){this.setUpdated(h,false)}var o=h;switch(l){case"inserted":case"insert":if(j!=h){this.obj[this._methods[2]](h,j);h=j}break;case"delete":case"deleted":this.obj.setUserData(h,this.action_param,"true_deleted");this.obj[this._methods[3]](h);delete this._in_progress[i];return this.callEvent("onAfterUpdate",[h,l,j,m]);break}if(this._in_progress[i]!="wait"){if(n){this.obj.setUserData(h,this.action_param,"")}delete this._in_progress[i]}else{delete this._in_progress[i];this.setUpdated(j,true,this.obj.getUserData(h,this.action_param))}this.callEvent("onAfterUpdate",[o,l,j,m])},enableDebug:function(){this._debug=true},_log:function(){if(this._debug&&window.console&&window.console.info){window.console.info.apply(window.console,arguments)}},afterUpdate:function(r,s,y){this._log("Server response received");if(window.JSON){try{var e=JSON.parse(s.xmlDoc.responseText);var v=e.action||this.getState(y)||"updated";var x=e.sid||y[0];var w=e.tid||y[0];r.afterUpdateCallback(x,w,v,e);r.finalizeUpdate();return}catch(q){}}var i=dhx4.ajax.xmltop("data",s.xmlDoc);if(!i||i.tagName=="DIV"){return this.cleanUpdate(y)}var p=dhx4.ajax.xpath("//data/action",i);if(!p.length){return this.cleanUpdate(y)}for(var t=0;t<p.length;t++){var u=p[t];var v=u.getAttribute("type");var x=u.getAttribute("sid");var w=u.getAttribute("tid");r.afterUpdateCallback(x,w,v,u)}r.finalizeUpdate()},cleanUpdate:function(c){if(c){for(var d=0;d<c.length;d++){delete this._in_progress[c[d]]}}},finalizeUpdate:function(){if(this._waitMode){this._waitMode--}if((this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length){this.sendData()}this.callEvent("onAfterUpdateFinish",[]);if(!this.updatedRows.length){this.callEvent("onFullSync",[])}},init:function(b){this.obj=b;if(b._dp_init){b._dp_init(this)}if(this.connector_init){b._dataprocessor=this}},setOnAfterUpdate:function(b){this.attachEvent("onAfterUpdate",b)},setOnBeforeUpdateHandler:function(b){this.attachEvent("onBeforeDataSending",b)},setAutoUpdate:function(f,d){f=f||2000;this._user=d||(new Date()).valueOf();this._need_update=false;this._update_busy=false;this.attachEvent("onAfterUpdate",function(h,b,a,c){this.afterAutoUpdate(h,b,a,c)});this.attachEvent("onFullSync",function(){this.fullSync()});var e=this;window.setInterval(function(){e.loadUpdate()},f)},afterAutoUpdate:function(f,h,g,e){if(h=="collision"){this._need_update=true;return false}else{return true}},fullSync:function(){if(this._need_update==true){this._need_update=false;this.loadUpdate()}return true},getUpdates:function(d,c){if(this._update_busy){return false}else{this._update_busy=true}dhx4.ajax.get(d,c)},_v:function(b){if(b.firstChild){return b.firstChild.nodeValue}return""},_a:function(e){var f=[];for(var d=0;d<e.length;d++){f[d]=this._v(e[d])}return f},loadUpdate:function(){var d=this;var e=this.obj.getUserData(0,"version");var f=this.serverProcessor+this.url(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+e].join("&");f=f.replace("editing=true&","");this.getUpdates(f,function(c){var b=dhx4.ajax.xmltop("updates",c.xmlDoc);var o=dhx4.ajax.xpath("//userdata",b);d.obj.setUserData(0,"version",d._v(o[0]));var q=dhx4.ajax.xpath("//update",b);if(q.length){d._silent_mode=true;for(var n=0;n<q.length;n++){var p=q[n].getAttribute("status");var a=q[n].getAttribute("id");var i=q[n].getAttribute("parent");switch(p){case"inserted":d.callEvent("insertCallback",[q[n],a,i]);break;case"updated":d.callEvent("updateCallback",[q[n],a,i]);break;case"deleted":d.callEvent("deleteCallback",[q[n],a,i]);break}}d._silent_mode=false}d._update_busy=false;d=null})}};if(window.dataProcessor&&!dataProcessor.prototype.init_original){dataProcessor.prototype.connector_init=true};